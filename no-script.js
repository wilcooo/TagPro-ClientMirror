!function Container(){var PIXI={},tagpro={},ContainedWebSocket=WebSocket;delete window.WebSocket,delete window.MozWebSocket;var onlyNatives=function(){var t,e,i=Object.prototype.toString,n=Function.prototype.toString,r=/^\[object .+?Constructor\]$/,o=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return!!("function"==(e=typeof(t=ContainedWebSocket))?o.test(n.call(t)):t&&"object"==e&&r.test(i.call(t)))}();if(onlyNatives){var t,e,factory;if(t=this,e=function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t,e){"object"===(void 0===t?"undefined":r(t))&&(e=t,t=void 0),e=e||{};var i,n=o(t),s=n.source,u=n.id,h=n.path,p=c[u]&&h in c[u].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||p?(l("ignoring socket cache for %s",s),i=a(s,e)):(c[u]||(l("new io instance for %s",s),c[u]=a(s,e)),i=c[u]),n.query&&!e.query&&(e.query=n.query),i.socket(n.path,e)}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(1),s=i(7),a=i(12),l=i(3)("socket.io-client");t.exports=e=n;var c=e.managers={};e.protocol=s.protocol,e.connect=n,e.Manager=i(12),e.Socket=i(37)},function(t,e,i){(function(e){"use strict";var n=i(2),r=i(3)("socket.io-client:url");t.exports=function(t,i){var o=t;i=i||e.location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==i?i.protocol+"//"+t:"https://"+t),r("parse %s",t),o=n(t)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";var s=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port,o.href=o.protocol+"://"+s+(i&&i.port===o.port?"":":"+o.port),o}}).call(e,function(){return this}())},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,r=t.indexOf("["),o=t.indexOf("]");-1!=r&&-1!=o&&(t=t.substring(0,r)+t.substring(r,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=i.exec(t||""),a={},l=14;l--;)a[n[l]]=s[l]||"";return-1!=r&&-1!=o&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,i){(function(n){function r(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}(e=t.exports=i(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++r)}),t.splice(o,0,n)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=r,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(r())}).call(e,i(4))},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(){f&&p&&(f=!1,p.length?d=p.concat(d):m=-1,d.length&&s())}function s(){if(!f){var t=r(o);f=!0;for(var e=d.length;e;){for(p=d,d=[];++m<e;)p&&p[m].run();m=-1,e=d.length}p=null,f=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function l(){}var c,u,h=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(t){c=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}}();var p,d=[],f=!1,m=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];d.push(new a(t,e)),1!==d.length||f||r(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.prependListener=l,h.prependOnceListener=l,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,i){function n(t){function i(){if(i.enabled){var t=i,r=+new Date,o=r-(n||r);t.diff=o,t.prev=n,t.curr=r,n=r;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;l++;var r=e.formatters[n];if("function"==typeof r){var o=s[l];i=r.call(t,o),s.splice(l,1),l--}return i}),e.formatArgs.call(t,s),(i.log||e.log||console.log.bind(console)).apply(t,s)}}var n;return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=function(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),i.destroy=r,"function"==typeof e.init&&e.init(i),e.instances.push(i),i}function r(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];var i,n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var o=e.instances[i];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(6),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function i(t){return n(t,a,"day")||n(t,s,"hour")||n(t,o,"minute")||n(t,r,"second")||t+" ms"}function n(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var r=1e3,o=60*r,s=60*o,a=24*s,l=365.25*a;t.exports=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*l;case"days":case"day":case"d":return i*a;case"hours":case"hour":case"hrs":case"hr":case"h":return i*s;case"minutes":case"minute":case"mins":case"min":case"m":return i*o;case"seconds":case"second":case"secs":case"sec":case"s":return i*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(t);if("number"===n&&!1===isNaN(t))return e.long?i(t):function(t){return t>=a?Math.round(t/a)+"d":t>=s?Math.round(t/s)+"h":t>=o?Math.round(t/o)+"m":t>=r?Math.round(t/r)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){function n(){}function r(t){var i=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data){var n=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===n)return f;i+=n}return c("encoded %j as %s",t,i),i}function o(){this.reconstructor=null}function s(t){var i=0,n={type:Number(t.charAt(0))};if(null==e.types[n.type])return l("unknown packet type "+n.type);if(e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type){for(var r="";"-"!==t.charAt(++i)&&(r+=t.charAt(i),i!=t.length););if(r!=Number(r)||"-"!==t.charAt(i))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(i+1))for(n.nsp="";++i;){if(","===(s=t.charAt(i)))break;if(n.nsp+=s,i===t.length)break}else n.nsp="/";var o=t.charAt(i+1);if(""!==o&&Number(o)==o){for(n.id="";++i;){var s;if(null==(s=t.charAt(i))||Number(s)!=s){--i;break}if(n.id+=t.charAt(i),i===t.length)break}n.id=Number(n.id)}if(t.charAt(++i)){var a=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==a&&(n.type===e.ERROR||p(a))))return l("invalid payload");n.data=a}return c("decoded %s as %j",t,n),n}function a(t){this.reconPack=t,this.buffers=[]}function l(t){return{type:e.ERROR,data:"parser error: "+t}}var c=i(3)("socket.io-parser"),u=i(8),h=i(9),p=i(10),d=i(11);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=o;var f=e.ERROR+'"encode error"';n.prototype.encode=function(t,i){(c("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){h.removeBlobs(t,function(t){var i=h.deconstructPacket(t),n=r(i.packet),o=i.buffers;o.unshift(n),e(o)})}(t,i):i([r(t)])},u(o.prototype),o.prototype.add=function(t){var i;if("string"==typeof t)i=s(t),e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type?(this.reconstructor=new a(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!d(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,i){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,r=0;r<i.length;r++)if((n=i[r])===e||n.fn===e){i.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,r=(i=i.slice(0)).length;n<r;++n)i[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){(function(t){var n=i(10),r=i(11),o=Object.prototype.toString,s="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),a="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);e.deconstructPacket=function(t){var e=[],i=t.data,o=t;return o.data=function t(e,i){if(!e)return e;if(r(e)){var o={_placeholder:!0,num:i.length};return i.push(e),o}if(n(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a],i);return s}if("object"==typeof e&&!(e instanceof Date)){for(var l in s={},e)s[l]=t(e[l],i);return s}return e}(i,e),o.attachments=e.length,{packet:o,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,i){if(!e)return e;if(e&&e._placeholder)return i[e.num];if(n(e))for(var r=0;r<e.length;r++)e[r]=t(e[r],i);else if("object"==typeof e)for(var o in e)e[o]=t(e[o],i);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var i=0,o=t;(function t(l,c,u){if(!l)return l;if(s&&l instanceof Blob||a&&l instanceof File){i++;var h=new FileReader;h.onload=function(){u?u[c]=this.result:o=this.result,--i||e(o)},h.readAsArrayBuffer(l)}else if(n(l))for(var p=0;p<l.length;p++)t(l[p],p,l);else if("object"==typeof l&&!r(l))for(var d in l)t(l[d],d,l)})(o),i||e(o)}}).call(e,function(){return this}())},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){(function(e){t.exports=function(t){return i&&e.Buffer.isBuffer(t)||n&&(t instanceof e.ArrayBuffer||r(t))};var i="function"==typeof e.Buffer&&"function"==typeof e.Buffer.isBuffer,n="function"==typeof e.ArrayBuffer,r=n&&"function"==typeof e.ArrayBuffer.isView?e.ArrayBuffer.isView:function(t){return t.buffer instanceof e.ArrayBuffer}}).call(e,function(){return this}())},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);t&&"object"===(void 0===t?"undefined":r(t))&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=e.parser||l;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(13),s=i(37),a=i(8),l=i(7),c=i(39),u=i(40),h=i(3)("socket.io-client:manager"),p=i(36),d=i(41),f=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},n.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},a(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(t,e){if(h("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=o(this.uri,this.opts);var i=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=c(i,"open",function(){n.onopen(),t&&t()}),s=c(i,"error",function(e){if(h("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;h("connect attempt will timeout after %d",a);var l=setTimeout(function(){h("connect attempt timed out after %d",a),r.destroy(),i.close(),i.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(r),this.subs.push(s),this},n.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",u(this,"ondata"))),this.subs.push(c(t,"ping",u(this,"onping"))),this.subs.push(c(t,"pong",u(this,"onpong"))),this.subs.push(c(t,"error",u(this,"onerror"))),this.subs.push(c(t,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){h("error",t),this.emitAll("error",t)},n.prototype.socket=function(t,e){function i(){~p(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[t];if(!n){n=new s(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",i),n.on("connect",function(){n.id=r.generateId(t)}),this.autoConnect&&i()}return n},n.prototype.destroy=function(t){var e=p(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},n.prototype.packet=function(t){h("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},n.prototype.cleanup=function(){h("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){h("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){h("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();h("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(h("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(h("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(h("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,i){t.exports=i(14),t.exports.parser=i(21)},function(t,e,i){(function(e){function n(t,i){if(!(this instanceof n))return new n(t,i);i=i||{},t&&"object"==typeof t&&(i=t,t=null),t?(t=c(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=c(i.host).host),this.secure=null!=i.secure?i.secure:e.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(e.location?location.hostname:"localhost"),this.port=i.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var r="object"==typeof e&&e;r.global===r&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var r=i(15),o=i(8),s=i(3)("engine.io-client:socket"),a=i(36),l=i(21),c=i(2),u=i(30);t.exports=n,n.priorWebsocketSuccess=!1,o(n.prototype),n.protocol=l.protocol,n.Socket=n,n.Transport=i(20),n.transports=i(15),n.parser=i(21),n.prototype.createTransport=function(t){s('creating transport "%s"',t);var e=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.query);e.EIO=l.protocol,e.transport=t;var i=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){s("setting transport %s",t.name);var e=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(p.onlyBinaryUpgrades){var e=!this.supportsBinary&&p.transport.supportsBinary;h=h||e}h||(s('probe transport "%s" opened',t),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(e){if(!h)if("pong"===e.type&&"probe"===e.data){if(s('probe transport "%s" pong',t),p.upgrading=!0,p.emit("upgrading",u),!u)return;n.priorWebsocketSuccess="websocket"===u.name,s('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){h||"closed"!==p.readyState&&(s("changing transport and sending upgrade packet"),c(),p.setTransport(u),u.send([{type:"upgrade"}]),p.emit("upgrade",u),u=null,p.upgrading=!1,p.flush())})}else{s('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=u.name,p.emit("upgradeError",i)}}))}function i(){h||(h=!0,c(),u.close(),u=null)}function r(e){var n=new Error("probe error: "+e);n.transport=u.name,i(),s('probe transport "%s" failed because of error: %s',t,e),p.emit("upgradeError",n)}function o(){r("transport closed")}function a(){r("socket closed")}function l(t){u&&t.name!==u.name&&(s('"%s" works - aborting "%s"',t.name,u.name),i())}function c(){u.removeListener("open",e),u.removeListener("error",r),u.removeListener("close",o),p.removeListener("close",a),p.removeListener("upgrading",l)}s('probing transport "%s"',t);var u=this.createTransport(t,{probe:1}),h=!1,p=this;n.priorWebsocketSuccess=!1,u.once("open",e),u.once("error",r),u.once("close",o),this.once("close",a),this.once("upgrading",l),u.open()},n.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else s('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},n.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var r={type:t,data:e,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),s("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function i(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},n.prototype.onError=function(t){s("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},n.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~a(this.transports,t[i])&&e.push(t[i]);return e}}).call(e,function(){return this}())},function(t,e,i){(function(t){var n=i(16),r=i(18),o=i(33),s=i(34);e.polling=function(e){var i=!1,s=!1,a=!1!==e.jsonp;if(t.location){var l="https:"===location.protocol,c=location.port;c||(c=l?443:80),i=e.hostname!==location.hostname||c!==e.port,s=e.secure!==l}if(e.xdomain=i,e.xscheme=s,"open"in new n(e)&&!e.forceJSONP)return new r(e);if(!a)throw new Error("JSONP disabled");return new o(e)},e.websocket=s}).call(e,function(){return this}())},function(t,e,i){(function(e){var n=i(17);t.exports=function(t){var i=t.xdomain,r=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(t){}if(!i)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(e,function(){return this}())},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,i){(function(e){function n(){}function r(t){if(l.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,e.location){var i="https:"===location.protocol,n=location.port;n||(n=i?443:80),this.xd=t.hostname!==e.location.hostname||n!==t.port,this.xs=t.secure!==i}}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function s(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}var a=i(16),l=i(19),c=i(8),u=i(31),h=i(3)("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=o,u(r,l),r.prototype.supportsBinary=!0,r.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new o(t)},r.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:i}),r=this;n.on("success",e),n.on("error",function(t){r.onError("xhr post error",t)}),this.sendXhr=n},r.prototype.doPoll=function(){h("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},c(o.prototype),o.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new a(t),n=this;try{h("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this.extraHeaders[r])}catch(t){}if("POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){n.onLoad()},i.onerror=function(){n.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState)try{var t=i.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===t&&(i.responseType="arraybuffer")}catch(t){}4===i.readyState&&(200===i.status||1223===i.status?n.onLoad():setTimeout(function(){n.onError(i.status)},0))},h("xhr data %s",this.data),i.send(this.data)}catch(t){return void setTimeout(function(){n.onError(t)},0)}e.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(t){}e.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return void 0!==e.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",s):e.addEventListener&&e.addEventListener("beforeunload",s,!1))}).call(e,function(){return this}())},function(t,e,i){function n(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),r.call(this,t)}var r=i(20),o=i(30),s=i(21),a=i(31),l=i(32),c=i(3)("engine.io-client:polling");t.exports=n;var u=null!=new(i(16))({xdomain:!1}).responseType;a(n,r),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){c("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){c("pre-pause polling complete"),--n||e()})),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",function(){c("pre-pause writing complete"),--n||e()}))}else e()},n.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var e=this;c("polling got data %s",t);s.decodePayload(t,this.socket.binaryType,function(t,i,n){return"opening"===e.readyState&&e.onOpen(),"close"===t.type?(e.onClose(),!1):void e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){c("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=l()),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,e,i){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var r=i(21),o=i(8);t.exports=n,o(n.prototype),n.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,i){(function(t){function n(t,i){return i("b"+e.packets[t.type]+t.data.data)}function r(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=y[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}function o(t,i,n){if(!i)return e.encodeBase64Packet(t,n);if(m)return function(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=new FileReader;return r.onload=function(){t.data=r.result,e.encodePacket(t,i,!0,n)},r.readAsArrayBuffer(t.data)}(t,i,n);var r=new Uint8Array(1);return r[0]=y[t.type],n(new g([r.buffer,t.data]))}function s(t,e,i){for(var n=new Array(t.length),r=h(t.length,i),o=function(t,i,r){e(i,function(e,i){n[t]=i,r(e,n)})},s=0;s<t.length;s++)o(s,t[s],r)}var a,l=i(22),c=i(23),u=i(24),h=i(25),p=i(26);t&&t.ArrayBuffer&&(a=i(28));var d="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=d||f;e.protocol=3;var y=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},_=l(y),x={type:"error",data:"parser error"},g=i(29);e.encodePacket=function(e,i,s,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof s&&(a=s,s=null);var l=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&l instanceof ArrayBuffer)return r(e,i,a);if(g&&l instanceof t.Blob)return o(e,i,a);if(l&&l.base64)return n(e,a);var c=y[e.type];return void 0!==e.data&&(c+=s?p.encode(String(e.data),{strict:!1}):String(e.data)),a(""+c)},e.encodeBase64Packet=function(i,n){var r,o="b"+e.packets[i.type];if(g&&i.data instanceof t.Blob){var s=new FileReader;return s.onload=function(){var t=s.result.split(",")[1];n(o+t)},s.readAsDataURL(i.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(i.data))}catch(t){for(var a=new Uint8Array(i.data),l=new Array(a.length),c=0;c<a.length;c++)l[c]=a[c];r=String.fromCharCode.apply(null,l)}return o+=t.btoa(r),n(o)},e.decodePacket=function(t,i,n){if(void 0===t)return x;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),i);if(n&&!1===(t=function(t){try{t=p.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return x;var r=t.charAt(0);return Number(r)==r&&_[r]?t.length>1?{type:_[r],data:t.substring(1)}:{type:_[r]}:x}r=new Uint8Array(t)[0];var o=u(t,1);return g&&"blob"===i&&(o=new g([o])),{type:_[r],data:o}},e.decodeBase64Packet=function(t,e){var i=_[t.charAt(0)];if(!a)return{type:i,data:{base64:!0,data:t.substr(1)}};var n=a.decode(t.substr(1));return"blob"===e&&g&&(n=new g([n])),{type:i,data:n}},e.encodePayload=function(t,i,n){"function"==typeof i&&(n=i,i=null);var r=c(t);return i&&r?g&&!m?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n):t.length?void s(t,function(t,n){e.encodePacket(t,!!r&&i,!1,function(t){n(null,function(t){return t.length+":"+t}(t))})},function(t,e){return n(e.join(""))}):n("0:")},e.decodePayload=function(t,i,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,i,n);var r;if("function"==typeof i&&(n=i,i=null),""===t)return n(x,0,1);for(var o,s,a="",l=0,c=t.length;l<c;l++){var u=t.charAt(l);if(":"===u){if(""===a||a!=(o=Number(a)))return n(x,0,1);if(a!=(s=t.substr(l+1,o)).length)return n(x,0,1);if(s.length){if(r=e.decodePacket(s,i,!1),x.type===r.type&&x.data===r.data)return n(x,0,1);if(!1===n(r,l+o,c))return}l+=o,a=""}else a+=u}return""!==a?n(x,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,i){return t.length?void s(t,function(t,i){e.encodePacket(t,!0,!0,function(t){return i(null,t)})},function(t,e){var n=e.reduce(function(t,e){var i;return t+(i="string"==typeof e?e.length:e.byteLength).toString().length+i+2},0),r=new Uint8Array(n),o=0;return e.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);i=n.buffer}r[o++]=e?0:1;var a=i.byteLength.toString();for(s=0;s<a.length;s++)r[o++]=parseInt(a[s]);r[o++]=255;for(n=new Uint8Array(i),s=0;s<n.length;s++)r[o++]=n[s]}),i(r.buffer)}):i(new ArrayBuffer(0))},e.encodePayloadAsBlob=function(t,i){s(t,function(t,i){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);t=n.buffer,e[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)s[r]=parseInt(o[r]);if(s[o.length]=255,g){var a=new g([e.buffer,s.buffer,t]);i(null,a)}})},function(t,e){return i(new g(e))})},e.decodePayloadAsBinary=function(t,i,n){"function"==typeof i&&(n=i,i=null);for(var r=t,o=[];r.byteLength>0;){for(var s=new Uint8Array(r),a=0===s[0],l="",c=1;255!==s[c];c++){if(l.length>310)return n(x,0,1);l+=s[c]}r=u(r,2+l.length),l=parseInt(l);var h=u(r,0,l);if(a)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(t){var p=new Uint8Array(h);h="";for(c=0;c<p.length;c++)h+=String.fromCharCode(p[c])}o.push(h),r=u(r,l)}var d=o.length;o.forEach(function(t,r){n(e.decodePacket(t,i,!0),r,d)})}}).call(e,function(){return this}())},function(t,e){t.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},function(t,e,i){(function(e){var n=i(10),r=Object.prototype.toString,o="function"==typeof e.Blob||"[object BlobConstructor]"===r.call(e.Blob),s="function"==typeof e.File||"[object FileConstructor]"===r.call(e.File);t.exports=function t(i){if(!i||"object"!=typeof i)return!1;if(n(i)){for(var r=0,a=i.length;r<a;r++)if(t(i[r]))return!0;return!1}if("function"==typeof e.Buffer&&e.Buffer.isBuffer&&e.Buffer.isBuffer(i)||"function"==typeof e.ArrayBuffer&&i instanceof ArrayBuffer||o&&i instanceof Blob||s&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return t(i.toJSON(),!0);for(var l in i)if(Object.prototype.hasOwnProperty.call(i,l)&&t(i[l]))return!0;return!1}}).call(e,function(){return this}())},function(t,e){t.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-e),s=e,a=0;s<i;s++,a++)o[a]=r[s];return o.buffer}},function(t,e){function i(){}t.exports=function(t,e,n){function r(t,i){if(r.count<=0)throw new Error("after called too many times");--r.count,t?(o=!0,e(t),e=n):0!==r.count||o||e(null,i)}var o=!1;return n=n||i,r.count=t,0===t?e():r}},function(t,e,i){var n;(function(t,r){!function(o){function s(t){for(var e,i,n=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function a(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(t,e){return y(t>>e&63|128)}function c(t,e){if(0==(4294967168&t))return y(t);var i="";return 0==(4294965248&t)?i=y(t>>6&31|192):0==(4294901760&t)?(a(t,e)||(t=65533),i=y(t>>12&15|224),i+=l(t,6)):0==(4292870144&t)&&(i=y(t>>18&7|240),i+=l(t,12),i+=l(t,6)),i+y(63&t|128)}function u(){if(m>=f)throw Error("Invalid byte index");var t=255&d[m];if(m++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(t){var e,i;if(m>f)throw Error("Invalid byte index");if(m==f)return!1;if(e=255&d[m],m++,0==(128&e))return e;if(192==(224&e)){if((i=(31&e)<<6|u())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if((i=(15&e)<<12|u()<<6|u())>=2048)return a(i,t)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&((i=(7&e)<<18|u()<<12|u()<<6|u())>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}var p=("object"==typeof t&&t&&t.exports,"object"==typeof r&&r);p.global!==p&&p.window;var d,f,m,y=String.fromCharCode,_={version:"2.1.2",encode:function(t,e){for(var i=!1!==(e=e||{}).strict,n=s(t),r=n.length,o=-1,a="";++o<r;)a+=c(n[o],i);return a},decode:function(t,e){var i=!1!==(e=e||{}).strict;d=s(t),f=d.length,m=0;for(var n,r=[];!1!==(n=h(i));)r.push(n);return function(t){for(var e,i=t.length,n=-1,r="";++n<i;)(e=t[n])>65535&&(r+=y((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+=y(e);return r}(r)}};void 0===(n=function(){return _}.call(e,i,e,t))||(t.exports=n)}()}).call(e,i(27)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),n=0;n<t.length;n++)i[t.charCodeAt(n)]=n;e.encode=function(e){var i,n=new Uint8Array(e),r=n.length,o="";for(i=0;i<r;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,n,r,o,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(e=0;e<l;e+=4)n=i[t.charCodeAt(e)],r=i[t.charCodeAt(e+1)],o=i[t.charCodeAt(e+2)],s=i[t.charCodeAt(e+3)],h[c++]=n<<2|r>>4,h[c++]=(15&r)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return u}}()},function(t,e){(function(e){function i(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.buffer instanceof ArrayBuffer){var n=i.buffer;if(i.byteLength!==n.byteLength){var r=new Uint8Array(i.byteLength);r.set(new Uint8Array(n,i.byteOffset,i.byteLength)),n=r.buffer}t[e]=n}}}function n(t,e){e=e||{};var n=new o;i(t);for(var r=0;r<t.length;r++)n.append(t[r]);return e.type?n.getBlob(e.type):n.getBlob()}function r(t,e){return i(t),new Blob(t,e||{})}var o=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),l=o&&o.prototype.append&&o.prototype.getBlob;t.exports=s?a?e.Blob:r:l?n:void 0}).call(e,function(){return this}())},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),n=0,r=i.length;n<r;n++){var o=i[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){t.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e){"use strict";function i(t){var e="";do{e=o[t%s]+e,t=Math.floor(t/s)}while(t>0);return e}function n(){var t=i(+new Date);return t!==r?(l=0,r=t):t+"."+i(l++)}for(var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},l=0,c=0;c<s;c++)a[o[c]]=c;n.encode=i,n.decode=function(t){var e=0;for(c=0;c<t.length;c++)e=e*s+a[t.charAt(c)];return e},t.exports=n},function(t,e,i){(function(e){function n(){}function r(t){o.call(this,t),this.query=this.query||{},a||(e.___eio||(e.___eio=[]),a=e.___eio),this.index=a.length;var i=this;a.push(function(t){i.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=n)},!1)}var o=i(19),s=i(31);t.exports=r;var a,l=/\n/g,c=/\\n/g;s(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},r.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(t){(o=document.createElement("iframe")).name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=u,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),t=t.replace(c,"\\\n"),this.area.value=t.replace(l,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&i()}:this.iframe.onload=i}}).call(e,function(){return this}())},function(t,e,i){(function(e){function n(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=h&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(p=r),o.call(this,t)}var r,o=i(20),s=i(21),a=i(30),l=i(31),c=i(32),u=i(3)("engine.io-client:websocket"),h=ContainedWebSocket;if("undefined"==typeof window)try{r=i(35)}catch(t){}var p=h;p||"undefined"!=typeof window||(p=r),t.exports=n,l(n,o),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new p(t,e):new p(t):new p(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},n.prototype.write=function(t){var i=this;this.writable=!1;for(var n=t.length,r=0,o=n;r<o;r++)!function(t){s.encodePacket(t,i.supportsBinary,function(r){if(!i.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),i.perMessageDeflate)("string"==typeof r?e.Buffer.byteLength(r):r.length)<i.perMessageDeflate.threshold&&(o.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(r):i.ws.send(r,o)}catch(t){u("websocket closed before onclose event")}--n||(i.emit("flush"),setTimeout(function(){i.writable=!0,i.emit("drain")},0))})}(t[r])},n.prototype.onClose=function(){o.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},n.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===n.prototype.name)}}).call(e,function(){return this}())},function(t,e){},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e,i){"use strict";function n(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(7),s=i(8),a=i(38),l=i(39),c=i(40),u=i(3)("socket.io-client:socket"),h=i(30),p=i(23);t.exports=n;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=s.prototype.emit;s(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[l(t,"open",c(this,"onopen")),l(t,"packet",c(this,"onpacket")),l(t,"close",c(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var t=a(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){if(d.hasOwnProperty(t))return f.apply(this,arguments),this;var e=a(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:p(e))?o.BINARY_EVENT:o.EVENT,data:e,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"===r(this.query)?h.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:o.CONNECT,query:t})}else this.packet({type:o.CONNECT})},n.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){var e=t.nsp===this.nsp,i=t.type===o.ERROR&&"/"===t.nsp;if(e||i)switch(t.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(t);break;case o.ACK:case o.BINARY_ACK:this.onack(t);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var n=a(arguments);u("sending ack %j",n),e.packet({type:p(n)?o.BINARY_ACK:o.ACK,id:t,data:n})}}},n.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(t){return this.flags.compress=t,this},n.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}},function(t,e){"use strict";t.exports=function(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}},function(t,e){var i=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}}])},"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.io=e():t.io=e(),function(t,e){var i,n,r=typeof e,o=t.location,s=t.document,a=s.documentElement,l=t.jQuery,c=t.$,u={},h=[],p=h.concat,d=h.push,f=h.slice,m=h.indexOf,y=u.toString,_=u.hasOwnProperty,x="2.0.3".trim,g=function(t,e){return new g.fn.init(t,e,i)},v=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,b=/\S+/g,w=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^-ms-/,T=/-([\da-z])/gi,D=function(t,e){return e.toUpperCase()},A=function(){s.removeEventListener("DOMContentLoaded",A,!1),t.removeEventListener("load",A,!1),g.ready()};function B(t){var e=t.length,i=g.type(t);return!g.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)))}g.fn=g.prototype={jquery:"2.0.3",constructor:g,init:function(t,i,n){var r,o;if(!t)return this;if("string"==typeof t){if(!(r="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:w.exec(t))||!r[1]&&i)return!i||i.jquery?(i||n).find(t):this.constructor(i).find(t);if(r[1]){if(i=i instanceof g?i[0]:i,g.merge(this,g.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:s,!0)),C.test(r[1])&&g.isPlainObject(i))for(r in i)g.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}return(o=s.getElementById(r[2]))&&o.parentNode&&(this.length=1,this[0]=o),this.context=s,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):g.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),g.makeArray(t,this))},selector:"",length:0,toArray:function(){return f.call(this)},get:function(t){return null==t?this.toArray():t<0?this[this.length+t]:this[t]},pushStack:function(t){var e=g.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return g.each(this,t,e)},ready:function(t){return g.ready.promise().done(t),this},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},map:function(t){return this.pushStack(g.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},g.fn.init.prototype=g.fn,g.extend=g.fn.extend=function(){var t,i,n,r,o,s,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"object"==typeof a||g.isFunction(a)||(a={}),c===l&&(a=this,--l);l<c;l++)if(null!=(t=arguments[l]))for(i in t)n=a[i],a!==(r=t[i])&&(u&&r&&(g.isPlainObject(r)||(o=g.isArray(r)))?(o?(o=!1,s=n&&g.isArray(n)?n:[]):s=n&&g.isPlainObject(n)?n:{},a[i]=g.extend(u,s,r)):r!==e&&(a[i]=r));return a},g.extend({expando:"jQuery"+("2.0.3"+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===g&&(t.$=c),e&&t.jQuery===g&&(t.jQuery=l),g},isReady:!1,readyWait:1,holdReady:function(t){t?g.readyWait++:g.ready(!0)},ready:function(t){(!0===t?--g.readyWait:g.isReady)||(g.isReady=!0,!0!==t&&--g.readyWait>0||(n.resolveWith(s,[g]),g.fn.trigger&&g(s).trigger("ready").off("ready")))},isFunction:function(t){return"function"===g.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?u[y.call(t)]||"object":typeof t},isPlainObject:function(t){if("object"!==g.type(t)||t.nodeType||g.isWindow(t))return!1;try{if(t.constructor&&!_.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||s;var n=C.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=g.buildFragment([t],e,r),r&&g(r).remove(),g.merge([],n.childNodes))},parseJSON:JSON.parse,parseXML:function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new DOMParser).parseFromString(t,"text/xml")}catch(t){i=e}return i&&!i.getElementsByTagName("parsererror").length||g.error("Invalid XML: "+t),i},noop:function(){},globalEval:function(t){var e,i=eval;(t=g.trim(t))&&(1===t.indexOf("use strict")?((e=s.createElement("script")).text=t,s.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(S,"ms-").replace(T,D)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var n=0,r=t.length,o=B(t);if(i){if(o)for(;n<r&&!1!==e.apply(t[n],i);n++);else for(n in t)if(!1===e.apply(t[n],i))break}else if(o)for(;n<r&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":x.call(t)},makeArray:function(t,e){var i=e||[];return null!=t&&(B(Object(t))?g.merge(i,"string"==typeof t?[t]:t):d.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:m.call(e,t,i)},merge:function(t,i){var n=i.length,r=t.length,o=0;if("number"==typeof n)for(;o<n;o++)t[r++]=i[o];else for(;i[o]!==e;)t[r++]=i[o++];return t.length=r,t},grep:function(t,e,i){var n=[],r=0,o=t.length;for(i=!!i;r<o;r++)i!==!!e(t[r],r)&&n.push(t[r]);return n},map:function(t,e,i){var n,r=0,o=t.length,s=[];if(B(t))for(;r<o;r++)null!=(n=e(t[r],r,i))&&(s[s.length]=n);else for(r in t)null!=(n=e(t[r],r,i))&&(s[s.length]=n);return p.apply([],s)},guid:1,proxy:function(t,i){var n,r,o;return"string"==typeof i&&(n=t[i],i=t,t=n),g.isFunction(t)?(r=f.call(arguments,2),(o=function(){return t.apply(i||this,r.concat(f.call(arguments)))}).guid=t.guid=t.guid||g.guid++,o):e},access:function(t,i,n,r,o,s,a){var l=0,c=t.length,u=null==n;if("object"===g.type(n))for(l in o=!0,n)g.access(t,i,l,n[l],!0,s,a);else if(r!==e&&(o=!0,g.isFunction(r)||(a=!0),u&&(a?(i.call(t,r),i=null):(u=i,i=function(t,e,i){return u.call(g(t),i)})),i))for(;l<c;l++)i(t[l],n,a?r:r.call(t[l],l,i(t[l],n)));return o?t:u?i.call(t):c?i(t[0],n):s},now:Date.now,swap:function(t,e,i,n){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];for(o in r=i.apply(t,n||[]),e)t.style[o]=s[o];return r}}),g.ready.promise=function(e){return n||(n=g.Deferred(),"complete"===s.readyState?setTimeout(g.ready):(s.addEventListener("DOMContentLoaded",A,!1),t.addEventListener("load",A,!1))),n.promise(e)},g.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){u["[object "+e+"]"]=e.toLowerCase()}),i=g(s),function(t,e){var i,n,r,o,s,a,l,c,u,h,p,d,f,m,y,_,x,v="sizzle"+-new Date,b=t.document,w=0,C=0,S=ot(),T=ot(),D=ot(),A=!1,B=function(t,e){return t===e?(A=!0,0):0},M=1<<31,P={}.hasOwnProperty,E=[],I=E.pop,R=E.push,O=E.push,k=E.slice,L=E.indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]===t)return e;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",V="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",j=V.replace("w","w#"),G="\\["+N+"*("+V+")"+N+"*(?:([*^$|!~]?=)"+N+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+j+")|)|)"+N+"*\\]",U=":("+V+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+G.replace(3,8)+")*)|.*)\\)|)",z=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),X=new RegExp("^"+N+"*,"+N+"*"),W=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),J=new RegExp(N+"*[+~]"),H=new RegExp("="+N+"*([^\\]'\"]*)"+N+"*\\]","g"),q=new RegExp(U),Y=new RegExp("^"+j+"$"),$={ID:new RegExp("^#("+V+")"),CLASS:new RegExp("^\\.("+V+")"),TAG:new RegExp("^("+V.replace("w","w*")+")"),ATTR:new RegExp("^"+G),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,et=/'|\\/g,it=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),nt=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{O.apply(E=k.call(b.childNodes),b.childNodes),E[b.childNodes.length].nodeType}catch(t){O={apply:E.length?function(t,e){R.apply(t,k.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function rt(t,e,i,r){var s,a,c,u,d,y,_,g,w,C;if((e?e.ownerDocument||e:b)!==p&&h(e),e=e||p,i=i||[],!t||"string"!=typeof t)return i;if(1!==(u=e.nodeType)&&9!==u)return[];if(f&&!r){if(s=Z.exec(t))if(c=s[1]){if(9===u){if(!(a=e.getElementById(c))||!a.parentNode)return i;if(a.id===c)return i.push(a),i}else if(e.ownerDocument&&(a=e.ownerDocument.getElementById(c))&&x(e,a)&&a.id===c)return i.push(a),i}else{if(s[2])return O.apply(i,e.getElementsByTagName(t)),i;if((c=s[3])&&n.getElementsByClassName&&e.getElementsByClassName)return O.apply(i,e.getElementsByClassName(c)),i}if(n.qsa&&(!m||!m.test(t))){if(g=_=v,w=e,C=9===u&&t,1===u&&"object"!==e.nodeName.toLowerCase()){for(y=ft(t),(_=e.getAttribute("id"))?g=_.replace(et,"\\$&"):e.setAttribute("id",g),g="[id='"+g+"'] ",d=y.length;d--;)y[d]=g+mt(y[d]);w=J.test(t)&&e.parentNode||e,C=y.join(",")}if(C)try{return O.apply(i,w.querySelectorAll(C)),i}catch(t){}finally{_||e.removeAttribute("id")}}}return function(t,e,i,r){var s,a,c,u,h,p=ft(t);if(!r&&1===p.length){if((a=p[0]=p[0].slice(0)).length>2&&"ID"===(c=a[0]).type&&n.getById&&9===e.nodeType&&f&&o.relative[a[1].type]){if(!(e=(o.find.ID(c.matches[0].replace(it,nt),e)||[])[0]))return i;t=t.slice(a.shift().value.length)}for(s=$.needsContext.test(t)?0:a.length;s--&&(c=a[s],!o.relative[u=c.type]);)if((h=o.find[u])&&(r=h(c.matches[0].replace(it,nt),J.test(a[0].type)&&e.parentNode||e))){if(a.splice(s,1),!(t=r.length&&mt(a)))return O.apply(i,r),i;break}}return l(t,p)(r,e,!f,i,J.test(t)),i}(t.replace(z,"$1"),e,i,r)}function ot(){var t=[];return function e(i,n){return t.push(i+=" ")>o.cacheLength&&delete e[t.shift()],e[i]=n}}function st(t){return t[v]=!0,t}function at(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){for(var i=t.split("|"),n=t.length;n--;)o.attrHandle[i[n]]=e}function ct(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||M)-(~t.sourceIndex||M);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ut(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ht(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function pt(t){return st(function(e){return e=+e,st(function(i,n){for(var r,o=t([],i.length,e),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}for(i in a=rt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},n=rt.support={},h=rt.setDocument=function(t){var e=t?t.ownerDocument||t:b,i=e.defaultView;return e!==p&&9===e.nodeType&&e.documentElement?(p=e,d=e.documentElement,f=!a(e),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){h()}),n.attributes=at(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=at(function(t){return t.appendChild(e.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=at(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),n.getById=at(function(t){return d.appendChild(t).id=v,!e.getElementsByName||!e.getElementsByName(v).length}),n.getById?(o.find.ID=function(t,e){if(void 0!==e.getElementById&&f){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},o.filter.ID=function(t){var e=t.replace(it,nt);return function(t){return t.getAttribute("id")===e}}):(delete o.find.ID,o.filter.ID=function(t){var e=t.replace(it,nt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),o.find.TAG=n.getElementsByTagName?function(t,e){if(void 0!==e.getElementsByTagName)return e.getElementsByTagName(t)}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},o.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&f)return e.getElementsByClassName(t)},y=[],m=[],(n.qsa=K.test(e.querySelectorAll))&&(at(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+F+")"),t.querySelectorAll(":checked").length||m.push(":checked")}),at(function(t){var i=e.createElement("input");i.setAttribute("type","hidden"),t.appendChild(i).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=K.test(_=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&at(function(t){n.disconnectedMatch=_.call(t,"div"),_.call(t,"[s!='']:x"),y.push("!=",U)}),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),x=K.test(d.contains)||d.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},B=d.compareDocumentPosition?function(t,i){if(t===i)return A=!0,0;var r=i.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(i);return r?1&r||!n.sortDetached&&i.compareDocumentPosition(t)===r?t===e||x(b,t)?-1:i===e||x(b,i)?1:u?L.call(u,t)-L.call(u,i):0:4&r?-1:1:t.compareDocumentPosition?-1:1}:function(t,i){var n,r=0,o=t.parentNode,s=i.parentNode,a=[t],l=[i];if(t===i)return A=!0,0;if(!o||!s)return t===e?-1:i===e?1:o?-1:s?1:u?L.call(u,t)-L.call(u,i):0;if(o===s)return ct(t,i);for(n=t;n=n.parentNode;)a.unshift(n);for(n=i;n=n.parentNode;)l.unshift(n);for(;a[r]===l[r];)r++;return r?ct(a[r],l[r]):a[r]===b?-1:l[r]===b?1:0},e):p},rt.matches=function(t,e){return rt(t,null,null,e)},rt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(H,"='$1']"),n.matchesSelector&&f&&(!y||!y.test(e))&&(!m||!m.test(e)))try{var i=_.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return rt(e,p,null,[t]).length>0},rt.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),x(t,e)},rt.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var i=o.attrHandle[e.toLowerCase()],r=i&&P.call(o.attrHandle,e.toLowerCase())?i(t,e,!f):void 0;return void 0===r?n.attributes||!f?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null:r},rt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},rt.uniqueSort=function(t){var e,i=[],r=0,o=0;if(A=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(B),A){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return t},s=rt.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n];n++)i+=s(e);return i},(o=rt.selectors={cacheLength:50,createPseudo:st,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(it,nt),t[3]=(t[4]||t[5]||"").replace(it,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||rt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&rt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return $.CHILD.test(t[0])?null:(t[3]&&void 0!==t[4]?t[2]=t[4]:i&&q.test(i)&&(e=ft(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(it,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+N+")"+t+"("+N+"|$)"))&&S(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(n){var r=rt.attr(n,t);return null==r?"!="===e:!e||(r+="","="===e?r===i:"!="===e?r!==i:"^="===e?i&&0===r.indexOf(i):"*="===e?i&&r.indexOf(i)>-1:"$="===e?i&&r.slice(-i.length)===i:"~="===e?(" "+r+" ").indexOf(i)>-1:"|="===e&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,p,d,f,m=o!==s?"nextSibling":"previousSibling",y=e.parentNode,_=a&&e.nodeName.toLowerCase(),x=!l&&!a;if(y){if(o){for(;m;){for(h=e;h=h[m];)if(a?h.nodeName.toLowerCase()===_:1===h.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?y.firstChild:y.lastChild],s&&x){for(d=(c=(u=y[v]||(y[v]={}))[t]||[])[0]===w&&c[1],p=c[0]===w&&c[2],h=d&&y.childNodes[d];h=++d&&h&&h[m]||(p=d=0)||f.pop();)if(1===h.nodeType&&++p&&h===e){u[t]=[w,d,p];break}}else if(x&&(c=(e[v]||(e[v]={}))[t])&&c[0]===w)p=c[1];else for(;(h=++d&&h&&h[m]||(p=d=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==_:1!==h.nodeType)||!++p||(x&&((h[v]||(h[v]={}))[t]=[w,p]),h!==e)););return(p-=r)===n||p%n==0&&p/n>=0}}},PSEUDO:function(t,e){var i,n=o.pseudos[t]||o.setFilters[t.toLowerCase()]||rt.error("unsupported pseudo: "+t);return n[v]?n(e):n.length>1?(i=[t,t,"",e],o.setFilters.hasOwnProperty(t.toLowerCase())?st(function(t,i){for(var r,o=n(t,e),s=o.length;s--;)t[r=L.call(t,o[s])]=!(i[r]=o[s])}):function(t){return n(t,0,i)}):n}},pseudos:{not:st(function(t){var e=[],i=[],n=l(t.replace(z,"$1"));return n[v]?st(function(t,e,i,r){for(var o,s=n(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,n(e,null,o,i),!i.pop()}}),has:st(function(t){return function(e){return rt(t,e).length>0}}),contains:st(function(t){return function(e){return(e.textContent||e.innerText||s(e)).indexOf(t)>-1}}),lang:st(function(t){return Y.test(t||"")||rt.error("unsupported lang: "+t),t=t.replace(it,nt).toLowerCase(),function(e){var i;do{if(i=f?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!o.pseudos.empty(t)},header:function(t){return tt.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:pt(function(){return[0]}),last:pt(function(t,e){return[e-1]}),eq:pt(function(t,e,i){return[i<0?i+e:i]}),even:pt(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:pt(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:pt(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:pt(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=o.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[i]=ut(i);for(i in{submit:!0,reset:!0})o.pseudos[i]=ht(i);function dt(){}function ft(t,e){var i,n,r,s,a,l,c,u=T[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=o.preFilter;a;){for(s in i&&!(n=X.exec(a))||(n&&(a=a.slice(n[0].length)||a),l.push(r=[])),i=!1,(n=W.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(z," ")}),a=a.slice(i.length)),o.filter)!(n=$[s].exec(a))||c[s]&&!(n=c[s](n))||(i=n.shift(),r.push({value:i,type:s,matches:n}),a=a.slice(i.length));if(!i)break}return e?a.length:a?rt.error(t):T(t,l).slice(0)}function mt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function yt(t,e,i){var n=e.dir,o=i&&"parentNode"===n,s=C++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,r)}:function(e,i,a){var l,c,u,h=w+" "+s;if(a){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||o)if((c=(u=e[v]||(e[v]={}))[n])&&c[0]===h){if(!0===(l=c[1])||l===r)return!0===l}else if((c=u[n]=[h])[1]=t(e,i,a)||r,!0===c[1])return!0}}function _t(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function xt(t,e,i,n,r){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),c&&e.push(a)));return s}function gt(t,e,i,n,r,o){return n&&!n[v]&&(n=gt(n)),r&&!r[v]&&(r=gt(r,o)),st(function(o,s,a,l){var c,u,h,p=[],d=[],f=s.length,m=o||function(t,e,i){for(var n=0,r=e.length;n<r;n++)rt(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),y=!t||!o&&e?m:xt(m,p,t,a,l),_=i?r||(o?t:f||n)?[]:s:y;if(i&&i(y,_,a,l),n)for(c=xt(_,d),n(c,[],a,l),u=c.length;u--;)(h=c[u])&&(_[d[u]]=!(y[d[u]]=h));if(o){if(r||t){if(r){for(c=[],u=_.length;u--;)(h=_[u])&&c.push(y[u]=h);r(null,_=[],c,l)}for(u=_.length;u--;)(h=_[u])&&(c=r?L.call(o,h):p[u])>-1&&(o[c]=!(s[c]=h))}}else _=xt(_===s?_.splice(f,_.length):_),r?r(null,s,_,l):O.apply(s,_)})}function vt(t){for(var e,i,n,r=t.length,s=o.relative[t[0].type],a=s||o.relative[" "],l=s?1:0,u=yt(function(t){return t===e},a,!0),h=yt(function(t){return L.call(e,t)>-1},a,!0),p=[function(t,i,n){return!s&&(n||i!==c)||((e=i).nodeType?u(t,i,n):h(t,i,n))}];l<r;l++)if(i=o.relative[t[l].type])p=[yt(_t(p),i)];else{if((i=o.filter[t[l].type].apply(null,t[l].matches))[v]){for(n=++l;n<r&&!o.relative[t[n].type];n++);return gt(l>1&&_t(p),l>1&&mt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(z,"$1"),i,l<n&&vt(t.slice(l,n)),n<r&&vt(t=t.slice(n)),n<r&&mt(t))}p.push(i)}return _t(p)}dt.prototype=o.filters=o.pseudos,o.setFilters=new dt,l=rt.compile=function(t,e){var i,n=[],s=[],a=D[t+" "];if(!a){for(e||(e=ft(t)),i=e.length;i--;)(a=vt(e[i]))[v]?n.push(a):s.push(a);a=D(t,function(t,e){var i=0,n=e.length>0,s=t.length>0,a=function(a,l,u,h,d){var f,m,y,_=[],x=0,g="0",v=a&&[],b=null!=d,C=c,S=a||s&&o.find.TAG("*",d&&l.parentNode||l),T=w+=null==C?1:Math.random()||.1;for(b&&(c=l!==p&&l,r=i);null!=(f=S[g]);g++){if(s&&f){for(m=0;y=t[m++];)if(y(f,l,u)){h.push(f);break}b&&(w=T,r=++i)}n&&((f=!y&&f)&&x--,a&&v.push(f))}if(x+=g,n&&g!==x){for(m=0;y=e[m++];)y(v,_,l,u);if(a){if(x>0)for(;g--;)v[g]||_[g]||(_[g]=I.call(h));_=xt(_)}O.apply(h,_),b&&!a&&_.length>0&&x+e.length>1&&rt.uniqueSort(h)}return b&&(w=T,c=C),v};return n?st(a):a}(s,n))}return a},n.sortStable=v.split("").sort(B).join("")===v,n.detectDuplicates=A,h(),n.sortDetached=at(function(t){return 1&t.compareDocumentPosition(p.createElement("div"))}),at(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||lt("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&at(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||lt("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),at(function(t){return null==t.getAttribute("disabled")})||lt(F,function(t,e,i){var n;if(!i)return(n=t.getAttributeNode(e))&&n.specified?n.value:!0===t[e]?e.toLowerCase():null}),g.find=rt,g.expr=rt.selectors,g.expr[":"]=g.expr.pseudos,g.unique=rt.uniqueSort,g.text=rt.getText,g.isXMLDoc=rt.isXML,g.contains=rt.contains}(t);var M,P,E,I,R,O,k={};g.Callbacks=function(t){var i,n,r,o,s,a,l=[],c=!(t="string"==typeof t?k[t]||function(t){var e=k[t]={};return g.each(t.match(b)||[],function(t,i){e[i]=!0}),e}(t):g.extend({},t)).once&&[],u=function(e){for(i=t.memory&&e,n=!0,a=o||0,o=0,s=l.length,r=!0;l&&a<s;a++)if(!1===l[a].apply(e[0],e[1])&&t.stopOnFalse){i=!1;break}r=!1,l&&(c?c.length&&u(c.shift()):i?l=[]:h.disable())},h={add:function(){if(l){var e=l.length;!function e(i){g.each(i,function(i,n){var r=g.type(n);"function"===r?t.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==r&&e(n)})}(arguments),r?s=l.length:i&&(o=e,u(i))}return this},remove:function(){return l&&g.each(arguments,function(t,e){for(var i;(i=g.inArray(e,l,i))>-1;)l.splice(i,1),r&&(i<=s&&s--,i<=a&&a--)}),this},has:function(t){return t?g.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=i=e,this},disabled:function(){return!l},lock:function(){return c=e,i||h.disable(),this},locked:function(){return!c},fireWith:function(t,e){return!l||n&&!c||(e=[t,(e=e||[]).slice?e.slice():e],r?c.push(e):u(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},g.extend({Deferred:function(t){var e=[["resolve","done",g.Callbacks("once memory"),"resolved"],["reject","fail",g.Callbacks("once memory"),"rejected"],["notify","progress",g.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return g.Deferred(function(i){g.each(e,function(e,o){var s=o[0],a=g.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&g.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?g.extend(t,n):n}},r={};return n.pipe=n.then,g.each(e,function(t,o){var s=o[2],a=o[3];n[o[1]]=s.add,a&&s.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=s.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,o=f.call(arguments),s=o.length,a=1!==s||t&&g.isFunction(t.promise)?s:0,l=1===a?t:g.Deferred(),c=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?f.call(arguments):r,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(s>1)for(e=new Array(s),i=new Array(s),n=new Array(s);r<s;r++)o[r]&&g.isFunction(o[r].promise)?o[r].promise().done(c(r,n,o)).fail(l.reject).progress(c(r,i,e)):--a;return a||l.resolveWith(n,o),l.promise()}}),g.support=(M={},P=s.createElement("input"),E=s.createDocumentFragment(),I=s.createElement("div"),R=s.createElement("select"),O=R.appendChild(s.createElement("option")),P.type?(P.type="checkbox",M.checkOn=""!==P.value,M.optSelected=O.selected,M.reliableMarginRight=!0,M.boxSizingReliable=!0,M.pixelPosition=!1,P.checked=!0,M.noCloneChecked=P.cloneNode(!0).checked,R.disabled=!0,M.optDisabled=!O.disabled,(P=s.createElement("input")).value="t",P.type="radio",M.radioValue="t"===P.value,P.setAttribute("checked","t"),P.setAttribute("name","t"),E.appendChild(P),M.checkClone=E.cloneNode(!0).cloneNode(!0).lastChild.checked,M.focusinBubbles="onfocusin"in t,I.style.backgroundClip="content-box",I.cloneNode(!0).style.backgroundClip="",M.clearCloneStyle="content-box"===I.style.backgroundClip,g(function(){var e,i,n=s.getElementsByTagName("body")[0];n&&((e=s.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",n.appendChild(e).appendChild(I),I.innerHTML="",I.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",g.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){M.boxSizing=4===I.offsetWidth}),t.getComputedStyle&&(M.pixelPosition="1%"!==(t.getComputedStyle(I,null)||{}).top,M.boxSizingReliable="4px"===(t.getComputedStyle(I,null)||{width:"4px"}).width,(i=I.appendChild(s.createElement("div"))).style.cssText=I.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",i.style.marginRight=i.style.width="0",I.style.width="1px",M.reliableMarginRight=!parseFloat((t.getComputedStyle(i,null)||{}).marginRight)),n.removeChild(e))}),M):M);var L,F,N=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,V=/([A-Z])/g;function j(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=g.expando+Math.random()}function G(t,i,n){var r;if(n===e&&1===t.nodeType)if(r="data-"+i.replace(V,"-$1").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:N.test(n)?JSON.parse(n):n)}catch(t){}L.set(t,i,n)}else n=e;return n}j.uid=1,j.accepts=function(t){return!t.nodeType||(1===t.nodeType||9===t.nodeType)},j.prototype={key:function(t){if(!j.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=j.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,g.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,r=this.key(t),o=this.cache[r];if("string"==typeof e)o[e]=i;else if(g.isEmptyObject(o))g.extend(this.cache[r],e);else for(n in e)o[n]=e[n];return o},get:function(t,i){var n=this.cache[this.key(t)];return i===e?n:n[i]},access:function(t,i,n){var r;return i===e||i&&"string"==typeof i&&n===e?(r=this.get(t,i))!==e?r:this.get(t,g.camelCase(i)):(this.set(t,i,n),n!==e?n:i)},remove:function(t,i){var n,r,o,s=this.key(t),a=this.cache[s];if(i===e)this.cache[s]={};else{g.isArray(i)?r=i.concat(i.map(g.camelCase)):(o=g.camelCase(i),r=i in a?[i,o]:(r=o)in a?[r]:r.match(b)||[]),n=r.length;for(;n--;)delete a[r[n]]}},hasData:function(t){return!g.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}},L=new j,F=new j,g.extend({acceptData:j.accepts,hasData:function(t){return L.hasData(t)||F.hasData(t)},data:function(t,e,i){return L.access(t,e,i)},removeData:function(t,e){L.remove(t,e)},_data:function(t,e,i){return F.access(t,e,i)},_removeData:function(t,e){F.remove(t,e)}}),g.fn.extend({data:function(t,i){var n,r,o=this[0],s=0,a=null;if(t===e){if(this.length&&(a=L.get(o),1===o.nodeType&&!F.get(o,"hasDataAttrs"))){for(n=o.attributes;s<n.length;s++)0===(r=n[s].name).indexOf("data-")&&(r=g.camelCase(r.slice(5)),G(o,r,a[r]));F.set(o,"hasDataAttrs",!0)}return a}return"object"==typeof t?this.each(function(){L.set(this,t)}):g.access(this,function(i){var n,r=g.camelCase(t);if(o&&i===e)return(n=L.get(o,t))!==e?n:(n=L.get(o,r))!==e?n:(n=G(o,r,e))!==e?n:void 0;this.each(function(){var n=L.get(this,r);L.set(this,r,i),-1!==t.indexOf("-")&&n!==e&&L.set(this,t,i)})},null,i,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){L.remove(this,t)})}}),g.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=F.get(t,e),i&&(!n||g.isArray(i)?n=F.access(t,e,g.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=g.queue(t,e),n=i.length,r=i.shift(),o=g._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,function(){g.dequeue(t,e)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return F.get(t,i)||F.access(t,i,{empty:g.Callbacks("once memory").add(function(){F.remove(t,[e+"queue",i])})})}}),g.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),arguments.length<n?g.queue(this[0],t):i===e?this:this.each(function(){var e=g.queue(this,t,i);g._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&g.dequeue(this,t)})},dequeue:function(t){return this.each(function(){g.dequeue(this,t)})},delay:function(t,e){return t=g.fx&&g.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,r=1,o=g.Deferred(),s=this,a=this.length,l=function(){--r||o.resolveWith(s,[s])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;)(n=F.get(s[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(l));return l(),o.promise(i)}});var U,z=/[\t\r\n\f]/g,X=/\r/g,W=/^(?:input|select|textarea|button)$/i;g.fn.extend({attr:function(t,e){return g.access(this,g.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){g.removeAttr(this,t)})},prop:function(t,e){return g.access(this,g.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[g.propFix[t]||t]})},addClass:function(t){var e,i,n,r,o,s=0,a=this.length,l="string"==typeof t&&t;if(g.isFunction(t))return this.each(function(e){g(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(b)||[];s<a;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");i.className=g.trim(n)}return this},removeClass:function(t){var e,i,n,r,o,s=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(g.isFunction(t))return this.each(function(e){g(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(b)||[];s<a;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):"")){for(o=0;r=e[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=t?g.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):g.isFunction(t)?this.each(function(i){g(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var e,n=0,o=g(this),s=t.match(b)||[];e=s[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else i!==r&&"boolean"!==i||(this.className&&F.set(this,"__className__",this.className),this.className=this.className||!1===t?"":F.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(z," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,n,r,o=this[0];return arguments.length?(r=g.isFunction(t),this.each(function(n){var o;1===this.nodeType&&(null==(o=r?t.call(this,n,g(this).val()):t)?o="":"number"==typeof o?o+="":g.isArray(o)&&(o=g.map(o,function(t){return null==t?"":t+""})),(i=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&i.set(this,o,"value")!==e||(this.value=o))})):o?(i=g.valHooks[o.type]||g.valHooks[o.nodeName.toLowerCase()])&&"get"in i&&(n=i.get(o,"value"))!==e?n:"string"==typeof(n=o.value)?n.replace(X,""):null==n?"":n:void 0}}),g.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,s=o?null:[],a=o?r+1:n.length,l=r<0?a:o?r:0;l<a;l++)if(((i=n[l]).selected||l===r)&&(g.support.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!g.nodeName(i.parentNode,"optgroup"))){if(e=g(i).val(),o)return e;s.push(e)}return s},set:function(t,e){for(var i,n,r=t.options,o=g.makeArray(e),s=r.length;s--;)((n=r[s]).selected=g.inArray(g(n).val(),o)>=0)&&(i=!0);return i||(t.selectedIndex=-1),o}}},attr:function(t,i,n){var o,s,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===r?g.prop(t,i,n):(1===a&&g.isXMLDoc(t)||(i=i.toLowerCase(),o=g.attrHooks[i]||(g.expr.match.bool.test(i)?U:void 0)),n===e?o&&"get"in o&&null!==(s=o.get(t,i))?s:null==(s=g.find.attr(t,i))?e:s:null!==n?o&&"set"in o&&(s=o.set(t,n,i))!==e?s:(t.setAttribute(i,n+""),n):void g.removeAttr(t,i))},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(b);if(o&&1===t.nodeType)for(;i=o[r++];)n=g.propFix[i]||i,g.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!g.support.radioValue&&"radio"===e&&g.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{for:"htmlFor",class:"className"},prop:function(t,i,n){var r,o,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return(1!==s||!g.isXMLDoc(t))&&(i=g.propFix[i]||i,o=g.propHooks[i]),n!==e?o&&"set"in o&&(r=o.set(t,n,i))!==e?r:t[i]=n:o&&"get"in o&&null!==(r=o.get(t,i))?r:t[i]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||W.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),U={set:function(t,e,i){return!1===e?g.removeAttr(t,i):t.setAttribute(i,i),i}},g.each(g.expr.match.bool.source.match(/\w+/g),function(t,i){var n=g.expr.attrHandle[i]||g.find.attr;g.expr.attrHandle[i]=function(t,i,r){var o=g.expr.attrHandle[i],s=r?e:(g.expr.attrHandle[i]=e)!=n(t,i,r)?i.toLowerCase():null;return g.expr.attrHandle[i]=o,s}}),g.support.optSelected||(g.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){g.propFix[this.toLowerCase()]=this}),g.each(["radio","checkbox"],function(){g.valHooks[this]={set:function(t,e){if(g.isArray(e))return t.checked=g.inArray(g(t).val(),e)>=0}},g.support.checkOn||(g.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var J=/^key/,H=/^(?:mouse|contextmenu)|click/,q=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function $(){return!0}function K(){return!1}function Z(){try{return s.activeElement}catch(t){}}g.event={global:{},add:function(t,i,n,o,s){var a,l,c,u,h,p,d,f,m,y,_,x=F.get(t);if(x){for(n.handler&&(n=(a=n).handler,s=a.selector),n.guid||(n.guid=g.guid++),(u=x.events)||(u=x.events={}),(l=x.handle)||((l=x.handle=function(t){return typeof g===r||t&&g.event.triggered===t.type?e:g.event.dispatch.apply(l.elem,arguments)}).elem=t),h=(i=(i||"").match(b)||[""]).length;h--;)m=_=(c=Y.exec(i[h])||[])[1],y=(c[2]||"").split(".").sort(),m&&(d=g.event.special[m]||{},m=(s?d.delegateType:d.bindType)||m,d=g.event.special[m]||{},p=g.extend({type:m,origType:_,data:o,handler:n,guid:n.guid,selector:s,needsContext:s&&g.expr.match.needsContext.test(s),namespace:y.join(".")},a),(f=u[m])||((f=u[m]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(t,o,y,l)||t.addEventListener&&t.addEventListener(m,l,!1)),d.add&&(d.add.call(t,p),p.handler.guid||(p.handler.guid=n.guid)),s?f.splice(f.delegateCount++,0,p):f.push(p),g.event.global[m]=!0);t=null}},remove:function(t,e,i,n,r){var o,s,a,l,c,u,h,p,d,f,m,y=F.hasData(t)&&F.get(t);if(y&&(l=y.events)){for(c=(e=(e||"").match(b)||[""]).length;c--;)if(d=m=(a=Y.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),d){for(h=g.event.special[d]||{},p=l[d=(n?h.delegateType:h.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)u=p[o],!r&&m!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(p.splice(o,1),u.selector&&p.delegateCount--,h.remove&&h.remove.call(t,u));s&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,f,y.handle)||g.removeEvent(t,d,y.handle),delete l[d])}else for(d in l)g.event.remove(t,d+e[c],i,n,!0);g.isEmptyObject(l)&&(delete y.handle,F.remove(t,"events"))}},trigger:function(i,n,r,o){var a,l,c,u,h,p,d,f=[r||s],m=_.call(i,"type")?i.type:i,y=_.call(i,"namespace")?i.namespace.split("."):[];if(l=c=r=r||s,3!==r.nodeType&&8!==r.nodeType&&!q.test(m+g.event.triggered)&&(m.indexOf(".")>=0&&(m=(y=m.split(".")).shift(),y.sort()),h=m.indexOf(":")<0&&"on"+m,(i=i[g.expando]?i:new g.Event(m,"object"==typeof i&&i)).isTrigger=o?2:3,i.namespace=y.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=r),n=null==n?[i]:g.makeArray(n,[i]),d=g.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(r,n))){if(!o&&!d.noBubble&&!g.isWindow(r)){for(u=d.delegateType||m,q.test(u+m)||(l=l.parentNode);l;l=l.parentNode)f.push(l),c=l;c===(r.ownerDocument||s)&&f.push(c.defaultView||c.parentWindow||t)}for(a=0;(l=f[a++])&&!i.isPropagationStopped();)i.type=a>1?u:d.bindType||m,(p=(F.get(l,"events")||{})[i.type]&&F.get(l,"handle"))&&p.apply(l,n),(p=h&&l[h])&&g.acceptData(l)&&p.apply&&!1===p.apply(l,n)&&i.preventDefault();return i.type=m,o||i.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),n)||!g.acceptData(r)||h&&g.isFunction(r[m])&&!g.isWindow(r)&&((c=r[h])&&(r[h]=null),g.event.triggered=m,r[m](),g.event.triggered=e,c&&(r[h]=c)),i.result}},dispatch:function(t){t=g.event.fix(t);var i,n,r,o,s,a,l=f.call(arguments),c=(F.get(this,"events")||{})[t.type]||[],u=g.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=g.event.handlers.call(this,t,c),i=0;(o=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(s.namespace)||(t.handleObj=s,t.data=s.data,(r=((g.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l))!==e&&!1===(t.result=r)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,r,o,s,a=[],l=i.delegateCount,c=t.target;if(l&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!==this;c=c.parentNode||this)if(!0!==c.disabled||"click"!==t.type){for(r=[],n=0;n<l;n++)r[o=(s=i[n]).selector+" "]===e&&(r[o]=s.needsContext?g(o,this).index(c)>=0:g.find(o,this,null,[c]).length),r[o]&&r.push(s);r.length&&a.push({elem:c,handlers:r})}return l<i.length&&a.push({elem:this,handlers:i.slice(l)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,r,o,a=i.button;return null==t.pageX&&null!=i.clientX&&(r=(n=t.target.ownerDocument||s).documentElement,o=n.body,t.pageX=i.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),t.pageY=i.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[g.expando])return t;var e,i,n,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=H.test(r)?this.mouseHooks:J.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new g.Event(o),e=n.length;e--;)t[i=n[e]]=o[i];return t.target||(t.target=s),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Z()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Z()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&g.nodeName(this,"input"))return this.click(),!1},_default:function(t){return g.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=g.extend(new g.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?g.event.trigger(r,null,e):g.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},g.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},g.Event=function(t,e){if(!(this instanceof g.Event))return new g.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.getPreventDefault&&t.getPreventDefault()?$:K):this.type=t,e&&g.extend(this,e),this.timeStamp=t&&t.timeStamp||g.now(),this[g.expando]=!0},g.Event.prototype={isDefaultPrevented:K,isPropagationStopped:K,isImmediatePropagationStopped:K,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=$,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=$,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=$,this.stopPropagation()}},g.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){g.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,r=t.handleObj;return n&&(n===this||g.contains(this,n))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),g.support.focusinBubbles||g.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){g.event.simulate(e,t.target,g.event.fix(t),!0)};g.event.special[e]={setup:function(){0==i++&&s.addEventListener(t,n,!0)},teardown:function(){0==--i&&s.removeEventListener(t,n,!0)}}}),g.fn.extend({on:function(t,i,n,r,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=e),t)this.on(a,i,n,t[a],o);return this}if(null==n&&null==r?(r=i,n=i=e):null==r&&("string"==typeof i?(r=n,n=e):(r=n,n=i,i=e)),!1===r)r=K;else if(!r)return this;return 1===o&&(s=r,(r=function(t){return g().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=g.guid++)),this.each(function(){g.event.add(this,t,r,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var r,o;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,g(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(o in t)this.off(o,i,t[o]);return this}return!1!==i&&"function"!=typeof i||(n=i,i=e),!1===n&&(n=K),this.each(function(){g.event.remove(this,t,n,i)})},trigger:function(t,e){return this.each(function(){g.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return g.event.trigger(t,e,i,!0)}});var Q=/^.[^:#\[\.,]*$/,tt=/^(?:parents|prev(?:Until|All))/,et=g.expr.match.needsContext,it={children:!0,contents:!0,next:!0,prev:!0};function nt(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function rt(t,e,i){if(g.isFunction(e))return g.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return g.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(Q.test(e))return g.filter(e,t,i);e=g.filter(e,t)}return g.grep(t,function(t){return m.call(e,t)>=0!==i})}g.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(g(t).filter(function(){for(e=0;e<r;e++)if(g.contains(n[e],this))return!0}));for(e=0;e<r;e++)g.find(t,n[e],i);return(i=this.pushStack(r>1?g.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},has:function(t){var e=g(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(g.contains(this,e[t]))return!0})},not:function(t){return this.pushStack(rt(this,t||[],!0))},filter:function(t){return this.pushStack(rt(this,t||[],!1))},is:function(t){return!!rt(this,"string"==typeof t&&et.test(t)?g(t):t||[],!1).length},closest:function(t,e){for(var i,n=0,r=this.length,o=[],s=et.test(t)||"string"!=typeof t?g(t,e||this.context):0;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&g.find.matchesSelector(i,t))){i=o.push(i);break}return this.pushStack(o.length>1?g.unique(o):o)},index:function(t){return t?"string"==typeof t?m.call(g(t),this[0]):m.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?g(t,e):g.makeArray(t&&t.nodeType?[t]:t),n=g.merge(this.get(),i);return this.pushStack(g.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),g.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return g.dir(t,"parentNode")},parentsUntil:function(t,e,i){return g.dir(t,"parentNode",i)},next:function(t){return nt(t,"nextSibling")},prev:function(t){return nt(t,"previousSibling")},nextAll:function(t){return g.dir(t,"nextSibling")},prevAll:function(t){return g.dir(t,"previousSibling")},nextUntil:function(t,e,i){return g.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return g.dir(t,"previousSibling",i)},siblings:function(t){return g.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return g.sibling(t.firstChild)},contents:function(t){return t.contentDocument||g.merge([],t.childNodes)}},function(t,e){g.fn[t]=function(i,n){var r=g.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=g.filter(n,r)),this.length>1&&(it[t]||g.unique(r),tt.test(t)&&r.reverse()),this.pushStack(r)}}),g.extend({filter:function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?g.find.matchesSelector(n,t)?[n]:[]:g.find.matches(t,g.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,i,n){for(var r=[],o=n!==e;(t=t[i])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&g(t).is(n))break;r.push(t)}return r},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var ot=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,st=/<([\w:]+)/,at=/<|&#?\w+;/,lt=/<(?:script|style|link)/i,ct=/^(?:checkbox|radio)$/i,ut=/checked\s*(?:[^=]|=\s*.checked.)/i,ht=/^$|\/(?:java|ecma)script/i,pt=/^true\/(.*)/,dt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ft={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function mt(t,e){return g.nodeName(t,"table")&&g.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function yt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function _t(t){var e=pt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function xt(t,e){for(var i=t.length,n=0;n<i;n++)F.set(t[n],"globalEval",!e||F.get(e[n],"globalEval"))}function gt(t,e){var i,n,r,o,s,a,l,c;if(1===e.nodeType){if(F.hasData(t)&&(o=F.access(t),s=F.set(e,o),c=o.events))for(r in delete s.handle,s.events={},c)for(i=0,n=c[r].length;i<n;i++)g.event.add(e,r,c[r][i]);L.hasData(t)&&(a=L.access(t),l=g.extend({},a),L.set(e,l))}}function vt(t,i){var n=t.getElementsByTagName?t.getElementsByTagName(i||"*"):t.querySelectorAll?t.querySelectorAll(i||"*"):[];return i===e||i&&g.nodeName(t,i)?g.merge([t],n):n}function bt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&ct.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}ft.optgroup=ft.option,ft.tbody=ft.tfoot=ft.colgroup=ft.caption=ft.thead,ft.th=ft.td,g.fn.extend({text:function(t){return g.access(this,function(t){return t===e?g.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||mt(this,t).appendChild(t)})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=mt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?g.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||g.cleanData(vt(i)),i.parentNode&&(e&&g.contains(i.ownerDocument,i)&&xt(vt(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(g.cleanData(vt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return g.clone(this,t,e)})},html:function(t){return g.access(this,function(t){var i=this[0]||{},n=0,r=this.length;if(t===e&&1===i.nodeType)return i.innerHTML;if("string"==typeof t&&!lt.test(t)&&!ft[(st.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(ot,"<$1></$2>");try{for(;n<r;n++)1===(i=this[n]||{}).nodeType&&(g.cleanData(vt(i,!1)),i.innerHTML=t);i=0}catch(t){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=g.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(i){var n=t[e++],r=t[e++];r&&(n&&n.parentNode!==r&&(n=this.nextSibling),g(this).remove(),r.insertBefore(i,n))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=p.apply([],t);var n,r,o,s,a,l,c=0,u=this.length,h=this,d=u-1,f=t[0],m=g.isFunction(f);if(m||!(u<=1||"string"!=typeof f||g.support.checkClone)&&ut.test(f))return this.each(function(n){var r=h.eq(n);m&&(t[0]=f.call(this,n,r.html())),r.domManip(t,e,i)});if(u&&(r=(n=g.buildFragment(t,this[0].ownerDocument,!1,!i&&this)).firstChild,1===n.childNodes.length&&(n=r),r)){for(s=(o=g.map(vt(n,"script"),yt)).length;c<u;c++)a=n,c!==d&&(a=g.clone(a,!0,!0),s&&g.merge(o,vt(a,"script"))),e.call(this[c],a,c);if(s)for(l=o[o.length-1].ownerDocument,g.map(o,_t),c=0;c<s;c++)a=o[c],ht.test(a.type||"")&&!F.access(a,"globalEval")&&g.contains(l,a)&&(a.src?g._evalUrl(a.src):g.globalEval(a.textContent.replace(dt,"")))}return this}}),g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){g.fn[t]=function(t){for(var i,n=[],r=g(t),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),g(r[s])[e](i),d.apply(n,i.get());return this.pushStack(n)}}),g.extend({clone:function(t,e,i){var n,r,o,s,a=t.cloneNode(!0),l=g.contains(t.ownerDocument,t);if(!(g.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||g.isXMLDoc(t)))for(s=vt(a),n=0,r=(o=vt(t)).length;n<r;n++)bt(o[n],s[n]);if(e)if(i)for(o=o||vt(t),s=s||vt(a),n=0,r=o.length;n<r;n++)gt(o[n],s[n]);else gt(t,a);return(s=vt(a,"script")).length>0&&xt(s,!l&&vt(t,"script")),a},buildFragment:function(t,e,i,n){for(var r,o,s,a,l,c,u=0,h=t.length,p=e.createDocumentFragment(),d=[];u<h;u++)if((r=t[u])||0===r)if("object"===g.type(r))g.merge(d,r.nodeType?[r]:r);else if(at.test(r)){for(o=o||p.appendChild(e.createElement("div")),s=(st.exec(r)||["",""])[1].toLowerCase(),a=ft[s]||ft._default,o.innerHTML=a[1]+r.replace(ot,"<$1></$2>")+a[2],c=a[0];c--;)o=o.lastChild;g.merge(d,o.childNodes),(o=p.firstChild).textContent=""}else d.push(e.createTextNode(r));for(p.textContent="",u=0;r=d[u++];)if((!n||-1===g.inArray(r,n))&&(l=g.contains(r.ownerDocument,r),o=vt(p.appendChild(r),"script"),l&&xt(o),i))for(c=0;r=o[c++];)ht.test(r.type||"")&&i.push(r);return p},cleanData:function(t){for(var i,n,r,o,s,a,l=g.event.special,c=0;(n=t[c])!==e;c++){if(j.accepts(n)&&(s=n[F.expando])&&(i=F.cache[s])){if((r=Object.keys(i.events||{})).length)for(a=0;(o=r[a])!==e;a++)l[o]?g.event.remove(n,o):g.removeEvent(n,o,i.handle);F.cache[s]&&delete F.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(t){return g.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})}}),g.fn.extend({wrapAll:function(t){var e;return g.isFunction(t)?this.each(function(e){g(this).wrapAll(t.call(this,e))}):(this[0]&&(e=g(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return g.isFunction(t)?this.each(function(e){g(this).wrapInner(t.call(this,e))}):this.each(function(){var e=g(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=g.isFunction(t);return this.each(function(i){g(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){g.nodeName(this,"body")||g(this).replaceWith(this.childNodes)}).end()}});var wt,Ct,St=/^(none|table(?!-c[ea]).+)/,Tt=/^margin/,Dt=new RegExp("^("+v+")(.*)$","i"),At=new RegExp("^("+v+")(?!px)[a-z%]+$","i"),Bt=new RegExp("^([+-])=("+v+")","i"),Mt={BODY:"block"},Pt={position:"absolute",visibility:"hidden",display:"block"},Et={letterSpacing:0,fontWeight:400},It=["Top","Right","Bottom","Left"],Rt=["Webkit","O","Moz","ms"];function Ot(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=Rt.length;r--;)if((e=Rt[r]+i)in t)return e;return n}function kt(t,e){return t=e||t,"none"===g.css(t,"display")||!g.contains(t.ownerDocument,t)}function Lt(e){return t.getComputedStyle(e,null)}function Ft(t,e){for(var i,n,r,o=[],s=0,a=t.length;s<a;s++)(n=t[s]).style&&(o[s]=F.get(n,"olddisplay"),i=n.style.display,e?(o[s]||"none"!==i||(n.style.display=""),""===n.style.display&&kt(n)&&(o[s]=F.access(n,"olddisplay",Gt(n.nodeName)))):o[s]||(r=kt(n),(i&&"none"!==i||!r)&&F.set(n,"olddisplay",r?i:g.css(n,"display"))));for(s=0;s<a;s++)(n=t[s]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[s]||"":"none"));return t}function Nt(t,e,i){var n=Dt.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function Vt(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,s=0;o<4;o+=2)"margin"===i&&(s+=g.css(t,i+It[o],!0,r)),n?("content"===i&&(s-=g.css(t,"padding"+It[o],!0,r)),"margin"!==i&&(s-=g.css(t,"border"+It[o]+"Width",!0,r))):(s+=g.css(t,"padding"+It[o],!0,r),"padding"!==i&&(s+=g.css(t,"border"+It[o]+"Width",!0,r)));return s}function jt(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=Lt(t),s=g.support.boxSizing&&"border-box"===g.css(t,"boxSizing",!1,o);if(r<=0||null==r){if(((r=wt(t,e,o))<0||null==r)&&(r=t.style[e]),At.test(r))return r;n=s&&(g.support.boxSizingReliable||r===t.style[e]),r=parseFloat(r)||0}return r+Vt(t,e,i||(s?"border":"content"),n,o)+"px"}function Gt(t){var e=s,i=Mt[t];return i||("none"!==(i=Ut(t,e))&&i||((e=((Ct=(Ct||g("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement))[0].contentWindow||Ct[0].contentDocument).document).write("<!doctype html><html><body>"),e.close(),i=Ut(t,e),Ct.detach()),Mt[t]=i),i}function Ut(t,e){var i=g(e.createElement(t)).appendTo(e.body),n=g.css(i[0],"display");return i.remove(),n}g.fn.extend({css:function(t,i){return g.access(this,function(t,i,n){var r,o,s={},a=0;if(g.isArray(i)){for(r=Lt(t),o=i.length;a<o;a++)s[i[a]]=g.css(t,i[a],!1,r);return s}return n!==e?g.style(t,i,n):g.css(t,i)},t,i,arguments.length>1)},show:function(){return Ft(this,!0)},hide:function(){return Ft(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){kt(this)?g(this).show():g(this).hide()})}}),g.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=wt(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,i,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,a,l=g.camelCase(i),c=t.style;if(i=g.cssProps[l]||(g.cssProps[l]=Ot(c,l)),a=g.cssHooks[i]||g.cssHooks[l],n===e)return a&&"get"in a&&(o=a.get(t,!1,r))!==e?o:c[i];"string"===(s=typeof n)&&(o=Bt.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(g.css(t,i)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||g.cssNumber[l]||(n+="px"),g.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),a&&"set"in a&&(n=a.set(t,n,r))===e||(c[i]=n))}},css:function(t,i,n,r){var o,s,a,l=g.camelCase(i);return i=g.cssProps[l]||(g.cssProps[l]=Ot(t.style,l)),(a=g.cssHooks[i]||g.cssHooks[l])&&"get"in a&&(o=a.get(t,!0,n)),o===e&&(o=wt(t,i,r)),"normal"===o&&i in Et&&(o=Et[i]),""===n||n?(s=parseFloat(o),!0===n||g.isNumeric(s)?s||0:o):o}}),wt=function(t,i,n){var r,o,s,a=n||Lt(t),l=a?a.getPropertyValue(i)||a[i]:e,c=t.style;return a&&(""!==l||g.contains(t.ownerDocument,t)||(l=g.style(t,i)),At.test(l)&&Tt.test(i)&&(r=c.width,o=c.minWidth,s=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=a.width,c.width=r,c.minWidth=o,c.maxWidth=s)),l},g.each(["height","width"],function(t,e){g.cssHooks[e]={get:function(t,i,n){if(i)return 0===t.offsetWidth&&St.test(g.css(t,"display"))?g.swap(t,Pt,function(){return jt(t,e,n)}):jt(t,e,n)},set:function(t,i,n){var r=n&&Lt(t);return Nt(0,i,n?Vt(t,e,n,g.support.boxSizing&&"border-box"===g.css(t,"boxSizing",!1,r),r):0)}}}),g(function(){g.support.reliableMarginRight||(g.cssHooks.marginRight={get:function(t,e){if(e)return g.swap(t,{display:"inline-block"},wt,[t,"marginRight"])}}),!g.support.pixelPosition&&g.fn.position&&g.each(["top","left"],function(t,e){g.cssHooks[e]={get:function(t,i){if(i)return i=wt(t,e),At.test(i)?g(t).position()[e]+"px":i}}})}),g.expr&&g.expr.filters&&(g.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},g.expr.filters.visible=function(t){return!g.expr.filters.hidden(t)}),g.each({margin:"",padding:"",border:"Width"},function(t,e){g.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+It[n]+e]=o[n]||o[n-2]||o[0];return r}},Tt.test(t)||(g.cssHooks[t+e].set=Nt)});var zt=/%20/g,Xt=/\[\]$/,Wt=/\r?\n/g,Jt=/^(?:submit|button|image|reset|file)$/i,Ht=/^(?:input|select|textarea|keygen)/i;function qt(t,e,i,n){var r;if(g.isArray(e))g.each(e,function(e,r){i||Xt.test(t)?n(t,r):qt(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==g.type(e))n(t,e);else for(r in e)qt(t+"["+r+"]",e[r],i,n)}g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=g.prop(this,"elements");return t?g.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!g(this).is(":disabled")&&Ht.test(this.nodeName)&&!Jt.test(t)&&(this.checked||!ct.test(t))}).map(function(t,e){var i=g(this).val();return null==i?null:g.isArray(i)?g.map(i,function(t){return{name:e.name,value:t.replace(Wt,"\r\n")}}):{name:e.name,value:i.replace(Wt,"\r\n")}}).get()}}),g.param=function(t,i){var n,r=[],o=function(t,e){e=g.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=g.ajaxSettings&&g.ajaxSettings.traditional),g.isArray(t)||t.jquery&&!g.isPlainObject(t))g.each(t,function(){o(this.name,this.value)});else for(n in t)qt(n,t[n],i,o);return r.join("&").replace(zt,"+")},g.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){g.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),g.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Yt,$t,Kt=g.now(),Zt=/\?/,Qt=/#.*$/,te=/([?&])_=[^&]*/,ee=/^(.*?):[ \t]*([^\r\n]*)$/gm,ie=/^(?:GET|HEAD)$/,ne=/^\/\//,re=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,oe=g.fn.load,se={},ae={},le="*/".concat("*");try{$t=o.href}catch(t){($t=s.createElement("a")).href="",$t=$t.href}function ce(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(b)||[];if(g.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function ue(t,e,i,n){var r={},o=t===ae;function s(a){var l;return r[a]=!0,g.each(t[a]||[],function(t,a){var c=a(e,i,n);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)}),l}return s(e.dataTypes[0])||!r["*"]&&s("*")}function he(t,i){var n,r,o=g.ajaxSettings.flatOptions||{};for(n in i)i[n]!==e&&((o[n]?t:r||(r={}))[n]=i[n]);return r&&g.extend(!0,t,r),t}Yt=re.exec($t.toLowerCase())||[],g.fn.load=function(t,i,n){if("string"!=typeof t&&oe)return oe.apply(this,arguments);var r,o,s,a=this,l=t.indexOf(" ");return l>=0&&(r=t.slice(l),t=t.slice(0,l)),g.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(o="POST"),a.length>0&&g.ajax({url:t,type:o,dataType:"html",data:i}).done(function(t){s=arguments,a.html(r?g("<div>").append(g.parseHTML(t)).find(r):t)}).complete(n&&function(t,e){a.each(n,s||[t.responseText,e,t])}),this},g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){g.fn[e]=function(t){return this.on(e,t)}}),g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:$t,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Yt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":g.parseJSON,"text xml":g.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?he(he(t,g.ajaxSettings),e):he(g.ajaxSettings,t)},ajaxPrefilter:ce(se),ajaxTransport:ce(ae),ajax:function(t,i){"object"==typeof t&&(i=t,t=e),i=i||{};var n,r,o,s,a,l,c,u,h=g.ajaxSetup({},i),p=h.context||h,d=h.context&&(p.nodeType||p.jquery)?g(p):g.event,f=g.Deferred(),m=g.Callbacks("once memory"),y=h.statusCode||{},_={},x={},v=0,w="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(2===v){if(!s)for(s={};e=ee.exec(o);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===v?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return v||(t=x[i]=x[i]||t,_[t]=e),this},overrideMimeType:function(t){return v||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(v<2)for(e in t)y[e]=[y[e],t[e]];else C.always(t[C.status]);return this},abort:function(t){var e=t||w;return n&&n.abort(e),S(0,e),this}};if(f.promise(C).complete=m.add,C.success=C.done,C.error=C.fail,h.url=((t||h.url||$t)+"").replace(Qt,"").replace(ne,Yt[1]+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=g.trim(h.dataType||"*").toLowerCase().match(b)||[""],null==h.crossDomain&&(l=re.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===Yt[1]&&l[2]===Yt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Yt[3]||("http:"===Yt[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=g.param(h.data,h.traditional)),ue(se,h,i,C),2===v)return C;for(u in(c=h.global)&&0==g.active++&&g.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!ie.test(h.type),r=h.url,h.hasContent||(h.data&&(r=h.url+=(Zt.test(r)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=te.test(r)?r.replace(te,"$1_="+Kt++):r+(Zt.test(r)?"&":"?")+"_="+Kt++)),h.ifModified&&(g.lastModified[r]&&C.setRequestHeader("If-Modified-Since",g.lastModified[r]),g.etag[r]&&C.setRequestHeader("If-None-Match",g.etag[r])),(h.data&&h.hasContent&&!1!==h.contentType||i.contentType)&&C.setRequestHeader("Content-Type",h.contentType),C.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+le+"; q=0.01":""):h.accepts["*"]),h.headers)C.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(!1===h.beforeSend.call(p,C,h)||2===v))return C.abort();for(u in w="abort",{success:1,error:1,complete:1})C[u](h[u]);if(n=ue(ae,h,i,C)){C.readyState=1,c&&d.trigger("ajaxSend",[C,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){C.abort("timeout")},h.timeout));try{v=1,n.send(_,S)}catch(t){if(!(v<2))throw t;S(-1,t)}}else S(-1,"No Transport");function S(t,i,s,l){var u,_,x,b,w,S=i;2!==v&&(v=2,a&&clearTimeout(a),n=e,o=l||"",C.readyState=t>0?4:0,u=t>=200&&t<300||304===t,s&&(b=function(t,i,n){var r,o,s,a,l=t.contents,c=t.dataTypes;for(;"*"===c[0];)c.shift(),r===e&&(r=t.mimeType||i.getResponseHeader("Content-Type"));if(r)for(o in l)if(l[o]&&l[o].test(r)){c.unshift(o);break}if(c[0]in n)s=c[0];else{for(o in n){if(!c[0]||t.converters[o+" "+c[0]]){s=o;break}a||(a=o)}s=s||a}if(s)return s!==c[0]&&c.unshift(s),n[s]}(h,C,s)),b=function(t,e,i,n){var r,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];o=u.shift();for(;o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(r in c)if((a=r.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(h,b,C,u),u?(h.ifModified&&((w=C.getResponseHeader("Last-Modified"))&&(g.lastModified[r]=w),(w=C.getResponseHeader("etag"))&&(g.etag[r]=w)),204===t||"HEAD"===h.type?S="nocontent":304===t?S="notmodified":(S=b.state,_=b.data,u=!(x=b.error))):(x=S,!t&&S||(S="error",t<0&&(t=0))),C.status=t,C.statusText=(i||S)+"",u?f.resolveWith(p,[_,S,C]):f.rejectWith(p,[C,S,x]),C.statusCode(y),y=e,c&&d.trigger(u?"ajaxSuccess":"ajaxError",[C,h,u?_:x]),m.fireWith(p,[C,S]),c&&(d.trigger("ajaxComplete",[C,h]),--g.active||g.event.trigger("ajaxStop")))}return C},getJSON:function(t,e,i){return g.get(t,e,i,"json")},getScript:function(t,i){return g.get(t,e,i,"script")}}),g.each(["get","post"],function(t,i){g[i]=function(t,n,r,o){return g.isFunction(n)&&(o=o||r,r=n,n=e),g.ajax({url:t,type:i,dataType:o,data:n,success:r})}}),g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return g.globalEval(t),t}}}),g.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),g.ajaxTransport("script",function(t){var e,i;if(t.crossDomain)return{send:function(n,r){e=g("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),s.head.appendChild(e[0])},abort:function(){i&&i()}}});var pe=[],de=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=pe.pop()||g.expando+"_"+Kt++;return this[t]=!0,t}}),g.ajaxPrefilter("json jsonp",function(i,n,r){var o,s,a,l=!1!==i.jsonp&&(de.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&de.test(i.data)&&"data");if(l||"jsonp"===i.dataTypes[0])return o=i.jsonpCallback=g.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(de,"$1"+o):!1!==i.jsonp&&(i.url+=(Zt.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return a||g.error(o+" was not called"),a[0]},i.dataTypes[0]="json",s=t[o],t[o]=function(){a=arguments},r.always(function(){t[o]=s,i[o]&&(i.jsonpCallback=n.jsonpCallback,pe.push(o)),a&&g.isFunction(s)&&s(a[0]),a=s=e}),"script"}),g.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var fe=g.ajaxSettings.xhr(),me={0:200,1223:204},ye=0,_e={};t.ActiveXObject&&g(t).on("unload",function(){for(var t in _e)_e[t]();_e=e}),g.support.cors=!!fe&&"withCredentials"in fe,g.support.ajax=fe=!!fe,g.ajaxTransport(function(t){var i;if(g.support.cors||fe&&!t.crossDomain)return{send:function(n,r){var o,s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];for(o in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)a.setRequestHeader(o,n[o]);i=function(t){return function(){i&&(delete _e[s],i=a.onload=a.onerror=null,"abort"===t?a.abort():"error"===t?r(a.status||404,a.statusText):r(me[a.status]||a.status,a.statusText,"string"==typeof a.responseText?{text:a.responseText}:e,a.getAllResponseHeaders()))}},a.onload=i(),a.onerror=i("error"),i=_e[s=ye++]=i("abort"),a.send(t.hasContent&&t.data||null)},abort:function(){i&&i()}}});var xe,ge,ve=/^(?:toggle|show|hide)$/,be=new RegExp("^(?:([+-])=|)("+v+")([a-z%]*)$","i"),we=/queueHooks$/,Ce=[function(t,i,n){var r,o,s,a,l,c,u=this,h={},p=t.style,d=t.nodeType&&kt(t),f=F.get(t,"fxshow");n.queue||(null==(l=g._queueHooks(t,"fx")).unqueued&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,u.always(function(){u.always(function(){l.unqueued--,g.queue(t,"fx").length||l.empty.fire()})}));1===t.nodeType&&("height"in i||"width"in i)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===g.css(t,"display")&&"none"===g.css(t,"float")&&(p.display="inline-block"));n.overflow&&(p.overflow="hidden",u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in i)if(o=i[r],ve.exec(o)){if(delete i[r],s=s||"toggle"===o,o===(d?"hide":"show")){if("show"!==o||!f||f[r]===e)continue;d=!0}h[r]=f&&f[r]||g.style(t,r)}if(!g.isEmptyObject(h))for(r in f?"hidden"in f&&(d=f.hidden):f=F.access(t,"fxshow",{}),s&&(f.hidden=!d),d?g(t).show():u.done(function(){g(t).hide()}),u.done(function(){var e;for(e in F.remove(t,"fxshow"),h)g.style(t,e,h[e])}),h)a=De(d?f[r]:0,r,u),r in f||(f[r]=a.start,d&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}],Se={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=be.exec(e),o=r&&r[3]||(g.cssNumber[t]?"":"px"),s=(g.cssNumber[t]||"px"!==o&&+n)&&be.exec(g.css(i.elem,t)),a=1,l=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+n||1;do{s/=a=a||".5",g.style(i.elem,t,s+o)}while(a!==(a=i.cur()/n)&&1!==a&&--l)}return r&&(s=i.start=+s||+n||0,i.unit=o,i.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),i}]};function Te(){return setTimeout(function(){xe=e}),xe=g.now()}function De(t,e,i){for(var n,r=(Se[e]||[]).concat(Se["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,e,t))return n}function Ae(t,e,i){var n,r,o=0,s=Ce.length,a=g.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=xe||Te(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(n);return a.notifyWith(t,[c,n,i]),n<1&&s?i:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:g.extend({},e),opts:g.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:xe||Te(),duration:i.duration,tweens:[],createTween:function(e,i){var n=g.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)c.tweens[i].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),u=c.props;for(!function(t,e){var i,n,r,o,s;for(i in t)if(n=g.camelCase(i),r=e[n],o=t[i],g.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),(s=g.cssHooks[n])&&"expand"in s)for(i in o=s.expand(o),delete t[n],o)i in t||(t[i]=o[i],e[i]=r);else e[n]=r}(u,c.opts.specialEasing);o<s;o++)if(n=Ce[o].call(c,t,u,c.opts))return n;return g.map(u,De,c),g.isFunction(c.opts.start)&&c.opts.start.call(t,c),g.fx.timer(g.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function Be(t,e,i,n,r){return new Be.prototype.init(t,e,i,n,r)}function Me(t,e){var i,n={height:t},r=0;for(e=e?1:0;r<4;r+=2-e)n["margin"+(i=It[r])]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function Pe(t){return g.isWindow(t)?t:9===t.nodeType&&t.defaultView}g.Animation=g.extend(Ae,{tweener:function(t,e){g.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;n<r;n++)i=t[n],Se[i]=Se[i]||[],Se[i].unshift(e)},prefilter:function(t,e){e?Ce.unshift(t):Ce.push(t)}}),g.Tween=Be,Be.prototype={constructor:Be,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(g.cssNumber[i]?"":"px")},cur:function(){var t=Be.propHooks[this.prop];return t&&t.get?t.get(this):Be.propHooks._default.get(this)},run:function(t){var e,i=Be.propHooks[this.prop];return this.options.duration?this.pos=e=g.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Be.propHooks._default.set(this),this}},Be.prototype.init.prototype=Be.prototype,Be.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=g.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){g.fx.step[t.prop]?g.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[g.cssProps[t.prop]]||g.cssHooks[t.prop])?g.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},Be.propHooks.scrollTop=Be.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},g.each(["toggle","show","hide"],function(t,e){var i=g.fn[e];g.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(Me(e,!0),t,n,r)}}),g.fn.extend({fadeTo:function(t,e,i,n){return this.filter(kt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=g.isEmptyObject(t),o=g.speed(e,i,n),s=function(){var e=Ae(this,g.extend({},t),o);(r||F.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,i,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=g.timers,s=F.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&we.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||g.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=F.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=g.timers,s=n?n.length:0;for(i.finish=!0,g.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),g.each({slideDown:Me("show"),slideUp:Me("hide"),slideToggle:Me("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){g.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),g.speed=function(t,e,i){var n=t&&"object"==typeof t?g.extend({},t):{complete:i||!i&&e||g.isFunction(t)&&t,duration:t,easing:i&&e||e&&!g.isFunction(e)&&e};return n.duration=g.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in g.fx.speeds?g.fx.speeds[n.duration]:g.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){g.isFunction(n.old)&&n.old.call(this),n.queue&&g.dequeue(this,n.queue)},n},g.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},g.timers=[],g.fx=Be.prototype.init,g.fx.tick=function(){var t,i=g.timers,n=0;for(xe=g.now();n<i.length;n++)(t=i[n])()||i[n]!==t||i.splice(n--,1);i.length||g.fx.stop(),xe=e},g.fx.timer=function(t){t()&&g.timers.push(t)&&g.fx.start()},g.fx.interval=13,g.fx.start=function(){ge||(ge=setInterval(g.fx.tick,g.fx.interval))},g.fx.stop=function(){clearInterval(ge),ge=null},g.fx.speeds={slow:600,fast:200,_default:400},g.fx.step={},g.expr&&g.expr.filters&&(g.expr.filters.animated=function(t){return g.grep(g.timers,function(e){return t===e.elem}).length}),g.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){g.offset.setOffset(this,t,e)});var i,n,o=this[0],s={top:0,left:0},a=o&&o.ownerDocument;return a?(i=a.documentElement,g.contains(i,o)?(typeof o.getBoundingClientRect!==r&&(s=o.getBoundingClientRect()),n=Pe(a),{top:s.top+n.pageYOffset-i.clientTop,left:s.left+n.pageXOffset-i.clientLeft}):s):void 0},g.offset={setOffset:function(t,e,i){var n,r,o,s,a,l,c=g.css(t,"position"),u=g(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),o=g.css(t,"top"),l=g.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(n=u.position()).top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),g.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):u.css(h)}},g.fn.extend({position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===g.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),g.nodeName(t[0],"html")||(n=t.offset()),n.top+=g.css(t[0],"borderTopWidth",!0),n.left+=g.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-g.css(i,"marginTop",!0),left:e.left-n.left-g.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||a;t&&!g.nodeName(t,"html")&&"static"===g.css(t,"position");)t=t.offsetParent;return t||a})}}),g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(i,n){var r="pageYOffset"===n;g.fn[i]=function(o){return g.access(this,function(i,o,s){var a=Pe(i);if(s===e)return a?a[n]:i[o];a?a.scrollTo(r?t.pageXOffset:s,r?s:t.pageYOffset):i[o]=s},i,o,arguments.length,null)}}),g.each({Height:"height",Width:"width"},function(t,i){g.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,r){g.fn[r]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return g.access(this,function(i,n,r){var o;return g.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+t],o["scroll"+t],i.body["offset"+t],o["offset"+t],o["client"+t])):r===e?g.css(i,n,a):g.style(i,n,r,a)},i,s?r:e,s,null)}})}),g.fn.size=function(){return this.length},g.fn.andSelf=g.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=g:"function"==typeof define&&define.amd&&define("jquery",[],function(){return g}),"object"==typeof t&&"object"==typeof t.document&&(t.jQuery=t.$=g)}(window),window.Modernizr=function(t,e,i){var n,r,o={},s=e.documentElement,a=e.createElement("modernizr"),l=a.style,c="Webkit Moz O ms".split(" "),u="Webkit Moz O ms".toLowerCase().split(" "),h={},p=[],d=p.slice,f={}.hasOwnProperty;function m(t){l.cssText=t}function y(t,e){return typeof t===e}for(var _ in r=y(f,"undefined")||y(f.call,"undefined")?function(t,e){return e in t&&y(t.constructor.prototype[e],"undefined")}:function(t,e){return f.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=d.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=e.prototype;var o=new r,s=e.apply(o,i.concat(d.call(arguments)));return Object(s)===s?s:o}return e.apply(t,i.concat(d.call(arguments)))};return n}),h.canvas=function(){var t=e.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},h.websockets=function(){return"WebSocket"in t||"MozWebSocket"in t},h)r(h,_)&&(n=_.toLowerCase(),o[n]=h[_](),p.push((o[n]?"":"no-")+n));return o.addTest=function(t,e){if("object"==typeof t)for(var n in t)r(t,n)&&o.addTest(n,t[n]);else{if(t=t.toLowerCase(),o[t]!==i)return o;e="function"==typeof e?e():e,s.className+=" "+(e?"":"no-")+t,o[t]=e}return o},m(""),a=null,function(t,e){var i,n,r=t.html5||{},o=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,s=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,a="_html5shiv",l=0,c={};function u(){var t=f.elements;return"string"==typeof t?t.split(" "):t}function h(t){var e=c[t[a]];return e||(e={},l++,t[a]=l,c[l]=e),e}function p(t,i,r){return i||(i=e),n?i.createElement(t):(r||(r=h(i)),(a=r.cache[t]?r.cache[t].cloneNode():s.test(t)?(r.cache[t]=r.createElem(t)).cloneNode():r.createElem(t)).canHaveChildren&&!o.test(t)?r.frag.appendChild(a):a);var a}function d(t){t||(t=e);var r=h(t);return!f.shivCSS||i||r.hasCSS||(r.hasCSS=!!function(t,e){var i=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return i.innerHTML="x<style>"+e+"</style>",n.insertBefore(i.lastChild,n.firstChild)}(t,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),n||function(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(i){return f.shivMethods?p(i,t,e):e.createElem(i)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+u().join().replace(/\w+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(f,e.frag)}(t,r),t}!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",i="hidden"in t,n=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return void 0===t.cloneNode||void 0===t.createDocumentFragment||void 0===t.createElement}()}catch(t){i=!0,n=!0}}();var f={elements:r.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:!1!==r.shivCSS,supportsUnknownElements:n,shivMethods:!1!==r.shivMethods,type:"default",shivDocument:d,createElement:p,createDocumentFragment:function(t,i){if(t||(t=e),n)return t.createDocumentFragment();for(var r=(i=i||h(t)).frag.cloneNode(),o=0,s=u(),a=s.length;o<a;o++)r.createElement(s[o]);return r}};t.html5=f,d(e)}(this,e),o._version="2.6.2",o._domPrefixes=u,o._cssomPrefixes=c,s.className=s.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+" js "+p.join(" "),o}(this,this.document),function(t,e,i){function n(t){return"[object Function]"==y.call(t)}function r(t){return"string"==typeof t}function o(){}function s(t){return!t||"loaded"==t||"complete"==t||"uninitialized"==t}function a(){var t=_.shift();x=1,t?t.t?f(function(){("c"==t.t?p.injectCss:p.injectJs)(t.s,0,t.a,t.x,t.e,1)},0):(t(),a()):x=0}function l(t,i,n,r,o,l,c){function u(e){if(!d&&s(h.readyState)&&(g.r=d=1,!x&&a(),h.onload=h.onreadystatechange=null,e))for(var n in"img"!=t&&f(function(){b.removeChild(h)},50),D[i])D[i].hasOwnProperty(n)&&D[i][n].onload()}c=c||p.errorTimeout;var h=e.createElement(t),d=0,y=0,g={t:n,s:i,e:o,a:l,x:c};1===D[i]&&(y=1,D[i]=[]),"object"==t?h.data=i:(h.src=i,h.type=t),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){u.call(this,y)},_.splice(r,0,g),"img"!=t&&(y||2===D[i]?(b.insertBefore(h,v?null:m),f(u,c)):D[i].push(h))}function c(t,e,i,n,o){return x=0,e=e||"j",r(t)?l("c"==e?C:w,t,e,this.i++,i,n,o):(_.splice(this.i++,0,t),1==_.length&&a()),this}function u(){var t=p;return t.loader={load:c,i:0},t}var h,p,d=e.documentElement,f=t.setTimeout,m=e.getElementsByTagName("script")[0],y={}.toString,_=[],x=0,g="MozAppearance"in d.style,v=g&&!!e.createRange().compareNode,b=v?d:m.parentNode,w=(d=t.opera&&"[object Opera]"==y.call(t.opera),d=!!e.attachEvent&&!d,g?"object":d?"script":"img"),C=d?"script":w,S=Array.isArray||function(t){return"[object Array]"==y.call(t)},T=[],D={},A={timeout:function(t,e){return e.length&&(t.timeout=e[0]),t}};(p=function(t){function e(t,e,r,o,s){var a=function(t){t=t.split("!");var e,i,n,r=T.length,o=t.pop(),s=t.length;for(o={url:o,origUrl:o,prefixes:t},i=0;i<s;i++)n=t[i].split("="),(e=A[n.shift()])&&(o=e(o,n));for(i=0;i<r;i++)o=T[i](o);return o}(t),l=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(e&&(e=n(e)?e:e[t]||e[o]||e[t.split("/").pop().split("?")[0]]),a.instead?a.instead(t,e,r,o,s):(D[a.url]?a.noexec=!0:D[a.url]=1,r.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":i,a.noexec,a.attrs,a.timeout),(n(e)||n(l))&&r.load(function(){u(),e&&e(a.origUrl,s,o),l&&l(a.origUrl,s,o),D[a.url]=2})))}function s(t,i){function s(t,o){if(t){if(r(t))o||(h=function(){var t=[].slice.call(arguments);p.apply(this,t),d()}),e(t,h,i,0,c);else if(Object(t)===t)for(l in a=function(){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i}(),t)t.hasOwnProperty(l)&&(!o&&!--a&&(n(h)?h=function(){var t=[].slice.call(arguments);p.apply(this,t),d()}:h[l]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),d()}}(p[l])),e(t[l],h,i,l,c))}else!o&&d()}var a,l,c=!!t.test,u=t.load||t.both,h=t.callback||o,p=h,d=t.complete||o;s(c?t.yep:t.nope,!!u),u&&s(u)}var a,l,c=this.yepnope.loader;if(r(t))e(t,0,c,0);else if(S(t))for(a=0;a<t.length;a++)r(l=t[a])?e(l,0,c,0):S(l)?p(l):Object(l)===l&&s(l,c);else Object(t)===t&&s(t,c)}).addPrefix=function(t,e){A[t]=e},p.addFilter=function(t){T.push(t)},p.errorTimeout=1e4,null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",h=function(){e.removeEventListener("DOMContentLoaded",h,0),e.readyState="complete"},0)),t.yepnope=u(),t.yepnope.executeStack=a,t.yepnope.injectJs=function(t,i,n,r,l,c){var u,h,d=e.createElement("script");r=r||p.errorTimeout;for(h in d.src=t,n)d.setAttribute(h,n[h]);i=c?a:i||o,d.onreadystatechange=d.onload=function(){!u&&s(d.readyState)&&(u=1,i(),d.onload=d.onreadystatechange=null)},f(function(){u||(u=1,i(1))},r),l?d.onload():m.parentNode.insertBefore(d,m)},t.yepnope.injectCss=function(t,i,n,r,s,l){var c;r=e.createElement("link"),i=l?a:i||o;for(c in r.href=t,r.rel="stylesheet",r.type="text/css",n)r.setAttribute(c,n[c]);s||(m.parentNode.insertBefore(r,m),f(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("cookies",function(){if(navigator.cookieEnabled)return!0;document.cookie="cookietest=1";var t=-1!=document.cookie.indexOf("cookietest=");return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",t}),tagproConfig={},tagpro={version:"3.2.1",socket:null,players:null,chat:null,playerId:null,teamNames:null,score:null,state:null,sound:null,zoom:1,zooming:0,serverPort:null,serverHost:null,socketPort:null,socketHost:null,viewport:{followPlayer:!0,centerLock:!1,source:{x:0,y:0}},TILE_SIZE:40,kongregate:!1,settings:{ui:{allChat:!0,teamChat:!0,groupChat:!0,systemChat:!0,tutorialChat:!1,spectatorInfo:!0,performanceInfo:!0,names:!0,teamNames:"always",degrees:!0,matchState:!0}},keys:{left:[37,65,97],up:[38,87,119],right:[39,68,100],down:[40,83,115],space:[32],chatToTeam:[222,84],chatToGroup:[186,71,103],chatToAll:[13],chatAsMod:[],sendChat:[13],cancelChat:[27],nickCompleteChat:[9],showOptions:[27],zoomOut:[173,189,109],zoomIn:[61,187,107],resetZoom:[90],centerZoom:[67],specNext:[81],specPrev:[87],specRedFC:[65],specBlueFC:[83],toggleAutoJoin:[32]},ping:{current:0,history:[],avg:0},host:document.location.host,gameEndsAt:null,disableControls:0,spectator:!1,spectators:0,movement:[],joinGame:function(t){location.href=t},api:{redrawBackground:function(){console.error("The redrawBackground function has been deprecated.")}},events:{register:function(t){for(var e in t)tagpro.events[e]||(tagpro.events[e]=[]),eventFunc={},eventFunc[e]=t[e],tagpro.events[e].push(eventFunc)}},resourcesLoaded:!1,_readyCallbacks:[],_afterReadyCallbacks:[],ready:function(t){tagpro.resourcesLoaded?t():tagpro._readyCallbacks.push(t)}},tagpro.ready.after=function(t){tagpro.resourcesLoaded?t():tagpro._afterReadyCallbacks.push(t)},$(document).ready(function(){function t(t,e){var i=$.cookie(t);$.removeCookie(t);var n=void 0==$.cookie(t);(void 0==i||n)&&$.cookie(t,i||e,{expires:36500,path:"/",domain:tagproConfig.cookieHost})}if(t("music","false"),t("sound","true"),t("disableParticles","false"),t("forceCanvasRenderer","false"),t("disableViewportScaling","true"),t("disableTutorialChat","false"),t("tileRespawnWarnings","blink"),$(".js-copyright-date").text((new Date).getFullYear()),"/kongregate"!=window.location.pathname&&"/auth/link-accounts/close"!=window.location.pathname&&(tagpro.kongregate=!!$.cookie("kongregate"),!tagproConfig.isHomeServer&&window.self===window.top)){if($.removeCookie("kongregate",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-username",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-token",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-userId",{domain:tagproConfig.cookieHost}),tagpro.kongregate)return document.location.href="/logout";tagpro.kongregate=!1}if("/kongregate"!=window.location.pathname&&tagpro.kongregate){var e=["tagpro.gg","koalabeast.com","localhost","jukejuice.com","127.0.0.1"];$("a").each(function(){var t=$(this),i=t.attr("href");if(i){i=i.toLowerCase();var n=!e.some(function(t){return i.indexOf(t)>-1});n&&"http"!=i.substr(0,4)&&(n=!1),t.hasClass("ensureExternal")&&(n=!0),n&&t.attr("target","_parent")}})}setTimeout(function(){var t=$("#loadingMessage"),e=$("#assets img"),i=0;e.each(function(){$(this).prop("crossOrigin","Anonymous").attr("src",$(this).attr("src"))}),setTimeout(function(){tagpro.resourcesLoaded||e.not("[data-load]").each(function(){t.append($("<div></div>").css({"font-weight":"normal","font-size":"50%"}).text($(this).attr("id")+"..."))})},1e4);var n=function(){e.each(function(){var t=$(this)[0];t.loaded||t.complete&&t.naturalWidth>0&&(t.loaded=!0,i++)}),i<e.length?setTimeout(n,0):(tagpro.resourcesLoaded=!0,tagpro._readyCallbacks.forEach(function(t){t()}),tagpro._readyCallbacks=[],tagpro._afterReadyCallbacks.forEach(function(t){t()}),tagpro._afterReadyCallbacks=[])};n()},0),$(".header .nav .group-indicator").bind("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){this.classList.remove("js-animate"),this.offsetWidth=this.offsetWidth,this.classList.add("js-animate")}).addClass("js-animate"),$(".header .nav .mobile-menu-toggle").click(function(){$(".header .nav").toggleClass("mobile-expanded").find("li").slideToggle()}),window.onerror=function(){$(".js-console-error").length||(message="We are seeing some odd errors. This could have something to do with your TagPro addons and scripts. You might need to disable them until they are updated by the author.",tagpro.helpers.displayError(message).find(".msg").addClass("js-console-error"))}}),$(document).keydown(function(t){if(8==t.keyCode){var e=t.target.nodeName.toLowerCase();"input"!=e&&"textarea"!=e&&t.preventDefault()}}),tagpro.helpers={pad:function(t,e){t=t.toString();var i=(e=e.toString())+t,n=e.length>t.length?e.length:t.length;return i.substr(i.length-n)},timeFromSeconds:function(t,e){void 0==e&&(e=!1);var i=tagpro.helpers.pad;t=parseFloat(t);var n=parseInt(t/3600),r=t%60,o=i(parseInt(t/60)%60,"00")+":"+i(r,"00");return(!e||n>0)&&(o=i(n,"00")+":"+o),o},rebaseToCDN:function(t){return"/"==t.charAt(0)&&"/"!=t.charAt(1)?"http://"+tagproConfig.cdn+t:t},displayError:function(t){var e=$("<div></div>").addClass("col-md-8 col-md-offset-2"),i=$("<div></div>").addClass("msg msg-warning").css("margin-bottom",20);return i.text(t),e.append(i),$("body:not(.game-page) > .container > .row").first().prepend(e),e}},$(window).on("load",restoreFocus()),$(document).ready(function(){$(document).find("#viewport").click(function(){setTimeout(restoreFocus(),100)})}),tagpro.sendPingStatistics=function(){},function(){var t,e={};e.DEBUG=!1,e.cache={},e.clearCache=function(){this.cache={}},e.uid=function(){var i=this.data();return t(i.canvasFingerprint+":"+t(i.fonts.join(":"))+":"+JSON.stringify(i.screen)+":"+JSON.stringify(i.browser)+":"+JSON.stringify(i.webgl)+":"+JSON.stringify(e.pluginNames()))},e.match=function(t){return e.uid()===t},e.data=function(){return{canvasFingerprint:e.canvas(),fonts:e.fonts(),browser:e.browser(),plugins:e.pluginNames(),screen:e.screen(),webgl:e.webgl()}},e.screen=function(){return{width:screen.width,height:screen.height,colorDepth:screen.colorDepth,pixelDepth:screen.pixelDepth}},e.browser=function(){return{userAgent:navigator.userAgent,cookies:navigator.cookieEnabled,java:navigator.javaEnabled(),dnt:navigator.doNotTrack,lang:navigator.language}},e.PLUGINS=["Google Talk Plugin Video Renderer","Google Talk Plugin","Java Applet Plug-in","QuickTime Plug-in 7.7.3","Default Browser Helper","Shockwave Flash","AdobeAAMDetect","AdobeExManDetect","iPhotoPhotocast","SharePoint Browser Plug-in","Google Earth Plug-in","RealPlayer Plugin.plugin","DivX Web Player","Wacom Pressure Plug-In","Microsoft Office Live Plug-in","Widevine Content Decryption Module","Chrome Remote Desktop Viewer","Chrome PDF Viewer","Native Client","Google Talk Plugin Video Renderer","Unity Player","Default Browser Helper","Silverlight Plug-In","Wacom Tablet Plug-In","WebKit-integrierte PDF"],e.plugins=function(){if(!navigator.plugins)return null;var t=[];return this.PLUGINS.forEach(function(e){var i=navigator.plugins[e];void 0!==i&&(t[e]=i)}),t.sort()},e.pluginNames=function(){return navigator.plugins?this.PLUGINS.filter(function(t){return void 0!==navigator.plugins[t]}):null},e.canvas=function(){if(void 0!==e.cache.canvas)return e.cache.canvas;var t=document.createElement("canvas");t.width=280,t.height=60,this.DEBUG||(t.style.display="none"),t.id="beaver-bird-canvas",document.body.appendChild(t);var n=t.getContext("2d");n.fillStyle="rgb(178, 214, 232)",n.fillRect(10,20,60,80),n.fillStyle="#111",n.font="16pt Arial",n.fillText("BeaverBird is watching you",2,40),n.strokeStyle="rgb(120, 186, 176)",n.arc(80,10,20,0,Math.PI),n.stroke();var r=n.getImageData(0,0,280,60);this.DEBUG||document.body.removeChild(t);var o=function(t,e){t instanceof Uint8Array||(t=t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer):new Uint8Array(t));for(var n=-1^~~e,r=0;r<t.length;r++)n=i[255&(n^t[r])]^n>>>8;return-1^n}(r.data).toString();return e.cache.canvas=o,o},e.matchCanvas=function(t){return t===e.canvas()},e.fonts=function(t){if(void 0!==this.cache.fonts)return this.cache.fonts;var i=["Arial","Times New Roman","Helvetica","Open Sans","Source Sans Pro","Comic Sans MS","Century","Century Gothic","Monaco","Lato","Geneva","Futura","Fantasque Sans Mono","Courier","Courier New","Corsiva Hebrew","Comic Neue","Cambria","Calibri","TI-Nspire","Adobe Braille","Adobe Hebrew","Apple LiGothic","Apple Farben-Emoji","Avenir","Avenir Next","Batang","Bell MT","Birch Std","Damascus","Microsoft Sans Serif","Minion Pro","Times","Roboto","Oswald","Droid Sans","Droid Serif","Roboto Condensed","Ubuntu","Raleway","Lobster","Ubuntu Condensed","Helvetica Neue"];void 0!==t&&(i=t);var n=[{name:"serif"},{name:"sans-serif"},{name:"monospace"}],r=document.createElement("span");r.innerHTML="wwzrllTNMLllllliiimmqmmmmiiillllpl_~",r.style.fontSize="86px",n.forEach(function(t){r.style.fontFamily=t.name,document.body.appendChild(r),t.width=r.offsetWidth,t.height=r.offsetHeight,document.body.removeChild(r)}),this.DEBUG&&console.log(n);var o=[];i.forEach(function(t){var i=!1;n.forEach(function(e){r.style.fontFamily=t+","+e.name,document.body.appendChild(r),r.offsetWidth===e.width&&r.offsetHeight===e.height||(i=!0),document.body.removeChild(r)}),i&&(e.DEBUG&&console.log("found font:",t),o.push(t))}),e.DEBUG&&console.log("found",o.length,"fonts");var s=o.sort();return this.cache.fonts=s,s},e.matchFonts=function(t){var e=this.fonts(),i=!1;return t.forEach(function(t){-1===e.indexOf(t)&&(i=!0)}),!i},e.WEBGL_PARAMETERS=["VENDOR","RENDERER","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],e.webgl=function(){var t={},e=function(t){if(!window.WebGLRenderingContext)return null;var e=null;try{e=t.getContext("webgl")||t.getContext("moz-webgl")||t.getContext("experimental-webgl")||t.getContext("webkit-3d")}catch(t){}return e}(document.createElement("canvas"));return null===e?null:(t.parameters={},this.WEBGL_PARAMETERS.forEach(function(i){void 0!==e[i.toUpperCase()]&&(t.parameters[i.toLowerCase()]=e.getParameter(e[i.toUpperCase()]))}),t.extensions=e.getSupportedExtensions(),t)},"undefined"!=typeof module&&module.exports?module.exports=e:window.BeaverBird=e,function(){"use strict";var e=function(t,e){return t+e&4294967295},i=function(t,i,n,r,o,s){return i=e(e(i,t),e(r,s)),e(i<<o|i>>>32-o,n)},n=function(t,e,n,r,o,s,a){return i(e&n|~e&r,t,e,o,s,a)},r=function(t,e,n,r,o,s,a){return i(e&r|n&~r,t,e,o,s,a)},o=function(t,e,n,r,o,s,a){return i(e^n^r,t,e,o,s,a)},s=function(t,e,n,r,o,s,a){return i(n^(e|~r),t,e,o,s,a)},a=function(t,i){var a=t[0],l=t[1],c=t[2],u=t[3];a=n(a,l,c,u,i[0],7,-680876936),u=n(u,a,l,c,i[1],12,-389564586),c=n(c,u,a,l,i[2],17,606105819),l=n(l,c,u,a,i[3],22,-1044525330),a=n(a,l,c,u,i[4],7,-176418897),u=n(u,a,l,c,i[5],12,1200080426),c=n(c,u,a,l,i[6],17,-1473231341),l=n(l,c,u,a,i[7],22,-45705983),a=n(a,l,c,u,i[8],7,1770035416),u=n(u,a,l,c,i[9],12,-1958414417),c=n(c,u,a,l,i[10],17,-42063),l=n(l,c,u,a,i[11],22,-1990404162),a=n(a,l,c,u,i[12],7,1804603682),u=n(u,a,l,c,i[13],12,-40341101),c=n(c,u,a,l,i[14],17,-1502002290),l=n(l,c,u,a,i[15],22,1236535329),a=r(a,l,c,u,i[1],5,-165796510),u=r(u,a,l,c,i[6],9,-1069501632),c=r(c,u,a,l,i[11],14,643717713),l=r(l,c,u,a,i[0],20,-373897302),a=r(a,l,c,u,i[5],5,-701558691),u=r(u,a,l,c,i[10],9,38016083),c=r(c,u,a,l,i[15],14,-660478335),l=r(l,c,u,a,i[4],20,-405537848),a=r(a,l,c,u,i[9],5,568446438),u=r(u,a,l,c,i[14],9,-1019803690),c=r(c,u,a,l,i[3],14,-187363961),l=r(l,c,u,a,i[8],20,1163531501),a=r(a,l,c,u,i[13],5,-1444681467),u=r(u,a,l,c,i[2],9,-51403784),c=r(c,u,a,l,i[7],14,1735328473),l=r(l,c,u,a,i[12],20,-1926607734),a=o(a,l,c,u,i[5],4,-378558),u=o(u,a,l,c,i[8],11,-2022574463),c=o(c,u,a,l,i[11],16,1839030562),l=o(l,c,u,a,i[14],23,-35309556),a=o(a,l,c,u,i[1],4,-1530992060),u=o(u,a,l,c,i[4],11,1272893353),c=o(c,u,a,l,i[7],16,-155497632),l=o(l,c,u,a,i[10],23,-1094730640),a=o(a,l,c,u,i[13],4,681279174),u=o(u,a,l,c,i[0],11,-358537222),c=o(c,u,a,l,i[3],16,-722521979),l=o(l,c,u,a,i[6],23,76029189),a=o(a,l,c,u,i[9],4,-640364487),u=o(u,a,l,c,i[12],11,-421815835),c=o(c,u,a,l,i[15],16,530742520),l=o(l,c,u,a,i[2],23,-995338651),a=s(a,l,c,u,i[0],6,-198630844),u=s(u,a,l,c,i[7],10,1126891415),c=s(c,u,a,l,i[14],15,-1416354905),l=s(l,c,u,a,i[5],21,-57434055),a=s(a,l,c,u,i[12],6,1700485571),u=s(u,a,l,c,i[3],10,-1894986606),c=s(c,u,a,l,i[10],15,-1051523),l=s(l,c,u,a,i[1],21,-2054922799),a=s(a,l,c,u,i[8],6,1873313359),u=s(u,a,l,c,i[15],10,-30611744),c=s(c,u,a,l,i[6],15,-1560198380),l=s(l,c,u,a,i[13],21,1309151649),a=s(a,l,c,u,i[4],6,-145523070),u=s(u,a,l,c,i[11],10,-1120210379),c=s(c,u,a,l,i[2],15,718787259),l=s(l,c,u,a,i[9],21,-343485551),t[0]=e(a,t[0]),t[1]=e(l,t[1]),t[2]=e(c,t[2]),t[3]=e(u,t[3])},l=function(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i},c=function(t){var e,i,n,r,o,s,c=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)a(u,l(t.substring(e-64,e)));for(i=(t=t.substring(e-64)).length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(a(u,n),e=0;e<16;e+=1)n[e]=0;return r=(r=8*c).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(r[2],16),s=parseInt(r[1],16)||0,n[14]=o,n[15]=s,a(u,n),u},u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],h=function(t){var e,i="";for(e=0;e<4;e+=1)i+=u[t>>8*e+4&15]+u[t>>8*e&15];return i},p=function(t){var e;for(e=0;e<t.length;e+=1)t[e]=h(t[e]);return t.join("")};"5d41402abc4b2a76b9719d911017c592"!==p(c("hello"))&&(e=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}),t=function(t,e){/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t)));var i=c(t);return e?i:p(i)}}();var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]}(),$(document).ready(function(){window.location.port!=tagproConfig.serverPort&&""!=window.location.port||$.post("/fingerprint",{id:BeaverBird.uid()})}),factory=function(t){var e=/\+/g;function i(t){return r.raw?t:encodeURIComponent(t)}function n(i,n){var o=r.raw?i:function(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(e," ")),r.json?JSON.parse(t):t}catch(t){}}(i);return t.isFunction(n)?n(o):o}var r=t.cookie=function(e,o,s){if(arguments.length>1&&!t.isFunction(o)){if("number"==typeof(s=t.extend({},r.defaults,s)).expires){var a=s.expires,l=s.expires=new Date;l.setTime(+l+864e5*a)}return document.cookie=[i(e),"=",function(t){return i(r.json?JSON.stringify(t):String(t))}(o),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}for(var c,u=e?void 0:{},h=document.cookie?document.cookie.split("; "):[],p=0,d=h.length;p<d;p++){var f=h[p].split("="),m=(c=f.shift(),r.raw?c:decodeURIComponent(c)),y=f.join("=");if(e&&e===m){u=n(y,o);break}e||void 0===(y=n(y))||(u[m]=y)}return u};r.defaults={},t.removeCookie=function(e,i){return void 0!==t.cookie(e)&&(t.cookie(e,"",t.extend({},i,{expires:-1})),!t.cookie(e))}},"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?factory(require("jquery")):factory(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")}(jQuery),function(t){"use strict";function e(e,n){return this.each(function(){var r=t(this),o=r.data("bs.modal"),s=t.extend({},i.DEFAULTS,r.data(),"object"==typeof e&&e);o||r.data("bs.modal",o=new i(this,s)),"string"==typeof e?o[e](n):s.show&&o.show(n)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.3.6",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var n=this,r=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),r&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});r?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(i.TRANSITION_DURATION):n.$element.trigger("focus").trigger(o)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&r;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){n.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):s()}else e&&e()},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=t(this),r=n.attr("href"),o=t(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},o.data(),n.data());n.is("a")&&i.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),e.call(o,s,this)})}(jQuery);var Stats=function(){var t=Date.now(),e=t,i=0,n=1/0,r=0,o=0,s=1/0,a=0,l=0,c=0,u=document.createElement("div");u.id="stats",u.addEventListener("mousedown",function(t){t.preventDefault(),x(++c%2)},!1),u.style.cssText="width:80px;opacity:0.9;cursor:pointer";var h=document.createElement("div");h.id="fps",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",u.appendChild(h);var p=document.createElement("div");p.id="fpsText",p.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",p.innerHTML="FPS",h.appendChild(p);var d=document.createElement("div");for(d.id="fpsGraph",d.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",h.appendChild(d);74>d.children.length;){var f=document.createElement("span");f.style.cssText="width:1px;height:30px;float:left;background-color:#113",d.appendChild(f)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",u.appendChild(m);var y=document.createElement("div");y.id="msText",y.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",y.innerHTML="MS",m.appendChild(y);var _=document.createElement("div");for(_.id="msGraph",_.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(_);74>_.children.length;)(f=document.createElement("span")).style.cssText="width:1px;height:30px;float:left;background-color:#131",_.appendChild(f);var x=function(t){switch(c=t){case 0:h.style.display="block",m.style.display="none";break;case 1:h.style.display="none",m.style.display="block"}};return{REVISION:12,domElement:u,setMode:x,begin:function(){t=Date.now()},end:function(){var c=Date.now();i=c-t,n=Math.min(n,i),r=Math.max(r,i),y.textContent=i+" MS ("+n+"-"+r+")";var u=Math.min(30,30-i/200*30);return _.appendChild(_.firstChild).style.height=u+"px",l++,c>e+1e3&&(o=Math.round(1e3*l/(c-e)),s=Math.min(s,o),a=Math.max(a,o),p.textContent=o+" FPS ("+s+"-"+a+")",u=Math.min(30,30-o/100*30),d.appendChild(d.firstChild).style.height=u+"px",e=c,l=0),c},update:function(){t=this.end()}}};"object"==typeof module&&(module.exports=Stats),$(document).ready(function(){$("html").hasClass("no-cookies")&&(location.href="http://"+tagproConfig.serverHost+"/cookies")});var Sprite=function(t,e,i,n){var r={};this.createAnimation=function(t,e,i){return r[t]=new Sprite.Animation(e,i),r[t]},this.createInstance=function(o){return{start:(new Date).getTime(),animation:o,draw:function(i,n,o){var s=r[this.animation],a=Math.floor(((new Date).getTime()-this.start)%(s.frames.length*s.time)/s.time);i.drawImage(t,40*s.frames[a],40*s.y,e,e,n,o,e,e)},drawFloor:i||!1,redrawFloor:n||!1}}};Sprite.Animation=function(t,e){this.y=t,this.time=e,this.frames=[],this.createFrame=function(t){this.frames.push(t)}},tagpro.createSocket=function(){var t=io.connect(tagpro.gameSocket||document.location.href+"?r="+Math.round(1e7*Math.random()),{reconnect:!1});return tagpro.rawSocket=t,{on:function(e,i){var n=function(){try{i.apply(this,arguments)}catch(i){console.error("Unhandled socket.io on() error. Mod makers, handle your errors!"),console.error(i),t.removeListener(e,n)}};t.on(e,n)},emit:function(e,i){t.emit(e,i)}}},tagpro.group={socket:null},$(document).ready(function(){var t=$("#groupId").val();if(t&&"null"!=t){var e=io.connect("http://"+tagproConfig.socketHost+"/groups/"+t+"?r="+Math.round(1e7*Math.random()));e.playerLocation=null,tagpro.group.socket=e,setTimeout(function t(){setTimeout(t,3e4),e.connected&&e.emit("touch",e.playerLocation)},3e3)}}),tagpro.ready(function(){var t=tagpro.createSocket(),e={},n={},r=null,o=null,s=1;function a(t,i,n){var r=Math.abs(n);(void 0==t.lastSync[i]||r>t.lastSync[i])&&(t[i]=n>0,t.lastSync[i]=r,e[o]===t&&r>f&&(f=r))}function c(t){for(baseMap=[],subMap=[],i=0;i<t.length;i++)for(baseMap[i]=[],subMap[i]=[],j=0;j<t[0].length;j++)baseMap[i][j]=e(t[i][j]),subMap[i][j]=[];for(i=0;i<=t.length;i++)for(j=0;j<=t[0].length;j++)r(i,j);return subMap;function e(t){var e=[3,0,4,2];if("1"==t)return[1,1,1,1];if("1"==Math.floor(t)){for(offset=Number((t+"").substr(-1))-1;offset>0;offset--)e.unshift(e.pop());return e}return[0,0,0,0]}function n(t,e,i){subMap[t]&&(subMap[t][e]&&(subMap[t][e][0]=i[0]),subMap[t][e-1]&&(subMap[t][e-1][3]=i[3])),subMap[t-1]&&(subMap[t-1][e]&&(subMap[t-1][e][1]=i[1]),subMap[t-1][e-1]&&(subMap[t-1][e-1][2]=i[2]))}function r(t,e){var i=function(t,e){return quadArray=[0,0,0,0],baseMap[t]&&(baseMap[t][e]&&(quadArray[0]=baseMap[t][e][0]),baseMap[t][e-1]&&(quadArray[3]=baseMap[t][e-1][3])),baseMap[t-1]&&(baseMap[t-1][e]&&(quadArray[1]=baseMap[t-1][e][1]),baseMap[t-1][e-1]&&(quadArray[2]=baseMap[t-1][e-1][2])),quadArray}(t,e),r=0,o=[],s=!(1!=i[3]&&2!=i[3]&&3!=i[3]||1!=i[0]&&2!=i[0]&&4!=i[0]),a=s;if(i[0]+i[1]+i[2]+i[3]==0)return n(t,e,i);if(!(1!=i[0]&&2!=i[0]||1!=i[1]&&2!=i[1]||1!=i[2]&&2!=i[2]||1!=i[3]&&2!=i[3])){for(k=0;k<4;k++){var c=2==i[k]?"d":"";i[k]="1."+(k+1)+"00"+c}return n(t,e,i)}for(k=0;k<4;k++){var u=i[k];0==u?f(!s,2):1==u||2==u?f(s,2):3==u?(f(!s,1),f(s,1)):4==u&&(f(s,1),f(!s,1))}for(a?o.push(o.shift()):s&&o.push(0),k=0;k<o.length;k+=2)for(l=0;l<4;l++){var h=(o[k]+6*l)%8,p=(o[k+1]+6*l)%8;if(h<p&&(h<2||2==p||1==p)||h>p&&(p>0||h<2)){var d=2==i[l]?"d":"";i[l]="1."+(l+1)+o[k]+o[k+1]+d}}function f(t,e){t||(o.push(r),s=!s),r+=e}n(t,e,i)}}function u(t,e,i,n){if(i){var r=t.volume+e;return r>1&&(r=1),r<0&&(r=0),t.volume=r,void(t.rampTimeout=setTimeout(function(){u(t,e,i-1,n)},10))}n&&n()}tagpro.socket=t,tagpro.teamNames={},tagpro.players=e,tagpro.objects=n,tagpro.chat={},tagpro.playerId=null,tagpro.score={},tagpro.state=1,tagpro.sendKeyPress=m,tagpro.group.socket&&(tagpro.group.socket.playerLocation="game"),t.on("id",function(t){o=t,tagpro.playerId=o,tagpro.viewport.centerLock||(tagpro.viewport.followPlayer=!0)}),t.on("settings",function(i){for(var n in tagpro.settings=i,e)e[n];t.emit("loaded",{container:window.self!=window.top})}),t.on("tips",function(t){t=!!t,$("#tutorialButton").text(t?"Disable Tips":"Enable Tips")}),t.on("teamNames",function(t){tagpro.teamNames=t}),t.on("spectator",function(t){tagpro.spectator=t,tagpro.spectator||(tagpro.zoom=1,tagpro.viewport.centerLock=!1,tagpro.viewport.followPlayer=!0)}),t.on("spectators",function(t){tagpro.spectators=t}),setTimeout(function(){null==o&&(location.href="http://"+tagproConfig.serverHost)},1e4),t.on("p",function(t){for(var i=t.t||null,n=0,r=(t=t.u||t).length;n!=r;n++){var o=t[n],s=e[o.id];s||(e[(s=o).id]=s,s.lastSync={},s.pressing={});var l=!1,c=!1;for(var u in o)"up"!=u&&"down"!=u&&"left"!=u&&"right"!=u?(null==i||void 0==s.lastSync[u]||i>s.lastSync[u])&&(s[u]=o[u],i&&(s.lastSync[u]=i),"rx"!=u&&"ry"!=u&&"lx"!=u&&"ly"!=u&&"a"!=u&&"den"!=u&&"dead"!=u&&"draw"!=u||(l=!0),"dead"!=u&&"draw"!=u&&"directSet"!=u||(c=!0),!s.sprites||"name"!=u&&"auth"!=u||tagpro.renderer.drawName(s,!0)):a(s,u,o[u]);(c||l)&&tagpro.world&&tagpro.world.syncPlayer(s,c)}}),t.on("object",function(t){n[t.id]||(n[t.id]=t);var e=n[t.id],i=!1,r=!1;for(var o in t)e[o]=t[o],"rx"!=o&&"ry"!=o&&"lx"!=o&&"ly"!=o&&"a"!=o&&"draw"!=o||(i=!0),"draw"==o&&(r=!0);i&&tagpro.world.syncObject(e,r)}),t.on("playerLeft",function(t){2!=s&&(tagpro.world.destoryPlayer(t),tagpro.renderer.destroyPlayer(tagpro.players[t]),delete e[t])}),t.on("map",function(t){r=t.tiles,tagpro.map=r,tagpro.wallMap=c(r),tagpro.floorMap=function(t){for(var e=[0,2,11,12,17,18,23],i=[],n=0;n<t.length;n++){i[n]=[];for(var r=0;r<t[0].length;r++)i[n][r]=-1}for(n=0;n<t.length;n++)for(r=0;r<t[0].length;r++)-1==i[n][r]&&tagpro.tiles[t[n][r]]&&tagpro.tiles[t[n][r]].drawFloor&&o(n,r);function o(n,r){for(var o,s=!0,a=[n,r],l=[],c={};a.length>0;){var u=a.shift(),h=a.shift();if(!c[u+","+h]){c[u+","+h]=!0;var p=t[u]&&t[u][h]||0;if(-1!=e.indexOf(p))o=void 0!==o&&o!=p?2:p;else{var d=tagpro.tiles[t[u][h]];d&&d.drawFloor&&(d.redrawFloor&&(s=!1),(Array.isArray(d.drawFloor)?d.drawFloor:[{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}]).forEach(function(e){var i=u+e.x,n=h+e.y;t[i]&&t[i][n]&&tagpro.tiles[t[i][n]]&&Array.isArray(tagpro.tiles[t[i][n]].drawFloor)&&!tagpro.tiles[t[i][n]].drawFloor.some(function(t){return t.x==-e.x&&t.y==-e.y})||(a.push(i),a.push(n))}),l.push(u),l.push(h))}}}for(void 0!==o&&(o||s)||(o=2);l.length>0;)u=l.shift(),h=l.shift(),i[u][h]=o}return i}(r),tagpro.map.splats=t.splats,t.info&&$("div#mapInfo").removeClass("hide").text("Map: "+(t.info.name||"Untitled")+" by "+(t.info.author||"Unknown"))}),t.on("time",function(t){tagpro.gameEndsAt=new Date((new Date).getTime()+t.time),3==tagpro.state&&1==(t.state||1)&&tagpro.playSound("cheering"),tagpro.state=t.state||1}),tagpro.playSound=function(t,e){if(tagpro.sound){var i=$("audio#"+t).get(0);if(i&&i.play)if(i.volume=e||1,i.volume*=tagpro.volumeCoefficient,0==e)i.pause(),i.currentTime=0;else{if($(i).attr("data-ramp")){i.rampTimeout&&clearTimeout(i.rampTimeout);var n=i.volume;i.volume=0;u(i,.01,Math.ceil(Math.abs((n-i.volume)/.01)))}i.play()}}},tagpro.stopSound=function(t){var e=$("audio#"+t).get(0);if(e&&e.pause&&$(e).attr("data-ramp")){e.rampTimeout&&clearTimeout(e.rampTimeout);var i=Math.ceil(Math.abs((0-e.volume)/-.01));u(e,-.01,i,function(){e.pause(),e.currentTime=0})}},t.on("sound",function(t){if(tagpro.viewport.followPlayer)tagpro.playSound(t.s,t.v);else switch(t.s){case"cheering":case"sigh":tagpro.playSound("cheering",1);break;case"drop":case"friendlydrop":tagpro.playSound("friendlydrop",1);break;case"alert":case"friendlyalert":tagpro.playSound("friendlyalert",.5)}}),t.on("stopSound",function(t){tagpro.stopSound(t)}),t.on("score",function(t){tagpro.score=t});var h=!1,p="";t.on("full",function(){h=!0,location.href="http://"+tagproConfig.serverHost+"/games/find?r="+(new Date).getTime()}),t.on("private",function(t){h=!0,t&&t.groupId?location.href="http://"+tagproConfig.serverHost+"/groups/"+t.groupId:location.href="http://"+tagproConfig.serverHost+"/?err=private"}),t.on("banned",function(){h=!0,location.href="http://"+tagproConfig.serverHost+"/banned"}),t.on("vpn",function(){h=!0,location.href="http://"+tagproConfig.serverHost+"/vpn"}),t.on("duplicate",function(){h=!0,location.href="http://"+tagproConfig.serverHost+"/?err=duplicate"}),t.on("joinWorld",function(t){h=!0,location.href="http://"+location.hostname+":"+t+"/?alert=true"}),t.on("disconnectReason",function(t){p=t}),t.on("disconnect",function(t){p=p||t,tagpro.group.socket&&tagpro.group.socket.redirecting||2==s||h||(location.href=d?"http://"+tagproConfig.serverHost+"/groups/"+d:"http://"+tagproConfig.serverHost+"/?err="+p)}),t.on("end",function(t){if(s=2,tagpro.state=2,t.winner,tagpro.winner=t.winner,tagpro.showOptions(),g&&!tagpro.spectator){var e=$("#mapRatingContainer"),i=$("#mapRating");e.show(),i.val()&&v%10!=0||(i.addClass("shake").addClass("shake-slow").addClass("shake-constant"),setTimeout(function(){i.removeClass("shake").removeClass("shake-slow").removeClass("shake-constant")},1500))}$("div.news").fadeIn(),setTimeout(function(){t.groupId?location.href="http://"+tagproConfig.serverHost+"/groups/"+t.groupId:location.href="http://"+tagproConfig.serverHost+"/games/find?r="+(new Date).getTime()},25e3),tagpro.sendPingStatistics()});var d=null;t.on("groupId",function(t){t&&(d=t,$("#exit").attr("href","http://"+tagproConfig.serverHost+"/groups/"+d))});var f=1;function m(i,n){var r;r=n?"keyup":"keydown";var s=e[o];if(s&&(!s.pressing[i]&&"keydown"==r||s.pressing[i]&&"keyup"==r)){var l=f++;s.pressing[i]=!n,t.emit(r,{k:i,t:l}),tagpro.ping.avg&&setTimeout(function(){a(s,i,l)},tagpro.ping.avg/2)}}$(document).keydown(function(e){if(!tagpro.disableControls){if(-1!=tagpro.keys.resetZoom.indexOf(e.keyCode)&&(tagpro.zoom=1),tagpro.spectator)return function(e){-1!=tagpro.keys.specNext.indexOf(e.keyCode)&&(t.emit("next"),tagpro.viewport.centerLock=!1);-1!=tagpro.keys.specPrev.indexOf(e.keyCode)&&(t.emit("prev"),tagpro.viewport.centerLock=!1);-1!=tagpro.keys.specRedFC.indexOf(e.keyCode)&&(t.emit("redflagcarrier"),tagpro.viewport.centerLock=!1);-1!=tagpro.keys.specBlueFC.indexOf(e.keyCode)&&(t.emit("blueflagcarrier"),tagpro.viewport.centerLock=!1);-1!=tagpro.keys.zoomOut.indexOf(e.keyCode)&&(tagpro.zooming=.025);-1!=tagpro.keys.zoomIn.indexOf(e.keyCode)&&(tagpro.zooming=-.025);-1!=tagpro.keys.centerZoom.indexOf(e.keyCode)&&(tagpro.viewport.followPlayer=!tagpro.viewport.followPlayer,tagpro.viewport.centerLock=!tagpro.viewport.followPlayer);-1!=tagpro.keys.toggleAutoJoin.indexOf(e.keyCode)&&t.emit("join")}(e);var i=null;tagpro.keys.left.indexOf(e.keyCode)>-1&&(i="left"),tagpro.keys.up.indexOf(e.keyCode)>-1&&(i="up"),tagpro.keys.right.indexOf(e.keyCode)>-1&&(i="right"),tagpro.keys.down.indexOf(e.keyCode)>-1&&(i="down"),tagpro.keys.space.indexOf(e.keyCode)>-1&&(i="space"),i&&(e.preventDefault(),m(i),tagpro.events.keyDown&&tagpro.events.keyDown.forEach(function(t){t.keyDown(i)}))}}),$(document).keyup(function(i){var n=null;if(-1!=tagpro.keys.zoomOut.indexOf(i.keyCode)&&(tagpro.zooming=0),-1!=tagpro.keys.zoomIn.indexOf(i.keyCode)&&(tagpro.zooming=0),!tagpro.disableControls&&!tagpro.spectator&&(tagpro.keys.left.indexOf(i.keyCode)>-1&&(n="left"),tagpro.keys.up.indexOf(i.keyCode)>-1&&(n="up"),tagpro.keys.right.indexOf(i.keyCode)>-1&&(n="right"),tagpro.keys.down.indexOf(i.keyCode)>-1&&(n="down"),tagpro.keys.space.indexOf(i.keyCode)>-1&&(n="space"),n)){i.preventDefault();var r=e[o];if(r&&r.pressing[n]){var s=f++;r.pressing[n]=!1,t.emit("keyup",{k:n,t:s}),tagpro.ping.avg&&setTimeout(function(){a(r,n,-s)},tagpro.ping.avg/2)}}}),zoomValues=[1,20/15,20/12,2,2.5,20/6,4],zoomCursor=0;var y=!1;tagpro.showOptions=function(){if(!y){y=!0;var t=$("div#options");t.find("#name").val(tagpro.players[tagpro.playerId].name);var i=function(){var n=t.find("tbody.stats"),r=n.find("tr.template"),o=[];for(var s in n.find("tr").not(".template").remove(),e)o.push(e[s]);o.sort(function(t,e){return e.score-t.score}),tagpro.events.sortPlayers&&tagpro.events.sortPlayers.forEach(function(t){t.sortPlayers(o)}),o.forEach(function(t){var e=r.clone().data("model",t).removeClass("template").appendTo(n).find("td");e.eq(0).find(".scoreName").text(t.name).addClass(1==t.team?"team-red":"team-blue").end().find(".scoreAuth").html(t.auth?"&#x2713;":"").end(),e.eq(1).text(t.score),e.eq(2).text(t["s-tags"]),e.eq(3).text(t["s-pops"]),e.eq(4).text(t["s-grabs"]),e.eq(5).text(t["s-drops"]),e.eq(6).text(tagpro.helpers.timeFromSeconds(t["s-hold"],!0)),e.eq(7).text(t["s-captures"]),e.eq(8).text(tagpro.helpers.timeFromSeconds(t["s-prevent"],!0)),e.eq(9).text(t["s-returns"]),e.eq(10).text(t["s-support"]),e.eq(11).text(t["s-powerups"]),e.eq(12).text(0==t.points?"-":t.points),e.find("a.kick").attr("href",t.id)}),tagpro.musicPlayer.current?$("div#musicInfo").removeClass("hide").text("Music: "+(tagpro.musicPlayer.current.name||"Untitled")+" by "+(tagpro.musicPlayer.current.author||"Unknown")):$("div#musicInfo").addClass("hide"),y&&setTimeout(i,1e3),tagpro.events.modifyScoreUI&&tagpro.events.modifyScoreUI.forEach(function(t){t.modifyScoreUI($("#options > table:first"))})};y&&i(),t.show()}};var _=$("div#kick");$("#switchButton").click(function(e){e.preventDefault(),t.emit("switch")}),$("#tutorialButton").click(function(e){e.preventDefault();var i="Enable Tips"===$(this).text();$.cookie("disableTutorialChat",!i,{expires:36500,path:"/",domain:tagproConfig.cookieHost}),t.emit("tips",i),tagpro.settings.ui.tutorialChat=i}),$(window).keydown(function(t){27==t.which&&t.preventDefault()}),$(document).keyup(function(t){if(t.preventDefault(),tagpro.keys.showOptions.indexOf(t.keyCode)>-1){if(!y)return void tagpro.showOptions();y=!1,$("div#options").hide(),$("#name").blur()}});var x=function(){t.emit("name",$(this).val()),tagpro.group.socket&&tagpro.group.socket.emit("name",$(this).val())};$("#name").keyup(x).change(x).focus(function(){tagpro.disableControls=!0}).blur(function(){tagpro.disableControls=!1}),$("select#mapRating").change(function(){var e=parseInt($(this).val());e>1||e<-1||t.emit("mapRating",e)});var g=!1,v=0;t.on("mapRating",function(t){$("select#mapRating").val(t.rating),g=!0,v=t.plays}),$("select#preferredServer").change(function(){t.emit("preferredServer",$(this).val())}),t.on("preferredServer",function(t){$("select#preferredServer").val(t)});var b=$("div#sendToPreferred"),w=null;t.on("sendPreferred",function(t){b.find("span#preferredServer").text(t.name).end().css({left:$(document.body).width()/2-_.width()/2,top:$(document.body).height()/2-_.height()/2}).show();var e=8,i=$("span#countdown"),n=function(){e--,i.text(e),e>0?w=setTimeout(n,1e3):document.location=t.url+"games/find/?preferred=true"};n()}),$("a#sendToPreferredCancel").click(function(e){e.preventDefault(),b.hide(),clearTimeout(w),$("select#preferredServer").val(""),t.emit("preferredServer","")});var C=[],S=0,T=0,D=0;setInterval(function(){var e=(new Date).getTime(),i={sent:e,id:S++,time:null,lost:!1};C.push(i),t.emit("p",{id:i.id,c:tagpro.ping.avg}),T++,C.length>5&&C.shift();var n=0,r=0;C.forEach(function(t){if(!t.lost)return t.time>=1e3||null==t.time&&e-t.sent>=1e3?(t.lost=!0,void D++):void(null!=t.time&&(n++,r+=t.time))}),tagpro.ping.avg=Math.round(r/n)||0,tagpro.ping.current=tagpro.ping.avg,tagpro.ping.loss=D/T},2e3),t.on("pr",function(t){var e=(new Date).getTime(),i=C.filter(function(e){return e.id==t&&!e.lost});i&&i.length&&((i=i[0]).time=e-i.sent)}),window.addEventListener("beforeunload",function(){h=!0})}),tagpro.ready(function(){var t,e={width:0,height:0},i={x:0,y:0},n=!1,r=!1;function o(t,e,i,n){return tagpro.ui.sprites[i]=tagpro.tiles.draw(t,e,n,30,30),tagpro.ui.flags.push(tagpro.ui.sprites[i]),tagpro.ui.sprites[i]}function s(t,e){var i=new PIXI.Container,n=20,r=2,o=.5;for(var s,a,l,c=1;c<=e;)s=c++,a=void 0,void 0,a=0,l=s%2==0?n+r:0,a+=Math.floor((s-1)/2)*(n+r),tagpro.tiles.draw(i,t,{x:a,y:l},n,n,o);return i}setTimeout(function(){$("#loadingMessage").fadeOut(100),$("#viewportDiv").fadeIn(250),$("#viewport").fadeIn(250,function(){tagpro.chat.resize()})},0),tagpro.ui={redFlagTaken:!1,blueFlagTaken:!1,yellowFlagTakenByRed:!1,yellowFlagTakenByBlue:!1,enabled:!0,sprites:{},redPotatoTaken:!1,bluePotatoTaken:!1,yellowPotatoTakenByRed:!1,yellowPotatoTakenByBlue:!1,flags:[]},tagpro.ui.resize=function(t,n){e.width=t,e.height=n,i.x=t/2,i.y=n/2,tagpro.ui.alignUI()},tagpro.ui.scoreXOffset=0,tagpro.ui.alignUI=function(){if(tagpro.ui.sprites){var t=tagpro.ui.sprites;if([!!t.redScore,!!t.blueScore,!!tagpro.ui.sprites.timer,!!t.performanceInfo,tagpro.ui.flags.length>0,!!t.xhr].every(function(t){return!!t})){var e=2*i.y;tagpro.ui.sprites.redScore.x=i.x-80-tagpro.ui.scoreXOffset,tagpro.ui.sprites.redScore.y=e-80,tagpro.ui.sprites.blueScore.x=i.x+80+tagpro.ui.scoreXOffset,tagpro.ui.sprites.blueScore.y=e-80,tagpro.ui.sprites.timer.x=i.x,tagpro.ui.sprites.timer.y=e-50,tagpro.ui.sprites.performanceInfo.x=10,tagpro.ui.sprites.performanceInfo.y=10,tagpro.ui.sprites.xhr.x=i.x-tagpro.ui.sprites.xhr.width/2,tagpro.ui.sprites.xhr.y=10;for(var n=0;n<tagpro.ui.flags.length;n++){var r=tagpro.ui.flags[n];r.x=i.x+r.xOffset,r.y=e+r.yOffset}}else setTimeout(tagpro.ui.alignUI,1e3)}else setTimeout(tagpro.ui.alignUI,1e3)},tagpro.ui.scores=function(){var t="",e="",i="always"==tagpro.settings.ui.teamNames||"spectating"==tagpro.settings.ui.teamNames&&1==tagpro.spectator;i&&"Red"!==tagpro.teamNames.redTeamName&&(t=tagpro.teamNames.redTeamName+" - "),i&&"Blue"!==tagpro.teamNames.blueTeamName&&(e=" - "+tagpro.teamNames.blueTeamName);var n=t+(tagpro.score.r?tagpro.score.r.toString():"0"),r=(tagpro.score.b?tagpro.score.b.toString():"0")+e;tagpro.ui.sprites.redScore?(tagpro.ui.sprites.redScore.text=n,tagpro.ui.sprites.blueScore.text=r):(tagpro.ui.sprites.redScore=new PIXI.Text(n,{fill:"#FF0000",fontFamily:"Arial",fontSize:"40pt",fontWeight:"bold"}),tagpro.ui.sprites.blueScore=new PIXI.Text(r,{fill:"#0000FF",fontFamily:"Arial",fontSize:"40pt",fontWeight:"bold"}),tagpro.ui.sprites.redScore.alpha=.5,tagpro.ui.sprites.blueScore.alpha=.5,tagpro.ui.sprites.redScore.anchor.x=1,tagpro.ui.sprites.blueScore.anchor.x=0,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.redScore),tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.blueScore))},tagpro.ui.updateFlags=function(t,e,i){tagpro.ui.sprites.redFlag||function(t,e,i){function n(t,n,r,o){return{tile:t,name:n,drawPos:{x:e.x+r,y:o|i.height-40},xOffset:r,yOffset:-40|o}}for(var r=[n("redflag","redFlag",110),n("blueflag","blueFlag",-110),n("yellowflag","yellowFlagTakenByRed",-80),n("yellowflag","yellowFlagTakenByBlue",80),n("redpotato","redPotatoTaken",110),n("bluepotato","bluePotatoTaken",-110),n("yellowpotato","yellowPotatoTakenByRed",-80),n("yellowpotato","yellowPotatoTakenByBlue",80)],s=0;s<r.length;s++){var a=r[s],l=o(t,a.tile,a.name,a.drawPos);l.xOffset=a.xOffset,l.yOffset=a.yOffset,l.anchor.x=.5}}(t,e,i);for(var n=[["redFlag","redFlagTaken"],["blueFlag","blueFlagTaken"],["yellowFlagTakenByRed",null],["yellowFlagTakenByBlue",null],["redPotatoTaken",null],["bluePotatoTaken",null],["yellowPotatoTakenByRed",null],["yellowPotatoTakenByBlue",null]],r=0;r<n.length;r++){var s,a=n[r],l=tagpro.ui.sprites[a[0]];s=a[1]?!!tagpro.ui[a[1]]:!!tagpro.ui[a[0]],l.visible=s}t.globalAlpha=1},tagpro.ui.timer=function(t,e,i,n){var r=tagpro.ui.sprites.timer;r||((r=tagpro.ui.sprites.timer=new PIXI.Text("",{fill:"#FFFFFF",strokeThickness:4,stroke:"#000000",fontFamily:"Arial",fontSize:"30pt",fontWeight:"bold"})).alpha=.5,r.anchor.x=.5,t.addChild(tagpro.ui.sprites.timer)),r.text=n,r.visible=!!tagpro.settings.ui.matchState};var a=-1,l=-1,c=-1,u=-1;tagpro.ui.updatePlayerIndicators=function(){tagpro.ui.sprites.playerIndicators||(tagpro.ui.sprites.playerIndicators=new PIXI.Container);var t=0,e=0;for(var i in tagpro.players)tagpro.players.hasOwnProperty(i)&&(1==tagpro.players[i].team?t++:e++);var n=$("#viewport"),r=n.width(),o=n.height();if(t!=a||e!=l||r!=c||o!=u){a=t,l=e,c=r,u=o;var h=s("redball",t);h.x=r/2-120-h.width,h.y=o-70;var p=s("blueball",e);p.x=r/2+120,p.y=o-70,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.playerIndicators),tagpro.ui.sprites.playerIndicators.removeChildren(),tagpro.ui.sprites.playerIndicators.addChild(h),tagpro.ui.sprites.playerIndicators.addChild(p)}},tagpro.ui.spectatorInfo=function(t,e){var i=tagpro.ui.sprites.spectatorInfo1,n=tagpro.ui.sprites.spectatorInfo2;tagpro.spectator?(i||(i=tagpro.ui.sprites.spectatorInfo1=tagpro.renderer.prettyText("You are spectating"),t.addChild(i),i.y=10,i.anchor.x=.5,i.alpha=.6),i.x=e.x,n&&tagpro.spectator==tagpro.ui.lastSpectatorValue||(n&&t.removeChild(n),n=tagpro.ui.sprites.spectatorInfo2=tagpro.renderer.prettyText("auto-join is "+("waiting"==tagpro.spectator?"on":"off")),t.addChild(n),n.y=25,n.anchor.x=.5,n.alpha=.6,tagpro.ui.lastSpectatorValue=tagpro.spectator),n.x=e.x):(i&&t.removeChild(i),n&&t.removeChild(n))},tagpro.ui.performanceInfo=function(t,e,i,n){var r,o;tagpro.ui.sprites.performanceInfo||(tagpro.ui.xhrStartTime=performance.now(),tagpro.ui.sprites.performanceInfo=tagpro.renderer.prettyText(""),tagpro.ui.sprites.xhr=tagpro.renderer.prettyText(""),tagpro.ui.sprites.xhr.tint=16711680,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.performanceInfo),tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.xhr)),r=tagpro.ui.sprites.performanceInfo,o=tagpro.ui.sprites.xhr;var s=!!tagpro.settings.ui.performanceInfo;if(r.visible=s,o.visible=performance.now()-tagpro.ui.xhrStartTime>1e3&&!!tagpro.rawSocket.io.engine.transport.polling,s){var a="FPS: "+Math.round(tagpro.fps)+", Ping: "+tagpro.ping.avg+(n?", Loss: "+n+"%":"");tagpro.rawSocket.io.engine.transport.polling&&(o.text="XHR Mode, this will be laggy! Check your firewall!"),r.text=a}},tagpro.ui.largeAlert=function(t,e,i,n,r){var o=tagpro.renderer.largeText(n,r);return o.x=Math.round(e.x-o.width/2),o.y=100,t.addChild(o),o};var h="";function p(){tagpro.renderer.layers.ui.debug||function(){tagpro.renderer.layers.ui.debug={};var t=tagpro.renderer.renderer.type==PIXI.WEBGL_RENDERER?"WebGL":"Canvas",e=tagpro.renderer.prettyText("Engine Type: "+t);e.x=10,e.y=100,tagpro.renderer.layers.ui.debug.engineType=e,tagpro.renderer.layers.ui.addChild(e);var i=tagpro.renderer.prettyText("");i.x=10,i.y=120,tagpro.renderer.layers.ui.debug.childCount=i,tagpro.renderer.layers.ui.addChild(i);var n=tagpro.renderer.prettyText("Particles: "+!tagpro.renderer.options.disableParticles);n.x=10,n.y=140,tagpro.renderer.layers.ui.debug.particles=n,tagpro.renderer.layers.ui.addChild(n);var r=tagpro.renderer.prettyText("Scaling: "+!tagpro.renderer.options.disableViewportScaling);r.x=10,r.y=160,tagpro.renderer.layers.ui.debug.viewport=r,tagpro.renderer.layers.ui.addChild(r);var o=tagpro.renderer.prettyText("");o.x=10,o.y=180,tagpro.renderer.layers.ui.debug.position=o,tagpro.renderer.layers.ui.addChild(o);var s=tagpro.renderer.prettyText("");s.x=10,s.y=200,tagpro.renderer.layers.ui.debug.realPosition=s,tagpro.renderer.layers.ui.addChild(s)}();var t="Sprite Count: "+function(){var t=0;return function e(i){if(i.visible){t+=1;for(var n=0;n<i.children.length;n++){var r=i.children[n];e(r)}}}(tagpro.renderer.stage),t}();tagpro.renderer.layers.ui.debug.childCount.text=t;var e=tagpro.playerId;if(e){var i=tagpro.players[e],n="X: "+i.x+", Y: "+i.y;tagpro.renderer.layers.ui.debug.position.text=n;var r="RX: "+i.rx+", RY: "+i.ry;tagpro.renderer.layers.ui.debug.realPosition.text=r}}setInterval(function(){if(tagpro.gameEndsAt){var n=tagpro.gameEndsAt-(new Date).getTime();3==tagpro.state&&(n+=1e3);var r="00"+Math.floor(n/6e4),o="00"+Math.floor(n%6e4/1e3),s=r.substr(r.length-2,2)+":"+o.substr(o.length-2,2);2==tagpro.state&&(s=h),t&&tagpro.ui.timer(t,i,e,s),"00:03"==s&&s!=h&&2!=tagpro.state&&tagpro.playSound("countdown",1),h=s}},100),tagpro.ui.update=function(){if(tagpro.ui.enabled&&(t||(t=tagpro.renderer.layers.ui),tagpro.settings.ui.spectatorInfo&&tagpro.ui.spectatorInfo(t,i),tagpro.renderer.debug&&p(),tagpro.settings.ui.matchState)){tagpro.ui.scores(t,i,e),tagpro.ui.updateFlags(tagpro.renderer.layers.ui,i,e),tagpro.ui.updatePlayerIndicators();var o=Math.floor(100*(tagpro.ping.loss||0));if(tagpro.ui.performanceInfo(t,i,e,o),tagpro.ui.alignUI(),2==tagpro.state)n||("red"==tagpro.winner?(tagpro.ui.largeAlert(t,i,e,(tagpro.teamNames.redTeamName||"Blue")+" Wins!","#ff0000"),n=!0):"blue"==tagpro.winner?(tagpro.ui.largeAlert(t,i,e,(tagpro.teamNames.blueTeamName||"Red")+" Wins!","#0000ff"),n=!0):"tie"==tagpro.winner?(tagpro.ui.largeAlert(t,i,e,"It's a tie!"),n=!0):(tagpro.ui.largeAlert(t,i,e,tagpro.winner),n=!0));else if(3==tagpro.state&&!r){var s=tagpro.ui.largeAlert(t,i,e,"Match Begins Soon..."),a=function(){3!=tagpro.state?(t.removeChild(s),s.visible=!1):setTimeout(a,20)};setTimeout(a,20),r=!0}}}}),tagpro.ready(function(){var t=$("div#kick");tagpro.kick={player:function(e){t.attr("data-id",e.id).find("#kickPlayer").text(" "+e.name).end().find("#kickSelect").prop("selectedIndex",0).end().css({left:($(window).width()-t.width())/2,top:($(window).height()-t.height())/2}).show()},clickBall:function(t){var e=t.pageX-$canvas.offset().left,i=t.pageY-$canvas.offset().top,n=null,r=-1;for(var o in tagpro.players){var s=tagpro.players[o],a=tagpro.helpers.toLockedPos({x:s.x,y:s.y}),l=a.x+20,c=a.y+20,u=Math.pow(l-e,2)+Math.pow(c-i,2);(null===n||u<r)&&(n=s,r=u)}n&&r<Math.pow(40,2)&&tagpro.kick.player(n)}},$("tbody.stats").on("click","a.kick",function(t){t.preventDefault();var e=tagpro.players[parseInt($(this).attr("href"))];tagpro.kick.player(e)}),$("#kickSelect").change(function(e){tagpro.socket.emit("kick",{playerId:parseInt(t.attr("data-id")),reason:parseInt($(this).val())})}),$("#muteButton").click(function(e){e.preventDefault(),t.hide(),tagpro.socket.emit("mute",{playerId:parseInt(t.attr("data-id"))})}),$("#kickCancelButton").click(function(e){e.preventDefault(),t.hide()})}),tagpro.ready(function(){var t=!1,e=!1,i=!1,n=!1,r=$("div#chatHistory"),o=$("input#chat"),s=$("canvas"),a=s.offset(),l=s.get(0).height,c=tagpro.socket,u="",h="";$(document).keydown(function(r){var s,a,l,u=-1!=tagpro.keys.chatToTeam.indexOf(r.keyCode),h=-1!=tagpro.keys.chatToGroup.indexOf(r.keyCode)&&tagpro.group.socket,p=-1!=tagpro.keys.chatToAll.indexOf(r.keyCode),d=tagpro.keys.chatAsMod&&-1!=tagpro.keys.chatAsMod.indexOf(r.keyCode);if((u||h||p||d)&&!t){if($("#name").is(":focus"))return;s=u,a=h,l=d,t=!0,tagpro.disableControls=!0,e=s,i=a,n=l,o.val("").show().focus(),r.preventDefault()}else-1!=tagpro.keys.sendChat.indexOf(r.keyCode)&&t&&function(){var t=o.val();if(m(),t.length>70||""==t)return void f();i?tagpro.group.socket&&tagpro.group.socket.emit("chat",t):c.emit("chat",{toAll:!e,asMod:n,message:t});f()}()});var p=$("<div><span class='auth'>&#10004</span><span class='name'></span><span class='message'></span></div>");function d(t){var e=tagpro.settings.ui||{allChat:!0,teamChat:!0,groupChat:!0,systemChat:!0};if(!t.mod){if(!e.allChat&&"all"==t.to&&t.from)return;if(!e.teamChat&&"team"==t.to)return;if(!e.groupChat&&"group"==t.to)return;if(!e.systemChat&&"all"==t.to&&!t.from)return}var i=null,n=null,o=p.clone();"number"==typeof t.from?(i=tagpro.players[t.from],o.data("player",i)):"string"==typeof t.from&&(i={name:t.from,auth:!1}),i&&i.auth||o.children(".auth").remove(),i?(i.team?n=1==i.team?"#FFB5BD":"#CFCFFF":"group"==t.to?n="#E7E700":"ADMIN_GLOBAL_BROADCAST"==t.from?(n="#FF0000",i.name="ANNOUNCEMENT"):t.mod&&(n="#00B900"),o.children(".name").css({color:n}).text(i.name)):o.children(".name").remove();var s=n;"all"==t.to&&(s=t.c||null),"group"!=t.to||t.from||(s="#E7E700"),o.children(".message").css({color:s}).text(t.message).end(),r.append(o).scrollTop(r.get(0).scrollHeight),setTimeout(function(){o.remove()},2e4)}function f(){t=!1,tagpro.disableControls=!1,o.hide()}function m(){u="",h=""}c.on("chat",d),tagpro.group.socket&&tagpro.group.socket.on("chat",d),o.keydown(function(t){if([37,38,39,40].indexOf(t.keyCode)>=0&&t.preventDefault(),tagpro.keys.nickCompleteChat.indexOf(t.keyCode)>-1)return t.preventDefault(),function(){var t=o.val(),e=Object.keys(tagpro.players).map(function(t){return tagpro.players[t].name}).sort(function(t,e){return t>e});if(u.length){var i=t.lastIndexOf(u);i+u.length===t.length&&(t=t.substr(0,i),t+=h);var n=e.indexOf(u.trim());n>-1&&(e=n+1===e.length?e:e.slice(n+1))}var r=t.split(" "),s=r[r.length-1];if(r.length){var a=s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),l=new RegExp("^"+a+".*","i"),c=s;e.some(function(t){return!!l.test(t)&&(c=t+" ",!0)}),u=c,h=s,r[r.length-1]=c,o.val(r.join(" "))}}();tagpro.keys.cancelChat.indexOf(t.keyCode)>-1&&f(),m()}),tagpro.chat.resize=function(){a=s.offset(),l=s.get(0).height,o.css({left:a.left+10,top:a.top+l-40}),r.css({left:a.left+10,top:a.top+l-r.outerHeight()-50})},r.on("click","div",function(){var t=$(this).data("player");t&&tagpro.kick.player(t)})});var overrideableAssets={speedpad:"img#speedpad",speedpadRed:"img#speedpadred",speedpadBlue:"img#speedpadblue",portal:"img#portal",tiles:"img#tiles",splats:"img#splats",gravityWell:"img#gravityWell"};tagpro.loadAssets=function(t){var e=function(t){$(document).ready(function(){$("#assets").append(t)})};for(var i in t){var n=t[i],r=generateId(),o=new Image;o.crossOrigin=!0,o.src=n,o.id=r,o.className="asset",overrideableAssets[i]="img#"+r,e(o)}tagpro.loadAssets=function(){console.log("tagpro.loadAssets has already been called. Ignoring second invocation.")}},tagpro.ready(function(){const t=$.cookie("tileRespawnWarnings")||"blink";var e={};function i(t,i,n,r,o){e[i]||(e[i]=new PIXI.BaseTexture(t));var s=e[i];return function(t,e,i,n,r){var o=[],s=(new PIXI.Rectangle(0,0,e.width,e.height),function(t){var i=new PIXI.Rectangle(n*t,0,n,n);o.push(new PIXI.Texture(e,i))});if(i)s(t-1);else if(r)s(0),s(t-1);else for(var a=0;a<t-1;a++)s(a);return o}(s.width/r,s,n,r,o)}function n(t,e,n,r,o){n=n||40;var s=function(t){var e=new PIXI.extras.AnimatedSprite(t);return e.playing=!0,e}(i($(t).get(0),t,e,n,r));return r&&(s.blink=!0),o&&(s.alpha=o),s}function r(e,i){return"blink"===t?n(e,!1,null,!0,.5):"alpha"===t?n(e,!1,null,!1,.35):i}function o(e,i,n,r,o){return"blink"===t?{x:e,y:i,drawFloor:!0,redrawFloor:!0,dynamic:!0,alpha:.5,blink:!0,frameTiles:n}:"alpha"===t?{x:e,y:i,drawFloor:!0,redrawFloor:!0,dynamic:!0,alpha:.35,blink:!1}:{x:r,y:o,drawFloor:!0,redrawFloor:!0,dynamic:!0}}var s=n(overrideableAssets.speedpad),a=n(overrideableAssets.speedpad,!0),l=r(overrideableAssets.speedpad,a),c=n(overrideableAssets.speedpadRed),u=n(overrideableAssets.speedpadRed,!0),h=r(overrideableAssets.speedpadRed,u),p=n(overrideableAssets.speedpadBlue),d=n(overrideableAssets.speedpadBlue,!0),f=r(overrideableAssets.speedpadBlue,d),m=n(overrideableAssets.portal),y=n(overrideableAssets.portal,!0),_=r(overrideableAssets.portal,y);tagpro.tiles={1:{},1.1:{drawFloor:[{x:1,y:0},{x:0,y:-1}]},1.2:{drawFloor:[{x:1,y:0},{x:0,y:1}]},1.3:{drawFloor:[{x:-1,y:0},{x:0,y:1}]},1.4:{drawFloor:[{x:-1,y:0},{x:0,y:-1}]},2:{x:13,y:4},16:{x:13,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},yellowflag:{x:13,y:1,isFlag:!0,dynamic:!0},16.1:{x:13,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},3:{x:14,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},redflag:{x:14,y:1,isFlag:!0,dynamic:!0},3.1:{x:14,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},4:{x:15,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},blueflag:{x:15,y:1,isFlag:!0,dynamic:!0},4.1:{x:15,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},5:s,5.1:a,5.11:l,14:c,14.1:u,14.11:h,15:p,15.1:d,15.11:f,6:{x:12,y:8,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.1:{x:12,y:4,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.11:o(12,4,[6.1,6],12,8),grip:{x:12,y:4,dynamic:!0},6.2:{x:12,y:5,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.21:o(12,5,[6.2,6],12,8),bomb:{x:12,y:5,dynamic:!0},6.3:{x:12,y:6,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.31:o(12,6,[6.3,6],12,8),tagpro:{x:12,y:6,dynamic:!0},6.4:{x:12,y:7,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.41:o(12,7,[6.4,6],12,8),speed:{x:12,y:7,dynamic:!0},17:{x:14,y:5,dynamic:!0},18:{x:15,y:5,dynamic:!0},7:{x:12,y:0,drawFloor:!0,redrawFloor:!1,dynamic:!0},21:{x:14,y:6,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},yellowpotato:{x:14,y:6,isFlag:!0,dynamic:!0},21.1:{x:15,y:6,drawFloor:!0,redrawFloor:!0,dynamic:!0},19:{x:14,y:7,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},redpotato:{x:14,y:7,isFlag:!0,dynamic:!0},19.1:{x:15,y:7,drawFloor:!0,redrawFloor:!0,dynamic:!0},20:{x:14,y:8,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},bluepotato:{x:14,y:8,isFlag:!0,dynamic:!0},20.1:{x:15,y:8,drawFloor:!0,redrawFloor:!0,dynamic:!0},22:{x:0,y:0,drawFloor:!0,source:"gravityWell"},redball:{x:14,y:0},blueball:{x:15,y:0},8:{x:13,y:6,drawFloor:!0,redrawFloor:!1,dynamic:!0},9:{x:12,y:3,dynamic:!0},9.1:{x:13,y:3,dynamic:!0},9.2:{x:14,y:3,dynamic:!0},9.3:{x:15,y:3,dynamic:!0},10:{x:12,y:1,drawFloor:!0,redrawFloor:!0,dynamic:!0},10.1:{x:12,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},10.11:o(12,1,[10,10.1],12,2),11:{x:14,y:4},12:{x:15,y:4},23:{x:13,y:5},marsball:{x:12,y:9,size:80,keep:!0},13:m,13.1:y,13.11:_,"1.310":{x:10.5,y:7.5,size:20},"1.410":{x:11,y:7.5,size:20},"1.110":{x:11,y:8,size:20},"1.210":{x:10.5,y:8,size:20},"1.310d":{x:.5,y:3.5,size:20},"1.410d":{x:1,y:3.5,size:20},"1.210d":{x:.5,y:4,size:20},1.321:{x:4.5,y:9.5,size:20},1.421:{x:5,y:9.5,size:20},1.121:{x:5,y:10,size:20},1.221:{x:4.5,y:10,size:20},"1.321d":{x:1.5,y:2.5,size:20},"1.421d":{x:2,y:2.5,size:20},"1.221d":{x:1.5,y:3,size:20},1.332:{x:6.5,y:9.5,size:20},1.432:{x:7,y:9.5,size:20},1.132:{x:7,y:10,size:20},1.232:{x:6.5,y:10,size:20},"1.332d":{x:9.5,y:2.5,size:20},"1.432d":{x:10,y:2.5,size:20},"1.132d":{x:10,y:3,size:20},1.343:{x:.5,y:7.5,size:20},1.443:{x:1,y:7.5,size:20},1.143:{x:1,y:8,size:20},1.243:{x:.5,y:8,size:20},"1.343d":{x:10.5,y:3.5,size:20},"1.443d":{x:11,y:3.5,size:20},"1.143d":{x:11,y:4,size:20},1.354:{x:1.5,y:6.5,size:20},1.454:{x:2,y:6.5,size:20},1.154:{x:2,y:7,size:20},1.254:{x:1.5,y:7,size:20},"1.454d":{x:9,y:1.5,size:20},"1.154d":{x:9,y:2,size:20},"1.254d":{x:8.5,y:2,size:20},1.365:{x:6.5,y:8.5,size:20},1.465:{x:7,y:8.5,size:20},1.165:{x:7,y:9,size:20},1.265:{x:6.5,y:9,size:20},"1.465d":{x:11,y:1.5,size:20},"1.165d":{x:11,y:2,size:20},"1.265d":{x:10.5,y:2,size:20},1.376:{x:4.5,y:8.5,size:20},1.476:{x:5,y:8.5,size:20},1.176:{x:5,y:9,size:20},1.276:{x:4.5,y:9,size:20},"1.376d":{x:.5,y:1.5,size:20},"1.176d":{x:1,y:2,size:20},"1.276d":{x:.5,y:2,size:20},1.307:{x:9.5,y:6.5,size:20},1.407:{x:10,y:6.5,size:20},1.107:{x:10,y:7,size:20},1.207:{x:9.5,y:7,size:20},"1.307d":{x:2.5,y:1.5,size:20},"1.107d":{x:3,y:2,size:20},"1.207d":{x:2.5,y:2,size:20},"1.320":{x:1.5,y:7.5,size:20},"1.420":{x:2,y:7.5,size:20},"1.220":{x:1.5,y:8,size:20},"1.320d":{x:10.5,y:.5,size:20},"1.420d":{x:11,y:.5,size:20},"1.220d":{x:10.5,y:1,size:20},1.331:{x:5.5,y:6.5,size:20},1.431:{x:6,y:6.5,size:20},1.131:{x:6,y:7,size:20},1.231:{x:5.5,y:7,size:20},"1.331d":{x:5.5,y:.5,size:20},"1.431d":{x:6,y:.5,size:20},1.342:{x:9.5,y:7.5,size:20},1.442:{x:10,y:7.5,size:20},1.142:{x:10,y:8,size:20},"1.342d":{x:.5,y:.5,size:20},"1.442d":{x:1,y:.5,size:20},"1.142d":{x:1,y:1,size:20},1.353:{x:4.5,y:5.5,size:20},1.453:{x:5,y:5.5,size:20},1.153:{x:5,y:6,size:20},1.253:{x:4.5,y:6,size:20},"1.453d":{x:7,y:1.5,size:20},"1.153d":{x:7,y:2,size:20},1.464:{x:4,y:9.5,size:20},1.164:{x:4,y:10,size:20},1.264:{x:3.5,y:10,size:20},"1.464d":{x:2,y:3.5,size:20},"1.164d":{x:2,y:4,size:20},"1.264d":{x:1.5,y:4,size:20},1.375:{x:5.5,y:2.5,size:20},1.475:{x:6,y:2.5,size:20},1.175:{x:6,y:4,size:20},1.275:{x:5.5,y:4,size:20},"1.175d":{x:6,y:3,size:20},"1.275d":{x:5.5,y:3,size:20},1.306:{x:7.5,y:9.5,size:20},1.106:{x:8,y:10,size:20},1.206:{x:7.5,y:10,size:20},"1.306d":{x:9.5,y:3.5,size:20},"1.106d":{x:10,y:4,size:20},"1.206d":{x:9.5,y:4,size:20},1.317:{x:6.5,y:5.5,size:20},1.417:{x:7,y:5.5,size:20},1.117:{x:7,y:6,size:20},1.217:{x:6.5,y:6,size:20},"1.317d":{x:4.5,y:1.5,size:20},"1.217d":{x:4.5,y:2,size:20},1.327:{x:7.5,y:8.5,size:20},1.427:{x:8,y:8.5,size:20},1.101:{x:4,y:5,size:20},1.227:{x:7.5,y:9,size:20},"1.327d":{x:8.5,y:3.5,size:20},"1.227d":{x:8.5,y:4,size:20},"1.330":{x:8.5,y:7.5,size:20},"1.430":{x:9,y:7.5,size:20},1.112:{x:2,y:0,size:20},"1.230":{x:8.5,y:8,size:20},"1.330d":{x:3.5,y:.5,size:20},"1.430d":{x:4,y:.5,size:20},1.341:{x:2.5,y:7.5,size:20},1.441:{x:3,y:7.5,size:20},1.141:{x:3,y:8,size:20},1.223:{x:9.5,y:0,size:20},"1.341d":{x:7.5,y:.5,size:20},"1.441d":{x:8,y:.5,size:20},1.352:{x:3.5,y:8.5,size:20},1.452:{x:4,y:8.5,size:20},1.152:{x:4,y:9,size:20},1.234:{x:7.5,y:5,size:20},"1.452d":{x:3,y:3.5,size:20},"1.152d":{x:3,y:4,size:20},1.345:{x:7.5,y:6.5,size:20},1.463:{x:10,y:8.5,size:20},1.163:{x:10,y:9,size:20},1.263:{x:9.5,y:9,size:20},"1.463d":{x:2,y:.5,size:20},"1.163d":{x:2,y:1,size:20},1.356:{x:6.5,y:7.5,size:20},1.474:{x:9,y:9.5,size:20},1.174:{x:9,y:10,size:20},1.274:{x:8.5,y:10,size:20},"1.174d":{x:10,y:5,size:20},"1.274d":{x:9.5,y:5,size:20},1.305:{x:2.5,y:9.5,size:20},1.467:{x:5,y:7.5,size:20},1.105:{x:3,y:10,size:20},1.205:{x:2.5,y:10,size:20},"1.105d":{x:2,y:5,size:20},"1.205d":{x:1.5,y:5,size:20},1.316:{x:1.5,y:8.5,size:20},"1.470":{x:4,y:6.5,size:20},1.116:{x:2,y:9,size:20},1.216:{x:1.5,y:9,size:20},"1.316d":{x:9.5,y:.5,size:20},"1.216d":{x:9.5,y:1,size:20},1.337:{x:10.5,y:9.5,size:20},1.437:{x:11,y:9.5,size:20},1.102:{x:0,y:7,size:20},1.237:{x:10.5,y:10,size:20},"1.337d":{x:10.5,y:4.5,size:20},"1.102d":{x:0,y:0,size:20},"1.340":{x:8.5,y:10.5,size:20},"1.440":{x:9,y:10.5,size:20},1.113:{x:6,y:8,size:20},1.213:{x:5.5,y:8,size:20},"1.340d":{x:3.5,y:2.5,size:20},"1.440d":{x:8,y:2.5,size:20},1.351:{x:.5,y:9.5,size:20},1.451:{x:1,y:9.5,size:20},1.151:{x:1,y:10,size:20},1.224:{x:11.5,y:7,size:20},"1.224d":{x:11.5,y:0,size:20},"1.451d":{x:1,y:4.5,size:20},1.335:{x:11.5,y:8.5,size:20},1.462:{x:0,y:5.5,size:20},1.162:{x:0,y:5,size:20},1.235:{x:11.5,y:9,size:20},"1.462d":{x:0,y:4.5,size:20},"1.162d":{x:0,y:6,size:20},1.346:{x:11.5,y:7.5,size:20},1.473:{x:8,y:6.5,size:20},1.173:{x:8,y:7,size:20},1.273:{x:7.5,y:7,size:20},"1.346d":{x:2.5,y:4.5,size:20},"1.173d":{x:9,y:3,size:20},1.357:{x:5.5,y:10.5,size:20},1.457:{x:6,y:10.5,size:20},1.104:{x:6,y:5,size:20},1.204:{x:5.5,y:5,size:20},"1.104d":{x:7,y:5,size:20},"1.204d":{x:4.5,y:5,size:20},1.315:{x:3.5,y:6.5,size:20},"1.460":{x:0,y:7.5,size:20},1.115:{x:4,y:7,size:20},1.215:{x:3.5,y:7,size:20},"1.460d":{x:9,y:4.5,size:20},"1.215d":{x:2.5,y:3,size:20},1.326:{x:11.5,y:5.5,size:20},1.471:{x:0,y:8.5,size:20},1.171:{x:0,y:9,size:20},1.226:{x:11.5,y:5,size:20},"1.326d":{x:11.5,y:4.5,size:20},"1.226d":{x:11.5,y:6,size:20},1.347:{x:9.5,y:10.5,size:20},1.447:{x:10,y:10.5,size:20},1.103:{x:9,y:6,size:20},1.203:{x:8.5,y:6,size:20},"1.347d":{x:3.5,y:1.5,size:20},"1.103d":{x:4,y:1,size:20},"1.350":{x:1.5,y:10.5,size:20},"1.450":{x:2,y:10.5,size:20},1.114:{x:3,y:6,size:20},1.214:{x:2.5,y:6,size:20},"1.214d":{x:7.5,y:1,size:20},"1.450d":{x:8,y:1.5,size:20},1.325:{x:4.5,y:7.5,size:20},1.461:{x:4,y:3.5,size:20},1.161:{x:4,y:4,size:20},1.225:{x:4.5,y:8,size:20},"1.225d":{x:8.5,y:5,size:20},"1.461d":{x:8,y:4.5,size:20},1.336:{x:7.5,y:3.5,size:20},1.472:{x:7,y:7.5,size:20},1.172:{x:7,y:8,size:20},1.236:{x:7.5,y:4,size:20},"1.336d":{x:3.5,y:4.5,size:20},"1.172d":{x:3,y:5,size:20},"1.300":{x:5.5,y:5.5,size:20},"1.400":{x:6,y:5.5,size:20},"1.100":{x:6,y:6,size:20},"1.200":{x:5.5,y:6,size:20},"1.300d":{x:5.5,y:8.5,size:20},"1.400d":{x:6,y:8.5,size:20},"1.100d":{x:6,y:10,size:20},"1.200d":{x:5.5,y:10,size:20}},tagpro.tiles.tileCanvases={};var x=$(overrideableAssets.tiles);tagpro.tiles.image=x[0],tagpro.tiles.images={gravityWell:$(overrideableAssets.gravityWell)[0]},tagpro.events.defineCustomTiles&&tagpro.events.defineCustomTiles.forEach(function(t){t.defineCustomTiles(tagpro.tiles)});var g=[];tagpro.tiles.createAnimation=n,tagpro.tiles.drawNext=function(){for(;g.length;)g.pop()()},this.firstLoad=!1,tagpro.tiles.drawWithZoom=function(t,e,i,n,r,o){return tagpro.tiles.draw(t,e,i,n,r,o,!0)},tagpro.tiles.getTexture=function(t,e,i){if(!PIXI.utils.TextureCache[t]){e||(e=tagpro.tiles[t]),i||(i=e.spread||0);var n=e.source?tagpro.tiles.images[e.source]:tagpro.tiles.image,r=document.createElement("canvas");r.width=e.size||40,r.height=e.size||40;var o=r.getContext("2d"),s=40*e.x-i,a=40*e.y-i,l=(e.size||40)+2*i;o.drawImage(n,s,a,l,l,0,0,l,l),PIXI.utils.TextureCache[t]=PIXI.Texture.fromCanvas(r)}return PIXI.utils.TextureCache[t]},tagpro.tiles.draw=function(t,e,i,n,r,o,s){var a=tagpro.tiles[e];if(a&&!a.draw){var l=a.spread||0,c=(a.size,a.size,function(){var c=tagpro.tiles.getTexture(e,a,l),u=new PIXI.Sprite(c);return u.position.x=i.x,u.position.y=i.y,u.width=n||40,u.height=r||40,u.alpha=a.alpha||o||1,s?t.addChildAt(u,0):t.addChild(u),u});if(!l)return c();g.push(c),i={x:i.x,y:i.y}}},tagpro.tiles.animations={},tagpro.tiles.drawLayers=function(t,e,i,n,r){var o=tagpro.tiles[tagpro.map[e][i]];if(o){var s=o instanceof PIXI.extras.AnimatedSprite;tagpro.tiles.draw(t,{x:1,y:0},n),tagpro.floorMap[e][i]&&tagpro.tiles.draw(t,tagpro.floorMap[e][i],n),s?tagpro.tiles.draw(t,2,n):1==Math.floor(tagpro.map[e][i])?(tagpro.tiles.draw(t,tagpro.wallMap[e][i][0],n,20,20),tagpro.tiles.draw(t,tagpro.wallMap[e][i][1],{x:n.x+20,y:n.y},20,20),tagpro.tiles.draw(t,tagpro.wallMap[e][i][2],{x:n.x+20,y:n.y+20},20,20),tagpro.tiles.draw(t,tagpro.wallMap[e][i][3],{x:n.x,y:n.y+20},20,20)):o.dynamic||tagpro.tiles.draw(t,tagpro.map[e][i],n)}},function(){var t=$(overrideableAssets.splats).get(0),e=new PIXI.BaseTexture(t),i=e.width/120,n=function(t,i){var n=new PIXI.Rectangle(120*t,120*i,120,120);return new PIXI.Texture(e,n)};tagpro.tiles.splats={red:[],blue:[]};for(var r=0;r<i-1;r++)tagpro.tiles.splats.red.push(n(r,0)),tagpro.tiles.splats.blue.push(n(r,1))}()}),$(document).ready(function(){var t=JSON.parse($.trim($("#textures").text()));if(!t)try{t=JSON.parse($.cookie("textures"))}catch(t){}if(t){var e={};["tiles","speedpad","speedpadRed","speedpadBlue","portal","splats","gravityWell"].forEach(function(i){t[i]&&(e[i]=tagpro.helpers.rebaseToCDN(t[i]))}),tagpro.loadAssets(e)}}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,PIXI=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return r(i||t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";"use restrict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-1<<31,i.sign=function(t){return(t>0)-(t<0)},i.abs=function(t){var e=t>>31;return(t^e)-e},i.min=function(t,e){return e^(t^e)&-(t<e)},i.max=function(t,e){return t^(t^e)&-(t<e)},i.isPow2=function(t){return!(t&t-1||!t)},i.log2=function(t){var e,i;return e=(t>65535)<<4,e|=i=((t>>>=e)>255)<<3,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1},i.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},i.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},i.countTrailingZeros=n,i.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},i.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},i.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var i=e,n=e,r=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=1&i,--r;t[e]=n<<r&255}}(r),i.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},i.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},i.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},i.interleave3=function(t,e,i){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},i.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},i.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},{}],2:[function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n,a,l,c,u,d,m,y=e&&e.length,_=y?e[0]*i:t.length,x=r(t,0,_,i,!0),g=[];if(!x)return g;if(y&&(x=function(t,e,i,n){var s,a,l,c,u,d=[];for(s=0,a=e.length;s<a;s++)l=e[s]*n,c=s<a-1?e[s+1]*n:t.length,(u=r(t,l,c,n,!1))===u.next&&(u.steiner=!0),d.push(f(u));for(d.sort(h),s=0;s<d.length;s++)p(d[s],i),i=o(i,i.next);return i}(t,e,x,i)),t.length>80*i){n=l=t[0],a=c=t[1];for(var v=i;v<_;v+=i)u=t[v],d=t[v+1],u<n&&(n=u),d<a&&(a=d),u>l&&(l=u),d>c&&(c=d);m=Math.max(l-n,c-a)}return s(x,g,i,n,a,m),g}function r(t,e,i,n,r){var o,s;if(r===T(t,e,i,n)>0)for(o=e;o<i;o+=n)s=w(o,t[o],t[o+1],s);else for(o=i-n;o>=e;o-=n)s=w(o,t[o],t[o+1],s);return s&&x(s,s.next)&&(C(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!x(n,n.next)&&0!==_(n.prev,n,n.next))n=n.next;else{if(C(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function s(t,e,i,n,r,h,p){if(t){!p&&h&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=d(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,o,s,a,l,c=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ);e++);for(l=c;a>0||l>0&&n;)0===a?(r=n,n=n.nextZ,l--):0!==l&&n?i.z<=n.z?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--):(r=i,i=i.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,c*=2}while(s>1)}(r)}(t,n,r,h);for(var f,m,y=t;t.prev!==t.next;)if(f=t.prev,m=t.next,h?l(t,n,r,h):a(t))e.push(f.i/i),e.push(t.i/i),e.push(m.i/i),C(t),t=m.next,y=m.next;else if((t=m)===y){p?1===p?s(t=c(t,e,i),e,i,n,r,h,2):2===p&&u(t,e,i,n,r,h):s(o(t),e,i,n,r,h,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(_(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(m(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&_(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(t,e,i,n){var r=t.prev,o=t,s=t.next;if(_(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,c=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,h=d(a,l,e,i,n),p=d(c,u,e,i,n),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&m(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&m(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&_(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function c(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!x(r,o)&&g(r,n,n.next,o)&&v(r,o)&&v(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),C(n),C(n.next),n=t=o),n=n.next}while(n!==t);return n}function u(t,e,i,n,r,a){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&y(l,c)){var u=b(l,c);return l=o(l,l.next),u=o(u,u.next),s(l,e,i,n,r,a),void s(u,e,i,n,r,a)}c=c.next}l=l.next}while(l!==t)}function h(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var i,n=e,r=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s){if(s=a,a===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===s)return i.prev;var l,c=i,u=i.x,h=i.y,p=1/0;n=i.next;for(;n!==c;)r>=n.x&&n.x>=u&&m(o<h?r:s,o,u,h,o<h?s:r,o,n.x,n.y)&&((l=Math.abs(o-n.y)/(r-n.x))<p||l===p&&n.x>i.x)&&v(n,t)&&(i=n,p=l),n=n.next;return i}(t,e)){var i=b(e,t);o(i,i.next)}}function d(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function m(t,e,i,n,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(r-s)*(n-a)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&g(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&v(t,e)&&v(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)}function _(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function g(t,e,i,n){return!!(x(t,e)&&x(i,n)||x(t,n)&&x(i,e))||_(t,e,i)>0!=_(t,e,n)>0&&_(i,n,t)>0!=_(i,n,e)>0}function v(t,e){return _(t.prev,t,t.next)<0?_(t,e,t.next)>=0&&_(t,t.prev,e)>=0:_(t,e,t.prev)<0||_(t,t.next,e)<0}function b(t,e){var i=new S(t.i,t.x,t.y),n=new S(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function w(t,e,i,n){var r=new S(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function C(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,i,n){for(var r=0,o=e,s=i-n;o<i;o+=n)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}e.exports=n,n.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,s=Math.abs(T(t,0,o,i));if(r)for(var a=0,l=e.length;a<l;a++){var c=e[a]*i,u=a<l-1?e[a+1]*i:t.length;s-=Math.abs(T(t,c,u,i))}var h=0;for(a=0;a<n.length;a+=3){var p=n[a]*i,d=n[a+1]*i,f=n[a+2]*i;h+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[r][o][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},{}],3:[function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function o(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)n.call(t,e)&&i.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t,e){var i=r?r+t:t,n=this._events[i];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var o=0,s=n.length,a=new Array(s);o<s;o++)a[o]=n[o].fn;return a},a.prototype.emit=function(t,e,i,n,o,s){var a=r?r+t:t;if(!this._events[a])return!1;var l,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,n),!0;case 5:return u.fn.call(u.context,e,i,n,o),!0;case 6:return u.fn.call(u.context,e,i,n,o,s),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var p,d=u.length;for(c=0;c<d;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,n);break;default:if(!l)for(p=1,l=new Array(h-1);p<h;p++)l[p-1]=arguments[p];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(t,e,i){var n=new s(e,i||this),o=r?r+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},a.prototype.once=function(t,e,i){var n=new s(e,i||this,!0),o=r?r+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],n]:this._events[o].push(n):(this._events[o]=n,this._eventsCount++),this},a.prototype.removeListener=function(t,e,i,n){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return 0==--this._eventsCount?this._events=new o:delete this._events[s],this;var a=this._events[s];if(a.fn)a.fn!==e||n&&!a.once||i&&a.context!==i||(0==--this._eventsCount?this._events=new o:delete this._events[s]);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==e||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new o:delete this._events[s]}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new o:delete this._events[e])):(this._events=new o,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=r,a.EventEmitter=a,void 0!==e&&(e.exports=a)},{}],4:[function(t,e,i){var n,r,o,s,a,l,c,u,h,p,d,f,m,y,_,x,g,v,b;n=this,r=/iPhone/i,o=/iPod/i,s=/iPad/i,a=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,l=/Android/i,c=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,u=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/Windows Phone/i,p=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,d=/BlackBerry/i,f=/BB10/i,m=/Opera Mini/i,y=/(CriOS|Chrome)(?=.*\bMobile\b)/i,_=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,x=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),g=function(t,e){return t.test(e)},v=function(t){var e=t||navigator.userAgent,i=e.split("[FBAN");if(void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]),this.apple={phone:g(r,e),ipod:g(o,e),tablet:!g(r,e)&&g(s,e),device:g(r,e)||g(o,e)||g(s,e)},this.amazon={phone:g(c,e),tablet:!g(c,e)&&g(u,e),device:g(c,e)||g(u,e)},this.android={phone:g(c,e)||g(a,e),tablet:!g(c,e)&&!g(a,e)&&(g(u,e)||g(l,e)),device:g(c,e)||g(u,e)||g(a,e)||g(l,e)},this.windows={phone:g(h,e),tablet:g(p,e),device:g(h,e)||g(p,e)},this.other={blackberry:g(d,e),blackberry10:g(f,e),opera:g(m,e),firefox:g(_,e),chrome:g(y,e),device:g(d,e)||g(f,e)||g(m,e)||g(_,e)||g(y,e)},this.seven_inch=g(x,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},b=function(){var t=new v;return t.Class=v,t},void 0!==e&&e.exports&&"undefined"==typeof window?e.exports=v:void 0!==e&&e.exports&&"undefined"!=typeof window?e.exports=b():n.isMobile=b()},{}],5:[function(t,e,i){"use strict";var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var c in i=Object(arguments[l]))r.call(i,c)&&(a[c]=i[c]);if(n){s=n(i);for(var u=0;u<s.length;u++)o.call(i,s[u])&&(a[s[u]]=i[s[u]])}}return a}},{}],6:[function(t,e,i){var n=new ArrayBuffer(0),r=function(t,e,i,r){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=r||t.STATIC_DRAW,this.data=n,i&&this.upload(i),this._updateID=0};r.prototype.upload=function(t,e,i){i||this.bind();var n=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?n.bufferSubData(this.type,e,t):n.bufferData(this.type,t,this.drawType),this.data=t},r.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},r.createVertexBuffer=function(t,e,i){return new r(t,t.ARRAY_BUFFER,e,i)},r.createIndexBuffer=function(t,e,i){return new r(t,t.ELEMENT_ARRAY_BUFFER,e,i)},r.create=function(t,e,i,n){return new r(t,e,i,n)},r.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=r},{}],7:[function(t,e,i){var n=t("./GLTexture"),r=function(t,e,i){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=i||100};r.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new n(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},r.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},r.prototype.clear=function(t,e,i,n){this.bind();var r=this.gl;r.clearColor(t,e,i,n),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)},r.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},r.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},r.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},r.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},r.createRGBA=function(t,e,i,o){var s=n.fromData(t,null,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new r(t,e,i);return a.enableTexture(s),a.unbind(),a},r.createFloat32=function(t,e,i,o){var s=new n.fromData(t,o,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new r(t,e,i);return a.enableTexture(s),a.unbind(),a},e.exports=r},{"./GLTexture":9}],8:[function(t,e,i){var n=t("./shader/compileProgram"),r=t("./shader/extractAttributes"),o=t("./shader/extractUniforms"),s=t("./shader/setPrecision"),a=t("./shader/generateUniformAccessObject"),l=function(t,e,i,l,c){this.gl=t,l&&(e=s(e,l),i=s(i,l)),this.program=n(t,e,i,c),this.attributes=r(t,this.program),this.uniformData=o(t,this.program),this.uniforms=a(t,this.uniformData)};l.prototype.bind=function(){this.gl.useProgram(this.program)},l.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=l},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18,"./shader/setPrecision":22}],9:[function(t,e,i){var n=function(t,e,i,n,r){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=i||-1,this.format=n||t.RGBA,this.type=r||t.UNSIGNED_BYTE};n.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var i=t.videoWidth||t.width,n=t.videoHeight||t.height;n!==this.height||i!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=i,this.height=n};var r=!1;n.prototype.uploadData=function(t,e,i){this.bind();var n=this.gl;if(t instanceof Float32Array){if(!r){if(!n.getExtension("OES_texture_float"))throw new Error("floating point textures not available");r=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||i!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,e,i,0,this.format,this.type,t||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,i,this.format,this.type,t||null),this.width=e,this.height=i},n.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},n.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},n.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},n.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},n.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},n.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},n.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},n.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},n.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},n.fromSource=function(t,e,i){var r=new n(t);return r.premultiplyAlpha=i||!1,r.upload(e),r},n.fromData=function(t,e,i,r){var o=new n(t);return o.uploadData(e,i,r),o},e.exports=n},{}],10:[function(t,e,i){var n=t("./setVertexAttribArrays");function r(t,e){if(this.nativeVaoExtension=null,r.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}r.prototype.constructor=r,e.exports=r,r.FORCE_NATIVE=!1,r.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},r.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},r.prototype.activate=function(){for(var t=this.gl,e=null,i=0;i<this.attributes.length;i++){var r=this.attributes[i];e!==r.buffer&&(r.buffer.bind(),e=r.buffer),t.vertexAttribPointer(r.attribute.location,r.attribute.size,r.type||t.FLOAT,r.normalized||!1,r.stride||0,r.start||0)}return n(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},r.prototype.addAttribute=function(t,e,i,n,r,o){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:i||this.gl.FLOAT,normalized:n||!1,stride:r||0,start:o||0}),this.dirty=!0,this},r.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},r.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},r.prototype.draw=function(t,e,i){var n=this.gl;return this.indexBuffer?n.drawElements(t,e||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(i||0)):n.drawArrays(t,i,e||this.getSize()),this},r.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},r.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":13}],11:[function(t,e,i){e.exports=function(t,e){var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i}},{}],12:[function(t,e,i){var n={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};void 0!==e&&e.exports&&(e.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":6,"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(t,e,i){e.exports=function(t,e,i){var n;if(i){var r=i.tempAttribState,o=i.attribState;for(n=0;n<r.length;n++)r[n]=!1;for(n=0;n<e.length;n++)r[e[n].attribute.location]=!0;for(n=0;n<o.length;n++)o[n]!==r[n]&&(o[n]=r[n],i.attribState[n]?t.enableVertexAttribArray(n):t.disableVertexAttribArray(n))}else for(n=0;n<e.length;n++){var s=e[n];t.enableVertexAttribArray(s.attribute.location)}}},{}],14:[function(t,e,i){var n=function(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)};e.exports=function(t,e,i,r){var o=n(t,t.VERTEX_SHADER,e),s=n(t,t.FRAGMENT_SHADER,i),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),r)for(var l in r)t.bindAttribLocation(a,r[l],l);return t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(a,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(a)),t.deleteProgram(a),a=null),t.deleteShader(o),t.deleteShader(s),a}},{}],15:[function(t,e,i){var n=function(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e};e.exports=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return n(2*e);case"bvec3":return n(3*e);case"bvec4":return n(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],16:[function(t,e,i){var n=t("./mapType"),r=t("./mapSize"),o=function(t,e,i,n){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,i||0,n||0)};e.exports=function(t,e){for(var i={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<s;a++){var l=t.getActiveAttrib(e,a),c=n(t,l.type);i[l.name]={type:c,size:r(c),location:t.getAttribLocation(e,l.name),pointer:o}}return i}},{"./mapSize":20,"./mapType":21}],17:[function(t,e,i){var n=t("./mapType"),r=t("./defaultValue");e.exports=function(t,e){for(var i={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;s++){var a=t.getActiveUniform(e,s),l=a.name.replace(/\[.*?\]/,""),c=n(t,a.type);i[l]={type:c,size:a.size,location:t.getUniformLocation(e,l),value:r(c,a.size)}}return i}},{"./defaultValue":15,"./mapType":21}],18:[function(t,e,i){var n=function(t){var e=s.replace("%%",t);return new Function(e)},r=function(t,e){var i,n=a.replace(/%%/g,t);return(i=1===e.size?l[e.type]:c[e.type])&&(n+="\nthis.gl."+i+";"),new Function("value",n)},o=function(t,e){for(var i=e,n=0;n<t.length-1;n++){var r=i[t[n]]||{data:{}};i[t[n]]=r,i=r}return i},s=["return this.data.%%.value;"].join("\n"),a=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),l={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},c={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};e.exports=function(t,e){var i={data:{}};i.gl=t;for(var s=Object.keys(e),a=0;a<s.length;a++){var l=s[a],c=l.split("."),u=c[c.length-1],h=o(c,i),p=e[l];h.data[u]=p,h.gl=t,Object.defineProperty(h,u,{get:n(u),set:r(u,p)})}return i}},{}],19:[function(t,e,i){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21,"./setPrecision":22}],20:[function(t,e,i){var n={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(t){return n[t]}},{}],21:[function(t,e,i){var n=null,r={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(t,e){if(!n){var i=Object.keys(r);n={};for(var o=0;o<i.length;++o){var s=i[o];n[t[s]]=r[s]}}return n[e]}},{}],22:[function(t,e,i){e.exports=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t}},{}],23:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return n.exec(t).slice(1)};function o(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}i.resolve=function(){for(var i="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var s=r>=0?arguments[r]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(i=s+"/"+i,n="/"===s.charAt(0))}return i=e(o(i.split("/"),function(t){return!!t}),!n).join("/"),(n?"/":"")+i||"."},i.normalize=function(t){var n=i.isAbsolute(t),r="/"===s(t,-1);return(t=e(o(t.split("/"),function(t){return!!t}),!n).join("/"))||n||(t="."),t&&r&&(t+="/"),(n?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(o(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var r=n(t.split("/")),o=n(e.split("/")),s=Math.min(r.length,o.length),a=s,l=0;l<s;l++)if(r[l]!==o[l]){a=l;break}var c=[];for(l=a;l<r.length;l++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=r(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=r(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return r(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:24}],24:[function(t,e,i){var n,r,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],h=!1,p=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!h){var t=l(d);h=!0;for(var e=u.length;e;){for(c=u,u=[];++p<e;)c&&c[p].run();p=-1,e=u.length}c=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new m(t,e)),1!==u.length||h||l(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],25:[function(t,e,i){(function(t){!function(n){var r="object"==typeof i&&i&&!i.nodeType&&i,o="object"==typeof e&&e&&!e.nodeType&&e,s="object"==typeof t&&t;s.global!==s&&s.window!==s&&s.self!==s||(n=s);var a,l,c=2147483647,u=36,h=1,p=26,d=38,f=700,m=72,y=128,_="-",x=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=u-h,C=Math.floor,S=String.fromCharCode;function T(t){throw new RangeError(b[t])}function D(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function A(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+D((t=t.replace(v,".")).split("."),e).join(".")}function B(t){for(var e,i,n=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function M(t){return D(t,function(t){var e="";return t>65535&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)}).join("")}function P(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function E(t,e,i){var n=0;for(t=i?C(t/f):t>>1,t+=C(t/e);t>w*p>>1;n+=u)t=C(t/w);return C(n+(w+1)*t/(t+d))}function I(t){var e,i,n,r,o,s,a,l,d,f,x,g=[],v=t.length,b=0,w=y,S=m;for((i=t.lastIndexOf(_))<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&T("not-basic"),g.push(t.charCodeAt(n));for(r=i>0?i+1:0;r<v;){for(o=b,s=1,a=u;r>=v&&T("invalid-input"),((l=(x=t.charCodeAt(r++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:u)>=u||l>C((c-b)/s))&&T("overflow"),b+=l*s,!(l<(d=a<=S?h:a>=S+p?p:a-S));a+=u)s>C(c/(f=u-d))&&T("overflow"),s*=f;S=E(b-o,e=g.length+1,0==o),C(b/e)>c-w&&T("overflow"),w+=C(b/e),b%=e,g.splice(b++,0,w)}return M(g)}function R(t){var e,i,n,r,o,s,a,l,d,f,x,g,v,b,w,D=[];for(g=(t=B(t)).length,e=y,i=0,o=m,s=0;s<g;++s)(x=t[s])<128&&D.push(S(x));for(n=r=D.length,r&&D.push(_);n<g;){for(a=c,s=0;s<g;++s)(x=t[s])>=e&&x<a&&(a=x);for(a-e>C((c-i)/(v=n+1))&&T("overflow"),i+=(a-e)*v,e=a,s=0;s<g;++s)if((x=t[s])<e&&++i>c&&T("overflow"),x==e){for(l=i,d=u;!(l<(f=d<=o?h:d>=o+p?p:d-o));d+=u)w=l-f,b=u-f,D.push(S(P(f+w%b,0))),l=C(w/b);D.push(S(P(l,0))),o=E(i,v,n==r),i=0,++n}++i,++e}return D.join("")}if(a={version:"1.4.1",ucs2:{decode:B,encode:M},decode:I,encode:R,toASCII:function(t){return A(t,function(t){return g.test(t)?"xn--"+R(t):t})},toUnicode:function(t){return A(t,function(t){return x.test(t)?I(t.slice(4).toLowerCase()):t})}},r&&o)if(e.exports==r)o.exports=a;else for(l in a)a.hasOwnProperty(l)&&(r[l]=a[l]);else n.punycode=a}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,o){e=e||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=t.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var h,p,d,f,m=t[u].replace(a,"%20"),y=m.indexOf(i);y>=0?(h=m.substr(0,y),p=m.substr(y+1)):(h=m,p=""),d=decodeURIComponent(h),f=decodeURIComponent(p),n(s,d)?r(s[d])?s[d].push(f):s[d]=[s[d],f]:s[d]=f}return s};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],27:[function(t,e,i){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),function(s){var a=encodeURIComponent(n(s))+i;return r(t[s])?o(t[s],function(t){return a+encodeURIComponent(n(t))}).join(e):a+encodeURIComponent(n(t[s]))}).join(e):a?encodeURIComponent(n(a))+i+encodeURIComponent(n(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var s=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],28:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":26,"./encode":27}],29:[function(t,e,i){"use strict";var n=t("punycode"),r=t("./util");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=g,i.resolve=function(t,e){return g(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?g(t,!1,!0).resolveObject(e):e},i.format=function(t){r.isString(t)&&(t=g(t));return t instanceof o?t.format():o.prototype.format.call(t)},i.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),h=["%","/","?",";","#"].concat(u),p=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},x=t("querystring");function g(t,e,i){if(t&&r.isObject(t)&&t instanceof o)return t;var n=new o;return n.parse(t,e,i),n}o.prototype.parse=function(t,e,i){if(!r.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",c=t.split(a);c[0]=c[0].replace(/\\/g,"/");var g=t=c.join(a);if(g=g.trim(),!i&&1===t.split("#").length){var v=l.exec(g);if(v)return this.path=g,this.href=g,this.pathname=v[1],v[2]?(this.search=v[2],this.query=e?x.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=s.exec(g);if(b){var w=(b=b[0]).toLowerCase();this.protocol=w,g=g.substr(b.length)}if(i||b||g.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===g.substr(0,2);!C||b&&y[b]||(g=g.substr(2),this.slashes=!0)}if(!y[b]&&(C||b&&!_[b])){for(var S,T,D=-1,A=0;A<p.length;A++){-1!==(B=g.indexOf(p[A]))&&(-1===D||B<D)&&(D=B)}-1!==(T=-1===D?g.lastIndexOf("@"):g.lastIndexOf("@",D))&&(S=g.slice(0,T),g=g.slice(T+1),this.auth=decodeURIComponent(S)),D=-1;for(A=0;A<h.length;A++){var B;-1!==(B=g.indexOf(h[A]))&&(-1===D||B<D)&&(D=B)}-1===D&&(D=g.length),this.host=g.slice(0,D),g=g.slice(D),this.parseHost(),this.hostname=this.hostname||"";var M="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!M)for(var P=this.hostname.split(/\./),E=(A=0,P.length);A<E;A++){var I=P[A];if(I&&!I.match(d)){for(var R="",O=0,k=I.length;O<k;O++)I.charCodeAt(O)>127?R+="x":R+=I[O];if(!R.match(d)){var L=P.slice(0,A),F=P.slice(A+1),N=I.match(f);N&&(L.push(N[1]),F.unshift(N[2])),F.length&&(g="/"+F.join(".")+g),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),M||(this.hostname=n.toASCII(this.hostname));var V=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+V,this.href+=this.host,M&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==g[0]&&(g="/"+g))}if(!m[w])for(A=0,E=u.length;A<E;A++){var G=u[A];if(-1!==g.indexOf(G)){var U=encodeURIComponent(G);U===G&&(U=escape(G)),g=g.split(G).join(U)}}var z=g.indexOf("#");-1!==z&&(this.hash=g.substr(z),g=g.slice(0,z));var X=g.indexOf("?");if(-1!==X?(this.search=g.substr(X),this.query=g.substr(X+1),e&&(this.query=x.parse(this.query)),g=g.slice(0,X)):e&&(this.search="",this.query={}),g&&(this.pathname=g),_[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){V=this.pathname||"";var W=this.search||"";this.path=V+W}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(s=x.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(t){return this.resolveObject(g(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(r.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var i=new o,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var l=Object.keys(t),c=0;c<l.length;c++){var u=l[c];"protocol"!==u&&(i[u]=t[u])}return _[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!_[t.protocol]){for(var h=Object.keys(t),p=0;p<h.length;p++){var d=h[p];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||y[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",x=i.search||"";i.path=m+x}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var g=i.pathname&&"/"===i.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=v||g||i.host&&t.pathname,w=b,C=i.pathname&&i.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],i.protocol&&!_[i.protocol]);if(S&&(i.hostname="",i.port=null,i.host&&(""===C[0]?C[0]=i.host:C.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),b=b&&(""===f[0]||""===C[0])),v)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,C=f;else if(f.length)C||(C=[]),C.pop(),C=C.concat(f),i.search=t.search,i.query=t.query;else if(!r.isNullOrUndefined(t.search)){if(S)i.hostname=i.host=C.shift(),(M=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=M.shift(),i.host=i.hostname=M.shift());return i.search=t.search,i.query=t.query,r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!C.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=C.slice(-1)[0],D=(i.host||t.host||C.length>1)&&("."===T||".."===T)||""===T,A=0,B=C.length;B>=0;B--)"."===(T=C[B])?C.splice(B,1):".."===T?(C.splice(B,1),A++):A&&(C.splice(B,1),A--);if(!b&&!w)for(;A--;A)C.unshift("..");!b||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),D&&"/"!==C.join("/").substr(-1)&&C.push("");var M,P=""===C[0]||C[0]&&"/"===C[0].charAt(0);S&&(i.hostname=i.host=P?"":C.length?C.shift():"",(M=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=M.shift(),i.host=i.hostname=M.shift()));return(b=b||i.host&&C.length)&&!P&&C.unshift(""),C.length?i.pathname=C.join("/"):(i.pathname=null,i.path=null),r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":30,punycode:25,querystring:28}],30:[function(t,e,i){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],31:[function(t,e,i){"use strict";e.exports=function(t,e,i){var n,r=t.length;if(!(e>=r||0===i)){var o=r-(i=e+i>r?r-e:i);for(n=e;n<o;++n)t[n]=t[n+i];t.length=o}}},{}],32:[function(t,e,i){"use strict";i.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=l(t("mini-signals")),o=l(t("parse-uri")),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./async")),a=l(t("./Resource"));function l(t){return t&&t.__esModule?t:{default:t}}var c=/(#[\w-]+)?$/,u=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=i,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,i){return e._loadResource(t,i)},this._queue=s.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new r.default,this.onError=new r.default,this.onLoad=new r.default,this.onStart=new r.default,this.onComplete=new r.default}return t.prototype.add=function(t,e,i,r){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===(void 0===t?"undefined":n(t))&&(r=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(r=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(r=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new a.default(t,e,i),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var s=i.parentResource,l=[],c=0;c<s.children.length;++c)s.children[c].isComplete||l.push(s.children[c]);var u=s.progressChunk*(l.length+1)/(l.length+2);s.children.push(this.resources[t]),s.progressChunk=u;for(var h=0;h<l.length;++h)l[h].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},t.prototype._prepareUrl=function(t){var e=(0,o.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=c.exec(i)[0];-1!==(i=i.substr(0,i.length-n.length)).indexOf("?")?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=n}return i},t.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,s.eachSeries(this._beforeMiddleware,function(e,n){e.call(i,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},t.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),s.eachSeries(this._afterMiddleware,function(i,n){i.call(e,t,n)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&(e.progress=100,e._onComplete())},!0)},t}();i.default=u},{"./Resource":33,"./async":34,"mini-signals":38,"parse-uri":39}],33:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=s(t("parse-uri")),o=s(t("mini-signals"));function s(t){return t&&t.__esModule?t:{default:t}}var a=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),l=null;function c(){}var u=function(){function t(e,i,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=c,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new o.default,this.onProgress=new o.default,this.onComplete=new o.default,this.onAfterMiddleware=new o.default}return t.setExtensionLoadType=function(e,i){h(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){h(t._xhrTypeMap,e,i)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(i)},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:a&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=i,n},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(p(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(p(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(p(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",n=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===n&&i.length>0?n=200:1223===n&&(n=204),2===(n/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(i,"text/xml")}else{var o=document.createElement("div");o.innerHTML=i,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,l||(l=document.createElement("a")),l.href=t;var i=!(t=(0,r.default)(l.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var n=t.indexOf("?"),r=t.indexOf("#"),o=Math.min(n>-1?n:t.length,r>-1?r:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function h(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function p(t){return t.toString().replace("object ","")}i.default=u,u.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},u.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},u.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},u.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},u._loadTypeMap={gif:u.LOAD_TYPE.IMAGE,png:u.LOAD_TYPE.IMAGE,bmp:u.LOAD_TYPE.IMAGE,jpg:u.LOAD_TYPE.IMAGE,jpeg:u.LOAD_TYPE.IMAGE,tif:u.LOAD_TYPE.IMAGE,tiff:u.LOAD_TYPE.IMAGE,webp:u.LOAD_TYPE.IMAGE,tga:u.LOAD_TYPE.IMAGE,svg:u.LOAD_TYPE.IMAGE,"svg+xml":u.LOAD_TYPE.IMAGE,mp3:u.LOAD_TYPE.AUDIO,ogg:u.LOAD_TYPE.AUDIO,wav:u.LOAD_TYPE.AUDIO,mp4:u.LOAD_TYPE.VIDEO,webm:u.LOAD_TYPE.VIDEO},u._xhrTypeMap={xhtml:u.XHR_RESPONSE_TYPE.DOCUMENT,html:u.XHR_RESPONSE_TYPE.DOCUMENT,htm:u.XHR_RESPONSE_TYPE.DOCUMENT,xml:u.XHR_RESPONSE_TYPE.DOCUMENT,tmx:u.XHR_RESPONSE_TYPE.DOCUMENT,svg:u.XHR_RESPONSE_TYPE.DOCUMENT,tsx:u.XHR_RESPONSE_TYPE.DOCUMENT,gif:u.XHR_RESPONSE_TYPE.BLOB,png:u.XHR_RESPONSE_TYPE.BLOB,bmp:u.XHR_RESPONSE_TYPE.BLOB,jpg:u.XHR_RESPONSE_TYPE.BLOB,jpeg:u.XHR_RESPONSE_TYPE.BLOB,tif:u.XHR_RESPONSE_TYPE.BLOB,tiff:u.XHR_RESPONSE_TYPE.BLOB,webp:u.XHR_RESPONSE_TYPE.BLOB,tga:u.XHR_RESPONSE_TYPE.BLOB,json:u.XHR_RESPONSE_TYPE.JSON,text:u.XHR_RESPONSE_TYPE.TEXT,txt:u.XHR_RESPONSE_TYPE.TEXT,ttf:u.XHR_RESPONSE_TYPE.BUFFER,otf:u.XHR_RESPONSE_TYPE.BUFFER},u.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":38,"parse-uri":39}],34:[function(t,e,i){"use strict";function n(){}function r(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}i.__esModule=!0,i.eachSeries=function(t,e,i,n){var r=0,o=t.length;!function s(a){a||r===o?i&&i(a):n?setTimeout(function(){e(t[r++],s)},1):e(t[r++],s)}()},i.queue=function(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,o={_tasks:[],concurrency:e,saturated:n,unsaturated:n,buffer:e/4,empty:n,drain:n,error:n,started:!1,paused:!1,push:function(t,e){s(t,!1,e)},kill:function(){i=0,o.drain=n,o.started=!1,o._tasks=[]},unshift:function(t,e){s(t,!0,e)},process:function(){for(;!o.paused&&i<o.concurrency&&o._tasks.length;){var e=o._tasks.shift();0===o._tasks.length&&o.empty(),(i+=1)===o.concurrency&&o.saturated(),t(e.data,r(a(e)))}},length:function(){return o._tasks.length},running:function(){return i},idle:function(){return o._tasks.length+i===0},pause:function(){!0!==o.paused&&(o.paused=!0)},resume:function(){if(!1!==o.paused){o.paused=!1;for(var t=1;t<=o.concurrency;t++)o.process()}}};function s(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(o.started=!0,null==t&&o.idle())setTimeout(function(){return o.drain()},1);else{var r={data:t,callback:"function"==typeof i?i:n};e?o._tasks.unshift(r):o._tasks.push(r),setTimeout(function(){return o.process()},1)}}function a(t){return function(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&o.error(arguments[0],t.data),i<=o.concurrency-o.buffer&&o.unsaturated(),o.idle()&&o.drain(),o.process()}}return o}},{}],35:[function(t,e,i){"use strict";i.__esModule=!0,i.encodeBinary=function(t){var e="",i=0;for(;i<t.length;){for(var r=[0,0,0],o=[0,0,0,0],s=0;s<r.length;++s)i<t.length?r[s]=255&t.charCodeAt(i++):r[s]=0;o[0]=r[0]>>2,o[1]=(3&r[0])<<4|r[1]>>4,o[2]=(15&r[1])<<2|r[2]>>6,o[3]=63&r[2];var a=i-(t.length-1);switch(a){case 2:o[3]=64,o[2]=64;break;case 1:o[3]=64}for(var l=0;l<o.length;++l)e+=n.charAt(o[l])}return e};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],36:[function(t,e,i){"use strict";var n=t("./Loader").default,r=t("./Resource").default,o=t("./async"),s=t("./b64");n.Resource=r,n.async=o,n.base64=s,e.exports=n,e.exports.default=n},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(t,e,i){"use strict";i.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===r.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=(l=a.createObjectURL(t.data),t.blob=t.data,t.data=new Image,t.data.src=l,t.type=r.default.TYPE.IMAGE,t.data.onload=function(){a.revokeObjectURL(l),t.data.onload=null,e()},{v:void 0});if("object"===(void 0===i?"undefined":n(i)))return i.v}}else{var s=t.xhr.getResponseHeader("content-type");if(s&&0===s.indexOf("image"))return t.data=new Image,t.data.src="data:"+s+";base64,"+o.default.encodeBinary(t.xhr.responseText),t.type=r.default.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}var l;e()}else e()}};var r=s(t("../../Resource")),o=s(t("../../b64"));function s(t){return t&&t.__esModule?t:{default:t}}var a=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,i,n){void 0===i&&(i=!1),r(this,t),this._fn=e,this._once=i,this._thisArg=n,this._next=this._prev=this._owner=null}return n(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function s(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){r(this,t),this._head=this._tail=void 0}return n(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new o(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new o(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=o,i.default=a,e.exports=i.default},{}],39:[function(t,e,i){"use strict";e.exports=function(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=i.parser[e.strictMode?"strict":"loose"].exec(t),r={},o=14;o--;)r[i.key[o]]=n[o]||"";return r[i.q.name]={},r[i.key[12]].replace(i.q.parser,function(t,e,n){e&&(r[i.q.name][e]=n)}),r}},{}],40:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),r=s(t("ismobilejs")),o=s(t("./accessibleTarget"));function s(t){return t&&t.__esModule?t:{default:t}}n.utils.mixins.delayMixin(n.DisplayObject.prototype,o.default);var a=100,l=0,c=0,u=2,h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!r.default.tablet&&!r.default.phone||navigator.isCocoonJS||this.createTouchHook();var i=document.createElement("div");i.style.width=a+"px",i.style.height=a+"px",i.style.position="absolute",i.style.top=l+"px",i.style.left=c+"px",i.style.zIndex=u,this.div=i,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},t.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=e.length-1;i>=0;i--)this.updateAccessibleObjects(e[i])}},t.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,r=this.div;r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var s=this.children[o];if(s.renderId!==this.renderId)s._accessibleActive=!1,n.utils.removeItems(this.children,o,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{r=s._accessibleDiv;var a=s.hitArea,l=s.worldTransform;s.hitArea?(r.style.left=(l.tx+a.x*l.a)*e+"px",r.style.top=(l.ty+a.y*l.d)*i+"px",r.style.width=a.width*l.a*e+"px",r.style.height=a.height*l.d*i+"px"):(a=s.getBounds(),this.capHitArea(a),r.style.left=a.x*e+"px",r.style.top=a.y*i+"px",r.style.width=a.width*e+"px",r.style.height=a.height*i+"px")}}this.renderId++}},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=a+"px",e.style.height=a+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=u,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleTitle||t.accessibleHint||(e.title="displayObject "+this.tabIndex),t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},t.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(){this.deactivate()},t.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();i.default=h,n.WebGLRenderer.registerPlugin("accessibility",h),n.CanvasRenderer.registerPlugin("accessibility",h)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(t,e,i){"use strict";i.__esModule=!0,i.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./accessibleTarget");Object.defineProperty(i,"accessibleTarget",{enumerable:!0,get:function(){return o(n).default}});var r=t("./AccessibilityManager");function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"AccessibilityManager",{enumerable:!0,get:function(){return o(r).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("./autoDetectRenderer"),o=c(t("./display/Container")),s=t("./ticker"),a=c(t("./settings")),l=t("./const");function c(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(e,i,n,l,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"number"==typeof e&&(e=Object.assign({width:e,height:i||a.default.RENDER_OPTIONS.height,forceCanvas:!!l,sharedTicker:!!c},n)),this._options=e=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},e),this.renderer=(0,r.autoDetectRenderer)(e),this.stage=new o.default,this._ticker=null,this.ticker=e.sharedTicker?s.shared:new s.Ticker,e.autoStart&&this.start()}return t.prototype.render=function(){this.renderer.render(this.stage)},t.prototype.stop=function(){this._ticker.stop()},t.prototype.start=function(){this._ticker.start()},t.prototype.destroy=function(t){var e=this._ticker;this.ticker=null,e.destroy(),this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},n(t,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,l.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),t}();i.default=u},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":120}],44:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("pixi-gl-core"),o=t("./settings"),s=(n=o)&&n.__esModule?n:{default:n};function a(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var i=t.slice(0);return i.unshift("precision "+e+" float;"),i}}else if("precision"!==t.substring(0,9))return"precision "+e+" float;\n"+t;return t}var l=function(t){function e(i,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,a(n,s.default.PRECISION_VERTEX),a(r,s.default.PRECISION_FRAGMENT)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(r.GLShader);i.default=l},{"./settings":101,"pixi-gl-core":12}],45:[function(t,e,i){"use strict";i.__esModule=!0,i.autoDetectRenderer=function(t,e,i,s){var a=t&&t.forceCanvas;void 0!==s&&(a=s);if(!a&&n.isWebGLSupported())return new o.default(t,e,i);return new r.default(t,e,i)};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./utils")),r=s(t("./renderers/canvas/CanvasRenderer")),o=s(t("./renderers/webgl/WebGLRenderer"));function s(t){return t&&t.__esModule?t:{default:t}}},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":124}],46:[function(t,e,i){"use strict";i.__esModule=!0;i.VERSION="4.5.6",i.PI_2=2*Math.PI,i.RAD_TO_DEG=180/Math.PI,i.DEG_TO_RAD=Math.PI/180,i.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},i.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},i.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},i.SCALE_MODES={LINEAR:0,NEAREST:1},i.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},i.GC_MODES={AUTO:0,MANUAL:1},i.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,i.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,i.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,i.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},i.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},i.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},i.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},i.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../math");var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?n.Rectangle.EMPTY:((t=t||new n.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,o=t[0],s=t[1];e=o<e?o:e,i=s<i?s:i,n=o>n?o:n,r=s>r?s:r,o=t[2],s=t[3],e=o<e?o:e,i=s<i?s:i,n=o>n?o:n,r=s>r?s:r,o=t[4],s=t[5],e=o<e?o:e,i=s<i?s:i,n=o>n?o:n,r=s>r?s:r,o=t[6],s=t[7],e=o<e?o:e,i=s<i?s:i,n=o>n?o:n,r=s>r?s:r,this.minX=e,this.minY=i,this.maxX=n,this.maxY=r},t.prototype.addFrame=function(t,e,i,n,r){var o=t.worldTransform,s=o.a,a=o.b,l=o.c,c=o.d,u=o.tx,h=o.ty,p=this.minX,d=this.minY,f=this.maxX,m=this.maxY,y=s*e+l*i+u,_=a*e+c*i+h;p=y<p?y:p,d=_<d?_:d,f=y>f?y:f,m=_>m?_:m,_=a*n+c*i+h,p=(y=s*n+l*i+u)<p?y:p,d=_<d?_:d,f=y>f?y:f,m=_>m?_:m,_=a*e+c*r+h,p=(y=s*e+l*r+u)<p?y:p,d=_<d?_:d,f=y>f?y:f,m=_>m?_:m,_=a*n+c*r+h,p=(y=s*n+l*r+u)<p?y:p,d=_<d?_:d,f=y>f?y:f,m=_>m?_:m,this.minX=p,this.minY=d,this.maxX=f,this.maxY=m},t.prototype.addVertices=function(t,e,i,n){for(var r=t.worldTransform,o=r.a,s=r.b,a=r.c,l=r.d,c=r.tx,u=r.ty,h=this.minX,p=this.minY,d=this.maxX,f=this.maxY,m=i;m<n;m+=2){var y=e[m],_=e[m+1],x=o*y+a*_+c,g=l*_+s*y+u;h=x<h?x:h,p=g<p?g:p,d=x>d?x:d,f=g>f?g:f}this.minX=h,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=r&&n<=o){var s=this.minX,a=this.minY,l=this.maxX,c=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=r>l?r:l,this.maxY=o>c?o:c}},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=r&&n<=o){var s=this.minX,a=this.minY,l=this.maxX,c=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=r>l?r:l,this.maxY=o>c?o:c}},t}();i.default=r},{"../math":70}],48:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("../utils"),s=t("./DisplayObject");var a=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.children=[],i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);(0,o.removeItems)(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.removeChild(arguments[i]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,(0,o.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,o.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=t,n="number"==typeof e?e:this.children.length,r=n-i,o=void 0;if(r>0&&r<=n){o=this.children.splice(i,r);for(var s=0;s<o.length;++s)o[s].parent=null,o[s].transform&&(o[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<o.length;++a)o[a].emit("removed",this);return o}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}i&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var r=0,o=this.children.length;r<o;r++)this.children[r].renderWebGL(t);t.flush(),i&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(e){t.prototype.destroy.call(this);var i="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(i)for(var r=0;r<n.length;++r)n[r].destroy(e)},r(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),e}(((n=s)&&n.__esModule?n:{default:n}).default);i.default=a,a.prototype.containerUpdateTransform=a.prototype.updateTransform},{"../utils":124,"./DisplayObject":49}],49:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=h(t("eventemitter3")),o=t("../const"),s=h(t("../settings")),a=h(t("./TransformStatic")),l=h(t("./Transform")),c=h(t("./Bounds")),u=t("../math");function h(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),n=s.default.TRANSFORM_MODE===o.TRANSFORM_MODE.STATIC?a.default:l.default;return i.tempDisplayObjectParent=null,i.transform=new n,i.alpha=1,i.visible=!0,i.renderable=!0,i.parent=null,i.worldAlpha=1,i.filterArea=null,i._filters=null,i._enabledFilters=null,i._bounds=new c.default,i._boundsID=0,i._lastBoundsID=-1,i._boundsRect=null,i._localBoundsRect=null,i._mask=null,i._destroyed=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new u.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),t=this._localBoundsRect);var n=this.getBounds(!1,t);return this.parent=i,this.transform=e,n},e.prototype.toGlobal=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.renderWebGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=r,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=l,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},n(e,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),e}(r.default);i.default=p,p.prototype.displayObjectUpdateTransform=p.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("../math"),s=t("./TransformBase");var a=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.position=new o.Point(0,0),i.scale=new o.Point(1,1),i.skew=new o.ObservablePoint(i.updateSkew,i,0,0),i.pivot=new o.Point(0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},e.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},e.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._worldID++},e.prototype.setFromMatrix=function(t){t.decompose(this)},r(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(((n=s)&&n.__esModule?n:{default:n}).default);i.default=a},{"../math":70,"./TransformBase":51}],51:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../math");var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},t.prototype.updateTransform=function(t){var e=t.worldTransform,i=this.worldTransform,n=this.localTransform;i.a=n.a*e.a+n.b*e.c,i.b=n.a*e.b+n.b*e.d,i.c=n.c*e.a+n.d*e.c,i.d=n.c*e.b+n.d*e.d,i.tx=n.tx*e.a+n.ty*e.c+e.tx,i.ty=n.tx*e.b+n.ty*e.d+e.ty,this._worldID++},t}();i.default=r,r.prototype.updateWorldTransform=r.prototype.updateTransform,r.IDENTITY=new r},{"../math":70}],52:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("../math"),s=t("./TransformBase");var a=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.position=new o.ObservablePoint(i.onChange,i,0,0),i.scale=new o.ObservablePoint(i.onChange,i,1,1),i.pivot=new o.ObservablePoint(i.onChange,i,0,0),i.skew=new o.ObservablePoint(i.updateSkew,i,0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i._localID=0,i._currentLocalID=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},r(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(((n=s)&&n.__esModule?n:{default:n}).default);i.default=a},{"../math":70,"./TransformBase":51}],53:[function(t,e,i){"use strict";i.__esModule=!0;var n=f(t("../display/Container")),r=f(t("../textures/RenderTexture")),o=f(t("../textures/Texture")),s=f(t("./GraphicsData")),a=f(t("../sprites/Sprite")),l=t("../math"),c=t("../utils"),u=t("../const"),h=f(t("../display/Bounds")),p=f(t("./utils/bezierCurveTo")),d=f(t("../renderers/canvas/CanvasRenderer"));function f(t){return t&&t.__esModule?t:{default:t}}var m=void 0,y=new l.Matrix,_=new l.Point,x=new Float32Array(4),g=new Float32Array(4),v=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.fillAlpha=1,n.lineWidth=0,n.nativeLines=i,n.lineColor=0,n.graphicsData=[],n.tint=16777215,n._prevTint=16777215,n.blendMode=u.BLEND_MODES.NORMAL,n.currentPath=null,n._webGL={},n.isMask=!1,n.boundsPadding=0,n._localBounds=new h.default,n.dirty=0,n.fastRectDirty=-1,n.clearDirty=0,n.boundsDirty=-1,n.cachedSpriteDirty=!1,n._spriteRect=null,n._fastRect=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.clone=function(){var t=new e;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)t.graphicsData.push(this.graphicsData[i].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},e.prototype.lineStyle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this.currentPath)if(this.currentPath.shape.points.length){var n=new l.Polygon(this.currentPath.shape.points.slice(-2));n.closed=!1,this.drawShape(n)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},e.prototype.moveTo=function(t,e){var i=new l.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},e.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty++,this},e.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r=this.currentPath.shape.points,o=0,s=0;0===r.length&&this.moveTo(0,0);for(var a=r[r.length-2],l=r[r.length-1],c=1;c<=20;++c){var u=c/20;o=a+(t-a)*u,s=l+(e-l)*u,r.push(o+(t+(i-t)*u-o)*u,s+(e+(n-e)*u-s)*u)}return this.dirty++,this},e.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,a=s[s.length-2],l=s[s.length-1];return s.length-=2,(0,p.default)(a,l,t,e,i,n,r,o,s),this.dirty++,this},e.prototype.arcTo=function(t,e,i,n,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,s=o[o.length-2],a=o[o.length-1]-e,l=s-t,c=n-e,u=i-t,h=Math.abs(a*u-l*c);if(h<1e-8||0===r)o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e);else{var p=a*a+l*l,d=c*c+u*u,f=a*c+l*u,m=r*Math.sqrt(p)/h,y=r*Math.sqrt(d)/h,_=m*f/p,x=y*f/d,g=m*u+y*l,v=m*c+y*a,b=l*(y+_),w=a*(y+_),C=u*(m+x),S=c*(m+x),T=Math.atan2(w-v,b-g),D=Math.atan2(S-v,C-g);this.arc(g+t,v+e,r,T,D,l*c>u*a)}return this.dirty++,this},e.prototype.arc=function(t,e,i,n,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(n===r)return this;!o&&r<=n?r+=2*Math.PI:o&&n<=r&&(n+=2*Math.PI);var s=r-n,a=40*Math.ceil(Math.abs(s)/(2*Math.PI));if(0===s)return this;var l=t+Math.cos(n)*i,c=e+Math.sin(n)*i,u=this.currentPath?this.currentPath.shape.points:null;u?u[u.length-2]===l&&u[u.length-1]===c||u.push(l,c):(this.moveTo(l,c),u=this.currentPath.shape.points);for(var h=s/(2*a),p=2*h,d=Math.cos(h),f=Math.sin(h),m=a-1,y=m%1/m,_=0;_<=m;++_){var x=h+n+p*(_+y*_),g=Math.cos(x),v=-Math.sin(x);u.push((d*g+f*v)*i+t,(d*-v+f*g)*i+e)}return this.dirty++,this},e.prototype.beginFill=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},e.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.prototype.drawRect=function(t,e,i,n){return this.drawShape(new l.Rectangle(t,e,i,n)),this},e.prototype.drawRoundedRect=function(t,e,i,n,r){return this.drawShape(new l.RoundedRectangle(t,e,i,n,r)),this},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new l.Circle(t,e,i)),this},e.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new l.Ellipse(t,e,i,n)),this},e.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof l.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var r=new l.Polygon(e);return r.closed=i,this.drawShape(r),this},e.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===u.SHAPES.RECT&&!this.graphicsData[0].lineWidth},e.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},e.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new a.default(new o.default(o.default.WHITE)));var i=this._spriteRect;if(16777215===this.tint)i.tint=this.graphicsData[0].fillColor;else{var n=x,r=g;(0,c.hex2rgb)(this.graphicsData[0].fillColor,n),(0,c.hex2rgb)(this.tint,r),n[0]*=r[0],n[1]*=r[1],n[2]*=r[2],i.tint=(0,c.rgb2hex)(n)}i.alpha=this.graphicsData[0].fillAlpha,i.worldAlpha=this.worldAlpha*i.alpha,i.blendMode=this.blendMode,i._texture._frame.width=e.width,i._texture._frame.height=e.height,i.transform.worldTransform=this.transform.worldTransform,i.anchor.set(-e.x/e.width,-e.y/e.height),i._onAnchorUpdate(),i._renderWebGL(t)},e.prototype._renderCanvas=function(t){!0!==this.isMask&&t.plugins.graphics.render(this)},e.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,_);for(var e=this.graphicsData,i=0;i<e.length;++i){var n=e[i];if(n.fill&&(n.shape&&n.shape.contains(_.x,_.y))){if(n.holes)for(var r=0;r<n.holes.length;r++){if(n.holes[r].contains(_.x,_.y))return!1}return!0}}return!1},e.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var r=0,o=0,s=0,a=0,l=0,c=0;c<this.graphicsData.length;c++){var h=this.graphicsData[c],p=h.type,d=h.lineWidth;if(r=h.shape,p===u.SHAPES.RECT||p===u.SHAPES.RREC)o=r.x-d/2,s=r.y-d/2,a=r.width+d,l=r.height+d,t=o<t?o:t,e=o+a>e?o+a:e,i=s<i?s:i,n=s+l>n?s+l:n;else if(p===u.SHAPES.CIRC)o=r.x,s=r.y,a=r.radius+d/2,l=r.radius+d/2,t=o-a<t?o-a:t,e=o+a>e?o+a:e,i=s-l<i?s-l:i,n=s+l>n?s+l:n;else if(p===u.SHAPES.ELIP)o=r.x,s=r.y,a=r.width+d/2,l=r.height+d/2,t=o-a<t?o-a:t,e=o+a>e?o+a:e,i=s-l<i?s-l:i,n=s+l>n?s+l:n;else for(var f=r.points,m=0,y=0,_=0,x=0,g=0,v=0,b=0,w=0,C=0;C+2<f.length;C+=2)o=f[C],s=f[C+1],m=f[C+2],y=f[C+3],_=Math.abs(m-o),x=Math.abs(y-s),l=d,(a=Math.sqrt(_*_+x*x))<1e-9||(v=(l/a*_+x)/2,w=(y+s)/2,t=(b=(m+o)/2)-(g=(l/a*x+_)/2)<t?b-g:t,e=b+g>e?b+g:e,i=w-v<i?w-v:i,n=w+v>n?w+v:n)}else t=0,e=0,i=0,n=0;var S=this.boundsPadding;this._localBounds.minX=t-S,this._localBounds.maxX=e+S,this._localBounds.minY=i-S,this._localBounds.maxY=n+S},e.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new s.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty++,e},e.prototype.generateCanvasTexture=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.getLocalBounds(),n=r.default.create(i.width,i.height,t,e);m||(m=new d.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(y),y.invert(),y.tx-=i.x,y.ty-=i.y,m.render(this,n,!0,y);var s=o.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,t,"graphics");return s.baseTexture.resolution=e,s.baseTexture.update(),s},e.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},e.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(var n in this._webgl)for(var r=0;r<this._webgl[n].data.length;++r)this._webgl[n].data[r].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},e}(n.default);i.default=v,v._SPRITE_TEXTURE=null},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":124,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e,i,n,r,o,s,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lineWidth=e,this.nativeLines=a,this.lineColor=i,this.lineAlpha=n,this._lineTint=i,this.fillColor=r,this.fillAlpha=o,this._fillTint=r,this.fill=s,this.holes=[],this.shape=l,this.type=l.type}return t.prototype.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},t.prototype.addHole=function(t){this.holes.push(t)},t.prototype.destroy=function(){this.shape=null,this.holes=null},t}();i.default=n},{}],55:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../renderers/canvas/CanvasRenderer"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldAlpha,r=t.transform.worldTransform,o=e.resolution;this._prevTint!==this.tint&&(this.dirty=!0),i.setTransform(r.a*o,r.b*o,r.c*o,r.d*o,r.tx*o,r.ty*o),t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),e.setBlendMode(t.blendMode);for(var a=0;a<t.graphicsData.length;a++){var l=t.graphicsData[a],c=l.shape,u=l._fillTint,h=l._lineTint;if(i.lineWidth=l.lineWidth,l.type===s.SHAPES.POLY){i.beginPath(),this.renderPolygon(c.points,c.closed,i);for(var p=0;p<l.holes.length;p++)this.renderPolygon(l.holes[p].points,!0,i);l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}else if(l.type===s.SHAPES.RECT)(l.fillColor||0===l.fillColor)&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fillRect(c.x,c.y,c.width,c.height)),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.strokeRect(c.x,c.y,c.width,c.height));else if(l.type===s.SHAPES.CIRC)i.beginPath(),i.arc(c.x,c.y,c.radius,0,2*Math.PI),i.closePath(),l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke());else if(l.type===s.SHAPES.ELIP){var d=2*c.width,f=2*c.height,m=c.x-d/2,y=c.y-f/2;i.beginPath();var _=d/2*.5522848,x=f/2*.5522848,g=m+d,v=y+f,b=m+d/2,w=y+f/2;i.moveTo(m,w),i.bezierCurveTo(m,w-x,b-_,y,b,y),i.bezierCurveTo(b+_,y,g,w-x,g,w),i.bezierCurveTo(g,w+x,b+_,v,b,v),i.bezierCurveTo(b-_,v,m,w+x,m,w),i.closePath(),l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}else if(l.type===s.SHAPES.RREC){var C=c.x,S=c.y,T=c.width,D=c.height,A=c.radius,B=Math.min(T,D)/2|0;A=A>B?B:A,i.beginPath(),i.moveTo(C,S+A),i.lineTo(C,S+D-A),i.quadraticCurveTo(C,S+D,C+A,S+D),i.lineTo(C+T-A,S+D),i.quadraticCurveTo(C+T,S+D,C+T,S+D-A),i.lineTo(C+T,S+A),i.quadraticCurveTo(C+T,S,C+T-A,S),i.lineTo(C+A,S),i.quadraticCurveTo(C,S,C,S+A),i.closePath(),(l.fillColor||0===l.fillColor)&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.stroke())}}},t.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,r=0;r<t.graphicsData.length;++r){var o=t.graphicsData[r],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}},t.prototype.renderPolygon=function(t,e,i){i.moveTo(t[0],t[1]);for(var n=1;n<t.length/2;++n)i.lineTo(t[2*n],t[2*n+1]);e&&i.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=a,o.default.registerPlugin("graphics",a)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i,n,r,o,s,a){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],c=0,u=0,h=0,p=0,d=0;l.push(t,e);for(var f=1,m=0;f<=20;++f)h=(u=(c=1-(m=f/20))*c)*c,d=(p=m*m)*m,l.push(h*t+3*u*m*i+3*c*p*r+d*s,h*e+3*u*m*n+3*c*p*o+d*a);return l}},{}],57:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../utils"),r=t("../../const"),o=d(t("../../renderers/webgl/utils/ObjectRenderer")),s=d(t("../../renderers/webgl/WebGLRenderer")),a=d(t("./WebGLGraphicsData")),l=d(t("./shaders/PrimitiveShader")),c=d(t("./utils/buildPoly")),u=d(t("./utils/buildRectangle")),h=d(t("./utils/buildRoundedRectangle")),p=d(t("./utils/buildCircle"));function d(t){return t&&t.__esModule?t:{default:t}}var f=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.graphicsDataPool=[],n.primitiveShader=null,n.gl=i.gl,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new l.default(this.gl)},e.prototype.destroy=function(){o.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},e.prototype.render=function(t){var e=this.renderer,i=e.gl,r=void 0,o=t._webGL[this.CONTEXT_UID];o&&t.dirty===o.dirty||(this.updateGraphics(t),o=t._webGL[this.CONTEXT_UID]);var s=this.primitiveShader;e.bindShader(s),e.state.setBlendMode(t.blendMode);for(var a=0,l=o.data.length;a<l;a++){var c=(r=o.data[a]).shader;e.bindShader(c),c.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),c.uniforms.tint=(0,n.hex2rgb)(t.tint),c.uniforms.alpha=t.worldAlpha,e.bindVao(r.vao),r.nativeLines?i.drawArrays(i.LINES,0,r.points.length/6):r.vao.draw(i.TRIANGLE_STRIP,r.indices.length)}},e.prototype.updateGraphics=function(t){var e=this.renderer.gl,i=t._webGL[this.CONTEXT_UID];if(i||(i=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e,clearDirty:-1,dirty:-1}),i.dirty=t.dirty,t.clearDirty!==i.clearDirty){i.clearDirty=t.clearDirty;for(var n=0;n<i.data.length;n++)this.graphicsDataPool.push(i.data[n]);i.data.length=0,i.lastIndex=0}for(var o=void 0,s=void 0,a=i.lastIndex;a<t.graphicsData.length;a++){var l=t.graphicsData[a];o=this.getWebGLData(i,0),l.nativeLines&&l.lineWidth&&(s=this.getWebGLData(i,0,!0),i.lastIndex++),l.type===r.SHAPES.POLY&&(0,c.default)(l,o,s),l.type===r.SHAPES.RECT?(0,u.default)(l,o,s):l.type===r.SHAPES.CIRC||l.type===r.SHAPES.ELIP?(0,p.default)(l,o,s):l.type===r.SHAPES.RREC&&(0,h.default)(l,o,s),i.lastIndex++}this.renderer.bindVao(null);for(var d=0;d<i.data.length;d++)(o=i.data[d]).dirty&&o.upload()},e.prototype.getWebGLData=function(t,e,i){var n=t.data[t.data.length-1];return(!n||n.nativeLines!==i||n.points.length>32e4)&&((n=this.graphicsDataPool.pop()||new a.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=i,n.reset(e),t.data.push(n)),n.dirty=!0,n},e}(o.default);i.default=f,s.default.registerPlugin("graphics",f)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":124,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("pixi-gl-core"),o=(n=r)&&n.__esModule?n:{default:n};var s=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=o.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=o.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=i,this.vao=new o.default.VertexArrayObject(e,n).addIndex(this.indexBuffer).addAttribute(this.buffer,i.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,i.attributes.aColor,e.FLOAT,!1,24,8)}return t.prototype.reset=function(){this.points.length=0,this.indices.length=0},t.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},t.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},t}();i.default=s},{"pixi-gl-core":12}],59:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../../Shader");var o=function(t){function e(i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((n=r)&&n.__esModule?n:{default:n}).default);i.default=o},{"../../../Shader":44}],60:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var n=t.shape,r=n.x,l=n.y,c=void 0,u=void 0;t.type===s.SHAPES.CIRC?(c=n.radius,u=n.radius):(c=n.width,u=n.height);if(0===c||0===u)return;var h=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(n.width+n.height)),p=2*Math.PI/h;if(t.fill){var d=(0,a.hex2rgb)(t.fillColor),f=t.fillAlpha,m=d[0]*f,y=d[1]*f,_=d[2]*f,x=e.points,g=e.indices,v=x.length/6;g.push(v);for(var b=0;b<h+1;b++)x.push(r,l,m,y,_,f),x.push(r+Math.sin(p*b)*c,l+Math.cos(p*b)*u,m,y,_,f),g.push(v++,v++);g.push(v-1)}if(t.lineWidth){var w=t.points;t.points=[];for(var C=0;C<h+1;C++)t.points.push(r+Math.sin(p*C)*c,l+Math.cos(p*C)*u);(0,o.default)(t,e,i),t.points=w}};var n,r=t("./buildLine"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../../const"),a=t("../../../utils")},{"../../../const":46,"../../../utils":124,"./buildLine":61}],61:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){t.nativeLines?function(t,e){var i=0,n=t.points;if(0===n.length)return;var o=e.points,s=n.length/2,a=(0,r.hex2rgb)(t.lineColor),l=t.lineAlpha,c=a[0]*l,u=a[1]*l,h=a[2]*l;for(i=1;i<s;i++){var p=n[2*(i-1)],d=n[2*(i-1)+1],f=n[2*i],m=n[2*i+1];o.push(p,d),o.push(c,u,h,l),o.push(f,m),o.push(c,u,h,l)}}(t,i):function(t,e){var i=t.points;if(0===i.length)return;var o=new n.Point(i[0],i[1]),s=new n.Point(i[i.length-2],i[i.length-1]);if(o.x===s.x&&o.y===s.y){(i=i.slice()).pop(),i.pop();var a=(s=new n.Point(i[i.length-2],i[i.length-1])).x+.5*(o.x-s.x),l=s.y+.5*(o.y-s.y);i.unshift(a,l),i.push(a,l)}var c=e.points,u=e.indices,h=i.length/2,p=i.length,d=c.length/6,f=t.lineWidth/2,m=(0,r.hex2rgb)(t.lineColor),y=t.lineAlpha,_=m[0]*y,x=m[1]*y,g=m[2]*y,v=i[0],b=i[1],w=i[2],C=i[3],S=0,T=0,D=-(b-C),A=v-w,B=0,M=0,P=0,E=0,I=Math.sqrt(D*D+A*A);D/=I,A/=I,D*=f,A*=f,c.push(v-D,b-A,_,x,g,y),c.push(v+D,b+A,_,x,g,y);for(var R=1;R<h-1;++R){v=i[2*(R-1)],b=i[2*(R-1)+1],w=i[2*R],C=i[2*R+1],S=i[2*(R+1)],T=i[2*(R+1)+1],D=-(b-C),A=v-w,I=Math.sqrt(D*D+A*A),D/=I,A/=I,D*=f,A*=f,B=-(C-T),M=w-S,I=Math.sqrt(B*B+M*M),B/=I,M/=I;var O=-A+b-(-A+C),k=-D+w-(-D+v),L=(-D+v)*(-A+C)-(-D+w)*(-A+b),F=-(M*=f)+T-(-M+C),N=-(B*=f)+w-(-B+S),V=(-B+S)*(-M+C)-(-B+w)*(-M+T),j=O*N-F*k;if(Math.abs(j)<.1)j+=10.1,c.push(w-D,C-A,_,x,g,y),c.push(w+D,C+A,_,x,g,y);else{var G=(k*V-N*L)/j,U=(F*L-O*V)/j,z=(G-w)*(G-w)+(U-C)*(U-C);z>196*f*f?(P=D-B,E=A-M,I=Math.sqrt(P*P+E*E),P/=I,E/=I,P*=f,E*=f,c.push(w-P,C-E),c.push(_,x,g,y),c.push(w+P,C+E),c.push(_,x,g,y),c.push(w-P,C-E),c.push(_,x,g,y),p++):(c.push(G,U),c.push(_,x,g,y),c.push(w-(G-w),C-(U-C)),c.push(_,x,g,y))}}v=i[2*(h-2)],b=i[2*(h-2)+1],w=i[2*(h-1)],C=i[2*(h-1)+1],D=-(b-C),A=v-w,I=Math.sqrt(D*D+A*A),D/=I,A/=I,D*=f,A*=f,c.push(w-D,C-A),c.push(_,x,g,y),c.push(w+D,C+A),c.push(_,x,g,y),u.push(d);for(var X=0;X<p;++X)u.push(d++);u.push(d-1)}(t,e)};var n=t("../../../math"),r=t("../../../utils")},{"../../../math":70,"../../../utils":124}],62:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){t.points=t.shape.points.slice();var s=t.points;if(t.fill&&s.length>=6){for(var a=[],l=t.holes,c=0;c<l.length;c++){var u=l[c];a.push(s.length/2),s=s.concat(u.points)}var h=e.points,p=e.indices,d=s.length/2,f=(0,r.hex2rgb)(t.fillColor),m=t.fillAlpha,y=f[0]*m,_=f[1]*m,x=f[2]*m,g=(0,o.default)(s,a,2);if(!g)return;for(var v=h.length/6,b=0;b<g.length;b+=3)p.push(g[b]+v),p.push(g[b]+v),p.push(g[b+1]+v),p.push(g[b+2]+v),p.push(g[b+2]+v);for(var w=0;w<d;w++)h.push(s[2*w],s[2*w+1],y,_,x,m)}t.lineWidth>0&&(0,n.default)(t,e,i)};var n=s(t("./buildLine")),r=t("../../../utils"),o=s(t("earcut"));function s(t){return t&&t.__esModule?t:{default:t}}},{"../../../utils":124,"./buildLine":61,earcut:2}],63:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var n=t.shape,r=n.x,a=n.y,l=n.width,c=n.height;if(t.fill){var u=(0,s.hex2rgb)(t.fillColor),h=t.fillAlpha,p=u[0]*h,d=u[1]*h,f=u[2]*h,m=e.points,y=e.indices,_=m.length/6;m.push(r,a),m.push(p,d,f,h),m.push(r+l,a),m.push(p,d,f,h),m.push(r,a+c),m.push(p,d,f,h),m.push(r+l,a+c),m.push(p,d,f,h),y.push(_,_,_+1,_+2,_+3,_+3)}if(t.lineWidth){var x=t.points;t.points=[r,a,r+l,a,r+l,a+c,r,a+c,r,a],(0,o.default)(t,e,i),t.points=x}};var n,r=t("./buildLine"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../../utils")},{"../../../utils":124,"./buildLine":61}],64:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var s=t.shape,a=s.x,c=s.y,u=s.width,h=s.height,p=s.radius,d=[];if(d.push(a,c+p),l(a,c+h-p,a,c+h,a+p,c+h,d),l(a+u-p,c+h,a+u,c+h,a+u,c+h-p,d),l(a+u,c+p,a+u,c,a+u-p,c,d),l(a+p,c,a,c,a,c+p+1e-10,d),t.fill){for(var f=(0,o.hex2rgb)(t.fillColor),m=t.fillAlpha,y=f[0]*m,_=f[1]*m,x=f[2]*m,g=e.points,v=e.indices,b=g.length/6,w=(0,n.default)(d,null,2),C=0,S=w.length;C<S;C+=3)v.push(w[C]+b),v.push(w[C]+b),v.push(w[C+1]+b),v.push(w[C+2]+b),v.push(w[C+2]+b);for(var T=0,D=d.length;T<D;T++)g.push(d[T],d[++T],y,_,x,m)}if(t.lineWidth){var A=t.points;t.points=d,(0,r.default)(t,e,i),t.points=A}};var n=s(t("earcut")),r=s(t("./buildLine")),o=t("../../../utils");function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e,i){return t+(e-t)*i}function l(t,e,i,n,r,o){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=0,c=0,u=0,h=0,p=0,d=0,f=0,m=0;f<=20;++f)l=a(t,i,m=f/20),c=a(e,n,m),u=a(i,r,m),h=a(n,o,m),p=a(l,u,m),d=a(c,h,m),s.push(p,d);return s}},{"../../../utils":124,"./buildLine":61,earcut:2}],65:[function(t,e,i){"use strict";i.__esModule=!0,i.autoDetectRenderer=i.Application=i.Filter=i.SpriteMaskFilter=i.Quad=i.RenderTarget=i.ObjectRenderer=i.WebGLManager=i.Shader=i.CanvasRenderTarget=i.TextureUvs=i.VideoBaseTexture=i.BaseRenderTexture=i.RenderTexture=i.BaseTexture=i.Texture=i.Spritesheet=i.CanvasGraphicsRenderer=i.GraphicsRenderer=i.GraphicsData=i.Graphics=i.TextMetrics=i.TextStyle=i.Text=i.SpriteRenderer=i.CanvasTinter=i.CanvasSpriteRenderer=i.Sprite=i.TransformBase=i.TransformStatic=i.Transform=i.Container=i.DisplayObject=i.Bounds=i.glCore=i.WebGLRenderer=i.CanvasRenderer=i.ticker=i.utils=i.settings=void 0;var n=t("./const");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return n[t]}})});var r=t("./math");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var o=t("pixi-gl-core");Object.defineProperty(i,"glCore",{enumerable:!0,get:function(){return J(o).default}});var s=t("./display/Bounds");Object.defineProperty(i,"Bounds",{enumerable:!0,get:function(){return J(s).default}});var a=t("./display/DisplayObject");Object.defineProperty(i,"DisplayObject",{enumerable:!0,get:function(){return J(a).default}});var l=t("./display/Container");Object.defineProperty(i,"Container",{enumerable:!0,get:function(){return J(l).default}});var c=t("./display/Transform");Object.defineProperty(i,"Transform",{enumerable:!0,get:function(){return J(c).default}});var u=t("./display/TransformStatic");Object.defineProperty(i,"TransformStatic",{enumerable:!0,get:function(){return J(u).default}});var h=t("./display/TransformBase");Object.defineProperty(i,"TransformBase",{enumerable:!0,get:function(){return J(h).default}});var p=t("./sprites/Sprite");Object.defineProperty(i,"Sprite",{enumerable:!0,get:function(){return J(p).default}});var d=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(i,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return J(d).default}});var f=t("./sprites/canvas/CanvasTinter");Object.defineProperty(i,"CanvasTinter",{enumerable:!0,get:function(){return J(f).default}});var m=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(i,"SpriteRenderer",{enumerable:!0,get:function(){return J(m).default}});var y=t("./text/Text");Object.defineProperty(i,"Text",{enumerable:!0,get:function(){return J(y).default}});var _=t("./text/TextStyle");Object.defineProperty(i,"TextStyle",{enumerable:!0,get:function(){return J(_).default}});var x=t("./text/TextMetrics");Object.defineProperty(i,"TextMetrics",{enumerable:!0,get:function(){return J(x).default}});var g=t("./graphics/Graphics");Object.defineProperty(i,"Graphics",{enumerable:!0,get:function(){return J(g).default}});var v=t("./graphics/GraphicsData");Object.defineProperty(i,"GraphicsData",{enumerable:!0,get:function(){return J(v).default}});var b=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(i,"GraphicsRenderer",{enumerable:!0,get:function(){return J(b).default}});var w=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(i,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return J(w).default}});var C=t("./textures/Spritesheet");Object.defineProperty(i,"Spritesheet",{enumerable:!0,get:function(){return J(C).default}});var S=t("./textures/Texture");Object.defineProperty(i,"Texture",{enumerable:!0,get:function(){return J(S).default}});var T=t("./textures/BaseTexture");Object.defineProperty(i,"BaseTexture",{enumerable:!0,get:function(){return J(T).default}});var D=t("./textures/RenderTexture");Object.defineProperty(i,"RenderTexture",{enumerable:!0,get:function(){return J(D).default}});var A=t("./textures/BaseRenderTexture");Object.defineProperty(i,"BaseRenderTexture",{enumerable:!0,get:function(){return J(A).default}});var B=t("./textures/VideoBaseTexture");Object.defineProperty(i,"VideoBaseTexture",{enumerable:!0,get:function(){return J(B).default}});var M=t("./textures/TextureUvs");Object.defineProperty(i,"TextureUvs",{enumerable:!0,get:function(){return J(M).default}});var P=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(i,"CanvasRenderTarget",{enumerable:!0,get:function(){return J(P).default}});var E=t("./Shader");Object.defineProperty(i,"Shader",{enumerable:!0,get:function(){return J(E).default}});var I=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(i,"WebGLManager",{enumerable:!0,get:function(){return J(I).default}});var R=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(i,"ObjectRenderer",{enumerable:!0,get:function(){return J(R).default}});var O=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(i,"RenderTarget",{enumerable:!0,get:function(){return J(O).default}});var k=t("./renderers/webgl/utils/Quad");Object.defineProperty(i,"Quad",{enumerable:!0,get:function(){return J(k).default}});var L=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(i,"SpriteMaskFilter",{enumerable:!0,get:function(){return J(L).default}});var F=t("./renderers/webgl/filters/Filter");Object.defineProperty(i,"Filter",{enumerable:!0,get:function(){return J(F).default}});var N=t("./Application");Object.defineProperty(i,"Application",{enumerable:!0,get:function(){return J(N).default}});var V=t("./autoDetectRenderer");Object.defineProperty(i,"autoDetectRenderer",{enumerable:!0,get:function(){return V.autoDetectRenderer}});var j=W(t("./utils")),G=W(t("./ticker")),U=J(t("./settings")),z=J(t("./renderers/canvas/CanvasRenderer")),X=J(t("./renderers/webgl/WebGLRenderer"));function W(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function J(t){return t&&t.__esModule?t:{default:t}}i.settings=U.default,i.utils=j,i.ticker=G,i.CanvasRenderer=z.default,i.WebGLRenderer=X.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureUvs":116,"./textures/VideoBaseTexture":117,"./ticker":120,"./utils":124,"pixi-gl-core":12}],66:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./Matrix"),o=(n=r)&&n.__esModule?n:{default:n};var s=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],a=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],l=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],c=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],u=[],h=[];function p(t){return t<0?-1:t>0?1:0}!function(){for(var t=0;t<16;t++){var e=[];h.push(e);for(var i=0;i<16;i++)for(var n=p(s[t]*s[i]+l[t]*a[i]),r=p(a[t]*s[i]+c[t]*a[i]),d=p(s[t]*l[i]+l[t]*c[i]),f=p(a[t]*l[i]+c[t]*c[i]),m=0;m<16;m++)if(s[m]===n&&a[m]===r&&l[m]===d&&c[m]===f){e.push(m);break}}for(var y=0;y<16;y++){var _=new o.default;_.set(s[y],a[y],l[y],c[y],0,0),u.push(_)}}();var d={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return s[t]},uY:function(t){return a[t]},vX:function(t){return l[t]},vY:function(t){return c[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return h[t][e]},sub:function(t,e){return h[t][d.inv(e)]},rotate180:function(t){return 4^t},isSwapWidthHeight:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?d.S:d.N:2*Math.abs(e)<=Math.abs(t)?t>0?d.E:d.W:e>0?t>0?d.SE:d.SW:t>0?d.NE:d.NW},matrixAppendRotationInv:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=u[d.inv(e)];r.tx=i,r.ty=n,t.append(r)}};i.default=d},{"./Matrix":67}],67:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("./Point"),s=(n=o)&&n.__esModule?n:{default:n};var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.a=e,this.b=i,this.c=n,this.d=r,this.tx=o,this.ty=s,this.array=null}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,n,r,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new s.default;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new s.default;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,r=t.y;return e.x=this.d*i*n+-this.c*i*r+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*r+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,o=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},t.prototype.setTransform=function(t,e,i,n,r,o,s,a,l){var c=Math.sin(s),u=Math.cos(s),h=Math.cos(l),p=Math.sin(l),d=-Math.sin(a),f=Math.cos(a),m=u*r,y=c*r,_=-c*o,x=u*o;return this.a=h*m+p*_,this.b=h*y+p*x,this.c=d*m+f*_,this.d=d*y+f*x,this.tx=t+(i*m+n*_),this.ty=e+(i*y+n*x),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,o=-Math.atan2(-n,r),s=Math.atan2(i,e);return Math.abs(o+s)<1e-5?(t.rotation=s,e<0&&r>=0&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,o=t*n-e*i;return this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-n*r)/o,this.ty=-(t*this.ty-e*r)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r(t,null,[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}();i.default=a},{"./Point":69}],68:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._x=n,this._y=r,this.cb=e,this.scope=i}return t.prototype.set=function(t,e){var i=t||0,n=e||(0!==e?i:0);this._x===i&&this._y===n||(this._x=i,this._y=n,this.cb.call(this.scope))},t.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},n(t,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}();i.default=r},{}],69:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){this.set(t.x,t.y)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},t}();i.default=n},{}],70:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Point");Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return p(n).default}});var r=t("./ObservablePoint");Object.defineProperty(i,"ObservablePoint",{enumerable:!0,get:function(){return p(r).default}});var o=t("./Matrix");Object.defineProperty(i,"Matrix",{enumerable:!0,get:function(){return p(o).default}});var s=t("./GroupD8");Object.defineProperty(i,"GroupD8",{enumerable:!0,get:function(){return p(s).default}});var a=t("./shapes/Circle");Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return p(a).default}});var l=t("./shapes/Ellipse");Object.defineProperty(i,"Ellipse",{enumerable:!0,get:function(){return p(l).default}});var c=t("./shapes/Polygon");Object.defineProperty(i,"Polygon",{enumerable:!0,get:function(){return p(c).default}});var u=t("./shapes/Rectangle");Object.defineProperty(i,"Rectangle",{enumerable:!0,get:function(){return p(u).default}});var h=t("./shapes/RoundedRectangle");function p(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"RoundedRectangle",{enumerable:!0,get:function(){return p(h).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./Rectangle"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.radius=n,this.type=s.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,n=this.x-t,r=this.y-e;return(n*=n)+(r*=r)<=i},t.prototype.getBounds=function(){return new o.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();i.default=a},{"../../const":46,"./Rectangle":74}],72:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./Rectangle"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.width=n,this.height=r,this.type=s.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return(i*=i)+(n*=n)<=1},t.prototype.getBounds=function(){return new o.default(this.x-this.width,this.y-this.height,this.width,this.height)},t}();i.default=a},{"../../const":46,"./Rectangle":74}],73:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../Point"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../const");var a=function(){function t(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Array.isArray(i[0])&&(i=i[0]),i[0]instanceof o.default){for(var r=[],a=0,l=i.length;a<l;a++)r.push(i[a].x,i[a].y);i=r}this.closed=!0,this.points=i,this.type=s.SHAPES.POLY}return t.prototype.clone=function(){return new t(this.points.slice())},t.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},t.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,r=0,o=n-1;r<n;o=r++){var s=this.points[2*r],a=this.points[2*r+1],l=this.points[2*o],c=this.points[2*o+1];a>e!=c>e&&t<(e-a)/(c-a)*(l-s)+s&&(i=!i)}return i},t}();i.default=a},{"../../const":46,"../Point":69}],74:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../../const");var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=Number(e),this.y=Number(i),this.width=Number(n),this.height=Number(o),this.type=r.SHAPES.RECT}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},t.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=n,this.height=r-n},n(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}();i.default=o},{"../../const":46}],75:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../const");var r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.width=r,this.height=o,this.radius=s,this.type=n.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),n=e-(this.y+this.radius),r=this.radius*this.radius;if(i*i+n*n<=r)return!0;if((i=t-(this.x+this.width-this.radius))*i+n*n<=r)return!0;if(i*i+(n=e-(this.y+this.height-this.radius))*n<=r)return!0;if((i=t-(this.x+this.radius))*i+n*n<=r)return!0}return!1},t}();i.default=r},{"../../const":46}],76:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../utils"),o=t("../math"),s=t("../const"),a=h(t("../settings")),l=h(t("../display/Container")),c=h(t("../textures/RenderTexture")),u=h(t("eventemitter3"));function h(t){return t&&t.__esModule?t:{default:t}}var p=new o.Matrix,d=function(t){function e(i,n,c,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return(0,r.sayHello)(i),"number"==typeof n&&(n=Object.assign({width:n,height:c||a.default.RENDER_OPTIONS.height},u)),n=Object.assign({},a.default.RENDER_OPTIONS,n),h.options=n,h.type=s.RENDERER_TYPE.UNKNOWN,h.screen=new o.Rectangle(0,0,n.width,n.height),h.view=n.view||document.createElement("canvas"),h.resolution=n.resolution||a.default.RESOLUTION,h.transparent=n.transparent,h.autoResize=n.autoResize||!1,h.blendModes=null,h.preserveDrawingBuffer=n.preserveDrawingBuffer,h.clearBeforeRender=n.clearBeforeRender,h.roundPixels=n.roundPixels,h._backgroundColor=0,h._backgroundColorRgba=[0,0,0,0],h._backgroundColorString="#000000",h.backgroundColor=n.backgroundColor||h._backgroundColor,h._tempDisplayObjectParent=new l.default,h._lastObjectRendered=h._tempDisplayObjectParent,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,i){var n=t.getLocalBounds(),r=c.default.create(0|n.width,0|n.height,e,i);return p.tx=-n.x,p.ty=-n.y,this.render(t,r,!1,p,!0),r},e.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=s.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},n(e,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,r.hex2string)(t),(0,r.hex2rgb)(t,this._backgroundColorRgba)}}]),e}(u.default);i.default=d},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":124,eventemitter3:3}],77:[function(t,e,i){"use strict";i.__esModule=!0;var n=u(t("../SystemRenderer")),r=u(t("./utils/CanvasMaskManager")),o=u(t("./utils/CanvasRenderTarget")),s=u(t("./utils/mapCanvasBlendModesToPixi")),a=t("../../utils"),l=t("../../const"),c=u(t("../../settings"));function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(i,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"Canvas",i,n,o));return a.type=l.RENDERER_TYPE.CANVAS,a.rootContext=a.view.getContext("2d",{alpha:a.transparent}),a.context=a.rootContext,a.refresh=!0,a.maskManager=new r.default(a),a.smoothProperty="imageSmoothingEnabled",a.rootContext.imageSmoothingEnabled||(a.rootContext.webkitImageSmoothingEnabled?a.smoothProperty="webkitImageSmoothingEnabled":a.rootContext.mozImageSmoothingEnabled?a.smoothProperty="mozImageSmoothingEnabled":a.rootContext.oImageSmoothingEnabled?a.smoothProperty="oImageSmoothingEnabled":a.rootContext.msImageSmoothingEnabled&&(a.smoothProperty="msImageSmoothingEnabled")),a.initPlugins(),a.blendModes=(0,s.default)(),a._activeBlendMode=null,a.renderingToScreen=!1,a.resize(a.options.width,a.options.height),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t,e,i,n,r){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var s=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new o.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var a=this.context;if(e||(this._lastObjectRendered=t),!r){var c=t.parent,u=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(u),this._tempDisplayObjectParent.transform._worldID=-1):u.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=c}a.setTransform(1,0,0,1,0,0),a.globalAlpha=1,this._activeBlendMode=l.BLEND_MODES.NORMAL,a.globalCompositeOperation=this.blendModes[l.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(a.fillStyle="black",a.clear()),(void 0!==i?i:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?a.clearRect(0,0,this.width,this.height):(a.fillStyle=this._backgroundColorString,a.fillRect(0,0,this.width,this.height)));var h=this.context;this.context=a,t.renderCanvas(this),this.context=h,this.resolution=s,this.emit("postrender")}},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){this.destroyPlugins(),t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.smoothProperty&&(this.rootContext[this.smoothProperty]=c.default.SCALE_MODE===l.SCALE_MODES.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e}(n.default);i.default=h,a.pluginTarget.mixin(h)},{"../../const":46,"../../settings":101,"../../utils":124,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../../../const");var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e}return t.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var i=t.alpha,n=t.transform.worldTransform,r=e.resolution;e.context.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r,n.ty*r),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=i},t.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,i=t.graphicsData.length;if(0!==i){e.beginPath();for(var r=0;r<i;r++){var o=t.graphicsData[r],s=o.shape;if(o.type===n.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var l=1;l<a.length/2;l++)e.lineTo(a[2*l],a[2*l+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(o.type===n.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(o.type===n.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(o.type===n.SHAPES.ELIP){var c=2*s.width,u=2*s.height,h=s.x-c/2,p=s.y-u/2,d=c/2*.5522848,f=u/2*.5522848,m=h+c,y=p+u,_=h+c/2,x=p+u/2;e.moveTo(h,x),e.bezierCurveTo(h,x-f,_-d,p,_,p),e.bezierCurveTo(_+d,p,m,x-f,m,x),e.bezierCurveTo(m,x+f,_+d,y,_,y),e.bezierCurveTo(_-d,y,h,x+f,h,x),e.closePath()}else if(o.type===n.SHAPES.RREC){var g=s.x,v=s.y,b=s.width,w=s.height,C=s.radius,S=Math.min(b,w)/2|0;C=C>S?S:C,e.moveTo(g,v+C),e.lineTo(g,v+w-C),e.quadraticCurveTo(g,v+w,g+C,v+w),e.lineTo(g+b-C,v+w),e.quadraticCurveTo(g+b,v+w,g+b,v+w-C),e.lineTo(g+b,v+C),e.quadraticCurveTo(g+b,v,g+b-C,v),e.lineTo(g+C,v),e.quadraticCurveTo(g,v,g,v+C),e.closePath()}}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();i.default=r},{"../../../const":46}],79:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("../../../settings"),s=(n=o)&&n.__esModule?n:{default:n};var a=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||s.default.RESOLUTION,this.resize(e,i)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},r(t,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),t}();i.default=a},{"../../../settings":101}],80:[function(t,e,i){"use strict";function n(t){var e=document.createElement("canvas");e.width=6,e.height=1;var i=e.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,6,1),e}i.__esModule=!0,i.default=function(){if("undefined"==typeof document)return!1;var t=n("#ff00ff"),e=n("#ffff00"),i=document.createElement("canvas");i.width=6,i.height=1;var r=i.getContext("2d");r.globalCompositeOperation="multiply",r.drawImage(t,0,0),r.drawImage(e,2,0);var o=r.getImageData(2,0,1,1);if(!o)return!1;var s=o.data;return 255===s[0]&&0===s[1]&&0===s[2]}},{}],81:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,s.default)()?(t[r.BLEND_MODES.NORMAL]="source-over",t[r.BLEND_MODES.ADD]="lighter",t[r.BLEND_MODES.MULTIPLY]="multiply",t[r.BLEND_MODES.SCREEN]="screen",t[r.BLEND_MODES.OVERLAY]="overlay",t[r.BLEND_MODES.DARKEN]="darken",t[r.BLEND_MODES.LIGHTEN]="lighten",t[r.BLEND_MODES.COLOR_DODGE]="color-dodge",t[r.BLEND_MODES.COLOR_BURN]="color-burn",t[r.BLEND_MODES.HARD_LIGHT]="hard-light",t[r.BLEND_MODES.SOFT_LIGHT]="soft-light",t[r.BLEND_MODES.DIFFERENCE]="difference",t[r.BLEND_MODES.EXCLUSION]="exclusion",t[r.BLEND_MODES.HUE]="hue",t[r.BLEND_MODES.SATURATION]="saturate",t[r.BLEND_MODES.COLOR]="color",t[r.BLEND_MODES.LUMINOSITY]="luminosity"):(t[r.BLEND_MODES.NORMAL]="source-over",t[r.BLEND_MODES.ADD]="lighter",t[r.BLEND_MODES.MULTIPLY]="source-over",t[r.BLEND_MODES.SCREEN]="source-over",t[r.BLEND_MODES.OVERLAY]="source-over",t[r.BLEND_MODES.DARKEN]="source-over",t[r.BLEND_MODES.LIGHTEN]="source-over",t[r.BLEND_MODES.COLOR_DODGE]="source-over",t[r.BLEND_MODES.COLOR_BURN]="source-over",t[r.BLEND_MODES.HARD_LIGHT]="source-over",t[r.BLEND_MODES.SOFT_LIGHT]="source-over",t[r.BLEND_MODES.DIFFERENCE]="source-over",t[r.BLEND_MODES.EXCLUSION]="source-over",t[r.BLEND_MODES.HUE]="source-over",t[r.BLEND_MODES.SATURATION]="source-over",t[r.BLEND_MODES.COLOR]="source-over",t[r.BLEND_MODES.LUMINOSITY]="source-over");return t[r.BLEND_MODES.NORMAL_NPM]=t[r.BLEND_MODES.NORMAL],t[r.BLEND_MODES.ADD_NPM]=t[r.BLEND_MODES.ADD],t[r.BLEND_MODES.SCREEN_NPM]=t[r.BLEND_MODES.SCREEN],t};var n,r=t("../../../const"),o=t("./canUseNewCanvasBlendModes"),s=(n=o)&&n.__esModule?n:{default:n}},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../const"),o=t("../../settings"),s=(n=o)&&n.__esModule?n:{default:n};var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=s.default.GC_MAX_IDLE,this.checkCountMax=s.default.GC_MAX_CHECK_COUNT,this.mode=s.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==r.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},t.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,i=!1,n=0;n<e.length;n++){var r=e[n];!r._glRenderTargets&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[n]=null,i=!0)}if(i){for(var o=0,s=0;s<e.length;s++)null!==e[s]&&(e[o++]=e[s]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture,!0);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t}();i.default=a},{"../../const":46,"../../settings":101}],83:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("pixi-gl-core"),o=t("../../const"),s=t("./utils/RenderTarget"),a=(n=s)&&n.__esModule?n:{default:n},l=t("../../utils");var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(t,e){var i=this.gl,n=!!t._glRenderTargets;if(!t.hasLoaded)return null;var s=this.renderer.boundTextures;if(void 0===e){e=0;for(var l=0;l<s.length;++l)if(s[l]===t){e=l;break}}s[e]=t,i.activeTexture(i.TEXTURE0+e);var c=t._glTextures[this.renderer.CONTEXT_UID];if(c)n?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):c.upload(t.source);else{if(n){var u=new a.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);u.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=u,c=u.texture}else(c=new r.GLTexture(this.gl,null,null,null,null)).bind(e),c.premultiplyAlpha=!0,c.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=c,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&c.enableMipmap(),t.wrapMode===o.WRAP_MODES.CLAMP?c.enableWrapClamp():t.wrapMode===o.WRAP_MODES.REPEAT?c.enableWrapRepeat():c.enableWrapMirrorRepeat()):c.enableWrapClamp(),t.scaleMode===o.SCALE_MODES.NEAREST?c.enableNearestScaling():c.enableLinearScaling()}return c},t.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded){var i=this.renderer.CONTEXT_UID,n=t._glTextures,r=t._glRenderTargets;if(n[i]&&(this.renderer.unbindTexture(t),n[i].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete n[i],!e)){var o=this._managedTextures.indexOf(t);-1!==o&&(0,l.removeItems)(this._managedTextures,o,1)}r&&r[i]&&(r[i].destroy(),delete r[i])}},t.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();i.default=c},{"../../const":46,"../../utils":124,"./utils/RenderTarget":96,"pixi-gl-core":12}],84:[function(t,e,i){"use strict";i.__esModule=!0;var n=x(t("../SystemRenderer")),r=x(t("./managers/MaskManager")),o=x(t("./managers/StencilManager")),s=x(t("./managers/FilterManager")),a=x(t("./utils/RenderTarget")),l=x(t("./utils/ObjectRenderer")),c=x(t("./TextureManager")),u=x(t("../../textures/BaseTexture")),h=x(t("./TextureGarbageCollector")),p=x(t("./WebGLState")),d=x(t("./utils/mapWebGLDrawModesToPixi")),f=x(t("./utils/validateContext")),m=t("../../utils"),y=x(t("pixi-gl-core")),_=t("../../const");function x(t){return t&&t.__esModule?t:{default:t}}var g=0,v=function(t){function e(i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"WebGL",i,n,s));return a.legacy=a.options.legacy,a.legacy&&(y.default.VertexArrayObject.FORCE_NATIVE=!0),a.type=_.RENDERER_TYPE.WEBGL,a.handleContextLost=a.handleContextLost.bind(a),a.handleContextRestored=a.handleContextRestored.bind(a),a.view.addEventListener("webglcontextlost",a.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",a.handleContextRestored,!1),a._contextOptions={alpha:a.transparent,antialias:a.options.antialias,premultipliedAlpha:a.transparent&&"notMultiplied"!==a.transparent,stencil:!0,preserveDrawingBuffer:a.options.preserveDrawingBuffer,powerPreference:a.options.powerPreference},a._backgroundColorRgba[3]=a.transparent?0:1,a.maskManager=new r.default(a),a.stencilManager=new o.default(a),a.emptyRenderer=new l.default(a),a.currentRenderer=a.emptyRenderer,a.textureManager=null,a.filterManager=null,a.initPlugins(),a.options.context&&(0,f.default)(a.options.context),a.gl=a.options.context||y.default.createContext(a.view,a._contextOptions),a.CONTEXT_UID=g++,a.state=new p.default(a.gl),a.renderingToScreen=!0,a.boundTextures=null,a._activeShader=null,a._activeVao=null,a._activeRenderTarget=null,a._initContext(),a.drawModes=(0,d.default)(a.gl),a._nextTextureLocation=0,a.setBlendMode(0),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this.textureManager=new c.default(this),this.filterManager=new s.default(this),this.textureGC=new h.default(this),this.state.resetToDefault(),this.rootRenderTarget=new a.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var i=new y.default.GLTexture.fromData(t,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var r=0;r<e;r++){var o=new u.default;o._glTextures[this.CONTEXT_UID]=i,this.boundTextures[r]=n,this.emptyTextures[r]=o,this.bindTexture(null,r)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},e.prototype.render=function(t,e,i,n,r){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!r){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.bindRenderTexture(e,n),this.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.resize=function(t,e){n.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},e.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},e.prototype.clear=function(t){this._activeRenderTarget.clear(t)},e.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},e.prototype.clearRenderTexture=function(t,e){var i=t.baseTexture._glRenderTargets[this.CONTEXT_UID];return i&&i.clear(e),this},e.prototype.bindRenderTexture=function(t,e){var i=void 0;if(t){var n=t.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),(i=n._glRenderTargets[this.CONTEXT_UID]).setFrame(t.frame)}else i=this.rootRenderTarget;return i.transform=e,this.bindRenderTarget(i),this},e.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},e.prototype.bindShader=function(t,e){return this._activeShader!==t&&(this._activeShader=t,t.bind(),!1!==e&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},e.prototype.bindTexture=function(t,e,i){if((t=(t=t||this.emptyTextures[e]).baseTexture||t).touched=this.textureGC.count,i)e=e||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===t)return n;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var r=this.gl,o=t._glTextures[this.CONTEXT_UID];return o?(this.boundTextures[e]=t,r.activeTexture(r.TEXTURE0+e),r.bindTexture(r.TEXTURE_2D,o.texture)):this.textureManager.updateTexture(t,e),e},e.prototype.unbindTexture=function(t){var e=this.gl;t=t.baseTexture||t;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===t&&(this.boundTextures[i]=this.emptyTextures[i],e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture));return this},e.prototype.createVao=function(){return new y.default.VertexArrayObject(this.gl,this.state.attribState)},e.prototype.bindVao=function(t){return this._activeVao===t?this:(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t,this)},e.prototype.reset=function(){return this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this.rootRenderTarget.activate(),this.state.resetToDefault(),this},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},e.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),t.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},e}(n.default);i.default=v,m.pluginTarget.mixin(v)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":124,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":12}],85:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./utils/mapWebGLBlendModesToPixi"),o=(n=r)&&n.__esModule?n:{default:n};var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,o.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},t.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},t.prototype.setState=function(t){this.setBlend(t[0]),this.setDepthTest(t[1]),this.setFrontFace(t[2]),this.setCullFace(t[3]),this.setBlendMode(t[4])},t.prototype.setBlend=function(t){t=t?1:0,this.activeState[0]!==t&&(this.activeState[0]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(t){if(t!==this.activeState[4]){this.activeState[4]=t;var e=this.blendModes[t];2===e.length?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},t.prototype.setDepthTest=function(t){t=t?1:0,this.activeState[1]!==t&&(this.activeState[1]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(t){t=t?1:0,this.activeState[3]!==t&&(this.activeState[3]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(t){t=t?1:0,this.activeState[2]!==t&&(this.activeState[2]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var i=1;i<this.maxAttribs;i++)this.gl.disableVertexAttribArray(i)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();i.default=s},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=l(t("./extractUniformsFromSrc")),o=t("../../../utils"),s=t("../../../const"),a=l(t("../../../settings"));function l(t){return t&&t.__esModule?t:{default:t}}var c={},u=function(){function t(e,i,n){for(var l in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this._blendMode=s.BLEND_MODES.NORMAL,this.uniformData=n||(0,r.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[l]=this.uniformData[l].value,this.uniformData[l].type&&(this.uniformData[l].type=this.uniformData[l].type.toLowerCase());this.glShaders={},c[this.vertexSrc+this.fragmentSrc]||(c[this.vertexSrc+this.fragmentSrc]=(0,o.uid)()),this.glShaderKey=c[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=a.default.RESOLUTION,this.enabled=!0,this.autoFit=!0}return t.prototype.apply=function(t,e,i,n,r){t.applyFilter(this,e,i,n)},n(t,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),t}();i.default=u},{"../../../const":46,"../../../settings":101,"../../../utils":124,"./extractUniformsFromSrc":87}],87:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var n=s(t),r=s(e);return Object.assign(n,r)};var n,r=t("pixi-gl-core");var o=((n=r)&&n.__esModule?n:{default:n}).default.shader.defaultValue;function s(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),i={},n=void 0,r=t.replace(/\s+/g," ").split(/\s*;\s*/),s=0;s<r.length;s++){var a=r[s].trim();if(a.indexOf("uniform")>-1){var l=a.split(" "),c=l[1],u=l[2],h=1;u.indexOf("[")>-1&&(u=(n=u.split(/\[|]/))[0],h*=Number(n[1])),u.match(e)||(i[u]={value:o(c,h),name:u,type:c})}}return i}},{"pixi-gl-core":12}],88:[function(t,e,i){"use strict";i.__esModule=!0,i.calculateScreenSpaceMatrix=function(t,e,i){var n=t.identity();return n.translate(e.x/i.width,e.y/i.height),n.scale(i.width,i.height),n},i.calculateNormalizedScreenSpaceMatrix=function(t,e,i){var n=t.identity();n.translate(e.x/i.width,e.y/i.height);var r=i.width/e.width,o=i.height/e.height;return n.scale(r,o),n},i.calculateSpriteMatrix=function(t,e,i,r){var o=r._texture.baseTexture,s=t.set(i.width,0,0,i.height,e.x,e.y),a=r.worldTransform.copy(n.Matrix.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(r.anchor.x,r.anchor.y),s};var n=t("../../../math")},{"../../../math":70}],89:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../Filter"),o=(n=r)&&n.__esModule?n:{default:n},s=t("../../../../math");t("path");var a=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new s.Matrix,r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return i.renderable=!1,r.maskSprite=i,r.maskMatrix=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var n=this.maskSprite;this.uniforms.mask=n._texture,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n),this.uniforms.alpha=n.worldAlpha,t.applyFilter(this,e,i)},e}(o.default);i.default=a},{"../../../../math":70,"../Filter":86,path:23}],90:[function(t,e,i){"use strict";i.__esModule=!0;var n=u(t("./WebGLManager")),r=u(t("../utils/RenderTarget")),o=u(t("../utils/Quad")),s=t("../../../math"),a=u(t("../../../Shader")),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../filters/filterTransforms")),c=u(t("bit-twiddle"));function u(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var p=function t(){h(this,t),this.renderTarget=null,this.sourceFrame=new s.Rectangle,this.destinationFrame=new s.Rectangle,this.filters=[],this.target=null,this.resolution=1},d=function(t){function e(i){h(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.gl=n.renderer.gl,n.quad=new o.default(n.gl,i.state.attribState),n.shaderCache={},n.pool={},n.filterData=null,n.managedFilters=[],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushFilter=function(t,e){var i=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var r=new p;r.sourceFrame=r.destinationFrame=this.renderer._activeRenderTarget.size,r.renderTarget=i._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[r]},this.filterData=n}var o=n.stack[++n.index];o||(o=n.stack[n.index]=new p);var s=e[0].resolution,a=0|e[0].padding,l=t.filterArea||t.getBounds(!0),c=o.sourceFrame,u=o.destinationFrame;c.x=(l.x*s|0)/s,c.y=(l.y*s|0)/s,c.width=(l.width*s|0)/s,c.height=(l.height*s|0)/s,n.stack[0].renderTarget.transform||e[0].autoFit&&c.fit(n.stack[0].destinationFrame),c.pad(a),u.width=c.width,u.height=c.height;var h=this.getPotRenderTarget(i.gl,c.width,c.height,s);o.target=t,o.filters=e,o.resolution=s,o.renderTarget=h,h.setFrame(u,c),i.bindRenderTarget(h),h.clear()},e.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],i=t.stack[t.index];this.quad.map(i.renderTarget.size,i.sourceFrame).upload();var n=i.filters;if(1===n.length)n[0].apply(this,i.renderTarget,e.renderTarget,!1,i),this.freePotRenderTarget(i.renderTarget);else{var r=i.renderTarget,o=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,i.resolution);o.setFrame(i.destinationFrame,i.sourceFrame),o.clear();var s=0;for(s=0;s<n.length-1;++s){n[s].apply(this,r,o,!0,i);var a=r;r=o,o=a}n[s].apply(this,r,e.renderTarget,!1,i),this.freePotRenderTarget(r),this.freePotRenderTarget(o)}t.index--,0===t.index&&(this.filterData=null)},e.prototype.applyFilter=function(t,e,i,n){var r=this.renderer,o=r.gl,s=t.glShaders[r.CONTEXT_UID];s||(t.glShaderKey?(s=this.shaderCache[t.glShaderKey])||(s=new a.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[r.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=s):s=t.glShaders[r.CONTEXT_UID]=new a.default(this.gl,t.vertexSrc,t.fragmentSrc),this.managedFilters.push(t),r.bindVao(null),this.quad.initVao(s)),r.bindVao(this.quad.vao),r.bindRenderTarget(i),n&&(o.disable(o.SCISSOR_TEST),r.clear(),o.enable(o.SCISSOR_TEST)),i===r.maskManager.scissorRenderTarget&&r.maskManager.pushScissorMask(null,r.maskManager.scissorData),r.bindShader(s);var l=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=l,this.syncUniforms(s,t),r.state.setBlendMode(t.blendMode),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),o.bindTexture(o.TEXTURE_2D,l._glTextures[this.renderer.CONTEXT_UID].texture)},e.prototype.syncUniforms=function(t,e){var i=e.uniformData,n=e.uniforms,r=1,o=void 0;if(t.uniforms.filterArea){o=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=o.renderTarget.size.width,s[1]=o.renderTarget.size.height,s[2]=o.sourceFrame.x,s[3]=o.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.filterClamp){o=o||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(o.sourceFrame.width-1)/o.renderTarget.size.width,a[3]=(o.sourceFrame.height-1)/o.renderTarget.size.height,t.uniforms.filterClamp=a}for(var l in i){var c=i[l].type;if("sampler2d"===c&&0!==n[l]){if(n[l].baseTexture)t.uniforms[l]=this.renderer.bindTexture(n[l].baseTexture,r);else{t.uniforms[l]=r;var u=this.renderer.gl;this.renderer.boundTextures[r]=this.renderer.emptyTextures[r],u.activeTexture(u.TEXTURE0+r),n[l].texture.bind()}r++}else if("mat3"===c)void 0!==n[l].a?t.uniforms[l]=n[l].toArray(!0):t.uniforms[l]=n[l];else if("vec2"===c)if(void 0!==n[l].x){var h=t.uniforms[l]||new Float32Array(2);h[0]=n[l].x,h[1]=n[l].y,t.uniforms[l]=h}else t.uniforms[l]=n[l];else"float"===c?t.uniforms.data[l].value!==i[l]&&(t.uniforms[l]=n[l]):t.uniforms[l]=n[l]}},e.prototype.getRenderTarget=function(t,e){var i=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,e||i.resolution);return n.setFrame(i.destinationFrame,i.sourceFrame),n},e.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},e.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},e.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return l.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.filterData.stack[this.filterData.index];return l.calculateSpriteMatrix(t,i.sourceFrame,i.renderTarget.size,e)},e.prototype.destroy=function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.renderer,i=this.managedFilters,n=0;n<i.length;n++)t||i[n].glShaders[e.CONTEXT_UID].destroy(),delete i[n].glShaders[e.CONTEXT_UID];this.shaderCache={},t?this.pool={}:this.emptyPool()},e.prototype.getPotRenderTarget=function(t,e,i,n){var o=(65535&(e=c.default.nextPow2(e*n)))<<16|65535&(i=c.default.nextPow2(i*n));this.pool[o]||(this.pool[o]=[]);var s=this.pool[o].pop();if(!s){var a=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),s=new r.default(t,e,i,null,1),t.bindTexture(t.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)}return s.resolution=n,s.defaultFrame.width=s.size.width=e/n,s.defaultFrame.height=s.size.height=i/n,s},e.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.pool={}},e.prototype.freePotRenderTarget=function(t){var e=(65535&t.size.width*t.resolution)<<16|65535&t.size.height*t.resolution;this.pool[e].push(t)},e}(n.default);i.default=d},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(t,e,i){"use strict";i.__esModule=!0;var n=o(t("./WebGLManager")),r=o(t("../filters/spriteMask/SpriteMaskFilter"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.scissor=!1,n.scissorData=null,n.scissorRenderTarget=null,n.enableScissor=!0,n.alphaMaskPool=[],n.alphaMaskIndex=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,n=Math.atan2(i.b,i.a);(n=Math.round(n*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new r.default(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e,t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,i),this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,n=e.getBounds();n.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var r=this.renderer.resolution;this.renderer.gl.scissor(n.x*r,(i.root?i.size.height-n.y-n.height:n.y)*r,n.width*r,n.height*r),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(n.default);i.default=s},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./WebGLManager"),o=(n=r)&&n.__esModule?n:{default:n};var s=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.stencilMaskStack=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},e.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},e.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(e),this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},e.prototype.destroy=function(){o.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},e}(o.default);i.default=s},{"./WebGLManager":93}],93:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();i.default=n},{}],94:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../managers/WebGLManager");var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(((n=r)&&n.__esModule?n:{default:n}).default);i.default=o},{"../managers/WebGLManager":93}],95:[function(t,e,i){"use strict";i.__esModule=!0;var n=o(t("pixi-gl-core")),r=o(t("../../../utils/createIndicesForQuads"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var o=0;o<4;o++)this.interleaved[4*o]=this.vertices[2*o],this.interleaved[4*o+1]=this.vertices[2*o+1],this.interleaved[4*o+2]=this.uvs[2*o],this.interleaved[4*o+3]=this.uvs[2*o+1];this.indices=(0,r.default)(1),this.vertexBuffer=n.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=n.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new n.default.VertexArrayObject(e,i)}return t.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},t.prototype.map=function(t,e){var i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this},t.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},t.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},t}();i.default=s},{"../../../utils/createIndicesForQuads":122,"pixi-gl-core":12}],96:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../../math"),o=t("../../../const"),s=t("../../../settings"),a=(n=s)&&n.__esModule?n:{default:n},l=t("pixi-gl-core");var c=function(){function t(e,i,n,s,c,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new r.Rectangle(0,0,1,1),this.resolution=c||a.default.RESOLUTION,this.projectionMatrix=new r.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new r.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=void 0!==s?s:a.default.SCALE_MODE,this.root=u,this.root?(this.frameBuffer=new l.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=l.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===o.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(i,n)}return t.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},t.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},t.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},t.prototype.calculateProjection=function(t,e){var i=this.projectionMatrix;e=e||t,i.identity(),this.root?(i.a=1/t.width*2,i.d=-1/t.height*2,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2,i.d=1/t.height*2,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},t.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var i=this.frame||this.size;this.calculateProjection(i)}},t.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},t}();i.default=c},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":12}],97:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=!e;if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(i){var n=document.createElement("canvas");n.width=1,n.height=1,e=o.default.createContext(n)}var r=e.createShader(e.FRAGMENT_SHADER);for(;;){var l=s.replace(/%forloop%/gi,a(t));if(e.shaderSource(r,l),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}i&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext();return t};var n,r=t("pixi-gl-core"),o=(n=r)&&n.__esModule?n:{default:n};var s=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function a(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}},{"pixi-gl-core":12}],98:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[n.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[n.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[n.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.DST_ALPHA,t.ONE,t.DST_ALPHA],e[n.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_COLOR],e};var n=t("../../../const")},{"../../../const":46}],99:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[n.DRAW_MODES.POINTS]=t.POINTS,e[n.DRAW_MODES.LINES]=t.LINES,e[n.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[n.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[n.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[n.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[n.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e};var n=t("../../../const")},{"../../../const":46}],100:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],101:[function(t,e,i){"use strict";i.__esModule=!0;var n=o(t("./utils/maxRecommendedTextures")),r=o(t("./utils/canUploadSameBuffer"));function o(t){return t&&t.__esModule?t:{default:t}}i.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,n.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,r.default)()}},{"./utils/canUploadSameBuffer":121,"./utils/maxRecommendedTextures":126}],102:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../math"),o=t("../utils"),s=t("../const"),a=c(t("../textures/Texture")),l=c(t("../display/Container"));function c(t){return t&&t.__esModule?t:{default:t}}var u=new r.Point,h=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._anchor=new r.ObservablePoint(n._onAnchorUpdate,n),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=s.BLEND_MODES.NORMAL,n.shader=null,n.cachedTint=16777215,n.texture=i||a.default.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.pluginName="sprite",n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,o.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,o.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,i=e.a,n=e.b,r=e.c,o=e.d,s=e.tx,a=e.ty,l=this.vertexData,c=t.trim,u=t.orig,h=this._anchor,p=0,d=0,f=0,m=0;c?(p=(d=c.x-h._x*u.width)+c.width,f=(m=c.y-h._y*u.height)+c.height):(p=(d=-h._x*u.width)+u.width,f=(m=-h._y*u.height)+u.height),l[0]=i*d+r*m+s,l[1]=o*m+n*d+a,l[2]=i*p+r*m+s,l[3]=o*m+n*p+a,l[4]=i*p+r*f+s,l[5]=o*f+n*p+a,l[6]=i*d+r*f+s,l[7]=o*f+n*d+a}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,n=this._anchor,r=this.transform.worldTransform,o=r.a,s=r.b,a=r.c,l=r.d,c=r.tx,u=r.ty,h=-n._x*i.width,p=h+i.width,d=-n._y*i.height,f=d+i.height;e[0]=o*h+a*d+c,e[1]=l*d+s*h+u,e[2]=o*p+a*d+c,e[3]=l*d+s*p+u,e[4]=o*p+a*f+c,e[5]=l*f+s*p+u,e[6]=o*h+a*f+c,e[7]=l*f+s*h+u},e.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x,r=0;return u.x>=n&&u.x<n+e&&(r=-i*this.anchor.y,u.y>=r&&u.y<r+i)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null,this.shader=null},e.from=function(t){return new e(a.default.from(t))},e.fromFrame=function(t){var i=o.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new e(i)},e.fromImage=function(t,i,n){return new e(a.default.fromImage(t,i,n))},n(e,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,o.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,o.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),e}(l.default);i.default=h},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":124}],103:[function(t,e,i){"use strict";i.__esModule=!0;var n=a(t("../../renderers/canvas/CanvasRenderer")),r=t("../../const"),o=t("../../math"),s=a(t("./CanvasTinter"));function a(t){return t&&t.__esModule?t:{default:t}}var l=new o.Matrix,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e}return t.prototype.render=function(t){var e=t._texture,i=this.renderer,n=e._frame.width,a=e._frame.height,c=t.transform.worldTransform,u=0,h=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(i.setBlendMode(t.blendMode),e.valid)){i.context.globalAlpha=t.worldAlpha;var p=e.baseTexture.scaleMode===r.SCALE_MODES.LINEAR;i.smoothProperty&&i.context[i.smoothProperty]!==p&&(i.context[i.smoothProperty]=p),e.trim?(u=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(u=(.5-t.anchor.x)*e.orig.width,h=(.5-t.anchor.y)*e.orig.height),e.rotate&&(c.copy(l),c=l,o.GroupD8.matrixAppendRotationInv(c,e.rotate,u,h),u=0,h=0),u-=n/2,h-=a/2,i.roundPixels?(i.context.setTransform(c.a,c.b,c.c,c.d,c.tx*i.resolution|0,c.ty*i.resolution|0),u|=0,h|=0):i.context.setTransform(c.a,c.b,c.c,c.d,c.tx*i.resolution,c.ty*i.resolution);var d=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint===t.tint&&t.tintedTexture.tintId===t._texture._updateID||(t.cachedTint=t.tint,t.tintedTexture=s.default.getTintedTexture(t,t.tint)),i.context.drawImage(t.tintedTexture,0,0,n*d,a*d,u*i.resolution,h*i.resolution,n*i.resolution,a*i.resolution)):i.context.drawImage(e.baseTexture.source,e._frame.x*d,e._frame.y*d,n*d,a*d,u*i.resolution,h*i.resolution,n*i.resolution,a*i.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();i.default=c,n.default.registerPlugin("sprite",c)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../utils"),o=t("../../renderers/canvas/utils/canUseNewCanvasBlendModes");var s={getTintedTexture:function(t,e){var i=t._texture,n="#"+("00000"+(0|(e=s.roundColor(e))).toString(16)).substr(-6);i.tintCache=i.tintCache||{};var r=i.tintCache[n],o=void 0;if(r){if(r.tintId===i._updateID)return i.tintCache[n];o=i.tintCache[n]}else o=s.canvas||document.createElement("canvas");if(s.tintMethod(i,e,o),o.tintId=i._updateID,s.convertTintToImage){var a=new Image;a.src=o.toDataURL(),i.tintCache[n]=a}else i.tintCache[n]=o,s.canvas=null;return o},tintWithMultiply:function(t,e,i){var n=i.getContext("2d"),r=t._frame.clone(),o=t.baseTexture.resolution;r.x*=o,r.y*=o,r.width*=o,r.height*=o,i.width=Math.ceil(r.width),i.height=Math.ceil(r.height),n.save(),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.restore()},tintWithOverlay:function(t,e,i){var n=i.getContext("2d"),r=t._frame.clone(),o=t.baseTexture.resolution;r.x*=o,r.y*=o,r.width*=o,r.height*=o,i.width=Math.ceil(r.width),i.height=Math.ceil(r.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,r.width,r.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height),n.restore()},tintWithPerPixel:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),s=t.baseTexture.resolution;o.x*=s,o.y*=s,o.width*=s,o.height*=s,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.save(),n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.restore();for(var a=(0,r.hex2rgb)(e),l=a[0],c=a[1],u=a[2],h=n.getImageData(0,0,o.width,o.height),p=h.data,d=0;d<p.length;d+=4)p[d+0]*=l,p[d+1]*=c,p[d+2]*=u;n.putImageData(h,0,0)},roundColor:function(t){var e=s.cacheStepsPerColorChannel,i=(0,r.hex2rgb)(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),(0,r.rgb2hex)(i)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,((n=o)&&n.__esModule?n:{default:n}).default)(),tintMethod:0};s.tintMethod=s.canUseMultiply?s.tintWithMultiply:s.tintWithPerPixel,i.default=s},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":124}],105:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();i.default=n},{}],106:[function(t,e,i){"use strict";i.__esModule=!0;var n=d(t("../../renderers/webgl/utils/ObjectRenderer")),r=d(t("../../renderers/webgl/WebGLRenderer")),o=d(t("../../utils/createIndicesForQuads")),s=d(t("./generateMultiTextureShader")),a=d(t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),l=d(t("./BatchBuffer")),c=d(t("../../settings")),u=t("../../utils"),h=d(t("pixi-gl-core")),p=d(t("bit-twiddle"));function d(t){return t&&t.__esModule?t:{default:t}}var f=0,m=0,y=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));n.vertSize=5,n.vertByteSize=4*n.vertSize,n.size=c.default.SPRITE_BATCH_SIZE,n.buffers=[];for(var r=1;r<=p.default.nextPow2(n.size);r*=2)n.buffers.push(new l.default(4*r*n.vertByteSize));n.indices=(0,o.default)(n.size),n.shader=null,n.currentIndex=0,n.groups=[];for(var s=0;s<n.size;s++)n.groups[s]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return n.sprites=[],n.vertexBuffers=[],n.vaos=[],n.vaoMax=2,n.vertexCount=0,n.renderer.on("prerender",n.onPrerender,n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,a.default)(this.MAX_TEXTURES,t)),this.shader=(0,s.default)(t,this.MAX_TEXTURES),this.indexBuffer=h.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var e=this.shader.attributes,i=0;i<this.vaoMax;i++){var n=this.vertexBuffers[i]=h.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),r=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(n,e.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(n,e.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(n,e.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);e.aTextureId&&r.addAttribute(n,e.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[i]=r}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},e.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,i=p.default.nextPow2(this.currentIndex),n=p.default.log2(i),r=this.buffers[n],o=this.sprites,s=this.groups,a=r.float32View,l=r.uint32View,d=this.boundTextures,y=this.renderer.boundTextures,_=this.renderer.textureGC.count,x=0,g=void 0,v=void 0,b=1,w=0,C=s[0],S=void 0,T=void 0,D=u.premultiplyBlendMode[o[0]._texture.baseTexture.premultipliedAlpha?1:0][o[0].blendMode];C.textureCount=0,C.start=0,C.blend=D,f++;var A=void 0;for(A=0;A<e;++A)d[A]=y[A],d[A]._virtalBoundId=A;for(A=0;A<this.currentIndex;++A){var B=o[A];g=B._texture.baseTexture;var M=u.premultiplyBlendMode[Number(g.premultipliedAlpha)][B.blendMode];if(D!==M&&(D=M,v=null,w=e,f++),v!==g&&(v=g,g._enabled!==f)){if(w===e&&(f++,C.size=A-C.start,w=0,(C=s[b++]).blend=D,C.textureCount=0,C.start=A),g.touched=_,-1===g._virtalBoundId)for(var P=0;P<e;++P){var E=(P+m)%e,I=d[E];if(I._enabled!==f){m++,I._virtalBoundId=-1,g._virtalBoundId=E,d[E]=g;break}}g._enabled=f,C.textureCount++,C.ids[w]=g._virtalBoundId,C.textures[w++]=g}if(S=B.vertexData,T=B._texture._uvs.uvsUint32,this.renderer.roundPixels){var R=this.renderer.resolution;a[x]=(S[0]*R|0)/R,a[x+1]=(S[1]*R|0)/R,a[x+5]=(S[2]*R|0)/R,a[x+6]=(S[3]*R|0)/R,a[x+10]=(S[4]*R|0)/R,a[x+11]=(S[5]*R|0)/R,a[x+15]=(S[6]*R|0)/R,a[x+16]=(S[7]*R|0)/R}else a[x]=S[0],a[x+1]=S[1],a[x+5]=S[2],a[x+6]=S[3],a[x+10]=S[4],a[x+11]=S[5],a[x+15]=S[6],a[x+16]=S[7];l[x+2]=T[0],l[x+7]=T[1],l[x+12]=T[2],l[x+17]=T[3];var O=Math.min(B.worldAlpha,1),k=O<1&&g.premultipliedAlpha?(0,u.premultiplyTint)(B._tintRGB,O):B._tintRGB+(255*O<<24);l[x+3]=l[x+8]=l[x+13]=l[x+18]=k,a[x+4]=a[x+9]=a[x+14]=a[x+19]=g._virtalBoundId,x+=20}if(C.size=A-C.start,c.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(r.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var L=this.shader.attributes,F=this.vertexBuffers[this.vertexCount]=h.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),N=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(F,L.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(F,L.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(F,L.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);L.aTextureId&&N.addAttribute(F,L.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=N}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(r.vertices,0,!1),this.vertexCount++}for(A=0;A<e;++A)y[A]._virtalBoundId=-1;for(A=0;A<b;++A){for(var V=s[A],j=V.textureCount,G=0;G<j;G++)v=V.textures[G],y[V.ids[G]]!==v&&this.renderer.bindTexture(v,V.ids[G],!0),v._virtalBoundId=-1;this.renderer.state.setBlendMode(V.blend),t.drawElements(t.TRIANGLES,6*V.size,t.UNSIGNED_SHORT,6*V.start*2)}this.currentIndex=0}},e.prototype.start=function(){this.renderer.bindShader(this.shader),c.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var i=0;i<this.buffers.length;++i)this.buffers[i].destroy()},e}(n.default);i.default=y,r.default.registerPlugin("sprite",y)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":124,"../../utils/createIndicesForQuads":122,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":12}],107:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=s;i=(i=i.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e));for(var n=new o.default(t,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",i),r=[],a=0;a<e;a++)r[a]=a;return n.bind(),n.uniforms.uSamplers=r,n};var n,r=t("../../Shader"),o=(n=r)&&n.__esModule?n:{default:n};t("path");var s=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n")},{"../../Shader":44,path:23}],108:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=d(t("../sprites/Sprite")),o=d(t("../textures/Texture")),s=t("../math"),a=t("../utils"),l=t("../const"),c=d(t("../settings")),u=d(t("./TextStyle")),h=d(t("./TextMetrics")),p=d(t("../utils/trimCanvas"));function d(t){return t&&t.__esModule?t:{default:t}}var f={texture:!0,children:!1,baseTexture:!0},m=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=r||document.createElement("canvas")).width=3,r.height=3;var a=o.default.fromCanvas(r,c.default.SCALE_MODE,"text");a.orig=new s.Rectangle,a.trim=new s.Rectangle;var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,a));return o.default.addToCache(l._texture,l._texture.baseTexture.textureCacheIds[0]),l.canvas=r,l.context=l.canvas.getContext("2d"),l.resolution=c.default.RESOLUTION,l._text=null,l._style=null,l._styleListener=null,l._font="",l.text=i,l.style=n,l.localStyleID=-1,l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i=this.context,n=h.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),r=n.width,o=n.height,s=n.lines,a=n.lineHeight,l=n.lineWidths,c=n.maxLineWidth,u=n.fontProperties;this.canvas.width=Math.ceil((r+2*e.padding)*this.resolution),this.canvas.height=Math.ceil((o+2*e.padding)*this.resolution),i.scale(this.resolution,this.resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.strokeStyle=e.stroke,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;var p=void 0,d=void 0;if(e.dropShadow){i.fillStyle=e.dropShadowColor,i.globalAlpha=e.dropShadowAlpha,i.shadowBlur=e.dropShadowBlur,e.dropShadowBlur>0&&(i.shadowColor=e.dropShadowColor);for(var f=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,m=Math.sin(e.dropShadowAngle)*e.dropShadowDistance,y=0;y<s.length;y++)p=e.strokeThickness/2,d=e.strokeThickness/2+y*a+u.ascent,"right"===e.align?p+=c-l[y]:"center"===e.align&&(p+=(c-l[y])/2),e.fill&&(this.drawLetterSpacing(s[y],p+f+e.padding,d+m+e.padding),e.stroke&&e.strokeThickness&&(i.strokeStyle=e.dropShadowColor,this.drawLetterSpacing(s[y],p+f+e.padding,d+m+e.padding,!0),i.strokeStyle=e.stroke))}i.shadowBlur=0,i.globalAlpha=1,i.fillStyle=this._generateFillStyle(e,s);for(var _=0;_<s.length;_++)p=e.strokeThickness/2,d=e.strokeThickness/2+_*a+u.ascent,"right"===e.align?p+=c-l[_]:"center"===e.align&&(p+=(c-l[_])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[_],p+e.padding,d+e.padding,!0),e.fill&&this.drawLetterSpacing(s[_],p+e.padding,d+e.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this._style.letterSpacing;if(0!==r)for(var o=String.prototype.split.call(t,""),s=e,a=0,l="";a<t.length;)l=o[a++],n?this.context.strokeText(l,s,i):this.context.fillText(l,s,i),s+=this.context.measureText(l).width+r;else n?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,p.default)(t);t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0)}var i=this._texture,n=this._style,r=n.trim?0:n.padding,o=i.baseTexture;o.hasLoaded=!0,o.resolution=this.resolution,o.realWidth=t.width,o.realHeight=t.height,o.width=t.width/this.resolution,o.height=t.height/this.resolution,i.trim.width=i._frame.width=t.width/this.resolution,i.trim.height=i._frame.height=t.height/this.resolution,i.trim.x=-r,i.trim.y=-r,i.orig.width=i._frame.width-2*r,i.orig.height=i._frame.height-2*r,this._onTextureUpdate(),o.emit("update",o),this.dirty=!1},e.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.renderWebGL.call(this,e)},e.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var i=void 0,n=void 0,r=void 0,o=void 0,s=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,c=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var h=c.length+1,p=1;p<h;++p)u.push(p/h);if(c.unshift(t.fill[0]),u.unshift(0),c.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===l.TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,0,s/2,a),n=(c.length+1)*e.length,r=0;for(var d=0;d<e.length;d++){r+=1;for(var f=0;f<c.length;f++)o="number"==typeof u[f]?u[f]/e.length+d/e.length:r/n,i.addColorStop(o,c[f]),r++}}else{i=this.context.createLinearGradient(0,a/2,s,a/2),n=c.length+1,r=1;for(var m=0;m<c.length;m++)o="number"==typeof u[m]?u[m]:r/n,i.addColorStop(o,c[m]),r++}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},f,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},n(e,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,a.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,a.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){(t=t||{})instanceof u.default?this._style=t:this._style=new u.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null===t||void 0===t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),e}(r.default);i.default=m},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":124,"../utils/trimCanvas":129,"./TextMetrics":109,"./TextStyle":110}],109:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e,i,n,r,o,s,a,l,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=e,this.style=i,this.width=n,this.height=r,this.lines=o,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=c}return t.measureText=function(e,i,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t._canvas;n=n||i.wordWrap;var o=i.toFontString(),s=t.measureFont(o),a=r.getContext("2d");a.font=o;for(var l=(n?t.wordWrap(e,i,r):e).split(/(?:\r\n|\r|\n)/),c=new Array(l.length),u=0,h=0;h<l.length;h++){var p=a.measureText(l[h]).width+(l[h].length-1)*i.letterSpacing;c[h]=p,u=Math.max(u,p)}var d=u+i.strokeThickness;i.dropShadow&&(d+=i.dropShadowDistance);var f=i.lineHeight||s.fontSize+i.strokeThickness,m=Math.max(f,s.fontSize+i.strokeThickness)+(l.length-1)*(f+i.leading);return i.dropShadow&&(m+=i.dropShadowDistance),new t(e,i,d,m,l,c,f+i.leading,u,s)},t.wordWrap=function(e,i){for(var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t._canvas).getContext("2d"),r="",o=e.split("\n"),s=i.wordWrapWidth,a={},l=0;l<o.length;l++){for(var c=s,u=o[l].split(" "),h=0;h<u.length;h++){var p=n.measureText(u[h]).width;if(i.breakWords&&p>s)for(var d=u[h].split(""),f=0;f<d.length;f++){var m=d[f],y=a[m];void 0===y&&(y=n.measureText(m).width,a[m]=y),y>c?(r+="\n"+m,c=s-y):(0===f&&(r+=" "),r+=m,c-=y)}else{var _=p+n.measureText(" ").width;0===h||_>c?(h>0&&(r+="\n"),r+=u[h],c=s-p):(c-=_,r+=" "+u[h])}}l<o.length-1&&(r+="\n")}return r},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var i={},n=t._canvas,r=t._context;r.font=e;var o=Math.ceil(r.measureText("|Mq").width),s=Math.ceil(r.measureText("M").width),a=2*s;s=1.4*s|0,n.width=o,n.height=a,r.fillStyle="#f00",r.fillRect(0,0,o,a),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText("|Mq",0,s);var l=r.getImageData(0,0,o,a).data,c=l.length,u=4*o,h=0,p=0,d=!1;for(h=0;h<s;++h){for(var f=0;f<u;f+=4)if(255!==l[p+f]){d=!0;break}if(d)break;p+=u}for(i.ascent=s-h,p=c-u,d=!1,h=a;h>s;--h){for(var m=0;m<u;m+=4)if(255!==l[p+m]){d=!0;break}if(d)break;p-=u}return i.descent=h-s,i.fontSize=i.ascent+i.descent,t._fonts[e]=i,i},t}();i.default=n;var r=document.createElement("canvas");r.width=r.height=10,n._canvas=r,n._context=r.getContext("2d"),n._fonts={}},{}],110:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../const"),o=t("../utils");var s={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:r.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,wordWrap:!1,wordWrapWidth:100,leading:0},a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.styleID=0,Object.assign(this,s,e)}return t.prototype.clone=function(){var e={};for(var i in s)e[i]=this[i];return new t(e)},t.prototype.reset=function(){Object.assign(this,s)},t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var n=e[i].trim();/([\"\'])[^\'\"]+\1/.test(n)||(n='"'+n+'"'),e[i]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},n(t,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=c(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=c(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=c(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),t}();function l(t){return"number"==typeof t?(0,o.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function c(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=l(t[e]);return t}return l(t)}i.default=a},{"../const":46,"../utils":124}],111:[function(t,e,i){"use strict";i.__esModule=!0;var n=o(t("./BaseTexture")),r=o(t("../settings"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments[2],s=arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,null,o));return a.resolution=s||r.default.RESOLUTION,a.width=i,a.height=n,a.realWidth=a.width*a.resolution,a.realHeight=a.height*a.resolution,a.scaleMode=void 0!==o?o:r.default.SCALE_MODE,a.hasLoaded=!0,a._glRenderTargets={},a._canvasRenderTarget=null,a.valid=!1,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){t===this.width&&e===this.height||(this.valid=t>0&&e>0,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.renderer=null},e}(n.default);i.default=s},{"../settings":101,"./BaseTexture":112}],112:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("../utils"),r=l(t("../settings")),o=l(t("eventemitter3")),s=l(t("../utils/determineCrossOrigin")),a=l(t("bit-twiddle"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(i,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return a.uid=(0,n.uid)(),a.touched=0,a.resolution=s||r.default.RESOLUTION,a.width=100,a.height=100,a.realWidth=100,a.realHeight=100,a.scaleMode=void 0!==o?o:r.default.SCALE_MODE,a.hasLoaded=!1,a.isLoading=!1,a.source=null,a.origSource=null,a.imageType=null,a.sourceScale=1,a.premultipliedAlpha=!0,a.imageUrl=null,a.isPowerOfTwo=!1,a.mipmap=r.default.MIPMAP_TEXTURES,a.wrapMode=r.default.WRAP_MODE,a._glTextures={},a._enabled=0,a._virtalBoundId=-1,a._destroyed=!1,a.textureCacheIds=[],i&&a.loadSource(i),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},e.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=a.default.isPow2(this.realWidth)&&a.default.isPow2(this.realHeight)},e.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null);var i=!this.source;if(this.source=t,(t.src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),i&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var n=this;if(t.onload=function(){n._updateImageType(),t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n._sourceLoaded(),"svg"!==n.imageType?n.emit("loaded",n):n._loadSvgSource())},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this)}}},e.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,n.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var i=t.subType.split("+")[0];if(!(e=(0,n.getUrlFileExtension)("."+i)))throw new Error("Invalid image type in data URI.")}else(e=(0,n.getUrlFileExtension)(this.imageUrl))||(e="png");this.imageType=e}},e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,n.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},e.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},e.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},e.prototype._loadSvgSourceUsingString=function(t){var i=(0,n.getSvgSize)(t),r=i.width,o=i.height;if(!r||!o)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(r*this.sourceScale),this.realHeight=Math.round(o*this.sourceScale),this._updateDimensions();var s=document.createElement("canvas");s.width=this.realWidth,s.height=this.realHeight,s._pixiId="canvas_"+(0,n.uid)(),s.getContext("2d").drawImage(this.source,0,0,r,o,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=s,e.addToCache(this,s._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},e.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},e.prototype.destroy=function(){this.imageUrl&&(delete n.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},e.fromImage=function(t,i,r,o){var a=n.BaseTextureCache[t];if(!a){var l=new Image;void 0===i&&0!==t.indexOf("data:")?l.crossOrigin=(0,s.default)(t):i&&(l.crossOrigin="string"==typeof i?i:"anonymous"),(a=new e(l,r)).imageUrl=t,o&&(a.sourceScale=o),a.resolution=(0,n.getResolutionOfUrl)(t),l.src=t,e.addToCache(a,t)}return a},e.fromCanvas=function(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";t._pixiId||(t._pixiId=r+"_"+(0,n.uid)());var o=n.BaseTextureCache[t._pixiId];return o||(o=new e(t,i),e.addToCache(o,t._pixiId)),o},e.from=function(t,i,r){if("string"==typeof t)return e.fromImage(t,void 0,i,r);if(t instanceof HTMLImageElement){var o=t.src,s=n.BaseTextureCache[o];return s||((s=new e(t,i)).imageUrl=o,r&&(s.sourceScale=r),s.resolution=(0,n.getResolutionOfUrl)(o),e.addToCache(s,o)),s}return t instanceof HTMLCanvasElement?e.fromCanvas(t,i):t},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),n.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),n.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=n.BaseTextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete n.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete n.BaseTextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e}(o.default);i.default=c},{"../settings":101,"../utils":124,"../utils/determineCrossOrigin":123,"bit-twiddle":1,eventemitter3:3}],113:[function(t,e,i){"use strict";i.__esModule=!0;var n=r(t("./BaseRenderTexture"));function r(t){return t&&t.__esModule?t:{default:t}}var o=function(t){function e(i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=null;if(!(i instanceof n.default)){var s=arguments[1],a=arguments[2],l=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+s+", "+a+") instead of the ctor directly."),o=arguments[0],r=null,i=new n.default(s,a,l,c)}var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,r));return u.legacyRenderer=o,u.valid=!0,u._updateUvs(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e,i){this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i||this.baseTexture.resize(t,e),this._updateUvs()},e.create=function(t,i,r,o){return new e(new n.default(t,i,r,o))},e}(r(t("./Texture")).default);i.default=o},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../"),o=t("../utils");var s=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseTexture=e,this.textures={},this.data=i,this.resolution=this._updateResolution(n||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return n(t,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),t.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=(0,o.getResolutionOfUrl)(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&(this.baseTexture.resolution=i,this.baseTexture.update()),i},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var i=e,n=t.BATCH_SIZE,o=this.baseTexture.sourceScale;i-e<n&&i<this._frameKeys.length;){var s=this._frameKeys[i],a=this._frames[s].frame;if(a){var l=null,c=null,u=new r.Rectangle(0,0,Math.floor(this._frames[s].sourceSize.w*o)/this.resolution,Math.floor(this._frames[s].sourceSize.h*o)/this.resolution);l=this._frames[s].rotated?new r.Rectangle(Math.floor(a.x*o)/this.resolution,Math.floor(a.y*o)/this.resolution,Math.floor(a.h*o)/this.resolution,Math.floor(a.w*o)/this.resolution):new r.Rectangle(Math.floor(a.x*o)/this.resolution,Math.floor(a.y*o)/this.resolution,Math.floor(a.w*o)/this.resolution,Math.floor(a.h*o)/this.resolution),this._frames[s].trimmed&&(c=new r.Rectangle(Math.floor(this._frames[s].spriteSourceSize.x*o)/this.resolution,Math.floor(this._frames[s].spriteSourceSize.y*o)/this.resolution,Math.floor(a.w*o)/this.resolution,Math.floor(a.h*o)/this.resolution)),this.textures[s]=new r.Texture(this.baseTexture,l,u,c,this._frames[s].rotated?2:0),r.Texture.addToCache(this.textures[s],s)}i++}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():e._parseComplete()},0)},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},t}();i.default=s},{"../":65,"../utils":124}],115:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=h(t("./BaseTexture")),o=h(t("./VideoBaseTexture")),s=h(t("./TextureUvs")),a=h(t("eventemitter3")),l=t("../math"),c=t("../utils"),u=h(t("../settings"));function h(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(i,n,r,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(a.noFrame=!1,n||(a.noFrame=!0,n=new l.Rectangle(0,0,1,1)),i instanceof e&&(i=i.baseTexture),a.baseTexture=i,a._frame=n,a.trim=o,a.valid=!1,a.requiresUpdate=!1,a._uvs=null,a.orig=r||n,a._rotate=Number(s||0),!0===s)a._rotate=2;else if(a._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return i.hasLoaded?(a.noFrame&&(n=new l.Rectangle(0,0,i.width,i.height),i.on("update",a.onBaseTextureUpdated,a)),a.frame=n):i.once("loaded",a.onBaseTextureLoaded,a),a._updateID=0,a.transform=null,a.textureCacheIds=[],a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){this.baseTexture.update()},e.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new l.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},e.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},e.prototype.destroy=function(t){this.baseTexture&&(t&&(c.TextureCache[this.baseTexture.imageUrl]&&e.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},e.prototype._updateUvs=function(){this._uvs||(this._uvs=new s.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.fromImage=function(t,i,n,o){var s=c.TextureCache[t];return s||(s=new e(r.default.fromImage(t,i,n,o)),e.addToCache(s,t)),s},e.fromFrame=function(t){var e=c.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},e.fromCanvas=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new e(r.default.fromCanvas(t,i,n))},e.fromVideo=function(t,i){return"string"==typeof t?e.fromVideoUrl(t,i):new e(o.default.fromVideo(t,i))},e.fromVideoUrl=function(t,i){return new e(o.default.fromUrl(t,i))},e.from=function(t){if("string"==typeof t){var i=c.TextureCache[t];return i||(null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?e.fromVideoUrl(t):e.fromImage(t))}return t instanceof HTMLImageElement?new e(r.default.from(t)):t instanceof HTMLCanvasElement?e.fromCanvas(t,u.default.SCALE_MODE,"HTMLCanvasElement"):t instanceof HTMLVideoElement?e.fromVideo(t):t instanceof r.default?new e(t):t},e.fromLoader=function(t,i,n){var o=new r.default(t,void 0,(0,c.getResolutionOfUrl)(i)),s=new e(o);return o.imageUrl=i,n||(n=i),r.default.addToCache(s.baseTexture,n),e.addToCache(s,n),n!==i&&(r.default.addToCache(s.baseTexture,i),e.addToCache(s,i)),s},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),c.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),c.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=c.TextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete c.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)c.TextureCache[t.textureCacheIds[n]]===t&&delete c.TextureCache[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},n(e,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,n=t.width,r=t.height,o=e+n>this.baseTexture.width,s=i+r>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",l="X: "+e+" + "+n+" = "+(e+n)+" > "+this.baseTexture.width,c="Y: "+i+" + "+r+" = "+(i+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+c)}this.valid=n&&r&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),e}(a.default);function d(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}i.default=p,p.EMPTY=new p(new r.default),d(p.EMPTY),d(p.EMPTY.baseTexture),p.WHITE=function(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new p(new r.default(t))}(),d(p.WHITE),d(p.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":124,"./BaseTexture":112,"./TextureUvs":116,"./VideoBaseTexture":117,eventemitter3:3}],116:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../math/GroupD8"),o=(n=r)&&n.__esModule?n:{default:n};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,i){var n=e.width,r=e.height;if(i){var s=t.width/2/n,a=t.height/2/r,l=t.x/n+s,c=t.y/r+a;i=o.default.add(i,o.default.NW),this.x0=l+s*o.default.uX(i),this.y0=c+a*o.default.uY(i),i=o.default.add(i,2),this.x1=l+s*o.default.uX(i),this.y1=c+a*o.default.uY(i),i=o.default.add(i,2),this.x2=l+s*o.default.uX(i),this.y2=c+a*o.default.uY(i),i=o.default.add(i,2),this.x3=l+s*o.default.uX(i),this.y3=c+a*o.default.uY(i)}else this.x0=t.x/n,this.y0=t.y/r,this.x1=(t.x+t.width)/n,this.y1=t.y/r,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/r,this.x3=t.x/n,this.y3=(t.y+t.height)/r;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},t}();i.default=s},{"../math/GroupD8":66}],117:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("./BaseTexture"),s=(n=o)&&n.__esModule?n:{default:n},a=t("../utils"),l=t("../ticker"),c=t("../const");var u=function(t){function e(i,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),!i)throw new Error("No video source element specified.");(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));return r.width=i.videoWidth,r.height=i.videoHeight,r._autoUpdate=!0,r._isAutoUpdating=!1,r.autoPlay=!0,r.update=r.update.bind(r),r._onCanPlay=r._onCanPlay.bind(r),i.addEventListener("play",r._onPlayStart.bind(r)),i.addEventListener("pause",r._onPlayStop.bind(r)),r.hasLoaded=!1,r.__loaded=!1,r._isSourceReady()?r._onCanPlay():(i.addEventListener("canplay",r._onCanPlay),i.addEventListener("canplaythrough",r._onCanPlay)),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(l.shared.add(this.update,this,c.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(l.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},e.prototype.destroy=function(){this._isAutoUpdating&&l.shared.remove(this.update,this),this.source&&this.source._pixiId&&(s.default.removeFromCache(this.source._pixiId),delete this.source._pixiId),t.prototype.destroy.call(this)},e.fromVideo=function(t,i){t._pixiId||(t._pixiId="video_"+(0,a.uid)());var n=a.BaseTextureCache[t._pixiId];return n||(n=new e(t,i),s.default.addToCache(n,t._pixiId)),n},e.fromUrl=function(t,i){var n=document.createElement("video");if(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),Array.isArray(t))for(var r=0;r<t.length;++r)n.appendChild(h(t[r].src||t[r],t[r].mime));else n.appendChild(h(t.src||t,t.mime));return n.load(),e.fromVideo(n,i)},r(e,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(l.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(l.shared.add(this.update,this,c.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),e}(s.default);function h(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}i.default=u,u.fromUrls=u.fromUrl},{"../const":46,"../ticker":120,"../utils":124,"./BaseTexture":112}],118:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=a(t("../settings")),o=t("../const"),s=a(t("./TickerListener"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._head=new s.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/r.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.UPDATE_PRIORITY.NORMAL;return this._addListener(new s.default(t,e,i))},t.prototype.addOnce=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.UPDATE_PRIORITY.NORMAL;return this._addListener(new s.default(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null},t.prototype.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;if(t>this.lastTime){(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*r.default.TARGET_FPMS*this.speed;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},n(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,r.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();i.default=l},{"../const":46,"../settings":101,"./TickerListener":119}],119:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fn=e,this.context=i,this.priority=n,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.previous;return this.next=t?null:e,this.previous=null,e},t}();i.default=n},{}],120:[function(t,e,i){"use strict";i.__esModule=!0,i.Ticker=i.shared=void 0;var n,r=t("./Ticker"),o=(n=r)&&n.__esModule?n:{default:n};var s=new o.default;s.autoStart=!0,s.destroy=function(){},i.shared=s,i.Ticker=o.default},{"./Ticker":118}],121:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],122:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){for(var e=6*t,i=new Uint16Array(e),n=0,r=0;n<e;n+=6,r+=4)i[n+0]=r+0,i[n+1]=r+1,i[n+2]=r+2,i[n+3]=r+0,i[n+4]=r+2,i[n+5]=r+3;return i}},{}],123:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,s||(s=document.createElement("a"));s.href=t;var i=!(t=o.default.parse(s.href)).port&&""===e.port||t.port===e.port;if(t.hostname!==e.hostname||!i||t.protocol!==e.protocol)return"anonymous";return""};var n,r=t("url"),o=(n=r)&&n.__esModule?n:{default:n};var s=void 0},{url:29}],124:[function(t,e,i){"use strict";i.__esModule=!0,i.premultiplyBlendMode=i.BaseTextureCache=i.TextureCache=i.mixins=i.pluginTarget=i.EventEmitter=i.removeItems=i.isMobile=void 0,i.uid=function(){return++d},i.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},i.hex2string=function(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},i.getResolutionOfUrl=function(t,e){var i=r.default.RETINA_PREFIX.exec(t);if(i)return parseFloat(i[1]);return void 0!==e?e:1},i.decomposeDataUri=function(t){var e=n.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,encoding:e[3]?e[3].toLowerCase():void 0,data:e[4]};return},i.getUrlFileExtension=function(t){var e=n.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase();return},i.getSvgSize=function(t){var e=n.SVG_SIZE.exec(t),i={};e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7])));return i},i.skipHello=function(){f=!0},i.sayHello=function(t){if(f)return;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c PixiJS "+n.VERSION+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+n.VERSION+" - "+t+" - http://www.pixijs.com/");f=!0},i.isWebGLSupported=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!i||!i.getContextAttributes().stencil);if(i){var r=i.getExtension("WEBGL_lose_context");r&&r.loseContext()}return i=null,n}catch(t){return!1}},i.sign=function(t){return 0===t?0:t<0?-1:1},i.destroyTextureCache=function(){var t=void 0;for(t in m)m[t].destroy();for(t in y)y[t].destroy()},i.clearTextureCache=function(){var t=void 0;for(t in m)delete m[t];for(t in y)delete y[t]},i.correctBlendMode=function(t,e){return _[e?1:0][t]},i.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,n=t>>8&255,r=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(r=r*e+.5|0)},i.premultiplyRgba=function(t,e,i,n){i=i||new Float32Array(4),n||void 0===n?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]);return i[3]=e,i},i.premultiplyTintToRgba=function(t,e,i,n){(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(n||void 0===n)&&(i[0]*=e,i[1]*=e,i[2]*=e);return i[3]=e,i};var n=t("../const"),r=p(t("../settings")),o=p(t("eventemitter3")),s=p(t("./pluginTarget")),a=h(t("./mixin")),l=h(t("ismobilejs")),c=p(t("remove-array-items")),u=p(t("./mapPremultipliedBlendModes"));function h(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function p(t){return t&&t.__esModule?t:{default:t}}var d=0,f=!1;i.isMobile=l,i.removeItems=c.default,i.EventEmitter=o.default,i.pluginTarget=s.default,i.mixins=a;var m=i.TextureCache=Object.create(null),y=i.BaseTextureCache=Object.create(null);var _=i.premultiplyBlendMode=(0,u.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":125,"./mixin":127,"./pluginTarget":128,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],125:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[n.BLEND_MODES.NORMAL_NPM]=n.BLEND_MODES.NORMAL,t[n.BLEND_MODES.ADD_NPM]=n.BLEND_MODES.ADD,t[n.BLEND_MODES.SCREEN_NPM]=n.BLEND_MODES.SCREEN,e[n.BLEND_MODES.NORMAL]=n.BLEND_MODES.NORMAL_NPM,e[n.BLEND_MODES.ADD]=n.BLEND_MODES.ADD_NPM,e[n.BLEND_MODES.SCREEN]=n.BLEND_MODES.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r};var n=t("../const")},{"../const":46}],126:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){if(o.default.tablet||o.default.phone)return 4;return t};var n,r=t("ismobilejs"),o=(n=r)&&n.__esModule?n:{default:n}},{ismobilejs:4}],127:[function(t,e,i){"use strict";function n(t,e){if(t&&e)for(var i=Object.keys(e),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}}i.__esModule=!0,i.mixin=n,i.delayMixin=function(t,e){r.push(t,e)},i.performMixins=function(){for(var t=0;t<r.length;t+=2)n(r[t],r[t+1]);r.length=0};var r=[]},{}],128:[function(t,e,i){"use strict";i.__esModule=!0,i.default={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],129:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=t.width,i=t.height,n=t.getContext("2d"),r=n.getImageData(0,0,e,i).data,o=r.length,s={top:null,left:null,right:null,bottom:null},a=void 0,l=void 0,c=void 0;for(a=0;a<o;a+=4)0!==r[a+3]&&(l=a/4%e,c=~~(a/4/e),null===s.top&&(s.top=c),null===s.left?s.left=l:l<s.left&&(s.left=l),null===s.right?s.right=l+1:s.right<l&&(s.right=l+1),null===s.bottom?s.bottom=c:s.bottom<c&&(s.bottom=c));e=s.right-s.left,i=s.bottom-s.top+1;var u=n.getImageData(s.left,s.top,e,i);return{height:i,width:e,data:u}}},{}],130:[function(t,e,i){"use strict";function n(t){var e=(new Error).stack;void 0===e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e)))}i.__esModule=!0,i.default=function(t){var e=t.mesh,i=t.particles,r=t.extras,o=t.filters,s=t.prepare,a=t.loaders,l=t.interaction;Object.defineProperties(t,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return n("You do not need to use a PIXI Stage any more, you can simply render any container."),t.Container}},DisplayObjectContainer:{get:function(){return n("DisplayObjectContainer has been shortened to Container, please use Container from now on."),t.Container}},Strip:{get:function(){return n("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),e.Mesh}},Rope:{get:function(){return n("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),e.Rope}},ParticleContainer:{get:function(){return n("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),i.ParticleContainer}},MovieClip:{get:function(){return n("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),r.AnimatedSprite}},TilingSprite:{get:function(){return n("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),r.TilingSprite}},BitmapText:{get:function(){return n("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),r.BitmapText}},blendModes:{get:function(){return n("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),t.BLEND_MODES}},scaleModes:{get:function(){return n("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),t.SCALE_MODES}},BaseTextureCache:{get:function(){return n("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),t.utils.BaseTextureCache}},TextureCache:{get:function(){return n("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),t.utils.TextureCache}},math:{get:function(){return n("The math namespace is deprecated, please access members already accessible on PIXI."),t}},AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.Filter}},TransformManual:{get:function(){return n("TransformManual has been renamed to TransformBase, please update your pixi-spine"),t.TransformBase}},TARGET_FPMS:{get:function(){return n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS},set:function(e){n("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS=e}},FILTER_RESOLUTION:{get:function(){return n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION},set:function(e){n("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION=e}},RESOLUTION:{get:function(){return n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION},set:function(e){n("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION=e}},MIPMAP_TEXTURES:{get:function(){return n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES},set:function(e){n("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES=e}},SPRITE_BATCH_SIZE:{get:function(){return n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE},set:function(e){n("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE=e}},SPRITE_MAX_TEXTURES:{get:function(){return n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES},set:function(e){n("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES=e}},RETINA_PREFIX:{get:function(){return n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX},set:function(e){n("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX=e}},DEFAULT_RENDER_OPTIONS:{get:function(){return n("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),t.settings.RENDER_OPTIONS}}});for(var c=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],u=function(e){var i=c[e];Object.defineProperty(t[i.parent],"DEFAULT",{get:function(){return n("PIXI."+i.parent+".DEFAULT has been deprecated, please use PIXI.settings."+i.target),t.settings[i.target]},set:function(e){n("PIXI."+i.parent+".DEFAULT has been deprecated, please use PIXI.settings."+i.target),t.settings[i.target]=e}})},h=0;h<c.length;h++)u(h);Object.defineProperties(t.settings,{PRECISION:{get:function(){return n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT},set:function(e){n("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT=e}}}),r.AnimatedSprite&&Object.defineProperties(r,{MovieClip:{get:function(){return n("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),r.AnimatedSprite}}});t.DisplayObject.prototype.generateTexture=function(t,e,i){return n("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,i)},t.Graphics.prototype.generateTexture=function(t,e){return n("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},t.RenderTexture.prototype.render=function(t,e,i,r){this.legacyRenderer.render(t,this,i,e,!r),n("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},t.RenderTexture.prototype.getImage=function(t){return n("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},t.RenderTexture.prototype.getBase64=function(t){return n("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},t.RenderTexture.prototype.getCanvas=function(t){return n("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},t.RenderTexture.prototype.getPixels=function(t){return n("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},t.Sprite.prototype.setTexture=function(t){this.texture=t,n("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},r.BitmapText&&(r.BitmapText.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")});t.Text.prototype.setText=function(t){this.text=t,n("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},t.Text.calculateFontProperties=function(e){return n("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),t.TextMetrics.measureFont(e)},Object.defineProperties(t.Text,{fontPropertiesCache:{get:function(){return n("Text.fontPropertiesCache is deprecated"),t.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return n("Text.fontPropertiesCanvas is deprecated"),t.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return n("Text.fontPropertiesContext is deprecated"),t.TextMetrics._context}}}),t.Text.prototype.setStyle=function(t){this.style=t,n("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},t.Text.prototype.determineFontProperties=function(e){return n("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),t.TextMetrics.measureFont(e)},t.Text.getFontStyle=function(e){return n("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),(e=e||{})instanceof t.TextStyle||(e=new t.TextStyle(e)),e.toFontString()},Object.defineProperties(t.TextStyle.prototype,{font:{get:function(){n("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){n("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),t.indexOf("italic")>1?this._fontStyle="italic":t.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",t.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var e=t.split(" "),i=-1;this._fontSize=26;for(var r=0;r<e.length;++r)if(e[r].match(/(px|pt|em|%)/)){i=r,this._fontSize=e[r];break}this._fontWeight="normal";for(var o=0;o<i;++o)if(e[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[o];break}if(i>-1&&i<e.length-1){this._fontFamily="";for(var s=i+1;s<e.length;++s)this._fontFamily+=e[s]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),t.Texture.prototype.setFrame=function(t){this.frame=t,n("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},t.Texture.addTextureToCache=function(e,i){t.Texture.addToCache(e,i),n("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},t.Texture.removeTextureFromCache=function(e){return n("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),t.BaseTexture.removeFromCache(e),t.Texture.removeFromCache(e)},Object.defineProperties(o,{AbstractFilter:{get:function(){return n("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.AbstractFilter}},SpriteMaskFilter:{get:function(){return n("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),t.SpriteMaskFilter}}}),t.utils.uuid=function(){return n("utils.uuid() is deprecated, please use utils.uid() from now on."),t.utils.uid()},t.utils.canUseNewCanvasBlendModes=function(){return n("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),t.CanvasTinter.canUseMultiply};var p=!0;Object.defineProperty(t.utils,"_saidHello",{set:function(t){t&&(n("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),p=t},get:function(){return p}}),s.BasePrepare&&(s.BasePrepare.prototype.register=function(t,e){return n("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),e&&this.registerUploadHook(e),this});s.canvas&&Object.defineProperty(s.canvas,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}});s.webgl&&Object.defineProperty(s.webgl,"UPLOADS_PER_FRAME",{set:function(){n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return n("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}});if(a.Loader){var d=a.Resource,f=a.Loader;Object.defineProperties(d.prototype,{isJson:{get:function(){return n("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===d.TYPE.JSON}},isXml:{get:function(){return n("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===d.TYPE.XML}},isImage:{get:function(){return n("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===d.TYPE.IMAGE}},isAudio:{get:function(){return n("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===d.TYPE.AUDIO}},isVideo:{get:function(){return n("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===d.TYPE.VIDEO}}}),Object.defineProperties(f.prototype,{before:{get:function(){return n("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return n("The after() method is deprecated, please use use()."),this.use}}})}l.interactiveTarget&&Object.defineProperty(l.interactiveTarget,"defaultCursor",{set:function(t){n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return n("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}});l.InteractionManager&&(Object.defineProperty(l.InteractionManager,"defaultCursorStyle",{set:function(t){n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return n("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(l.InteractionManager,"currentCursorStyle",{set:function(t){n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return n("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}},{}],131:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));var r=new n.Rectangle,o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,o=void 0,s=void 0,a=void 0;t&&(a=t instanceof n.RenderTexture?t:e.generateTexture(t)),a?(i=a.baseTexture._canvasRenderTarget.context,o=a.baseTexture._canvasRenderTarget.resolution,s=a.frame):(i=e.rootContext,(s=r).width=this.renderer.width,s.height=this.renderer.height);var l=s.width*o,c=s.height*o,u=new n.CanvasRenderTarget(l,c),h=i.getImageData(s.x*o,s.y*o,l,c);return u.context.putImageData(h,0,0),u.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,o=void 0,s=void 0,a=void 0;return t&&(a=t instanceof n.RenderTexture?t:e.generateTexture(t)),a?(i=a.baseTexture._canvasRenderTarget.context,o=a.baseTexture._canvasRenderTarget.resolution,s=a.frame):(i=e.rootContext,(s=r).width=e.width,s.height=e.height),i.getImageData(0,0,s.width*o,s.height*o).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=o,n.CanvasRenderer.registerPlugin("extract",o)},{"../../core":65}],132:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./webgl/WebGLExtract");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return o(n).default}});var r=t("./canvas/CanvasExtract");function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return o(r).default}})},{"./canvas/CanvasExtract":131,"./webgl/WebGLExtract":133}],133:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));var r=new n.Rectangle,o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,o=void 0,s=void 0,a=!1,l=void 0;t&&(l=t instanceof n.RenderTexture?t:this.renderer.generateTexture(t)),l?(o=(i=l.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,s=l.frame,a=!1):(o=(i=this.renderer.rootRenderTarget).resolution,a=!0,(s=r).width=i.size.width,s.height=i.size.height);var c=s.width*o,u=s.height*o,h=new n.CanvasRenderTarget(c,u);if(i){e.bindRenderTarget(i);var p=new Uint8Array(4*c*u),d=e.gl;d.readPixels(s.x*o,s.y*o,c,u,d.RGBA,d.UNSIGNED_BYTE,p);var f=h.context.getImageData(0,0,c,u);f.data.set(p),h.context.putImageData(f,0,0),a&&(h.context.scale(1,-1),h.context.drawImage(h.canvas,0,-u))}return h.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,o=void 0,s=void 0,a=void 0;t&&(a=t instanceof n.RenderTexture?t:this.renderer.generateTexture(t)),a?(o=(i=a.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,s=a.frame):(o=(i=this.renderer.rootRenderTarget).resolution,(s=r).width=i.size.width,s.height=i.size.height);var l=s.width*o,c=s.height*o,u=new Uint8Array(4*l*c);if(i){e.bindRenderTarget(i);var h=e.gl;h.readPixels(s.x*o,s.y*o,l,c,h.RGBA,h.UNSIGNED_BYTE,u)}return u},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=o,n.WebGLRenderer.registerPlugin("extract",o)},{"../../core":65}],134:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));var o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i[0]instanceof r.Texture?i[0]:i[0].texture));return o._textures=null,o._durations=null,o.textures=i,o._autoUpdate=!1!==n,o.animationSpeed=1,o.loop=!0,o.onComplete=null,o.onFrameChange=null,o.onLoop=null,o._currentTime=0,o.playing=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&r.ticker.shared.remove(this.update,this))},e.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&r.ticker.shared.add(this.update,this,r.UPDATE_PRIORITY.HIGH))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i?this.onLoop():this.animationSpeed<0&&this.currentFrame>i&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e)},e.fromFrames=function(t){for(var i=[],n=0;n<t.length;++n)i.push(r.Texture.fromFrame(t[n]));return new e(i)},e.fromImages=function(t){for(var i=[],n=0;n<t.length;++n)i.push(r.Texture.fromImage(t[n]));return new e(i)},n(e,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof r.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),e}(r.Sprite);i.default=o},{"../core":65}],135:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=a(t("../core/math/ObservablePoint")),s=a(t("../core/settings"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r._textWidth=0,r._textHeight=0,r._glyphs=[],r._font={tint:void 0!==n.tint?n.tint:16777215,align:n.align||"left",name:null,size:0},r.font=n.font,r._text=i,r._maxWidth=0,r._maxLineHeight=0,r._anchor=new o.default(function(){r.dirty=!0},r,0,0),r.dirty=!1,r.updateText(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],i=this._font.size/t.size,n=new r.Point,o=[],s=[],a=null,l=0,c=0,u=0,h=-1,p=0,d=0,f=0,m=0;m<this.text.length;m++){var y=this.text.charCodeAt(m);if(/(\s)/.test(this.text.charAt(m))&&(h=m,p=l),/(?:\r\n|\r|\n)/.test(this.text.charAt(m)))s.push(l),c=Math.max(c,l),u++,n.x=0,n.y+=t.lineHeight,a=null;else if(-1!==h&&this._maxWidth>0&&n.x*i>this._maxWidth)r.utils.removeItems(o,h-d,m-h),m=h,h=-1,++d,s.push(p),c=Math.max(c,p),u++,n.x=0,n.y+=t.lineHeight,a=null;else{var _=t.chars[y];_&&(a&&_.kerning[a]&&(n.x+=_.kerning[a]),o.push({texture:_.texture,line:u,charCode:y,position:new r.Point(n.x+_.xOffset,n.y+_.yOffset)}),l=n.x+(_.texture.width+_.xOffset),n.x+=_.xAdvance,f=Math.max(f,_.yOffset+_.texture.height),a=y)}}s.push(l),c=Math.max(c,l);for(var x=[],g=0;g<=u;g++){var v=0;"right"===this._font.align?v=c-s[g]:"center"===this._font.align&&(v=(c-s[g])/2),x.push(v)}for(var b=o.length,w=this.tint,C=0;C<b;C++){var S=this._glyphs[C];S?S.texture=o[C].texture:(S=new r.Sprite(o[C].texture),this._glyphs.push(S)),S.position.x=(o[C].position.x+x[o[C].line])*i,S.position.y=o[C].position.y*i,S.scale.x=S.scale.y=i,S.tint=w,S.parent||this.addChild(S)}for(var T=b;T<this._glyphs.length;++T)this.removeChild(this._glyphs[T]);if(this._textWidth=c*i,this._textHeight=(n.y+t.lineHeight)*i,0!==this.anchor.x||0!==this.anchor.y)for(var D=0;D<b;D++)this._glyphs[D].x-=this._textWidth*this.anchor.x,this._glyphs[D].y-=this._textHeight*this.anchor.y;this._maxLineHeight=f*i},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},e.registerFont=function(t,i){var n={},o=t.getElementsByTagName("info")[0],a=t.getElementsByTagName("common")[0],l=i.baseTexture.resolution||s.default.RESOLUTION;n.font=o.getAttribute("face"),n.size=parseInt(o.getAttribute("size"),10),n.lineHeight=parseInt(a.getAttribute("lineHeight"),10)/l,n.chars={};for(var c=t.getElementsByTagName("char"),u=0;u<c.length;u++){var h=c[u],p=parseInt(h.getAttribute("id"),10),d=new r.Rectangle(parseInt(h.getAttribute("x"),10)/l+i.frame.x/l,parseInt(h.getAttribute("y"),10)/l+i.frame.y/l,parseInt(h.getAttribute("width"),10)/l,parseInt(h.getAttribute("height"),10)/l);n.chars[p]={xOffset:parseInt(h.getAttribute("xoffset"),10)/l,yOffset:parseInt(h.getAttribute("yoffset"),10)/l,xAdvance:parseInt(h.getAttribute("xadvance"),10)/l,kerning:{},texture:new r.Texture(i.baseTexture,d)}}for(var f=t.getElementsByTagName("kerning"),m=0;m<f.length;m++){var y=f[m],_=parseInt(y.getAttribute("first"),10)/l,x=parseInt(y.getAttribute("second"),10)/l,g=parseInt(y.getAttribute("amount"),10)/l;n.chars[x]&&(n.chars[x].kerning[_]=g)}return e.fonts[n.font]=n,n},n(e,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),e}(r.Container);i.default=l,l.fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101}],136:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("../core/math/Matrix"),s=(n=o)&&n.__esModule?n:{default:n};var a=new s.default,l=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._texture=e,this.mapCoord=new s.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===i?.5:i}return t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,n=0;n<t.length;n+=2){var r=t[n],o=t[n+1];e[n]=r*i.a+o*i.c+i.tx,e[n+1]=r*i.b+o*i.d+i.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var n=e.orig,r=e.trim;r&&(a.set(n.width/r.width,0,0,n.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(a));var o=e.baseTexture,s=this.uClampFrame,l=this.clampMargin/o.resolution,c=this.clampOffset;return s[0]=(e._frame.x+l+c)/o.width,s[1]=(e._frame.y+l+c)/o.height,s[2]=(e._frame.x+e._frame.width-l+c)/o.width,s[3]=(e._frame.y+e._frame.height-l+c)/o.height,this.uClampOffset[0]=c/o.realWidth,this.uClampOffset[1]=c/o.realHeight,!0},r(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),t}();i.default=l},{"../core/math/Matrix":67}],137:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=a(t("../core/sprites/canvas/CanvasTinter")),s=a(t("./TextureTransform"));function a(t){return t&&t.__esModule?t:{default:t}}var l=new r.Point,c=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return a.tileTransform=new r.TransformStatic,a._width=n,a._height=o,a._canvasPattern=null,a.uvTransform=i.transform||new s.default(i),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},e.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,n=this.worldTransform,s=t.resolution,a=e.baseTexture,l=a.resolution,c=this.tilePosition.x/this.tileScale.x%e._frame.width*l,u=this.tilePosition.y/this.tileScale.y%e._frame.height*l;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var h=new r.CanvasRenderTarget(e._frame.width,e._frame.height,l);16777215!==this.tint?(this.tintedTexture=o.default.getTintedTexture(this,this.tint),h.context.drawImage(this.tintedTexture,0,0)):h.context.drawImage(a.source,-e._frame.x*l,-e._frame.y*l),this.cachedTint=this.tint,this._canvasPattern=h.context.createPattern(h.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(n.a*s,n.b*s,n.c*s,n.d*s,n.tx*s,n.ty*s),t.setBlendMode(this.blendMode),i.fillStyle=this._canvasPattern,i.scale(this.tileScale.x/l,this.tileScale.y/l);var p=this.anchor.x*-this._width,d=this.anchor.y*-this._height;this.uvRespectAnchor?(i.translate(c,u),i.fillRect(-c+p,-u+d,this._width/this.tileScale.x*l,this._height/this.tileScale.y*l)):(i.translate(c+p,u+d),i.fillRect(-c,-u,this._width/this.tileScale.x*l,this._height/this.tileScale.y*l))}},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,n)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),e||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);var e=this._width,i=this._height,n=-e*this.anchor._x;if(l.x>=n&&l.x<n+e){var r=-i*this.anchor._y;if(l.y>=r&&l.y<r+i)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},e.from=function(t,i,n){return new e(r.Texture.from(t),i,n)},e.fromFrame=function(t,i,n){var o=r.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(o,i,n)},e.fromImage=function(t,i,n,o,s){return new e(r.Texture.fromImage(t,o,s),i,n)},n(e,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(r.Sprite);i.default=c},{"../core":65,"../core/sprites/canvas/CanvasTinter":104,"./TextureTransform":136}],138:[function(t,e,i){"use strict";var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),r=a(t("../core/textures/Texture")),o=a(t("../core/textures/BaseTexture")),s=t("../core/utils");function a(t){return t&&t.__esModule?t:{default:t}}var l=n.DisplayObject,c=new n.Matrix;l.prototype._cacheAsBitmap=!1,l.prototype._cacheData=!1;var u=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(l.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){this._cacheAsBitmap=t;var e=void 0;t?(this._cacheData||(this._cacheData=new u),(e=this._cacheData).originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this._calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this._calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),l.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},l.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var i=this.getLocalBounds().clone();if(this._filters){var a=this._filters[0].padding;i.pad(a)}var l=t._activeRenderTarget,u=t.filterManager.filterStack,h=n.RenderTexture.create(0|i.width,0|i.height),p="cacheAsBitmap_"+(0,s.uid)();this._cacheData.textureCacheId=p,o.default.addToCache(h.baseTexture,p),r.default.addToCache(h,p);var d=c;d.tx=-i.x,d.ty=-i.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,h,!0,d,!0),t.bindRenderTarget(l),t.filterManager.filterStack=u,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var f=new n.Sprite(h);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-i.x/i.width,f.anchor.y=-i.y/i.height,f.alpha=e,f._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)}},l.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t))},l.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var a=t.context,l=n.RenderTexture.create(0|e.width,0|e.height),u="cacheAsBitmap_"+(0,s.uid)();this._cacheData.textureCacheId=u,o.default.addToCache(l.baseTexture,u),r.default.addToCache(l,u);var h=c;this.transform.localTransform.copy(h),h.invert(),h.tx-=e.x,h.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,l,!0,h,!1),t.context=a,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var p=new n.Sprite(l);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-e.x/e.width,p.anchor.y=-e.y/e.height,p._bounds=this._bounds,p.alpha=i,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=p,this.containsPoint=p.containsPoint.bind(p)}},l.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},l.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},l.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,o.default.removeFromCache(this._cacheData.textureCacheId),r.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},l.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":124}],139:[function(t,e,i){"use strict";var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":65}],140:[function(t,e,i){"use strict";var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));n.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.Point,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(t,e,i){"use strict";i.__esModule=!0,i.BitmapText=i.TilingSpriteRenderer=i.TilingSprite=i.TextureTransform=i.AnimatedSprite=void 0;var n=t("./AnimatedSprite");Object.defineProperty(i,"AnimatedSprite",{enumerable:!0,get:function(){return l(n).default}});var r=t("./TextureTransform");Object.defineProperty(i,"TextureTransform",{enumerable:!0,get:function(){return l(r).default}});var o=t("./TilingSprite");Object.defineProperty(i,"TilingSprite",{enumerable:!0,get:function(){return l(o).default}});var s=t("./webgl/TilingSpriteRenderer");Object.defineProperty(i,"TilingSpriteRenderer",{enumerable:!0,get:function(){return l(s).default}});var a=t("./BitmapText");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"BitmapText",{enumerable:!0,get:function(){return l(a).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":134,"./BitmapText":135,"./TextureTransform":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),r=t("../../core/const");t("path");var o=new n.Matrix,s=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.shader=null,n.simpleShader=null,n.quad=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new n.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new n.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new n.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},e.prototype.render=function(t){var e=this.renderer,i=this.quad;e.bindVao(i.vao);var s=i.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((s=i.uvs)[0]=s[6]=-t.anchor.x,s[1]=s[3]=-t.anchor.y,s[2]=s[4]=1-t.anchor.x,s[5]=s[7]=1-t.anchor.y),i.upload();var a=t._texture,l=a.baseTexture,c=t.tileTransform.localTransform,u=t.uvTransform,h=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;h&&(l._glTextures[e.CONTEXT_UID]?h=l.wrapMode!==r.WRAP_MODES.CLAMP:l.wrapMode===r.WRAP_MODES.CLAMP&&(l.wrapMode=r.WRAP_MODES.REPEAT));var p=h?this.simpleShader:this.shader;e.bindShader(p);var d=a.width,f=a.height,m=t._width,y=t._height;o.set(c.a*d/m,c.b*d/y,c.c*f/m,c.d*f/y,c.tx/m,c.ty/y),o.invert(),h?o.prepend(u.mapCoord):(p.uniforms.uMapCoord=u.mapCoord.toArray(!0),p.uniforms.uClampFrame=u.uClampFrame,p.uniforms.uClampOffset=u.uClampOffset),p.uniforms.uTransform=o.toArray(!0),p.uniforms.uColor=n.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,p.uniforms.uColor,l.premultipliedAlpha),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=e.bindTexture(a),e.setBlendMode(n.utils.correctBlendMode(t.blendMode,l.premultipliedAlpha)),i.vao.draw(this.renderer.gl.TRIANGLES,6,0)},e}(n.ObjectRenderer);i.default=s,n.WebGLRenderer.registerPlugin("tilingSprite",s)},{"../../core":65,"../../core/const":46,path:23}],143:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=a(t("./BlurXFilter")),s=a(t("./BlurYFilter"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(i,n,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return c.blurXFilter=new o.default(i,n,a,l),c.blurYFilter=new s.default(i,n,a,l),c.padding=0,c.resolution=a||r.settings.RESOLUTION,c.quality=n||4,c.blur=i||8,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var n=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,n,!0),this.blurYFilter.apply(t,n,i,!1),t.returnRenderTarget(n)},n(e,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),e}(r.Filter);i.default=l},{"../../core":65,"./BlurXFilter":144,"./BlurYFilter":145}],144:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=l(t("./generateBlurVertSource")),s=l(t("./generateBlurFragSource")),a=l(t("./getMaxBlurKernelSize"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(i,n,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),l=l||5;var c=(0,o.default)(l,!0),u=(0,s.default)(l),h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,c,u));return h.resolution=a||r.settings.RESOLUTION,h._quality=0,h.quality=n||4,h.strength=i||8,h.firstRun=!0,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i,n){if(this.firstRun){var r=t.renderer.gl,l=(0,a.default)(r);this.vertexSrc=(0,o.default)(l,!0),this.fragmentSrc=(0,s.default)(l),this.firstRun=!1}if(this.uniforms.strength=1/i.size.width*(i.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var c=t.getRenderTarget(!0),u=e,h=c,p=0;p<this.passes-1;p++){t.applyFilter(this,u,h,!0);var d=h;h=u,u=d}t.applyFilter(this,u,i,n),t.returnRenderTarget(c)}},n(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(r.Filter);i.default=c},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],145:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=l(t("./generateBlurVertSource")),s=l(t("./generateBlurFragSource")),a=l(t("./getMaxBlurKernelSize"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(i,n,a,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),l=l||5;var c=(0,o.default)(l,!1),u=(0,s.default)(l),h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,c,u));return h.resolution=a||r.settings.RESOLUTION,h._quality=0,h.quality=n||4,h.strength=i||8,h.firstRun=!0,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i,n){if(this.firstRun){var r=t.renderer.gl,l=(0,a.default)(r);this.vertexSrc=(0,o.default)(l,!1),this.fragmentSrc=(0,s.default)(l),this.firstRun=!1}if(this.uniforms.strength=1/i.size.height*(i.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var c=t.getRenderTarget(!0),u=e,h=c,p=0;p<this.passes-1;p++){t.applyFilter(this,u,h,!0);var d=h;h=u,u=d}t.applyFilter(this,u,i,n),t.returnRenderTarget(c)}},n(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(r.Filter);i.default=c},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],146:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){for(var e=n[t],i=e.length,o=r,s="",a=void 0,l=0;l<t;l++){var c="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",l);a=l,l>=i&&(a=t-l-1),c=c.replace("%value%",e[a]),s+=c,s+="\n"}return o=(o=o.replace("%blur%",s)).replace("%size%",t)};var n={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},r=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],147:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=Math.ceil(t/2),r=n,o="",s=void 0;s=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var l=s.replace("%index%",a);l=l.replace("%sampleIndex%",a-(i-1)+".0"),o+=l,o+="\n"}return r=(r=r.replace("%blur%",o)).replace("%size%",t)};var n=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],148:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=t.getParameter(t.MAX_VARYING_VECTORS),i=15;for(;i>e;)i-=2;return i}},{}],149:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return i.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i.alpha=1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._loadMatrix=function(t){var e=t;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(e,this.uniforms.m,t),e=this._colorMatrix(e)),this.uniforms.m=e},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),r=1/3,o=(0,Math.sqrt)(r),s=[i+(1-i)*r,r*(1-i)-o*n,r*(1-i)+o*n,0,0,r*(1-i)+o*n,i+r*(1-i),r*(1-i)-o*n,0,0,r*(1-i)-o*n,r*(1-i)+o*n,i+r*(1-i),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,n=-.5*(i-1),r=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.saturate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=2*t/3+1,n=-.5*(i-1),r=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,i,n,r){t=t||.2,e=e||.15;var o=((i=i||16770432)>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,l=((n=n||3375104)>>16&255)/255,c=(n>>8&255)/255,u=(255&n)/255,h=[.3,.59,.11,0,0,o,s,a,t,0,l,c,u,e,0,o-l,s-c,a-u,0,0];this._loadMatrix(h,r)},e.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},n(e,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(r.Filter);i.default=o,o.prototype.grayscale=o.prototype.greyscale},{"../../core":65,path:23}],150:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new r.Matrix;i.renderable=!1;var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return s.maskSprite=i,s.maskMatrix=o,s.uniforms.mapSampler=i._texture,s.uniforms.filterMatrix=o,s.uniforms.scale={x:1,y:1},null!==n&&void 0!==n||(n=20),s.scale=new r.Point(n,n),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var n=1/i.destinationFrame.width*(i.size.width/e.size.width);this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*n,this.uniforms.scale.y=this.scale.y*n,t.applyFilter(this,e,i)},n(e,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),e}(r.Filter);i.default=o},{"../../core":65,path:23}],151:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.Filter);i.default=r},{"../../core":65,path:23}],152:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./fxaa/FXAAFilter");Object.defineProperty(i,"FXAAFilter",{enumerable:!0,get:function(){return h(n).default}});var r=t("./noise/NoiseFilter");Object.defineProperty(i,"NoiseFilter",{enumerable:!0,get:function(){return h(r).default}});var o=t("./displacement/DisplacementFilter");Object.defineProperty(i,"DisplacementFilter",{enumerable:!0,get:function(){return h(o).default}});var s=t("./blur/BlurFilter");Object.defineProperty(i,"BlurFilter",{enumerable:!0,get:function(){return h(s).default}});var a=t("./blur/BlurXFilter");Object.defineProperty(i,"BlurXFilter",{enumerable:!0,get:function(){return h(a).default}});var l=t("./blur/BlurYFilter");Object.defineProperty(i,"BlurYFilter",{enumerable:!0,get:function(){return h(l).default}});var c=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(i,"ColorMatrixFilter",{enumerable:!0,get:function(){return h(c).default}});var u=t("./void/VoidFilter");function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"VoidFilter",{enumerable:!0,get:function(){return h(u).default}})},{"./blur/BlurFilter":143,"./blur/BlurXFilter":144,"./blur/BlurYFilter":145,"./colormatrix/ColorMatrixFilter":149,"./displacement/DisplacementFilter":150,"./fxaa/FXAAFilter":151,"./noise/NoiseFilter":153,"./void/VoidFilter":154}],153:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var o=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return r.noise=i,r.seed=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),n(e,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),e}(r.Filter);i.default=o},{"../../core":65,path:23}],154:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var r=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"));return i.glShaderKey="void",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.Filter);i.default=r},{"../../core":65,path:23}],155:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.global=new r.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t.prototype._copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=t.buttons,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},t.prototype._reset=function(){this.isPrimary=!1},n(t,[{key:"pointerId",get:function(){return this.identifier}}]),t}();i.default=o},{"../core":65}],156:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();i.default=n},{}],157:[function(t,e,i){"use strict";i.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=u(t("./InteractionData")),s=u(t("./InteractionEvent")),a=u(t("./InteractionTrackingData")),l=u(t("eventemitter3")),c=u(t("./interactiveTarget"));function u(t){return t&&t.__esModule?t:{default:t}}r.utils.mixins.delayMixin(r.DisplayObject.prototype,c.default);var h="MOUSE",p={target:null,data:{global:null}},d=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n=n||{},a.renderer=i,a.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,a.interactionFrequency=n.interactionFrequency||10,a.mouse=new o.default,a.mouse.identifier=h,a.mouse.global.set(-999999),a.activeInteractionData={},a.activeInteractionData[h]=a.mouse,a.interactionDataPool=[],a.eventData=new s.default,a.interactionDOMElement=null,a.moveWhenInside=!1,a.eventsAdded=!1,a.mouseOverRenderer=!1,a.supportsTouchEvents="ontouchstart"in window,a.supportsPointerEvents=!!window.PointerEvent,a.onPointerUp=a.onPointerUp.bind(a),a.processPointerUp=a.processPointerUp.bind(a),a.onPointerCancel=a.onPointerCancel.bind(a),a.processPointerCancel=a.processPointerCancel.bind(a),a.onPointerDown=a.onPointerDown.bind(a),a.processPointerDown=a.processPointerDown.bind(a),a.onPointerMove=a.onPointerMove.bind(a),a.processPointerMove=a.processPointerMove.bind(a),a.onPointerOut=a.onPointerOut.bind(a),a.processPointerOverOut=a.processPointerOverOut.bind(a),a.onPointerOver=a.onPointerOver.bind(a),a.cursorStyles={default:"inherit",pointer:"pointer"},a.currentCursorMode=null,a.cursor=null,a._tempPoint=new r.Point,a.resolution=1,a.setTargetElement(a.renderer.view,a.renderer.resolution),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.hitTest=function(t,e){return p.target=null,p.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(p,e,null,!0),p.target},e.prototype.setTargetElement=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(r.ticker.shared.add(this.update,this,r.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(r.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(void 0===e?"undefined":n(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.mapPositionToPoint=function(t,e,i){var n=void 0;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var r=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*r,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*r},e.prototype.processInteractive=function(t,e,i,n,r){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=r=e.interactive||r;if(e.hitArea?a=!1:n&&e._mask&&(e._mask.containsPoint(o)||(n=!1)),e.interactiveChildren&&e.children)for(var l=e.children,c=l.length-1;c>=0;c--){var u=l[c],h=this.processInteractive(t,u,i,n,a);if(h){if(!u.parent)continue;a=!1,h&&(t.target&&(n=!1),s=!0)}}return r&&(n&&!t.target&&(e.hitArea?(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(s=!0)):e.containsPoint&&e.containsPoint(o)&&(s=!0)),e.interactive&&(s&&!t.target&&(t.target=e),i&&i(t,e,!!s))),s},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var i=e.length,n=0;n<i;n++){var r=e[n],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===r.pointerType)this.emit("touchstart",s);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,i){var n=t.data,r=t.data.identifier;if(i)if(e.trackedPointers[r]||(e.trackedPointers[r]=new a.default(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var o=2===n.button;o?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var n=this.normalizeToPointerData(t),r=n.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<r;s++){var a=n[s],l=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(c.data.originalEvent=t,this.processInteractive(c,this.renderer._lastObjectRendered,i,e||!o),this.emit(e?"pointercancel":"pointerup"+o,c),"mouse"===a.pointerType||"pen"===a.pointerType){var u=2===a.button;this.emit(u?"rightup"+o:"mouseup"+o,c)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,c),this.releaseInteractionDataForPointerId(a.pointerId,l))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var n=t.data,r=t.data.identifier,o=e.trackedPointers[r],s="touch"===n.pointerType;if("mouse"===n.pointerType||"pen"===n.pointerType){var l=2===n.button,c=a.default.FLAGS,u=l?c.RIGHT_DOWN:c.LEFT_DOWN,h=void 0!==o&&o.flags&u;i?(this.dispatchEvent(e,l?"rightup":"mouseup",t),h&&this.dispatchEvent(e,l?"rightclick":"click",t)):h&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),o&&(l?o.rightDown=!1:o.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[r]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"===e[0].pointerType&&(this.didMove=!0,this.cursor=null);for(var i=e.length,n=0;n<i;n++){var r=e[n],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);s.data.originalEvent=t;var a="touch"!==r.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===r.pointerType&&this.emit("touchmove",s),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var n=t.data,r="touch"===n.pointerType,o="mouse"===n.pointerType||"pen"===n.pointerType;o&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var n=t.data,r=t.data.identifier,o="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[r];i&&!s&&(s=e.trackedPointers[r]=new a.default(r)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),o&&this.dispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[r]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},e.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId,i=void 0;return e===h||"mouse"===t.pointerType?i=this.mouse:this.activeInteractionData[e]?i=this.activeInteractionData[e]:((i=this.interactionDataPool.pop()||new o.default).identifier=e,this.activeInteractionData[e]=i),i._copyEvent(t),i},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e._reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(i.global.x=i.global.x/this.resolution,i.global.y=i.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t._reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var r=t.changedTouches[i];void 0===r.button&&(r.button=t.touches.length?1:0),void 0===r.buttons&&(r.buttons=t.touches.length?1:0),void 0===r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),r.twist=0,r.tangentialPressure=0,void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=h),void 0===t.pressure&&(t.pressure=.5),t.twist=0,t.tangentialPressure=0,t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(l.default);i.default=d,r.WebGLRenderer.registerPlugin("interaction",d),r.CanvasRenderer.registerPlugin("interaction",d)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},n(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),t}();i.default=r,r.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./InteractionData");Object.defineProperty(i,"InteractionData",{enumerable:!0,get:function(){return l(n).default}});var r=t("./InteractionManager");Object.defineProperty(i,"InteractionManager",{enumerable:!0,get:function(){return l(r).default}});var o=t("./interactiveTarget");Object.defineProperty(i,"interactiveTarget",{enumerable:!0,get:function(){return l(o).default}});var s=t("./InteractionTrackingData");Object.defineProperty(i,"InteractionTrackingData",{enumerable:!0,get:function(){return l(s).default}});var a=t("./InteractionEvent");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"InteractionEvent",{enumerable:!0,get:function(){return l(a).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(t,e,i){"use strict";i.__esModule=!0,i.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(t,e,i){"use strict";i.__esModule=!0,i.parse=a,i.default=function(){return function(t,e){if(t.data&&t.type===o.Resource.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var i=t.isDataUrl?"":n.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/")),(i=i.replace(this.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/");var s=i+t.data.getElementsByTagName("page")[0].getAttribute("file");if(r.utils.TextureCache[s])a(t,r.utils.TextureCache[s]),e();else{var l={crossOrigin:t.crossOrigin,loadType:o.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t};this.add(t.name+"_image",s,l,function(i){a(t,i.texture),e()})}}else e();else e()}};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("path")),r=t("../core"),o=t("resource-loader"),s=t("../extras");function a(t,e){t.bitmapFont=s.BitmapText.registerFont(t.data,e)}},{"../core":65,"../extras":141,path:23,"resource-loader":36}],162:[function(t,e,i){"use strict";i.__esModule=!0,i.shared=i.Resource=i.textureParser=i.getResourcePath=i.spritesheetParser=i.parseBitmapFontData=i.bitmapFontParser=i.Loader=void 0;var n=t("./bitmapFontParser");Object.defineProperty(i,"bitmapFontParser",{enumerable:!0,get:function(){return c(n).default}}),Object.defineProperty(i,"parseBitmapFontData",{enumerable:!0,get:function(){return n.parse}});var r=t("./spritesheetParser");Object.defineProperty(i,"spritesheetParser",{enumerable:!0,get:function(){return c(r).default}}),Object.defineProperty(i,"getResourcePath",{enumerable:!0,get:function(){return r.getResourcePath}});var o=t("./textureParser");Object.defineProperty(i,"textureParser",{enumerable:!0,get:function(){return c(o).default}});var s=t("resource-loader");Object.defineProperty(i,"Resource",{enumerable:!0,get:function(){return s.Resource}});var a=c(t("../core/Application")),l=c(t("./loader"));function c(t){return t&&t.__esModule?t:{default:t}}i.Loader=l.default;var u=new l.default;u.destroy=function(){},i.shared=u;var h=a.default.prototype;h._loader=null,Object.defineProperty(h,"loader",{get:function(){if(!this._loader){var t=this._options.sharedLoader;this._loader=t?u:new l.default}return this._loader}}),h._parentDestroy=h.destroy,h.destroy=function(t){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(t,e,i){"use strict";i.__esModule=!0;var n=c(t("resource-loader")),r=t("resource-loader/lib/middlewares/parsing/blob"),o=c(t("eventemitter3")),s=c(t("./textureParser")),a=c(t("./spritesheetParser")),l=c(t("./bitmapFontParser"));function c(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));o.default.call(r);for(var s=0;s<e._pixiMiddleware.length;++s)r.use(e._pixiMiddleware[s]());return r.onStart.add(function(t){return r.emit("start",t)}),r.onProgress.add(function(t,e){return r.emit("progress",t,e)}),r.onError.add(function(t,e,i){return r.emit("error",t,e,i)}),r.onLoad.add(function(t,e){return r.emit("load",t,e)}),r.onComplete.add(function(t,e){return r.emit("complete",t,e)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.addPixiMiddleware=function(t){e._pixiMiddleware.push(t)},e.prototype.destroy=function(){this.removeAllListeners(),this.reset()},e}(n.default);for(var h in i.default=u,o.default.prototype)u.prototype[h]=o.default.prototype[h];u._pixiMiddleware=[r.blobMiddlewareFactory,s.default,a.default,l.default];var p=n.default.Resource;p.setExtensionXhrType("fnt",p.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return function(t,e){var i=t.name+"_image";if(t.data&&t.type===r.Resource.TYPE.JSON&&t.data.frames&&!this.resources[i]){var n={crossOrigin:t.crossOrigin,loadType:r.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t},o=l(t,this.baseUrl);this.add(i,o,n,function(i){var n=new a.Spritesheet(i.texture.baseTexture,t.data,t.url);n.parse(function(){t.spritesheet=n,t.textures=n.textures,e()})})}else e()}},i.getResourcePath=l;var n,r=t("resource-loader"),o=t("url"),s=(n=o)&&n.__esModule?n:{default:n},a=t("../core");function l(t,e){return t.isDataUrl?t.data.meta.image:s.default.resolve(t.url.replace(e,""),t.data.meta.image)}},{"../core":65,"resource-loader":36,url:29}],165:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return function(t,e){t.data&&t.type===r.Resource.TYPE.IMAGE&&(t.texture=s.default.fromLoader(t.data,t.url,t.name)),e()}};var n,r=t("resource-loader"),o=t("../core/textures/Texture"),s=(n=o)&&n.__esModule?n:{default:n}},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),s=t("../extras/TextureTransform"),a=(n=s)&&n.__esModule?n:{default:n};var l=new o.Point,c=new o.Polygon,u=function(t){function e(i,n,r,s,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return c._texture=i,c.uvs=r||new Float32Array([0,0,1,0,1,1,0,1]),c.vertices=n||new Float32Array([0,0,100,0,100,100,0,100]),c.indices=s||new Uint16Array([0,1,3,2]),c.dirty=0,c.indexDirty=0,c.blendMode=o.BLEND_MODES.NORMAL,c.canvasPadding=0,c.drawMode=l||e.DRAW_MODES.TRIANGLE_MESH,c.shader=null,c.tintRgb=new Float32Array([1,1,1]),c._glDatas={},c._uvTransform=new a.default(i),c.uploadUvTransform=!1,c.pluginName="mesh",c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},e.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},e.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},e.prototype.refresh=function(t){this._uvTransform.update(t)&&this._refresh()},e.prototype._refresh=function(){},e.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,l);for(var i=this.vertices,n=c.points,r=this.indices,o=this.indices.length,s=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,a=0;a+2<o;a+=s){var u=2*r[a],h=2*r[a+1],p=2*r[a+2];if(n[0]=i[u],n[1]=i[u+1],n[2]=i[h],n[3]=i[h+1],n[4]=i[p],n[5]=i[p+1],c.contains(l.x,l.y))return!0}return!1},r(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return o.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=o.utils.hex2rgb(t,this.tintRgb)}}]),e}(o.Container);i.default=u,u.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../extras/TextureTransform":136}],167:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=t("./Plane");var s=10,a=function(t){function e(i,n,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,4,4));return l._origWidth=i.orig.width,l._origHeight=i.orig.height,l._width=l._origWidth,l._height=l._origHeight,l.leftWidth=void 0!==n?n:s,l.rightWidth=void 0!==o?o:s,l.topHeight=void 0!==r?r:s,l.bottomHeight=void 0!==a?a:s,l.refresh(!0),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateHorizontalVertices=function(){var t=this.vertices;t[9]=t[11]=t[13]=t[15]=this._topHeight,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices;t[2]=t[10]=t[18]=t[26]=this._leftWidth,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha;var i=this.worldTransform,n=t.resolution;t.roundPixels?e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n|0,i.ty*n|0):e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n,i.ty*n);var r=this._texture.baseTexture,o=r.source,s=r.width,a=r.height;this.drawSegment(e,o,s,a,0,1,10,11),this.drawSegment(e,o,s,a,2,3,12,13),this.drawSegment(e,o,s,a,4,5,14,15),this.drawSegment(e,o,s,a,8,9,18,19),this.drawSegment(e,o,s,a,10,11,20,21),this.drawSegment(e,o,s,a,12,13,22,23),this.drawSegment(e,o,s,a,16,17,26,27),this.drawSegment(e,o,s,a,18,19,28,29),this.drawSegment(e,o,s,a,20,21,30,31)},e.prototype.drawSegment=function(t,e,i,n,r,o,s,a){var l=this.uvs,c=this.vertices,u=(l[s]-l[r])*i,h=(l[a]-l[o])*n,p=c[s]-c[r],d=c[a]-c[o];u<1&&(u=1),h<1&&(h=1),p<1&&(p=1),d<1&&(d=1),t.drawImage(e,l[r]*i,l[o]*n,u,h,c[r],c[o],p,d)},e.prototype._refresh=function(){t.prototype._refresh.call(this);var e=this.uvs,i=this._texture;this._origWidth=i.orig.width,this._origHeight=i.orig.height;var n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},r(e,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),e}(((n=o)&&n.__esModule?n:{default:n}).default);i.default=a},{"./Plane":168}],168:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./Mesh"),o=(n=r)&&n.__esModule?n:{default:n};var s=function(t){function e(i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return s._ready=!0,s.verticesX=n||10,s.verticesY=r||10,s.drawMode=o.default.DRAW_MODES.TRIANGLES,s.refresh(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){for(var t=this._texture,e=this.verticesX*this.verticesY,i=[],n=[],r=[],o=this.verticesX-1,s=this.verticesY-1,a=t.width/o,l=t.height/s,c=0;c<e;c++){var u=c%this.verticesX,h=c/this.verticesX|0;i.push(u*a,h*l),n.push(u/o,h/s)}for(var p=o*s,d=0;d<p;d++){var f=d%o,m=d/o|0,y=m*this.verticesX+f,_=m*this.verticesX+f+1,x=(m+1)*this.verticesX+f,g=(m+1)*this.verticesX+f+1;r.push(y,_,x),r.push(_,g,x)}this.vertices=new Float32Array(i),this.uvs=new Float32Array(n),this.colors=new Float32Array([]),this.indices=new Uint16Array(r),this.indexDirty++,this.multiplyUvs()},e.prototype._onTextureUpdate=function(){o.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e}(o.default);i.default=s},{"./Mesh":166}],169:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("./Mesh");var o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.points=n,r.vertices=new Float32Array(4*n.length),r.uvs=new Float32Array(4*n.length),r.colors=new Float32Array(2*n.length),r.indices=new Uint16Array(2*n.length),r.autoUpdate=!0,r.refresh(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,i=this.indices,n=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var r=t.length,o=1;o<r;o++){var s=4*o,a=o/(r-1);e[s]=a,e[s+1]=0,e[s+2]=a,e[s+3]=1,n[s=2*o]=1,n[s+1]=1,i[s=2*o]=s,i[s+1]=s+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},e.prototype.refreshVertices=function(){var t=this.points;if(!(t.length<1))for(var e=t[0],i=void 0,n=0,r=0,o=this.vertices,s=t.length,a=0;a<s;a++){var l=t[a],c=4*a;r=-((i=a<t.length-1?t[a+1]:l).x-e.x),n=i.y-e.y;var u=10*(1-a/(s-1));u>1&&(u=1);var h=Math.sqrt(n*n+r*r),p=this._texture.height/2;n/=h,r/=h,n*=p,r*=p,o[c]=l.x+n,o[c+1]=l.y+r,o[c+2]=l.x-n,o[c+3]=l.y-r,e=l}},e.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},e}(((n=r)&&n.__esModule?n:{default:n}).default);i.default=o},{"./Mesh":166}],170:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=t("../Mesh"),s=(n=o)&&n.__esModule?n:{default:n};var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldTransform,r=e.resolution;e.roundPixels?i.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r|0,n.ty*r|0):i.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*r,n.ty*r),e.setBlendMode(t.blendMode),t.drawMode===s.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,i=0;i<e-2;i++){var n=2*i;this._renderDrawTriangle(t,n,n+2,n+4)}},t.prototype._renderTriangles=function(t){for(var e=t.indices,i=e.length,n=0;n<i;n+=3){var r=2*e[n],o=2*e[n+1],s=2*e[n+2];this._renderDrawTriangle(t,r,o,s)}},t.prototype._renderDrawTriangle=function(t,e,i,n){var r=this.renderer.context,o=t.uvs,s=t.vertices,a=t._texture;if(a.valid){var l=a.baseTexture,c=l.source,u=l.width,h=l.height,p=void 0,d=void 0,f=void 0,m=void 0,y=void 0,_=void 0;if(t.uploadUvTransform){var x=t._uvTransform.mapCoord;p=(o[e]*x.a+o[e+1]*x.c+x.tx)*l.width,d=(o[i]*x.a+o[i+1]*x.c+x.tx)*l.width,f=(o[n]*x.a+o[n+1]*x.c+x.tx)*l.width,m=(o[e]*x.b+o[e+1]*x.d+x.ty)*l.height,y=(o[i]*x.b+o[i+1]*x.d+x.ty)*l.height,_=(o[n]*x.b+o[n+1]*x.d+x.ty)*l.height}else p=o[e]*l.width,d=o[i]*l.width,f=o[n]*l.width,m=o[e+1]*l.height,y=o[i+1]*l.height,_=o[n+1]*l.height;var g=s[e],v=s[i],b=s[n],w=s[e+1],C=s[i+1],S=s[n+1];if(t.canvasPadding>0){var T=t.canvasPadding/t.worldTransform.a,D=t.canvasPadding/t.worldTransform.d,A=(g+v+b)/3,B=(w+C+S)/3,M=g-A,P=w-B,E=Math.sqrt(M*M+P*P);g=A+M/E*(E+T),w=B+P/E*(E+D),P=C-B,v=A+(M=v-A)/(E=Math.sqrt(M*M+P*P))*(E+T),C=B+P/E*(E+D),P=S-B,b=A+(M=b-A)/(E=Math.sqrt(M*M+P*P))*(E+T),S=B+P/E*(E+D)}r.save(),r.beginPath(),r.moveTo(g,w),r.lineTo(v,C),r.lineTo(b,S),r.closePath(),r.clip();var I=p*y+m*f+d*_-y*f-m*d-p*_,R=g*y+m*b+v*_-y*b-m*v-g*_,O=p*v+g*f+d*b-v*f-g*d-p*b,k=p*y*b+m*v*f+g*d*_-g*y*f-m*d*b-p*v*_,L=w*y+m*S+C*_-y*S-m*C-w*_,F=p*C+w*f+d*S-C*f-w*d-p*S,N=p*y*S+m*C*f+w*d*_-w*y*f-m*d*S-p*C*_;r.transform(R/I,L/I,O/I,F/I,k/I,N/I),r.drawImage(c,0,0,u*l.resolution,h*l.resolution,0,0,u,h),r.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,i=t.vertices,n=i.length/2;e.beginPath();for(var r=1;r<n-2;++r){var o=2*r,s=i[o],a=i[o+1],l=i[o+2],c=i[o+3],u=i[o+4],h=i[o+5];e.moveTo(s,a),e.lineTo(l,c),e.lineTo(u,h)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=a,r.CanvasRenderer.registerPlugin("mesh",a)},{"../../core":65,"../Mesh":166}],171:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./Mesh");Object.defineProperty(i,"Mesh",{enumerable:!0,get:function(){return c(n).default}});var r=t("./webgl/MeshRenderer");Object.defineProperty(i,"MeshRenderer",{enumerable:!0,get:function(){return c(r).default}});var o=t("./canvas/CanvasMeshRenderer");Object.defineProperty(i,"CanvasMeshRenderer",{enumerable:!0,get:function(){return c(o).default}});var s=t("./Plane");Object.defineProperty(i,"Plane",{enumerable:!0,get:function(){return c(s).default}});var a=t("./NineSlicePlane");Object.defineProperty(i,"NineSlicePlane",{enumerable:!0,get:function(){return c(a).default}});var l=t("./Rope");function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"Rope",{enumerable:!0,get:function(){return c(l).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),r=s(t("pixi-gl-core")),o=s(t("../Mesh"));t("path");function s(t){return t&&t.__esModule?t:{default:t}}var a=n.Matrix.IDENTITY,l=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.shader=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new n.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},e.prototype.render=function(t){var e=this.renderer,i=e.gl,s=t._texture;if(s.valid){var l=t._glDatas[e.CONTEXT_UID];l||(e.bindVao(null),(l={shader:this.shader,vertexBuffer:r.default.GLBuffer.createVertexBuffer(i,t.vertices,i.STREAM_DRAW),uvBuffer:r.default.GLBuffer.createVertexBuffer(i,t.uvs,i.STREAM_DRAW),indexBuffer:r.default.GLBuffer.createIndexBuffer(i,t.indices,i.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty}).vao=new r.default.VertexArrayObject(i).addIndex(l.indexBuffer).addAttribute(l.vertexBuffer,l.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(l.uvBuffer,l.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=l),e.bindVao(l.vao),t.dirty!==l.dirty&&(l.dirty=t.dirty,l.uvBuffer.upload(t.uvs)),t.indexDirty!==l.indexDirty&&(l.indexDirty=t.indexDirty,l.indexBuffer.upload(t.indices)),l.vertexBuffer.upload(t.vertices),e.bindShader(l.shader),l.shader.uniforms.uSampler=e.bindTexture(s),e.state.setBlendMode(n.utils.correctBlendMode(t.blendMode,s.baseTexture.premultipliedAlpha)),l.shader.uniforms.uTransform&&(t.uploadUvTransform?l.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):l.shader.uniforms.uTransform=a.toArray(!0)),l.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),l.shader.uniforms.uColor=n.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,l.shader.uniforms.uColor,s.baseTexture.premultipliedAlpha);var c=t.drawMode===o.default.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;l.vao.draw(c,t.indices.length,0)}},e}(n.ObjectRenderer);i.default=l,n.WebGLRenderer.registerPlugin("mesh",l)},{"../../core":65,"../Mesh":166,path:23,"pixi-gl-core":12}],173:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=t("../core/utils");var s=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,n=arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return o>16384&&(o=16384),o>i&&(o=i),a._properties=[!1,!0,!1,!1,!1],a._maxSize=i,a._batchSize=o,a._glBuffers={},a._bufferToUpdate=0,a.interactiveChildren=!1,a.blendMode=r.BLEND_MODES.NORMAL,a.autoResize=s,a.roundPixels=!0,a.baseTexture=null,a.setProperties(n),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t||"tint"in t?!!t.alpha||!!t.tint:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,n=!0,r=0,o=0,s=0,a=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var c=this.children[l];if(c.visible){var u=c._texture.frame;if(e.globalAlpha=this.worldAlpha*c.alpha,c.rotation%(2*Math.PI)==0)n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx*t.resolution,i.ty*t.resolution),n=!1),r=c.anchor.x*(-u.width*c.scale.x)+c.position.x+.5,o=c.anchor.y*(-u.height*c.scale.y)+c.position.y+.5,s=u.width*c.scale.x,a=u.height*c.scale.y;else{n||(n=!0),c.displayObjectUpdateTransform();var h=c.worldTransform;t.roundPixels?e.setTransform(h.a,h.b,h.c,h.d,h.tx*t.resolution|0,h.ty*t.resolution|0):e.setTransform(h.a,h.b,h.c,h.d,h.tx*t.resolution,h.ty*t.resolution),r=c.anchor.x*-u.width+.5,o=c.anchor.y*-u.height+.5,s=u.width,a=u.height}var p=c._texture.baseTexture.resolution;e.drawImage(c._texture.baseTexture.source,u.x*p,u.y*p,u.width*p,u.height*p,r*t.resolution,o*t.resolution,s*t.resolution,a*t.resolution)}}}},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._buffers)for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._properties=null,this._buffers=null},n(e,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,o.hex2rgb)(t,this.tintRgb)}}]),e}(r.Container);i.default=s},{"../core":65,"../core/utils":124}],174:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./ParticleContainer");Object.defineProperty(i,"ParticleContainer",{enumerable:!0,get:function(){return o(n).default}});var r=t("./webgl/ParticleRenderer");function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"ParticleRenderer",{enumerable:!0,get:function(){return o(r).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(t,e,i){"use strict";i.__esModule=!0;var n=o(t("pixi-gl-core")),r=o(t("../../core/utils/createIndicesForQuads"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e,i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var o=0;o<i.length;++o){var s=i[o];s={attribute:s.attribute,size:s.size,uploadFunction:s.uploadFunction,unsignedByte:s.unsignedByte,offset:s.offset},n[o]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,r.default)(this.size),this.indexBuffer=n.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var o=this.dynamicProperties[i];o.offset=e,e+=o.size,this.dynamicStride+=o.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=n.default.GLBuffer.createVertexBuffer(t,s,t.STREAM_DRAW);var a=0;this.staticStride=0;for(var l=0;l<this.staticProperties.length;++l){var c=this.staticProperties[l];c.offset=a,a+=c.size,this.staticStride+=c.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=n.default.GLBuffer.createVertexBuffer(t,u,t.STATIC_DRAW),this.vao=new n.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var h=0;h<this.dynamicProperties.length;++h){var p=this.dynamicProperties[h];p.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,p.attribute,t.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*p.offset):this.vao.addAttribute(this.dynamicBuffer,p.attribute,t.FLOAT,!1,4*this.dynamicStride,4*p.offset)}for(var d=0;d<this.staticProperties.length;++d){var f=this.staticProperties[d];f.unsignedByte?this.vao.addAttribute(this.staticBuffer,f.attribute,t.UNSIGNED_BYTE,!0,4*this.staticStride,4*f.offset):this.vao.addAttribute(this.staticBuffer,f.attribute,t.FLOAT,!1,4*this.staticStride,4*f.offset)}},t.prototype.uploadDynamic=function(t,e,i){for(var n=0;n<this.dynamicProperties.length;n++){var r=this.dynamicProperties[n];r.uploadFunction(t,e,i,r.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer.upload()},t.prototype.uploadStatic=function(t,e,i){for(var n=0;n<this.staticProperties.length;n++){var r=this.staticProperties[n];r.uploadFunction(t,e,i,r.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer.upload()},t.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()},t}();i.default=s},{"../../core/utils/createIndicesForQuads":122,"pixi-gl-core":12}],176:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),r=a(t("./ParticleShader")),o=a(t("./ParticleBuffer")),s=t("../../core/utils");function a(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.shader=null,r.indexBuffer=null,r.properties=null,r.tempMatrix=new n.Matrix,r.CONTEXT_UID=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new r.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},e.prototype.start=function(){this.renderer.bindShader(this.shader)},e.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,o=this.renderer,s=e.length;if(0!==s){s>i&&(s=i);var a=t._glBuffers[o.CONTEXT_UID];a||(a=t._glBuffers[o.CONTEXT_UID]=this.generateBuffers(t));var l=e[0]._texture.baseTexture;this.renderer.setBlendMode(n.utils.correctBlendMode(t.blendMode,l.premultipliedAlpha));var c=o.gl,u=t.worldTransform.copy(this.tempMatrix);u.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=u.toArray(!0),this.shader.uniforms.uColor=n.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,l.premultipliedAlpha),this.shader.uniforms.uSampler=o.bindTexture(l);for(var h=0,p=0;h<s;h+=r,p+=1){var d=s-h;if(d>r&&(d=r),p>=a.length){if(!t.autoResize)break;a.push(this._generateOneMoreBuffer(t))}var f=a[p];f.uploadDynamic(e,h,d),t._bufferToUpdate===p&&(f.uploadStatic(e,h,d),t._bufferToUpdate=p+1),o.bindVao(f.vao),f.vao.draw(c.TRIANGLES,6*d)}}},e.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,i=[],n=t._maxSize,r=t._batchSize,s=t._properties,a=0;a<n;a+=r)i.push(new o.default(e,this.properties,s,r));return i},e.prototype._generateOneMoreBuffer=function(t){var e=this.renderer.gl,i=t._batchSize,n=t._properties;return new o.default(e,this.properties,n,i)},e.prototype.uploadVertices=function(t,e,i,n,r,o){for(var s=0,a=0,l=0,c=0,u=0;u<i;++u){var h=t[e+u],p=h._texture,d=h.scale.x,f=h.scale.y,m=p.trim,y=p.orig;m?(s=(a=m.x-h.anchor.x*y.width)+m.width,l=(c=m.y-h.anchor.y*y.height)+m.height):(s=y.width*(1-h.anchor.x),a=y.width*-h.anchor.x,l=y.height*(1-h.anchor.y),c=y.height*-h.anchor.y),n[o]=a*d,n[o+1]=c*f,n[o+r]=s*d,n[o+r+1]=c*f,n[o+2*r]=s*d,n[o+2*r+1]=l*f,n[o+3*r]=a*d,n[o+3*r+1]=l*f,o+=4*r}},e.prototype.uploadPosition=function(t,e,i,n,r,o){for(var s=0;s<i;s++){var a=t[e+s].position;n[o]=a.x,n[o+1]=a.y,n[o+r]=a.x,n[o+r+1]=a.y,n[o+2*r]=a.x,n[o+2*r+1]=a.y,n[o+3*r]=a.x,n[o+3*r+1]=a.y,o+=4*r}},e.prototype.uploadRotation=function(t,e,i,n,r,o){for(var s=0;s<i;s++){var a=t[e+s].rotation;n[o]=a,n[o+r]=a,n[o+2*r]=a,n[o+3*r]=a,o+=4*r}},e.prototype.uploadUvs=function(t,e,i,n,r,o){for(var s=0;s<i;++s){var a=t[e+s]._texture._uvs;a?(n[o]=a.x0,n[o+1]=a.y0,n[o+r]=a.x1,n[o+r+1]=a.y1,n[o+2*r]=a.x2,n[o+2*r+1]=a.y2,n[o+3*r]=a.x3,n[o+3*r+1]=a.y3,o+=4*r):(n[o]=0,n[o+1]=0,n[o+r]=0,n[o+r+1]=0,n[o+2*r]=0,n[o+2*r+1]=0,n[o+3*r]=0,n[o+3*r+1]=0,o+=4*r)}},e.prototype.uploadTint=function(t,e,i,n,r,o){for(var a=0;a<i;++a){var l=t[e+a],c=l._texture.baseTexture.premultipliedAlpha,u=l.alpha,h=u<1&&c?(0,s.premultiplyTint)(l._tintRGB,u):l._tintRGB+(255*u<<24);n[o]=h,n[o+r]=h,n[o+2*r]=h,n[o+3*r]=h,o+=4*r}},e.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),t.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},e}(n.ObjectRenderer);i.default=l,n.WebGLRenderer.registerPlugin("particle",l)},{"../../core":65,"../../core/utils":124,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=t("../../core/Shader");var o=function(t){function e(i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((n=r)&&n.__esModule?n:{default:n}).default);i.default=o},{"../../core/Shader":44}],178:[function(t,e,i){"use strict";Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1})},{}],179:[function(t,e,i){"use strict";var n,r=t("object-assign"),o=(n=r)&&n.__esModule?n:{default:n};Object.assign||(Object.assign=o.default)},{"object-assign":5}],180:[function(t,e,i){"use strict";t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Object.assign":179,"./requestAnimationFrame":181}],181:[function(t,e,i){(function(t){"use strict";if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var i=Date.now(),n=["ms","moz","webkit","o"],r=0;r<n.length&&!t.requestAnimationFrame;++r){var o=n[r];t.requestAnimationFrame=t[o+"RequestAnimationFrame"],t.cancelAnimationFrame=t[o+"CancelAnimationFrame"]||t[o+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+i-e;return n<0&&(n=0),i=e,setTimeout(function(){i=Date.now(),t(performance.now())},n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],182:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=t("./limiters/CountLimiter"),s=(n=o)&&n.__esModule?n:{default:n};var a=r.ticker.shared;r.settings.UPLOADS_PER_FRAME=4;var l=function(){function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.limiter=new s.default(r.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){i.queue&&i.prepareItems()},this.registerFindHook(f),this.registerFindHook(m),this.registerFindHook(c),this.registerFindHook(u),this.registerFindHook(h),this.registerUploadHook(p),this.registerUploadHook(d)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,a.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)a.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var o=this.completes.slice(0);this.completes.length=0;for(var s=0,l=o.length;s<l;s++)o[s]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof r.Container)for(var n=t.children.length-1;n>=0;n--)this.add(t.children[n]);return this},t.prototype.destroy=function(){this.ticking&&a.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function c(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var n=0;n<t._textures.length;n++)if(t._textures[n]instanceof r.Texture){var o=t._textures[n].baseTexture;-1===e.indexOf(o)&&(e.push(o),i=!0)}return i}function u(t,e){return t instanceof r.BaseTexture&&(-1===e.indexOf(t)&&e.push(t),!0)}function h(t,e){if(t._texture&&t._texture instanceof r.Texture){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function p(t,e){return e instanceof r.Text&&(e.updateText(!0),!0)}function d(t,e){if(e instanceof r.TextStyle){var i=e.toFontString();return r.TextMetrics.measureFont(i),!0}return!1}function f(t,e){if(t instanceof r.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function m(t,e){return t instanceof r.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}i.default=l},{"../core":65,"./limiters/CountLimiter":185}],183:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=t("../BasePrepare");var s=16,a=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=s,n.canvas.height=s,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(l),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(((n=o)&&n.__esModule?n:{default:n}).default);function l(t,e){if(e instanceof r.BaseTexture){var i=e.source,n=0===i.width?t.canvas.width:Math.min(t.canvas.width,i.width),o=0===i.height?t.canvas.height:Math.min(t.canvas.height,i.height);return t.ctx.drawImage(i,0,0,n,o,0,0,t.canvas.width,t.canvas.height),!0}return!1}i.default=a,r.CanvasRenderer.registerPlugin("prepare",a)},{"../../core":65,"../BasePrepare":182}],184:[function(t,e,i){"use strict";i.__esModule=!0;var n=t("./webgl/WebGLPrepare");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return l(n).default}});var r=t("./canvas/CanvasPrepare");Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return l(r).default}});var o=t("./BasePrepare");Object.defineProperty(i,"BasePrepare",{enumerable:!0,get:function(){return l(o).default}});var s=t("./limiters/CountLimiter");Object.defineProperty(i,"CountLimiter",{enumerable:!0,get:function(){return l(s).default}});var a=t("./limiters/TimeLimiter");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"TimeLimiter",{enumerable:!0,get:function(){return l(a).default}})},{"./BasePrepare":182,"./canvas/CanvasPrepare":183,"./limiters/CountLimiter":185,"./limiters/TimeLimiter":186,"./webgl/WebGLPrepare":187}],185:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();i.default=n},{}],186:[function(t,e,i){"use strict";i.__esModule=!0;var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();i.default=n},{}],187:[function(t,e,i){"use strict";i.__esModule=!0;var n,r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),o=t("../BasePrepare");var s=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.uploadHookHelper=n.renderer,n.registerFindHook(c),n.registerUploadHook(a),n.registerUploadHook(l),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((n=o)&&n.__esModule?n:{default:n}).default);function a(t,e){return e instanceof r.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function l(t,e){return e instanceof r.Graphics&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function c(t,e){return t instanceof r.Graphics&&(e.push(t),!0)}i.default=s,r.WebGLRenderer.registerPlugin("prepare",s)},{"../../core":65,"../BasePrepare":182}],188:[function(t,e,i){(function(e){"use strict";i.__esModule=!0,i.loader=i.prepare=i.particles=i.mesh=i.loaders=i.interaction=i.filters=i.extras=i.extract=i.accessibility=void 0;var n=t("./polyfill");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return n[t]}})});var r=t("./core");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var o,s=t("./deprecation"),a=(o=s)&&o.__esModule?o:{default:o},l=_(t("./accessibility")),c=_(t("./extract")),u=_(t("./extras")),h=_(t("./filters")),p=_(t("./interaction")),d=_(t("./loaders")),f=_(t("./mesh")),m=_(t("./particles")),y=_(t("./prepare"));function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}r.utils.mixins.performMixins();var x=d.shared||null;i.accessibility=l,i.extract=c,i.extras=u,i.filters=h,i.interaction=p,i.loaders=d,i.mesh=f,i.particles=m,i.prepare=y,i.loader=x,"function"==typeof a.default&&(0,a.default)(i),e.PIXI=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":130,"./extract":132,"./extras":141,"./filters":152,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":180,"./prepare":184}]},{},[188])(188)}),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pixiParticles=t()}}(function(){var define,module,exports;return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return r(i||t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";var n=t("./ParticleUtils"),r=t("./Particle"),o=PIXI.Texture,s=function(t){r.call(this,t),this.textures=null,this.duration=0,this.framerate=0,this.elapsed=0,this.loop=!1},a=r.prototype,l=s.prototype=Object.create(a);l.init=function(){this.Particle_init(),this.elapsed=0,this.framerate<0&&(this.duration=this.maxLife,this.framerate=this.textures.length/this.duration)},l.applyArt=function(t){this.textures=t.textures,this.framerate=t.framerate,this.duration=t.duration,this.loop=t.loop},l.update=function(t){if(this.Particle_update(t)>=0){this.elapsed+=t,this.elapsed>this.duration&&(this.loop?this.elapsed=this.elapsed%this.duration:this.elapsed=this.duration-1e-6);var e=this.elapsed*this.framerate+1e-7|0;this.texture=this.textures[e]||n.EMPTY_TEXTURE}},l.Particle_destroy=r.prototype.destroy,l.destroy=function(){this.Particle_destroy(),this.textures=null},s.parseArt=function(t){var e,i,n,r,s,a,l=[];for(e=0;e<t.length;++e){for(i=t[e],t[e]=l={},l.textures=a=[],r=i.textures,n=0;n<r.length;++n)if("string"==typeof(s=r[n]))a.push(o.fromImage(s));else if(s instanceof o)a.push(s);else{var c=s.count||1;for(s="string"==typeof s.texture?o.fromImage(s.texture):s.texture;c>0;--c)a.push(s)}"matchLife"==i.framerate?(l.framerate=-1,l.duration=0,l.loop=!1):(l.loop=!!i.loop,l.framerate=i.framerate>0?i.framerate:60,l.duration=a.length/l.framerate)}return t},e.exports=s},{"./Particle":3,"./ParticleUtils":4}],2:[function(t,e,i){"use strict";var n=t("./ParticleUtils"),r=t("./Particle"),o=PIXI.particles.ParticleContainer||PIXI.ParticleContainer,s=PIXI.ticker.shared,a=function(t,e,i){this._particleConstructor=r,this.particleImages=null,this.startAlpha=1,this.endAlpha=1,this.startSpeed=0,this.endSpeed=0,this.minimumSpeedMultiplier=1,this.acceleration=null,this.maxSpeed=NaN,this.startScale=1,this.endScale=1,this.minimumScaleMultiplier=1,this.startColor=null,this.endColor=null,this.minLifetime=0,this.maxLifetime=0,this.minStartRotation=0,this.maxStartRotation=0,this.noRotation=!1,this.minRotationSpeed=0,this.maxRotationSpeed=0,this.particleBlendMode=0,this.customEase=null,this.extraData=null,this._frequency=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=null,this.spawnType=null,this._spawnFunc=null,this.spawnRect=null,this.spawnCircle=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this._parentIsPC=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._origArt=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this.parent=t,e&&i&&this.init(e,i),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos},l=a.prototype={},c=new PIXI.Point;Object.defineProperty(l,"frequency",{get:function(){return this._frequency},set:function(t){this._frequency="number"==typeof t&&t>0?t:1}}),Object.defineProperty(l,"particleConstructor",{get:function(){return this._particleConstructor},set:function(t){if(t!=this._particleConstructor){this._particleConstructor=t,this.cleanup();for(var e=this._poolFirst;e;e=e.next)e.destroy();this._poolFirst=null,this._origConfig&&this._origArt&&this.init(this._origArt,this._origConfig)}}}),Object.defineProperty(l,"parent",{get:function(){return this._parent},set:function(t){if(this._parentIsPC)for(var e=this._poolFirst;e;e=e.next)e.parent&&e.parent.removeChild(e);this.cleanup(),this._parent=t,this._parentIsPC=o&&t&&t instanceof o}}),l.init=function(t,e){if(t&&e){this.cleanup(),this._origConfig=e,this._origArt=t,t=Array.isArray(t)?t.slice():[t];var i=this._particleConstructor;this.particleImages=i.parseArt?i.parseArt(t):t,e.alpha?(this.startAlpha=e.alpha.start,this.endAlpha=e.alpha.end):this.startAlpha=this.endAlpha=1,e.speed?(this.startSpeed=e.speed.start,this.endSpeed=e.speed.end,this.minimumSpeedMultiplier=e.speed.minimumSpeedMultiplier||1):(this.minimumSpeedMultiplier=1,this.startSpeed=this.endSpeed=0);var r,o=e.acceleration;switch(o&&(o.x||o.y)?(this.endSpeed=this.startSpeed,this.acceleration=new PIXI.Point(o.x,o.y),this.maxSpeed=e.maxSpeed||NaN):this.acceleration=new PIXI.Point,e.scale?(this.startScale=e.scale.start,this.endScale=e.scale.end,this.minimumScaleMultiplier=e.scale.minimumScaleMultiplier||1):this.startScale=this.endScale=this.minimumScaleMultiplier=1,e.color&&(this.startColor=n.hexToRGB(e.color.start),e.color.start!=e.color.end?this.endColor=n.hexToRGB(e.color.end):this.endColor=null),e.startRotation?(this.minStartRotation=e.startRotation.min,this.maxStartRotation=e.startRotation.max):this.minStartRotation=this.maxStartRotation=0,e.noRotation&&(this.minStartRotation||this.maxStartRotation)?this.noRotation=!!e.noRotation:this.noRotation=!1,e.rotationSpeed?(this.minRotationSpeed=e.rotationSpeed.min,this.maxRotationSpeed=e.rotationSpeed.max):this.minRotationSpeed=this.maxRotationSpeed=0,this.minLifetime=e.lifetime.min,this.maxLifetime=e.lifetime.max,this.particleBlendMode=n.getBlendMode(e.blendMode),e.ease?this.customEase="function"==typeof e.ease?e.ease:n.generateEase(e.ease):this.customEase=null,i.parseData?this.extraData=i.parseData(e.extraData):this.extraData=e.extraData||null,this.spawnRect=this.spawnCircle=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,e.spawnType){case"rect":this.spawnType="rect",this._spawnFunc=this._spawnRect;var s=e.spawnRect;this.spawnRect=new PIXI.Rectangle(s.x,s.y,s.w,s.h);break;case"circle":this.spawnType="circle",this._spawnFunc=this._spawnCircle,r=e.spawnCircle,this.spawnCircle=new PIXI.Circle(r.x,r.y,r.r);break;case"ring":this.spawnType="ring",this._spawnFunc=this._spawnRing,r=e.spawnCircle,this.spawnCircle=new PIXI.Circle(r.x,r.y,r.r),this.spawnCircle.minRadius=r.minR;break;case"burst":this.spawnType="burst",this._spawnFunc=this._spawnBurst,this.particlesPerWave=e.particlesPerWave,this.particleSpacing=e.particleSpacing,this.angleStart=e.angleStart?e.angleStart:0;break;case"point":default:this.spawnType="point",this._spawnFunc=this._spawnPoint}this.frequency=e.frequency,this.emitterLifetime=e.emitterLifetime||-1,this.maxParticles=e.maxParticles>0?e.maxParticles:1e3,this.addAtBack=!!e.addAtBack,this.rotation=0,this.ownerPos=new PIXI.Point,this.spawnPos=new PIXI.Point(e.pos.x,e.pos.y),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===e.emit||!!e.emit,this.autoUpdate=void 0!==e.autoUpdate&&!!e.autoUpdate}},l.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t==this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t==this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,this._parentIsPC?(t.alpha=0,t.visible=!1):t.parent&&t.parent.removeChild(t),--this.particleCount},l.rotate=function(t){if(this.rotation!=t){var e=t-this.rotation;this.rotation=t,n.rotatePoint(e,this.spawnPos),this._posChanged=!0}},l.updateSpawnPos=function(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e},l.updateOwnerPos=function(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e},l.resetPositionTracking=function(){this._prevPosIsValid=!1},Object.defineProperty(l,"emit",{get:function(){return this._emit},set:function(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}}),Object.defineProperty(l,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){this._autoUpdate&&!t?s.remove(this.update,this):!this._autoUpdate&&t&&s.add(this.update,this),this._autoUpdate=!!t}}),l.playOnceAndDestroy=function(){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0},l.update=function(t){if(this._autoUpdate&&(t=t/PIXI.settings.TARGET_FPMS/1e3),this._parent){var e,i,n,r,o;for(i=this._activeParticlesFirst;i;i=n)n=i.next,i.update(t);this._prevPosIsValid&&(r=this._prevEmitterPos.x,o=this._prevEmitterPos.y);var s=this.ownerPos.x+this.spawnPos.x,a=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t;this._spawnTimer<=0;){if(this._emitterLife>0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles)this._spawnTimer+=this._frequency;else{var l;if(l=this.minLifetime==this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer<l){var c,u;if(this._prevPosIsValid&&this._posChanged){var h=1+this._spawnTimer/t;c=(s-r)*h+r,u=(a-o)*h+o}else c=s,u=a;e=0;for(var p=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount);e<p;++e){var d,f;if(this._poolFirst?(d=this._poolFirst,this._poolFirst=this._poolFirst.next,d.next=null):d=new this.particleConstructor(this),this.particleImages.length>1?d.applyArt(this.particleImages[Math.floor(Math.random()*this.particleImages.length)]):d.applyArt(this.particleImages[0]),d.startAlpha=this.startAlpha,d.endAlpha=this.endAlpha,1!=this.minimumSpeedMultiplier?(f=Math.random()*(1-this.minimumSpeedMultiplier)+this.minimumSpeedMultiplier,d.startSpeed=this.startSpeed*f,d.endSpeed=this.endSpeed*f):(d.startSpeed=this.startSpeed,d.endSpeed=this.endSpeed),d.acceleration.x=this.acceleration.x,d.acceleration.y=this.acceleration.y,d.maxSpeed=this.maxSpeed,1!=this.minimumScaleMultiplier?(f=Math.random()*(1-this.minimumScaleMultiplier)+this.minimumScaleMultiplier,d.startScale=this.startScale*f,d.endScale=this.endScale*f):(d.startScale=this.startScale,d.endScale=this.endScale),d.startColor=this.startColor,d.endColor=this.endColor,this.minRotationSpeed==this.maxRotationSpeed?d.rotationSpeed=this.minRotationSpeed:d.rotationSpeed=Math.random()*(this.maxRotationSpeed-this.minRotationSpeed)+this.minRotationSpeed,d.noRotation=this.noRotation,d.maxLife=l,d.blendMode=this.particleBlendMode,d.ease=this.customEase,d.extraData=this.extraData,this._spawnFunc(d,c,u,e),d.init(),d.update(-this._spawnTimer),this._parentIsPC&&d.parent){var m=this._parent.children;if(m[0]==d)m.shift();else if(m[m.length-1]==d)m.pop();else{var y=m.indexOf(d);m.splice(y,1)}this.addAtBack?m.unshift(d):m.push(d)}else this.addAtBack?this._parent.addChildAt(d,0):this._parent.addChild(d);this._activeParticlesLast?(this._activeParticlesLast.next=d,d.prev=this._activeParticlesLast,this._activeParticlesLast=d):this._activeParticlesLast=this._activeParticlesFirst=d,++this.particleCount}}this._spawnTimer+=this._frequency}}this._posChanged&&(this._prevEmitterPos.x=s,this._prevEmitterPos.y=a,this._prevPosIsValid=!0,this._posChanged=!1),!this._destroyWhenComplete||this._emit||this._activeParticlesFirst||this.destroy()}},l._spawnPoint=function(t,e,i){this.minStartRotation==this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,t.position.x=e,t.position.y=i},l._spawnRect=function(t,e,i){this.minStartRotation==this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,c.x=Math.random()*this.spawnRect.width+this.spawnRect.x,c.y=Math.random()*this.spawnRect.height+this.spawnRect.y,0!==this.rotation&&n.rotatePoint(this.rotation,c),t.position.x=e+c.x,t.position.y=i+c.y},l._spawnCircle=function(t,e,i){this.minStartRotation==this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,c.x=Math.random()*this.spawnCircle.radius,c.y=0,n.rotatePoint(360*Math.random(),c),c.x+=this.spawnCircle.x,c.y+=this.spawnCircle.y,0!==this.rotation&&n.rotatePoint(this.rotation,c),t.position.x=e+c.x,t.position.y=i+c.y},l._spawnRing=function(t,e,i){var r=this.spawnCircle;this.minStartRotation==this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,r.minRadius==r.radius?c.x=Math.random()*(r.radius-r.minRadius)+r.minRadius:c.x=r.radius,c.y=0;var o=360*Math.random();t.rotation+=o,n.rotatePoint(o,c),c.x+=this.spawnCircle.x,c.y+=this.spawnCircle.y,0!==this.rotation&&n.rotatePoint(this.rotation,c),t.position.x=e+c.x,t.position.y=i+c.y},l._spawnBurst=function(t,e,i,n){0===this.particleSpacing?t.rotation=360*Math.random():t.rotation=this.angleStart+this.particleSpacing*n+this.rotation,t.position.x=e,t.position.y=i},l.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t),t.parent&&t.parent.removeChild(t);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0},l.destroy=function(){var t;this.autoUpdate=!1,this.cleanup();for(var e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.particleImages=this.spawnPos=this.ownerPos=this.startColor=this.endColor=this.customEase=null},e.exports=a},{"./Particle":3,"./ParticleUtils":4}],3:[function(t,e,i){var n=t("./ParticleUtils"),r=PIXI.Sprite,o=function(t){r.call(this),this.emitter=t,this.anchor.x=this.anchor.y=.5,this.velocity=new PIXI.Point,this.maxLife=0,this.age=0,this.ease=null,this.extraData=null,this.startAlpha=0,this.endAlpha=0,this.startSpeed=0,this.endSpeed=0,this.acceleration=new PIXI.Point,this.maxSpeed=NaN,this.startScale=0,this.endScale=0,this.startColor=null,this._sR=0,this._sG=0,this._sB=0,this.endColor=null,this._eR=0,this._eG=0,this._eB=0,this._doAlpha=!1,this._doScale=!1,this._doSpeed=!1,this._doAcceleration=!1,this._doColor=!1,this._doNormalMovement=!1,this._oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.Particle_init=this.Particle_init,this.update=this.update,this.Particle_update=this.Particle_update,this.applyArt=this.applyArt,this.kill=this.kill},s=o.prototype=Object.create(r.prototype);s.init=s.Particle_init=function(){this.age=0,this.velocity.x=this.startSpeed,this.velocity.y=0,n.rotatePoint(this.rotation,this.velocity),this.noRotation?this.rotation=0:this.rotation*=n.DEG_TO_RADS,this.rotationSpeed*=n.DEG_TO_RADS,this.alpha=this.startAlpha,this.scale.x=this.scale.y=this.startScale,this.startColor&&(this._sR=this.startColor[0],this._sG=this.startColor[1],this._sB=this.startColor[2],this.endColor&&(this._eR=this.endColor[0],this._eG=this.endColor[1],this._eB=this.endColor[2])),this._doAlpha=this.startAlpha!=this.endAlpha,this._doSpeed=this.startSpeed!=this.endSpeed,this._doScale=this.startScale!=this.endScale,this._doColor=!!this.endColor,this._doAcceleration=0!==this.acceleration.x||0!==this.acceleration.y,this._doNormalMovement=this._doSpeed||0!==this.startSpeed||this._doAcceleration,this._oneOverLife=1/this.maxLife,this.tint=n.combineRGBComponents(this._sR,this._sG,this._sB),this.visible=!0},s.applyArt=function(t){this.texture=t||n.EMPTY_TEXTURE},s.update=s.Particle_update=function(t){if(this.age+=t,this.age>=this.maxLife)return this.kill(),-1;var e=this.age*this._oneOverLife;if(this.ease&&(e=4==this.ease.length?this.ease(e,0,1,1):this.ease(e)),this._doAlpha&&(this.alpha=(this.endAlpha-this.startAlpha)*e+this.startAlpha),this._doScale){var i=(this.endScale-this.startScale)*e+this.startScale;this.scale.x=this.scale.y=i}if(this._doNormalMovement){if(this._doSpeed){var r=(this.endSpeed-this.startSpeed)*e+this.startSpeed;n.normalize(this.velocity),n.scaleBy(this.velocity,r)}else if(this._doAcceleration&&(this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.maxSpeed)){var o=n.length(this.velocity);o>this.maxSpeed&&n.scaleBy(this.velocity,this.maxSpeed/o)}this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t}if(this._doColor){var s=(this._eR-this._sR)*e+this._sR,a=(this._eG-this._sG)*e+this._sG,l=(this._eB-this._sB)*e+this._sB;this.tint=n.combineRGBComponents(s,a,l)}return 0!==this.rotationSpeed?this.rotation+=this.rotationSpeed*t:this.acceleration&&!this.noRotation&&(this.rotation=Math.atan2(this.velocity.y,this.velocity.x)),e},s.kill=function(){this.emitter.recycle(this)},s.Sprite_Destroy=r.prototype.destroy,s.destroy=function(){this.parent&&this.parent.removeChild(this),this.Sprite_Destroy&&this.Sprite_Destroy(),this.emitter=this.velocity=this.startColor=this.endColor=this.ease=this.next=this.prev=null},o.parseArt=function(t){var e;for(e=t.length;e>=0;--e)"string"==typeof t[e]&&(t[e]=PIXI.Texture.fromImage(t[e]));if(n.verbose)for(e=t.length-1;e>0;--e)if(t[e].baseTexture!=t[e-1].baseTexture){window.console&&console.warn("PixiParticles: using particle textures from different images may hinder performance in WebGL");break}return t},o.parseData=function(t){return t},e.exports=o},{"./ParticleUtils":4}],4:[function(t,e,i){"use strict";var n=PIXI.BLEND_MODES||PIXI.blendModes,r=PIXI.Texture,o={verbose:!1},s=o.DEG_TO_RADS=Math.PI/180,a=o.EMPTY_TEXTURE=r.EMPTY;a.on=a.destroy=a.once=a.emit=function(){},o.rotatePoint=function(t,e){if(t){t*=s;var i=Math.sin(t),n=Math.cos(t),r=e.x*n-e.y*i,o=e.x*i+e.y*n;e.x=r,e.y=o}},o.combineRGBComponents=function(t,e,i){return t<<16|e<<8|i},o.normalize=function(t){var e=1/o.length(t);t.x*=e,t.y*=e},o.scaleBy=function(t,e){t.x*=e,t.y*=e},o.length=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},o.hexToRGB=function(t,e){var i;return e?e.length=0:e=[],"#"==t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8==t.length&&(i=t.substr(0,2),t=t.substr(2)),e.push(parseInt(t.substr(0,2),16)),e.push(parseInt(t.substr(2,2),16)),e.push(parseInt(t.substr(4,2),16)),i&&e.push(parseInt(i,16)),e},o.generateEase=function(t){var e=t.length,i=1/e;return function(n){var r,o,s=e*n|0;return r=(n-s*i)*e,(o=t[s]||t[e-1]).s+r*(2*(1-r)*(o.cp-o.s)+r*(o.e-o.s))}},o.getBlendMode=function(t){if(!t)return n.NORMAL;for(t=t.toUpperCase();t.indexOf(" ")>=0;)t=t.replace(" ","_");return n[t]||n.NORMAL},e.exports=o},{}],5:[function(require,module,exports){"use strict";var ParticleUtils=require("./ParticleUtils"),Particle=require("./Particle"),PathParticle=function(t){Particle.call(this,t),this.path=null,this.initialRotation=0,this.initialPosition=new PIXI.Point,this.movement=0},s=Particle.prototype,p=PathParticle.prototype=Object.create(s),helperPoint=new PIXI.Point;p.init=function(){this.initialRotation=this.rotation,this.Particle_init(),this.path=this.extraData.path,this._doNormalMovement=!this.path,this.movement=0,this.initialPosition.x=this.position.x,this.initialPosition.y=this.position.y};for(var MATH_FUNCS=["pow","sqrt","abs","floor","round","ceil","E","PI","sin","cos","tan","asin","acos","atan","atan2","log"],WHITELISTER="[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]",index=MATH_FUNCS.length-1;index>=0;--index)WHITELISTER+="|"+MATH_FUNCS[index];WHITELISTER=new RegExp(WHITELISTER,"g");var parsePath=function(pathString){for(var rtn,matches=pathString.match(WHITELISTER),i=matches.length-1;i>=0;--i)MATH_FUNCS.indexOf(matches[i])>=0&&(matches[i]="Math."+matches[i]);return pathString=matches.join(""),eval("rtn = function(x){ return "+pathString+"; };"),rtn};p.update=function(t){var e=this.Particle_update(t);if(e>=0&&this.path){var i=(this.endSpeed-this.startSpeed)*e+this.startSpeed;this.movement+=i*t,helperPoint.x=this.movement,helperPoint.y=this.path(this.movement),ParticleUtils.rotatePoint(this.initialRotation,helperPoint),this.position.x=this.initialPosition.x+helperPoint.x,this.position.y=this.initialPosition.y+helperPoint.y}},p.Particle_destroy=Particle.prototype.destroy,p.destroy=function(){this.Particle_destroy(),this.path=this.initialPosition=null},PathParticle.parseArt=function(t){return Particle.parseArt(t)},PathParticle.parseData=function(t){var e={};if(t&&t.path)try{e.path=parsePath(t.path)}catch(t){ParticleUtils.verbose&&console.error("PathParticle: error in parsing path expression"),e.path=null}else ParticleUtils.verbose&&console.error("PathParticle requires a path string in extraData!"),e.path=null;return e},module.exports=PathParticle},{"./Particle":3,"./ParticleUtils":4}],6:[function(t,e,i){},{}],7:[function(t,e,i){i.ParticleUtils=t("./ParticleUtils.js"),i.Particle=t("./Particle.js"),i.Emitter=t("./Emitter.js"),i.PathParticle=t("./PathParticle.js"),i.AnimatedParticle=t("./AnimatedParticle.js"),t("./deprecation.js")},{"./AnimatedParticle.js":1,"./Emitter.js":2,"./Particle.js":3,"./ParticleUtils.js":4,"./PathParticle.js":5,"./deprecation.js":6}],8:[function(t,e,i){"use strict";var n="undefined"!=typeof window?window:GLOBAL;if(n.PIXI.particles||(n.PIXI.particles={}),void 0!==e&&e.exports)void 0===PIXI&&t("pixi.js"),e.exports=n.PIXI.particles||r;else if(void 0===PIXI)throw"pixi-particles requires pixi.js to be loaded first";var r=t("./particles");for(var o in r)n.PIXI.particles[o]=r[o]},{"./particles":7,"pixi.js":void 0}]},{},[8])(8)}),function(){var t={linear:function(t,e,i,n){return i*t/n+e},quadIn:function(t,e,i,n){return i*(t/=n)*t+e},quadOut:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},quadInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},cubeIn:function(t,e,i,n){return i*(t/=n)*t*t+e},cubeOut:function(t,e,i,n){return t/=n,i*(--t*t*t+1)+e},cubeInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},quartIn:function(t,e,i,n){return i*(t/=n)*t*t*t+e},quartOut:function(t,e,i,n){return t/=n,-i*(--t*t*t*t-1)+e},quartInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},quintIn:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},quintOut:function(t,e,i,n){return t/=n,i*(--t*t*t*t*t+1)+e},quintInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},sineIn:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},sineOut:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},sineInOut:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},expoIn:function(t,e,i,n){return i*Math.pow(2,10*(t/n-1))+e},expoOut:function(t,e,i,n){return i*(1-Math.pow(2,-10*t/n))+e},expoInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:(t--,i/2*(2-Math.pow(2,-10*t))+e)},circIn:function(t,e,i,n){return t/=n,-i*(Math.sqrt(1-t*t)-1)+e},circOut:function(t,e,i,n){return t/=n,t--,i*Math.sqrt(1-t*t)+e},circInOut:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:(t-=2,i/2*(Math.sqrt(1-t*t)+1)+e)}},e=function(t){return Math.round(100*t)/100};window.Tween=function(t,e,i,n,r){return this.startTime=Date.now(),this.startValue=t,this.distance=e,this.duration=i,this.animationType=n,this.loop=r,this},window.Tween.prototype.getValue=function(){if(this.expired())if(this.loop)if("repeat"===this.loop){this.startTime=Date.now();i=t[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration)}else{this.startValue=this.startValue+this.distance,this.distance=-this.distance,this.startTime=Date.now();i=t[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration)}else var i=this.startValue+this.distance;else var i=t[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration);return e(i)},window.Tween.prototype.getStartTime=function(){return Date.now()-this.startTime-this.duration+Date.now()},window.Tween.prototype.expired=function(){return this.startTime+this.duration<Date.now()},window.Tween.prototype.set=function(t,e,i,n,r){return this.startValue=t||this.startValue,this.distance=e||this.distance,this.duration=i||this.duration,this.animationType=n||this.animationType,this.loop=r||this.loop,this},window.Tween.prototype.reset=function(){return this.startTime=Date.now(),this}}(),tagpro.particleDefinitions={tagproSparks:{alpha:{start:.75,end:0},scale:{start:0,end:.25,minimumScaleMultiplier:1},color:{start:"#83FF7A",end:"#00BB00"},speed:{start:30,end:30},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:0},lifetime:{min:.1,max:.9},blendMode:"normal",frequency:.01,emitterLifetime:-1,maxParticles:50,pos:{x:20,y:20},addAtBack:!0,spawnType:"point",spawnCircle:{x:0,y:0,r:0}},explosion:{alpha:{start:.74,end:0},scale:{start:5,end:1,minimumScaleMultiplier:.1},color:{start:"#ffdfa0",end:"#100f0c"},speed:{start:1e3,end:0},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:200},lifetime:{min:.25,max:.5},blendMode:"normal",ease:[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],frequency:.001,emitterLifetime:.1,maxParticles:50,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"},playerEmitter:{alpha:{start:.85,end:0},scale:{start:.01,end:.2,minimumScaleMultiplier:1},color:{start:"#fff191",end:"#ff622c"},speed:{start:20,end:20},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:50,max:50},lifetime:{min:.1,max:.75},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:50,pos:{x:20,y:20},addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:10}},death:{alpha:{start:.15,end:0},scale:{start:1.5,end:0},speed:{start:300,end:100},startRotation:{min:0,max:0},rotationSpeed:{min:0,max:0},lifetime:{min:.4,max:.4},frequency:.08,emitterLifetime:.17,maxParticles:50,pos:{x:0,y:0},addAtBack:!1,spawnType:"burst",particlesPerWave:16,particleSpacing:22.5,angleStart:0},rollingBomb:{alpha:{start:.45,end:0},scale:{start:.1,end:1.5,minimumScaleMultiplier:1},color:{start:"#85888d",end:"#100f0c"},speed:{start:1,end:50},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:0},lifetime:{min:.5,max:2},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:10,pos:{x:0,y:0},addAtBack:!1,spawnType:"circle",spawnCircle:{x:20,y:20,r:30}},gravityWell:{alpha:{start:0,end:1},scale:{start:.5,end:.15,minimumScaleMultiplier:1},color:{start:"#000000",end:"#000000"},speed:{start:1,end:500},acceleration:{x:0,y:0},startRotation:{min:180,max:180},rotationSpeed:{min:90,max:180},lifetime:{min:.9,max:1},blendMode:"normal",frequency:.025,emitterLifetime:-1,maxParticles:40,pos:{x:0,y:0},addAtBack:!1,spawnType:"ring",spawnCircle:{x:0,y:0,r:240,minR:240}},arcReactor:{alpha:{start:.25,end:0},scale:{start:.5,end:.25,minimumScaleMultiplier:1},color:{start:"#57d0d6",end:"#57d0d6"},speed:{start:0,end:0,minimumSpeedMultiplier:1},acceleration:{x:0,y:0},maxSpeed:0,startRotation:{min:0,max:0},noRotation:!0,rotationSpeed:{min:0,max:0},lifetime:{min:.1,max:.1},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:500,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},function(){if(void 0===window.performance&&(window.performance={}),!window.performance.now){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}(),console.image=function(t,e){e=e||1;var i=new Image;i.onload=function(){var i,n,r=(i=this.width*e,n=this.height*e,{string:"+",style:"font-size: 1px; padding: "+Math.floor(n/2)+"px "+Math.floor(i/2)+"px; line-height: "+n+"px;"});console.log("%c"+r.string,r.style+"background: url("+t+"); background-size: "+this.width*e+"px "+this.height*e+"px; color: transparent;")},i.src=t},tagpro.ready(createRenderer),PIXI.SpriteClip=function(t){PIXI.extras.AnimatedSprite.call(this,t),this.fps=4,this.lastUpdate=performance.now()},PIXI.SpriteClip.prototype=Object.create(PIXI.extras.AnimatedSprite.prototype),PIXI.SpriteClip.prototype.constructor=PIXI.SpriteClip,PIXI.SpriteClip.prototype.update=function(){var t=this.currentFrame,e=performance.now(),i=Math.min(e-this.lastUpdate,100);this.lastUpdate=e,this._currentTime+=this.fps*i/1e3,this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):t!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<t?this.onLoop():this.animationSpeed<0&&this.currentFrame>t&&this.onLoop()),this.updateTexture())},setTimeout(function(){tagpro.socket.emit("p",{c:Container?Container.toString().length:0})},5e3+25e3*Math.random());var Box2D={};!function(t,e){function i(){}!Object.defineProperty&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(t,e,i){i.get instanceof Function&&t.__defineGetter__(e,i.get),i.set instanceof Function&&t.__defineSetter__(e,i.set)}),t.inherit=function(t,e){var n=t;i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=n},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){void 0===t&&(t=0);for(var e=new Array(t||0),i=0;i<t;++i)e[i]=0;return e},t.is=function(t,e){return null!==t&&(e instanceof Function&&t instanceof e||!(void 0==t.constructor.__implements||!t.constructor.__implements[e]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector,b2CircleShape,b2PolygonShape,b2Shape,b2Settings,b2Math,b2Sweep,b2Transform,b2Vec2,b2AABB,b2Bound,b2BoundValues,b2Collision,b2ContactID,b2ContactPoint,b2Distance,b2DistanceInput,b2DistanceOutput,b2DistanceProxy,b2DynamicTree,b2DynamicTreeBroadPhase,b2DynamicTreeNode,b2DynamicTreePair,b2Manifold,b2ManifoldPoint,b2Point,b2RayCastInput,b2RayCastOutput,b2Segment,b2SeparationFunction,b2Simplex,b2SimplexCache,b2SimplexVertex,b2TimeOfImpact,b2TOIInput,b2WorldManifold,ClipVertex,Features,IBroadPhase,b2DebugDraw,i;for(void 0===Box2D&&(Box2D={}),void 0===Box2D.Collision&&(Box2D.Collision={}),void 0===Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),void 0===Box2D.Common&&(Box2D.Common={}),void 0===Box2D.Common.Math&&(Box2D.Common.Math={}),void 0===Box2D.Dynamics&&(Box2D.Dynamics={}),void 0===Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),void 0===Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),void 0===Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),function(){Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=function t(){t.b2AABB.apply(this,arguments)},Box2D.Collision.b2Bound=function t(){t.b2Bound.apply(this,arguments)},Box2D.Collision.b2BoundValues=function t(){t.b2BoundValues.apply(this,arguments),this.constructor===t&&this.b2BoundValues.apply(this,arguments)},Box2D.Collision.b2Collision=function t(){t.b2Collision.apply(this,arguments)},Box2D.Collision.b2ContactID=function t(){t.b2ContactID.apply(this,arguments),this.constructor===t&&this.b2ContactID.apply(this,arguments)},Box2D.Collision.b2ContactPoint=function t(){t.b2ContactPoint.apply(this,arguments)},Box2D.Collision.b2Distance=function t(){t.b2Distance.apply(this,arguments)},Box2D.Collision.b2DistanceInput=function t(){t.b2DistanceInput.apply(this,arguments)},Box2D.Collision.b2DistanceOutput=function t(){t.b2DistanceOutput.apply(this,arguments)},Box2D.Collision.b2DistanceProxy=function t(){t.b2DistanceProxy.apply(this,arguments)},Box2D.Collision.b2DynamicTree=function t(){t.b2DynamicTree.apply(this,arguments),this.constructor===t&&this.b2DynamicTree.apply(this,arguments)},Box2D.Collision.b2DynamicTreeBroadPhase=function t(){t.b2DynamicTreeBroadPhase.apply(this,arguments)},Box2D.Collision.b2DynamicTreeNode=function t(){t.b2DynamicTreeNode.apply(this,arguments)},Box2D.Collision.b2DynamicTreePair=function t(){t.b2DynamicTreePair.apply(this,arguments)},Box2D.Collision.b2Manifold=function t(){t.b2Manifold.apply(this,arguments),this.constructor===t&&this.b2Manifold.apply(this,arguments)},Box2D.Collision.b2ManifoldPoint=function t(){t.b2ManifoldPoint.apply(this,arguments),this.constructor===t&&this.b2ManifoldPoint.apply(this,arguments)},Box2D.Collision.b2Point=function t(){t.b2Point.apply(this,arguments)},Box2D.Collision.b2RayCastInput=function t(){t.b2RayCastInput.apply(this,arguments),this.constructor===t&&this.b2RayCastInput.apply(this,arguments)},Box2D.Collision.b2RayCastOutput=function t(){t.b2RayCastOutput.apply(this,arguments)},Box2D.Collision.b2Segment=function t(){t.b2Segment.apply(this,arguments)},Box2D.Collision.b2SeparationFunction=function t(){t.b2SeparationFunction.apply(this,arguments)},Box2D.Collision.b2Simplex=function t(){t.b2Simplex.apply(this,arguments),this.constructor===t&&this.b2Simplex.apply(this,arguments)},Box2D.Collision.b2SimplexCache=function t(){t.b2SimplexCache.apply(this,arguments)},Box2D.Collision.b2SimplexVertex=function t(){t.b2SimplexVertex.apply(this,arguments)},Box2D.Collision.b2TimeOfImpact=function t(){t.b2TimeOfImpact.apply(this,arguments)},Box2D.Collision.b2TOIInput=function t(){t.b2TOIInput.apply(this,arguments)},Box2D.Collision.b2WorldManifold=function t(){t.b2WorldManifold.apply(this,arguments),this.constructor===t&&this.b2WorldManifold.apply(this,arguments)},Box2D.Collision.ClipVertex=function t(){t.ClipVertex.apply(this,arguments)},Box2D.Collision.Features=function t(){t.Features.apply(this,arguments)},Box2D.Collision.Shapes.b2CircleShape=function t(){t.b2CircleShape.apply(this,arguments),this.constructor===t&&this.b2CircleShape.apply(this,arguments)},Box2D.Collision.Shapes.b2EdgeChainDef=function t(){t.b2EdgeChainDef.apply(this,arguments),this.constructor===t&&this.b2EdgeChainDef.apply(this,arguments)},Box2D.Collision.Shapes.b2EdgeShape=function t(){t.b2EdgeShape.apply(this,arguments),this.constructor===t&&this.b2EdgeShape.apply(this,arguments)},Box2D.Collision.Shapes.b2MassData=function t(){t.b2MassData.apply(this,arguments)},Box2D.Collision.Shapes.b2PolygonShape=function t(){t.b2PolygonShape.apply(this,arguments),this.constructor===t&&this.b2PolygonShape.apply(this,arguments)},Box2D.Collision.Shapes.b2Shape=function t(){t.b2Shape.apply(this,arguments),this.constructor===t&&this.b2Shape.apply(this,arguments)},Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=function t(){t.b2Color.apply(this,arguments),this.constructor===t&&this.b2Color.apply(this,arguments)},Box2D.Common.b2Settings=function t(){t.b2Settings.apply(this,arguments)},Box2D.Common.Math.b2Mat22=function t(){t.b2Mat22.apply(this,arguments),this.constructor===t&&this.b2Mat22.apply(this,arguments)},Box2D.Common.Math.b2Mat33=function t(){t.b2Mat33.apply(this,arguments),this.constructor===t&&this.b2Mat33.apply(this,arguments)},Box2D.Common.Math.b2Math=function t(){t.b2Math.apply(this,arguments)},Box2D.Common.Math.b2Sweep=function t(){t.b2Sweep.apply(this,arguments)},Box2D.Common.Math.b2Transform=function t(){t.b2Transform.apply(this,arguments),this.constructor===t&&this.b2Transform.apply(this,arguments)},Box2D.Common.Math.b2Vec2=function t(){t.b2Vec2.apply(this,arguments),this.constructor===t&&this.b2Vec2.apply(this,arguments)},Box2D.Common.Math.b2Vec3=function t(){t.b2Vec3.apply(this,arguments),this.constructor===t&&this.b2Vec3.apply(this,arguments)},Box2D.Dynamics.b2Body=function t(){t.b2Body.apply(this,arguments),this.constructor===t&&this.b2Body.apply(this,arguments)},Box2D.Dynamics.b2BodyDef=function t(){t.b2BodyDef.apply(this,arguments),this.constructor===t&&this.b2BodyDef.apply(this,arguments)},Box2D.Dynamics.b2ContactFilter=function t(){t.b2ContactFilter.apply(this,arguments)},Box2D.Dynamics.b2ContactImpulse=function t(){t.b2ContactImpulse.apply(this,arguments)},Box2D.Dynamics.b2ContactListener=function t(){t.b2ContactListener.apply(this,arguments)},Box2D.Dynamics.b2ContactManager=function t(){t.b2ContactManager.apply(this,arguments),this.constructor===t&&this.b2ContactManager.apply(this,arguments)},Box2D.Dynamics.b2DebugDraw=function t(){t.b2DebugDraw.apply(this,arguments),this.constructor===t&&this.b2DebugDraw.apply(this,arguments)},Box2D.Dynamics.b2DestructionListener=function t(){t.b2DestructionListener.apply(this,arguments)},Box2D.Dynamics.b2FilterData=function t(){t.b2FilterData.apply(this,arguments)},Box2D.Dynamics.b2Fixture=function t(){t.b2Fixture.apply(this,arguments),this.constructor===t&&this.b2Fixture.apply(this,arguments)},Box2D.Dynamics.b2FixtureDef=function t(){t.b2FixtureDef.apply(this,arguments),this.constructor===t&&this.b2FixtureDef.apply(this,arguments)},Box2D.Dynamics.b2Island=function t(){t.b2Island.apply(this,arguments),this.constructor===t&&this.b2Island.apply(this,arguments)},Box2D.Dynamics.b2TimeStep=function t(){t.b2TimeStep.apply(this,arguments)},Box2D.Dynamics.b2World=function t(){t.b2World.apply(this,arguments),this.constructor===t&&this.b2World.apply(this,arguments)},Box2D.Dynamics.Contacts.b2CircleContact=function t(){t.b2CircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2Contact=function t(){t.b2Contact.apply(this,arguments),this.constructor===t&&this.b2Contact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactConstraint=function t(){t.b2ContactConstraint.apply(this,arguments),this.constructor===t&&this.b2ContactConstraint.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactConstraintPoint=function t(){t.b2ContactConstraintPoint.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactEdge=function t(){t.b2ContactEdge.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactFactory=function t(){t.b2ContactFactory.apply(this,arguments),this.constructor===t&&this.b2ContactFactory.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactRegister=function t(){t.b2ContactRegister.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactResult=function t(){t.b2ContactResult.apply(this,arguments)},Box2D.Dynamics.Contacts.b2ContactSolver=function t(){t.b2ContactSolver.apply(this,arguments),this.constructor===t&&this.b2ContactSolver.apply(this,arguments)},Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=function t(){t.b2EdgeAndCircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2NullContact=function t(){t.b2NullContact.apply(this,arguments),this.constructor===t&&this.b2NullContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolyAndCircleContact=function t(){t.b2PolyAndCircleContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=function t(){t.b2PolyAndEdgeContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PolygonContact=function t(){t.b2PolygonContact.apply(this,arguments)},Box2D.Dynamics.Contacts.b2PositionSolverManifold=function t(){t.b2PositionSolverManifold.apply(this,arguments),this.constructor===t&&this.b2PositionSolverManifold.apply(this,arguments)},Box2D.Dynamics.Controllers.b2BuoyancyController=function t(){t.b2BuoyancyController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ConstantAccelController=function t(){t.b2ConstantAccelController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ConstantForceController=function t(){t.b2ConstantForceController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2Controller=function t(){t.b2Controller.apply(this,arguments)},Box2D.Dynamics.Controllers.b2ControllerEdge=function t(){t.b2ControllerEdge.apply(this,arguments)},Box2D.Dynamics.Controllers.b2GravityController=function t(){t.b2GravityController.apply(this,arguments)},Box2D.Dynamics.Controllers.b2TensorDampingController=function t(){t.b2TensorDampingController.apply(this,arguments)},Box2D.Dynamics.Joints.b2DistanceJoint=function t(){t.b2DistanceJoint.apply(this,arguments),this.constructor===t&&this.b2DistanceJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2DistanceJointDef=function t(){t.b2DistanceJointDef.apply(this,arguments),this.constructor===t&&this.b2DistanceJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2FrictionJoint=function t(){t.b2FrictionJoint.apply(this,arguments),this.constructor===t&&this.b2FrictionJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2FrictionJointDef=function t(){t.b2FrictionJointDef.apply(this,arguments),this.constructor===t&&this.b2FrictionJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2GearJoint=function t(){t.b2GearJoint.apply(this,arguments),this.constructor===t&&this.b2GearJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2GearJointDef=function t(){t.b2GearJointDef.apply(this,arguments),this.constructor===t&&this.b2GearJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2Jacobian=function t(){t.b2Jacobian.apply(this,arguments)},Box2D.Dynamics.Joints.b2Joint=function t(){t.b2Joint.apply(this,arguments),this.constructor===t&&this.b2Joint.apply(this,arguments)},Box2D.Dynamics.Joints.b2JointDef=function t(){t.b2JointDef.apply(this,arguments),this.constructor===t&&this.b2JointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2JointEdge=function t(){t.b2JointEdge.apply(this,arguments)},Box2D.Dynamics.Joints.b2LineJoint=function t(){t.b2LineJoint.apply(this,arguments),this.constructor===t&&this.b2LineJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2LineJointDef=function t(){t.b2LineJointDef.apply(this,arguments),this.constructor===t&&this.b2LineJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2MouseJoint=function t(){t.b2MouseJoint.apply(this,arguments),this.constructor===t&&this.b2MouseJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2MouseJointDef=function t(){t.b2MouseJointDef.apply(this,arguments),this.constructor===t&&this.b2MouseJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2PrismaticJoint=function t(){t.b2PrismaticJoint.apply(this,arguments),this.constructor===t&&this.b2PrismaticJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2PrismaticJointDef=function t(){t.b2PrismaticJointDef.apply(this,arguments),this.constructor===t&&this.b2PrismaticJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2PulleyJoint=function t(){t.b2PulleyJoint.apply(this,arguments),this.constructor===t&&this.b2PulleyJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2PulleyJointDef=function t(){t.b2PulleyJointDef.apply(this,arguments),this.constructor===t&&this.b2PulleyJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2RevoluteJoint=function t(){t.b2RevoluteJoint.apply(this,arguments),this.constructor===t&&this.b2RevoluteJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2RevoluteJointDef=function t(){t.b2RevoluteJointDef.apply(this,arguments),this.constructor===t&&this.b2RevoluteJointDef.apply(this,arguments)},Box2D.Dynamics.Joints.b2WeldJoint=function t(){t.b2WeldJoint.apply(this,arguments),this.constructor===t&&this.b2WeldJoint.apply(this,arguments)},Box2D.Dynamics.Joints.b2WeldJointDef=function t(){t.b2WeldJointDef.apply(this,arguments),this.constructor===t&&this.b2WeldJointDef.apply(this,arguments)}}(),Box2D.postDefs=[],b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2Shape=Box2D.Collision.Shapes.b2Shape,Box2D.Common.b2Color,Box2D.Common.b2internal,b2Settings=Box2D.Common.b2Settings,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,b2Math=Box2D.Common.Math.b2Math,b2Sweep=Box2D.Common.Math.b2Sweep,b2Transform=Box2D.Common.Math.b2Transform,b2Vec2=Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3,b2AABB=Box2D.Collision.b2AABB,b2Bound=Box2D.Collision.b2Bound,b2BoundValues=Box2D.Collision.b2BoundValues,b2Collision=Box2D.Collision.b2Collision,b2ContactID=Box2D.Collision.b2ContactID,b2ContactPoint=Box2D.Collision.b2ContactPoint,b2Distance=Box2D.Collision.b2Distance,b2DistanceInput=Box2D.Collision.b2DistanceInput,b2DistanceOutput=Box2D.Collision.b2DistanceOutput,b2DistanceProxy=Box2D.Collision.b2DistanceProxy,b2DynamicTree=Box2D.Collision.b2DynamicTree,b2DynamicTreeBroadPhase=Box2D.Collision.b2DynamicTreeBroadPhase,b2DynamicTreeNode=Box2D.Collision.b2DynamicTreeNode,b2DynamicTreePair=Box2D.Collision.b2DynamicTreePair,b2Manifold=Box2D.Collision.b2Manifold,b2ManifoldPoint=Box2D.Collision.b2ManifoldPoint,b2Point=Box2D.Collision.b2Point,b2RayCastInput=Box2D.Collision.b2RayCastInput,b2RayCastOutput=Box2D.Collision.b2RayCastOutput,b2Segment=Box2D.Collision.b2Segment,b2SeparationFunction=Box2D.Collision.b2SeparationFunction,b2Simplex=Box2D.Collision.b2Simplex,b2SimplexCache=Box2D.Collision.b2SimplexCache,b2SimplexVertex=Box2D.Collision.b2SimplexVertex,b2TimeOfImpact=Box2D.Collision.b2TimeOfImpact,b2TOIInput=Box2D.Collision.b2TOIInput,b2WorldManifold=Box2D.Collision.b2WorldManifold,ClipVertex=Box2D.Collision.ClipVertex,Features=Box2D.Collision.Features,IBroadPhase=Box2D.Collision.IBroadPhase,b2AABB.b2AABB=function(){this.lowerBound=new b2Vec2,this.upperBound=new b2Vec2},b2AABB.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},b2AABB.prototype.GetCenter=function(){return new b2Vec2((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},b2AABB.prototype.GetExtents=function(){return new b2Vec2((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},b2AABB.prototype.Contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},b2AABB.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,r=e.p1.x,o=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),c=Math.abs(a),u=t.normal,h=0,p=0,d=0,f=0,m=0;if(l<Number.MIN_VALUE){if(r<this.lowerBound.x||this.upperBound.x<r)return!1}else if(h=1/s,m=-1,(p=(this.lowerBound.x-r)*h)>(d=(this.upperBound.x-r)*h)&&(f=p,p=d,d=f,m=1),p>i&&(u.x=m,u.y=0,i=p),i>(n=Math.min(n,d)))return!1;if(c<Number.MIN_VALUE){if(o<this.lowerBound.y||this.upperBound.y<o)return!1}else if(h=1/a,m=-1,(p=(this.lowerBound.y-o)*h)>(d=(this.upperBound.y-o)*h)&&(f=p,p=d,d=f,m=1),p>i&&(u.y=m,u.x=0,i=p),i>(n=Math.min(n,d)))return!1;return t.fraction=i,!0},b2AABB.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,r=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0||n>0||r>0)},b2AABB.Combine=function(t,e){var i=new b2AABB;return i.Combine(t,e),i},b2AABB.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},b2Bound.b2Bound=function(){},b2Bound.prototype.IsLower=function(){return 0==(1&this.value)},b2Bound.prototype.IsUpper=function(){return 1==(1&this.value)},b2Bound.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},b2BoundValues.b2BoundValues=function(){},b2BoundValues.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},b2Collision.b2Collision=function(){},b2Collision.ClipSegmentToLine=function(t,e,i,n){var r;void 0===n&&(n=0);var o=0,s=(r=e[0]).v,a=(r=e[1]).v,l=i.x*s.x+i.y*s.y-n,c=i.x*a.x+i.y*a.y-n;if(l<=0&&t[o++].Set(e[0]),c<=0&&t[o++].Set(e[1]),l*c<0){var u,h=l/(l-c),p=(r=t[o]).v;p.x=s.x+h*(a.x-s.x),p.y=s.y+h*(a.y-s.y),r=t[o],l>0?(u=e[0],r.id=u.id):(u=e[1],r.id=u.id),++o}return o},b2Collision.EdgeSeparation=function(t,e,i,n,r){void 0===i&&(i=0),parseInt(t.m_vertexCount);var o,s,a=t.m_vertices,l=t.m_normals,c=parseInt(n.m_vertexCount),u=n.m_vertices;o=e.R,s=l[i];for(var h=o.col1.x*s.x+o.col2.x*s.y,p=o.col1.y*s.x+o.col2.y*s.y,d=(o=r.R).col1.x*h+o.col1.y*p,f=o.col2.x*h+o.col2.y*p,m=0,y=Number.MAX_VALUE,_=0;_<c;++_){var x=(s=u[_]).x*d+s.y*f;x<y&&(y=x,m=_)}s=a[i],o=e.R;var g=e.position.x+(o.col1.x*s.x+o.col2.x*s.y),v=e.position.y+(o.col1.y*s.x+o.col2.y*s.y);s=u[m],o=r.R;var b=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),w=r.position.y+(o.col1.y*s.x+o.col2.y*s.y);return(b-=g)*h+(w-=v)*p},b2Collision.FindMaxSeparation=function(t,e,i,n,r){var o,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=r.R,o=n.m_centroid;var c=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),u=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=e.m_centroid,c-=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),u-=i.position.y+(s.col1.y*o.x+s.col2.y*o.y);for(var h=c*i.R.col1.x+u*i.R.col1.y,p=c*i.R.col2.x+u*i.R.col2.y,d=0,f=-Number.MAX_VALUE,m=0;m<a;++m){var y=(o=l[m]).x*h+o.y*p;y>f&&(f=y,d=m)}var _=b2Collision.EdgeSeparation(e,i,d,n,r),x=parseInt(d-1>=0?d-1:a-1),g=b2Collision.EdgeSeparation(e,i,x,n,r),v=parseInt(d+1<a?d+1:0),b=b2Collision.EdgeSeparation(e,i,v,n,r),w=0,C=0,S=0;if(g>_&&g>b)S=-1,w=x,C=g;else{if(!(b>_))return t[0]=d,_;S=1,w=v,C=b}for(;d=-1==S?w-1>=0?w-1:a-1:w+1<a?w+1:0,(_=b2Collision.EdgeSeparation(e,i,d,n,r))>C;)w=d,C=_;return t[0]=w,C},b2Collision.FindIncidentEdge=function(t,e,i,n,r,o){void 0===n&&(n=0),parseInt(e.m_vertexCount);var s,a,l=e.m_normals,c=parseInt(r.m_vertexCount),u=r.m_vertices,h=r.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,d=s.col1.y*a.x+s.col2.y*a.y,f=(s=o.R).col1.x*p+s.col1.y*d;d=s.col2.x*p+s.col2.y*d,p=f;for(var m,y=0,_=Number.MAX_VALUE,x=0;x<c;++x){var g=p*(a=h[x]).x+d*a.y;g<_&&(_=g,y=x)}var v=parseInt(y),b=parseInt(v+1<c?v+1:0);m=t[0],a=u[v],s=o.R,m.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),m.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),m.id.features.referenceEdge=n,m.id.features.incidentEdge=v,m.id.features.incidentVertex=0,m=t[1],a=u[b],s=o.R,m.v.x=o.position.x+(s.col1.x*a.x+s.col2.x*a.y),m.v.y=o.position.y+(s.col1.y*a.x+s.col2.y*a.y),m.id.features.referenceEdge=n,m.id.features.incidentEdge=b,m.id.features.incidentVertex=1},b2Collision.MakeClipPointVector=function(){var t=new Vector(2);return t[0]=new ClipVertex,t[1]=new ClipVertex,t},b2Collision.CollidePolygons=function(t,e,i,n,r){var o;t.m_pointCount=0;var s=e.m_radius+n.m_radius,a=0;b2Collision.s_edgeAO[0]=a;var l=b2Collision.FindMaxSeparation(b2Collision.s_edgeAO,e,i,n,r);if(a=b2Collision.s_edgeAO[0],!(l>s)){var c=0;b2Collision.s_edgeBO[0]=c;var u=b2Collision.FindMaxSeparation(b2Collision.s_edgeBO,n,r,e,i);if(c=b2Collision.s_edgeBO[0],!(u>s)){var h,p,d,f,m,y=0,_=0;u>.98*l+.001?(h=n,p=e,d=r,f=i,y=c,t.m_type=b2Manifold.e_faceB,_=1):(h=e,p=n,d=i,f=r,y=a,t.m_type=b2Manifold.e_faceA,_=0);var x=b2Collision.s_incidentEdge;b2Collision.FindIncidentEdge(x,h,d,y,p,f);var g,v=parseInt(h.m_vertexCount),b=h.m_vertices,w=b[y];g=y+1<v?b[parseInt(y+1)]:b[0];var C=b2Collision.s_localTangent;C.Set(g.x-w.x,g.y-w.y),C.Normalize();var S=b2Collision.s_localNormal;S.x=C.y,S.y=-C.x;var T=b2Collision.s_planePoint;T.Set(.5*(w.x+g.x),.5*(w.y+g.y));var D=b2Collision.s_tangent;m=d.R,D.x=m.col1.x*C.x+m.col2.x*C.y,D.y=m.col1.y*C.x+m.col2.y*C.y;var A=b2Collision.s_tangent2;A.x=-D.x,A.y=-D.y;var B=b2Collision.s_normal;B.x=D.y,B.y=-D.x;var M=b2Collision.s_v11,P=b2Collision.s_v12;M.x=d.position.x+(m.col1.x*w.x+m.col2.x*w.y),M.y=d.position.y+(m.col1.y*w.x+m.col2.y*w.y),P.x=d.position.x+(m.col1.x*g.x+m.col2.x*g.y),P.y=d.position.y+(m.col1.y*g.x+m.col2.y*g.y);var E=B.x*M.x+B.y*M.y,I=-D.x*M.x-D.y*M.y+s,R=D.x*P.x+D.y*P.y+s,O=b2Collision.s_clipPoints1,k=b2Collision.s_clipPoints2;if(!(b2Collision.ClipSegmentToLine(O,x,A,I)<2||b2Collision.ClipSegmentToLine(k,O,D,R)<2)){t.m_localPlaneNormal.SetV(S),t.m_localPoint.SetV(T);for(var L=0,F=0;F<b2Settings.b2_maxManifoldPoints;++F)if(o=k[F],B.x*o.v.x+B.y*o.v.y-E<=s){var N=t.m_points[L];m=f.R;var V=o.v.x-f.position.x,j=o.v.y-f.position.y;N.m_localPoint.x=V*m.col1.x+j*m.col1.y,N.m_localPoint.y=V*m.col2.x+j*m.col2.y,N.m_id.Set(o.id),N.m_id.features.flip=_,++L}t.m_pointCount=L}}}},b2Collision.CollideCircles=function(t,e,i,n,r){var o,s;t.m_pointCount=0,o=i.R,s=e.m_p;var a=i.position.x+(o.col1.x*s.x+o.col2.x*s.y),l=i.position.y+(o.col1.y*s.x+o.col2.y*s.y);o=r.R,s=n.m_p;var c=r.position.x+(o.col1.x*s.x+o.col2.x*s.y)-a,u=r.position.y+(o.col1.y*s.x+o.col2.y*s.y)-l,h=c*c+u*u,p=e.m_radius+n.m_radius;h>p*p||(t.m_type=b2Manifold.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},b2Collision.CollidePolygonAndCircle=function(t,e,i,n,r){t.m_pointCount=0;var o,s,a=0,l=0;s=r.R,o=n.m_p;var c=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),u=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);a=c-i.position.x,l=u-i.position.y;for(var h=a*(s=i.R).col1.x+l*s.col1.y,p=a*s.col2.x+l*s.col2.y,d=0,f=-Number.MAX_VALUE,m=e.m_radius+n.m_radius,y=parseInt(e.m_vertexCount),_=e.m_vertices,x=e.m_normals,g=0;g<y;++g){a=h-(o=_[g]).x,l=p-o.y;var v=(o=x[g]).x*a+o.y*l;if(v>m)return;v>f&&(f=v,d=g)}var b=parseInt(d),w=parseInt(b+1<y?b+1:0),C=_[b],S=_[w];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=b2Manifold.e_faceA,t.m_localPlaneNormal.SetV(x[d]),t.m_localPoint.x=.5*(C.x+S.x),t.m_localPoint.y=.5*(C.y+S.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var T=(h-C.x)*(S.x-C.x)+(p-C.y)*(S.y-C.y),D=(h-S.x)*(C.x-S.x)+(p-S.y)*(C.y-S.y);if(T<=0){if((h-C.x)*(h-C.x)+(p-C.y)*(p-C.y)>m*m)return;t.m_pointCount=1,t.m_type=b2Manifold.e_faceA,t.m_localPlaneNormal.x=h-C.x,t.m_localPlaneNormal.y=p-C.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(C),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(D<=0){if((h-S.x)*(h-S.x)+(p-S.y)*(p-S.y)>m*m)return;t.m_pointCount=1,t.m_type=b2Manifold.e_faceA,t.m_localPlaneNormal.x=h-S.x,t.m_localPlaneNormal.y=p-S.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(S),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var A=.5*(C.x+S.x),B=.5*(C.y+S.y);if((f=(h-A)*x[b].x+(p-B)*x[b].y)>m)return;t.m_pointCount=1,t.m_type=b2Manifold.e_faceA,t.m_localPlaneNormal.x=x[b].x,t.m_localPlaneNormal.y=x[b].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(A,B),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},b2Collision.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,r=i.x-n.x,o=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(r>0||o>0||s>0||a>0)},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=b2Collision.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=b2Collision.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=b2Collision.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new b2Vec2,Box2D.Collision.b2Collision.s_localNormal=new b2Vec2,Box2D.Collision.b2Collision.s_planePoint=new b2Vec2,Box2D.Collision.b2Collision.s_normal=new b2Vec2,Box2D.Collision.b2Collision.s_tangent=new b2Vec2,Box2D.Collision.b2Collision.s_tangent2=new b2Vec2,Box2D.Collision.b2Collision.s_v11=new b2Vec2,Box2D.Collision.b2Collision.s_v12=new b2Vec2,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new b2Vec2,Box2D.Collision.b2Collision.b2_nullFeature=255}),b2ContactID.b2ContactID=function(){this.features=new Features},b2ContactID.prototype.b2ContactID=function(){this.features._m_id=this},b2ContactID.prototype.Set=function(t){this.key=t._key},b2ContactID.prototype.Copy=function(){var t=new b2ContactID;return t.key=this.key,t},Object.defineProperty(b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),b2ContactPoint.b2ContactPoint=function(){this.position=new b2Vec2,this.velocity=new b2Vec2,this.normal=new b2Vec2,this.id=new b2ContactID},b2Distance.b2Distance=function(){},b2Distance.Distance=function(t,e,i){++b2Distance.b2_gjkCalls;var n=i.proxyA,r=i.proxyB,o=i.transformA,s=i.transformB,a=b2Distance.s_simplex;a.ReadCache(e,n,o,r,s);for(var l,c=a.m_vertices,u=b2Distance.s_saveA,h=b2Distance.s_saveB,p=0,d=(a.GetClosestPoint().LengthSquared(),0),f=0;f<20;){for(p=a.m_count,d=0;d<p;d++)u[d]=c[d].indexA,h[d]=c[d].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:b2Settings.b2Assert(!1)}if(3==a.m_count)break;(l=a.GetClosestPoint()).LengthSquared();var m=a.GetSearchDirection();if(m.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var y=c[a.m_count];y.indexA=n.GetSupport(b2Math.MulTMV(o.R,m.GetNegative())),y.wA=b2Math.MulX(o,n.GetVertex(y.indexA)),y.indexB=r.GetSupport(b2Math.MulTMV(s.R,m)),y.wB=b2Math.MulX(s,r.GetVertex(y.indexB)),y.w=b2Math.SubtractVV(y.wB,y.wA),++f,++b2Distance.b2_gjkIters;var _=!1;for(d=0;d<p;d++)if(y.indexA==u[d]&&y.indexB==h[d]){_=!0;break}if(_)break;++a.m_count}if(b2Distance.b2_gjkMaxIters=b2Math.Max(b2Distance.b2_gjkMaxIters,f),a.GetWitnessPoints(t.pointA,t.pointB),t.distance=b2Math.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=f,a.WriteCache(e),i.useRadii){var x=n.m_radius,g=r.m_radius;if(t.distance>x+g&&t.distance>Number.MIN_VALUE){t.distance-=x+g;var v=b2Math.SubtractVV(t.pointB,t.pointA);v.Normalize(),t.pointA.x+=x*v.x,t.pointA.y+=x*v.y,t.pointB.x-=g*v.x,t.pointB.y-=g*v.y}else(l=new b2Vec2).x=.5*(t.pointA.x+t.pointB.x),l.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=l.x,t.pointA.y=t.pointB.y=l.y,t.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new b2Simplex,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),b2DistanceInput.b2DistanceInput=function(){},b2DistanceOutput.b2DistanceOutput=function(){this.pointA=new b2Vec2,this.pointB=new b2Vec2},b2DistanceProxy.b2DistanceProxy=function(){},b2DistanceProxy.prototype.Set=function(t){switch(t.GetType()){case b2Shape.e_circleShape:var e=t instanceof b2CircleShape?t:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=e.m_p,this.m_count=1,this.m_radius=e.m_radius;break;case b2Shape.e_polygonShape:var i=t instanceof b2PolygonShape?t:null;this.m_vertices=i.m_vertices,this.m_count=i.m_vertexCount,this.m_radius=i.m_radius;break;default:b2Settings.b2Assert(!1)}},b2DistanceProxy.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},b2DistanceProxy.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count},b2DistanceProxy.prototype.GetVertex=function(t){return void 0===t&&(t=0),b2Settings.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},b2DynamicTree.b2DynamicTree=function(){},b2DynamicTree.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},b2DynamicTree.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=b2Settings.b2_aabbExtension,r=b2Settings.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-r,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+r,i.userData=e,this.InsertLeaf(i),i},b2DynamicTree.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},b2DynamicTree.prototype.MoveProxy=function(t,e,i){if(b2Settings.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=b2Settings.b2_aabbExtension+b2Settings.b2_aabbMultiplier*(i.x>0?i.x:-i.x),r=b2Settings.b2_aabbExtension+b2Settings.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+r,this.InsertLeaf(t),!0},b2DynamicTree.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},b2DynamicTree.prototype.GetFatAABB=function(t){return t.aabb},b2DynamicTree.prototype.GetUserData=function(t){return t.userData},b2DynamicTree.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Vector,n=0;for(i[n++]=this.m_root;n>0;){var r=i[--n];if(r.aabb.TestOverlap(e))if(r.IsLeaf()){if(!t(r))return}else i[n++]=r.child1,i[n++]=r.child2}}},b2DynamicTree.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,r=b2Math.SubtractVV(i,n);r.Normalize();var o=b2Math.CrossFV(1,r),s=b2Math.AbsV(o),a=e.maxFraction,l=new b2AABB,c=0,u=0;c=i.x+a*(n.x-i.x),u=i.y+a*(n.y-i.y),l.lowerBound.x=Math.min(i.x,c),l.lowerBound.y=Math.min(i.y,u),l.upperBound.x=Math.max(i.x,c),l.upperBound.y=Math.max(i.y,u);var h=new Vector,p=0;for(h[p++]=this.m_root;p>0;){var d=h[--p];if(0!=d.aabb.TestOverlap(l)){var f=d.aabb.GetCenter(),m=d.aabb.GetExtents();if(!(Math.abs(o.x*(i.x-f.x)+o.y*(i.y-f.y))-s.x*m.x-s.y*m.y>0))if(d.IsLeaf()){var y=new b2RayCastInput;if(y.p1=e.p1,y.p2=e.p2,y.maxFraction=e.maxFraction,0==(a=t(y,d)))return;a>0&&(c=i.x+a*(n.x-i.x),u=i.y+a*(n.y-i.y),l.lowerBound.x=Math.min(i.x,c),l.lowerBound.y=Math.min(i.y,u),l.upperBound.x=Math.max(i.x,c),l.upperBound.y=Math.max(i.y,u))}else h[p++]=d.child1,h[p++]=d.child2}}}},b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new b2DynamicTreeNode},b2DynamicTree.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},b2DynamicTree.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,r=i.child2;i=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y)<Math.abs((r.aabb.lowerBound.x+r.aabb.upperBound.x)/2-e.x)+Math.abs((r.aabb.lowerBound.y+r.aabb.upperBound.y)/2-e.y)?n:r}while(0==i.IsLeaf());var o=i.parent,s=this.AllocateNode();if(s.parent=o,s.userData=null,s.aabb.Combine(t.aabb,i.aabb),o){i.parent.child1==i?o.child1=s:o.child2=s,s.child1=i,s.child2=t,i.parent=s,t.parent=s;do{if(o.aabb.Contains(s.aabb))break;o.aabb.Combine(o.child1.aabb,o.child2.aabb),s=o,o=o.parent}while(o)}else s.child1=i,s.child2=t,i.parent=s,t.parent=s,this.m_root=s},b2DynamicTree.prototype.RemoveLeaf=function(t){if(t!=this.m_root){var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var r=n.aabb;if(n.aabb=b2AABB.Combine(n.child1.aabb,n.child2.aabb),r.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)}else this.m_root=null},b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase=function(){this.m_tree=new b2DynamicTree,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},b2DynamicTreeBroadPhase.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},b2DynamicTreeBroadPhase.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},b2DynamicTreeBroadPhase.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},b2DynamicTreeBroadPhase.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},b2DynamicTreeBroadPhase.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},b2DynamicTreeBroadPhase.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},b2DynamicTreeBroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount},b2DynamicTreeBroadPhase.prototype.UpdatePairs=function(t){var e=this;e.m_pairCount=0;var i,n=0;for(n=0;n<e.m_moveBuffer.length;++n){function r(t){if(t==i)return!0;e.m_pairCount==e.m_pairBuffer.length&&(e.m_pairBuffer[e.m_pairCount]=new b2DynamicTreePair);var n=e.m_pairBuffer[e.m_pairCount];return n.proxyA=t<i?t:i,n.proxyB=t>=i?t:i,++e.m_pairCount,!0}i=e.m_moveBuffer[n];var o=e.m_tree.GetFatAABB(i);e.m_tree.Query(r,o)}for(e.m_moveBuffer.length=0,n=0;n<e.m_pairCount;){var s=e.m_pairBuffer[n];for(t(e.m_tree.GetUserData(s.proxyA),e.m_tree.GetUserData(s.proxyB)),++n;n<e.m_pairCount;){var a=e.m_pairBuffer[n];if(a.proxyA!=s.proxyA||a.proxyB!=s.proxyB)break;++n}}},b2DynamicTreeBroadPhase.prototype.Query=function(t,e){this.m_tree.Query(t,e)},b2DynamicTreeBroadPhase.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},b2DynamicTreeBroadPhase.prototype.Validate=function(){},b2DynamicTreeBroadPhase.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},b2DynamicTreeBroadPhase.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},b2DynamicTreeBroadPhase.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},b2DynamicTreeBroadPhase.prototype.ComparePairs=function(t,e){return 0},b2DynamicTreeBroadPhase.__implements={},b2DynamicTreeBroadPhase.__implements[IBroadPhase]=!0,b2DynamicTreeNode.b2DynamicTreeNode=function(){this.aabb=new b2AABB},b2DynamicTreeNode.prototype.IsLeaf=function(){return null==this.child1},b2DynamicTreePair.b2DynamicTreePair=function(){},b2Manifold.b2Manifold=function(){this.m_pointCount=0},b2Manifold.prototype.b2Manifold=function(){this.m_points=new Vector(b2Settings.b2_maxManifoldPoints);for(var t=0;t<b2Settings.b2_maxManifoldPoints;t++)this.m_points[t]=new b2ManifoldPoint;this.m_localPlaneNormal=new b2Vec2,this.m_localPoint=new b2Vec2},b2Manifold.prototype.Reset=function(){for(var t=0;t<b2Settings.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof b2ManifoldPoint?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},b2Manifold.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<b2Settings.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof b2ManifoldPoint?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},b2Manifold.prototype.Copy=function(){var t=new b2Manifold;return t.Set(this),t},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),b2ManifoldPoint.b2ManifoldPoint=function(){this.m_localPoint=new b2Vec2,this.m_id=new b2ContactID},b2ManifoldPoint.prototype.b2ManifoldPoint=function(){this.Reset()},b2ManifoldPoint.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},b2ManifoldPoint.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},b2Point.b2Point=function(){this.p=new b2Vec2},b2Point.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},b2Point.prototype.GetFirstVertex=function(t){return this.p},b2RayCastInput.b2RayCastInput=function(){this.p1=new b2Vec2,this.p2=new b2Vec2},b2RayCastInput.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},b2RayCastOutput.b2RayCastOutput=function(){this.normal=new b2Vec2},b2Segment.b2Segment=function(){this.p1=new b2Vec2,this.p2=new b2Vec2},b2Segment.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var r=i.p1,o=i.p2.x-r.x,s=i.p2.y-r.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,c=-a,u=100*Number.MIN_VALUE,h=-(o*l+s*c);if(h>u){var p=r.x-this.p1.x,d=r.y-this.p1.y,f=p*l+d*c;if(0<=f&&f<=n*h){var m=-o*d+s*p;if(-u*h<=m&&m<=h*(1+u)){f/=h;var y=Math.sqrt(l*l+c*c);return l/=y,c/=y,t[0]=f,e.Set(l,c),!0}}}return!1},b2Segment.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},b2Segment.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},b2Segment.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},b2SeparationFunction.b2SeparationFunction=function(){this.m_localPoint=new b2Vec2,this.m_axis=new b2Vec2},b2SeparationFunction.prototype.Initialize=function(t,e,i,n,r){this.m_proxyA=e,this.m_proxyB=n;var o,s,a,l,c,u,h=parseInt(t.count);b2Settings.b2Assert(0<h&&h<3);var p,d,f=0,m=0,y=0,_=0,x=0,g=0,v=0;if(1==h)this.m_type=b2SeparationFunction.e_points,o=this.m_proxyA.GetVertex(t.indexA[0]),l=this.m_proxyB.GetVertex(t.indexB[0]),d=o,p=i.R,f=i.position.x+(p.col1.x*d.x+p.col2.x*d.y),m=i.position.y+(p.col1.y*d.x+p.col2.y*d.y),d=l,p=r.R,y=r.position.x+(p.col1.x*d.x+p.col2.x*d.y),_=r.position.y+(p.col1.y*d.x+p.col2.y*d.y),this.m_axis.x=y-f,this.m_axis.y=_-m,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=b2SeparationFunction.e_faceA,s=this.m_proxyA.GetVertex(t.indexA[0]),a=this.m_proxyA.GetVertex(t.indexA[1]),l=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(s.x+a.x),this.m_localPoint.y=.5*(s.y+a.y),this.m_axis=b2Math.CrossVF(b2Math.SubtractVV(a,s),1),this.m_axis.Normalize(),d=this.m_axis,x=(p=i.R).col1.x*d.x+p.col2.x*d.y,g=p.col1.y*d.x+p.col2.y*d.y,d=this.m_localPoint,p=i.R,f=i.position.x+(p.col1.x*d.x+p.col2.x*d.y),m=i.position.y+(p.col1.y*d.x+p.col2.y*d.y),d=l,p=r.R,(v=((y=r.position.x+(p.col1.x*d.x+p.col2.x*d.y))-f)*x+((_=r.position.y+(p.col1.y*d.x+p.col2.y*d.y))-m)*g)<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=b2SeparationFunction.e_faceB,c=this.m_proxyB.GetVertex(t.indexB[0]),u=this.m_proxyB.GetVertex(t.indexB[1]),o=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(c.x+u.x),this.m_localPoint.y=.5*(c.y+u.y),this.m_axis=b2Math.CrossVF(b2Math.SubtractVV(u,c),1),this.m_axis.Normalize(),d=this.m_axis,x=(p=r.R).col1.x*d.x+p.col2.x*d.y,g=p.col1.y*d.x+p.col2.y*d.y,d=this.m_localPoint,p=r.R,y=r.position.x+(p.col1.x*d.x+p.col2.x*d.y),_=r.position.y+(p.col1.y*d.x+p.col2.y*d.y),d=o,p=i.R,(v=((f=i.position.x+(p.col1.x*d.x+p.col2.x*d.y))-y)*x+((m=i.position.y+(p.col1.y*d.x+p.col2.y*d.y))-_)*g)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(t.indexA[0]),a=this.m_proxyA.GetVertex(t.indexA[1]),c=this.m_proxyB.GetVertex(t.indexB[0]),u=this.m_proxyB.GetVertex(t.indexB[1]),b2Math.MulX(i,o);var b=b2Math.MulMV(i.R,b2Math.SubtractVV(a,s)),w=(b2Math.MulX(r,l),b2Math.MulMV(r.R,b2Math.SubtractVV(u,c))),C=b.x*b.x+b.y*b.y,S=w.x*w.x+w.y*w.y,T=b2Math.SubtractVV(w,b),D=b.x*T.x+b.y*T.y,A=w.x*T.x+w.y*T.y,B=b.x*w.x+b.y*w.y,M=C*S-B*B;v=0,0!=M&&(v=b2Math.Clamp((B*A-D*S)/M,0,1));var P=(B*v+A)/S;P<0&&(P=0,v=b2Math.Clamp((B-D)/C,0,1)),(o=new b2Vec2).x=s.x+v*(a.x-s.x),o.y=s.y+v*(a.y-s.y),(l=new b2Vec2).x=c.x+v*(u.x-c.x),l.y=c.y+v*(u.y-c.y),0==v||1==v?(this.m_type=b2SeparationFunction.e_faceB,this.m_axis=b2Math.CrossVF(b2Math.SubtractVV(u,c),1),this.m_axis.Normalize(),this.m_localPoint=l,d=this.m_axis,x=(p=r.R).col1.x*d.x+p.col2.x*d.y,g=p.col1.y*d.x+p.col2.y*d.y,d=this.m_localPoint,p=r.R,y=r.position.x+(p.col1.x*d.x+p.col2.x*d.y),_=r.position.y+(p.col1.y*d.x+p.col2.y*d.y),d=o,p=i.R,f=i.position.x+(p.col1.x*d.x+p.col2.x*d.y),m=i.position.y+(p.col1.y*d.x+p.col2.y*d.y),v<0&&this.m_axis.NegativeSelf()):(this.m_type=b2SeparationFunction.e_faceA,this.m_axis=b2Math.CrossVF(b2Math.SubtractVV(a,s),1),this.m_localPoint=o,d=this.m_axis,x=(p=i.R).col1.x*d.x+p.col2.x*d.y,g=p.col1.y*d.x+p.col2.y*d.y,d=this.m_localPoint,p=i.R,f=i.position.x+(p.col1.x*d.x+p.col2.x*d.y),m=i.position.y+(p.col1.y*d.x+p.col2.y*d.y),d=l,p=r.R,y=r.position.x+(p.col1.x*d.x+p.col2.x*d.y),_=r.position.y+(p.col1.y*d.x+p.col2.y*d.y),v<0&&this.m_axis.NegativeSelf())}},b2SeparationFunction.prototype.Evaluate=function(t,e){var i,n,r,o,s,a,l;switch(this.m_type){case b2SeparationFunction.e_points:return i=b2Math.MulTMV(t.R,this.m_axis),n=b2Math.MulTMV(e.R,this.m_axis.GetNegative()),r=this.m_proxyA.GetSupportVertex(i),o=this.m_proxyB.GetSupportVertex(n),s=b2Math.MulX(t,r),((a=b2Math.MulX(e,o)).x-s.x)*this.m_axis.x+(a.y-s.y)*this.m_axis.y;case b2SeparationFunction.e_faceA:return l=b2Math.MulMV(t.R,this.m_axis),s=b2Math.MulX(t,this.m_localPoint),n=b2Math.MulTMV(e.R,l.GetNegative()),o=this.m_proxyB.GetSupportVertex(n),((a=b2Math.MulX(e,o)).x-s.x)*l.x+(a.y-s.y)*l.y;case b2SeparationFunction.e_faceB:return l=b2Math.MulMV(e.R,this.m_axis),a=b2Math.MulX(e,this.m_localPoint),i=b2Math.MulTMV(t.R,l.GetNegative()),r=this.m_proxyA.GetSupportVertex(i),((s=b2Math.MulX(t,r)).x-a.x)*l.x+(s.y-a.y)*l.y;default:return b2Settings.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),b2Simplex.b2Simplex=function(){this.m_v1=new b2SimplexVertex,this.m_v2=new b2SimplexVertex,this.m_v3=new b2SimplexVertex,this.m_vertices=new Vector(3)},b2Simplex.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},b2Simplex.prototype.ReadCache=function(t,e,i,n,r){var o,s;b2Settings.b2Assert(0<=t.count&&t.count<=3),this.m_count=t.count;for(var a=this.m_vertices,l=0;l<this.m_count;l++){var c=a[l];c.indexA=t.indexA[l],c.indexB=t.indexB[l],o=e.GetVertex(c.indexA),s=n.GetVertex(c.indexB),c.wA=b2Math.MulX(i,o),c.wB=b2Math.MulX(r,s),c.w=b2Math.SubtractVV(c.wB,c.wA),c.a=0}if(this.m_count>1){var u=t.metric,h=this.GetMetric();(h<.5*u||2*u<h||h<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&((c=a[0]).indexA=0,c.indexB=0,o=e.GetVertex(0),s=n.GetVertex(0),c.wA=b2Math.MulX(i,o),c.wB=b2Math.MulX(r,s),c.w=b2Math.SubtractVV(c.wB,c.wA),this.m_count=1)},b2Simplex.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=Box2D.parseUInt(e[i].indexA),t.indexB[i]=Box2D.parseUInt(e[i].indexB)},b2Simplex.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=b2Math.SubtractVV(this.m_v2.w,this.m_v1.w);return b2Math.CrossVV(t,this.m_v1.w.GetNegative())>0?b2Math.CrossFV(1,t):b2Math.CrossVF(t,1);default:return b2Settings.b2Assert(!1),new b2Vec2}},b2Simplex.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return b2Settings.b2Assert(!1),new b2Vec2;case 1:return this.m_v1.w;case 2:return new b2Vec2(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return b2Settings.b2Assert(!1),new b2Vec2}},b2Simplex.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:b2Settings.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:b2Settings.b2Assert(!1)}},b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return b2Settings.b2Assert(!1),0;case 1:return 0;case 2:return b2Math.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return b2Math.CrossVV(b2Math.SubtractVV(this.m_v2.w,this.m_v1.w),b2Math.SubtractVV(this.m_v3.w,this.m_v1.w));default:return b2Settings.b2Assert(!1),0}},b2Simplex.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=b2Math.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var r=e.x*i.x+e.y*i.y;if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var o=1/(r+n);this.m_v1.a=r*o,this.m_v2.a=n*o,this.m_count=2},b2Simplex.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=b2Math.SubtractVV(e,t),r=b2Math.Dot(t,n),o=b2Math.Dot(e,n),s=-r,a=b2Math.SubtractVV(i,t),l=b2Math.Dot(t,a),c=b2Math.Dot(i,a),u=-l,h=b2Math.SubtractVV(i,e),p=b2Math.Dot(e,h),d=b2Math.Dot(i,h),f=-p,m=b2Math.CrossVV(n,a),y=m*b2Math.CrossVV(e,i),_=m*b2Math.CrossVV(i,t),x=m*b2Math.CrossVV(t,e);if(s<=0&&u<=0)return this.m_v1.a=1,void(this.m_count=1);if(o>0&&s>0&&x<=0){var g=1/(o+s);return this.m_v1.a=o*g,this.m_v2.a=s*g,void(this.m_count=2)}if(c>0&&u>0&&_<=0){var v=1/(c+u);return this.m_v1.a=c*v,this.m_v3.a=u*v,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(o<=0&&f<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(c<=0&&d<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(d>0&&f>0&&y<=0){var b=1/(d+f);return this.m_v2.a=d*b,this.m_v3.a=f*b,this.m_count=2,void this.m_v1.Set(this.m_v3)}var w=1/(y+_+x);this.m_v1.a=y*w,this.m_v2.a=_*w,this.m_v3.a=x*w,this.m_count=3},b2SimplexCache.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},b2SimplexVertex.b2SimplexVertex=function(){},b2SimplexVertex.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},b2TimeOfImpact.b2TimeOfImpact=function(){},b2TimeOfImpact.TimeOfImpact=function(t){++b2TimeOfImpact.b2_toiCalls;var e=t.proxyA,i=t.proxyB,n=t.sweepA,r=t.sweepB;b2Settings.b2Assert(n.t0==r.t0),b2Settings.b2Assert(1-n.t0>Number.MIN_VALUE);var o=e.m_radius+i.m_radius,s=t.tolerance,a=0,l=0,c=0;for(b2TimeOfImpact.s_cache.count=0,b2TimeOfImpact.s_distanceInput.useRadii=!1;;){if(n.GetTransform(b2TimeOfImpact.s_xfA,a),r.GetTransform(b2TimeOfImpact.s_xfB,a),b2TimeOfImpact.s_distanceInput.proxyA=e,b2TimeOfImpact.s_distanceInput.proxyB=i,b2TimeOfImpact.s_distanceInput.transformA=b2TimeOfImpact.s_xfA,b2TimeOfImpact.s_distanceInput.transformB=b2TimeOfImpact.s_xfB,b2Distance.Distance(b2TimeOfImpact.s_distanceOutput,b2TimeOfImpact.s_cache,b2TimeOfImpact.s_distanceInput),b2TimeOfImpact.s_distanceOutput.distance<=0){a=1;break}b2TimeOfImpact.s_fcn.Initialize(b2TimeOfImpact.s_cache,e,b2TimeOfImpact.s_xfA,i,b2TimeOfImpact.s_xfB);var u=b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA,b2TimeOfImpact.s_xfB);if(u<=0){a=1;break}if(0==l&&(c=u>o?b2Math.Max(o-s,.75*o):b2Math.Max(u-s,.02*o)),u-c<.5*s){if(0==l){a=1;break}break}var h=a,p=a,d=1,f=u;n.GetTransform(b2TimeOfImpact.s_xfA,d),r.GetTransform(b2TimeOfImpact.s_xfB,d);var m=b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA,b2TimeOfImpact.s_xfB);if(m>=c){a=1;break}for(var y=0;;){var _=0;_=1&y?p+(c-f)*(d-p)/(m-f):.5*(p+d),n.GetTransform(b2TimeOfImpact.s_xfA,_),r.GetTransform(b2TimeOfImpact.s_xfB,_);var x=b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA,b2TimeOfImpact.s_xfB);if(b2Math.Abs(x-c)<.025*s){h=_;break}if(x>c?(p=_,f=x):(d=_,m=x),++y,++b2TimeOfImpact.b2_toiRootIters,50==y)break}if(b2TimeOfImpact.b2_toiMaxRootIters=b2Math.Max(b2TimeOfImpact.b2_toiMaxRootIters,y),h<(1+100*Number.MIN_VALUE)*a)break;if(a=h,l++,++b2TimeOfImpact.b2_toiIters,1e3==l)break}return b2TimeOfImpact.b2_toiMaxIters=b2Math.Max(b2TimeOfImpact.b2_toiMaxIters,l),a},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new b2SimplexCache,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new b2DistanceInput,Box2D.Collision.b2TimeOfImpact.s_xfA=new b2Transform,Box2D.Collision.b2TimeOfImpact.s_xfB=new b2Transform,Box2D.Collision.b2TimeOfImpact.s_fcn=new b2SeparationFunction,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new b2DistanceOutput}),b2TOIInput.b2TOIInput=function(){this.proxyA=new b2DistanceProxy,this.proxyB=new b2DistanceProxy,this.sweepA=new b2Sweep,this.sweepB=new b2Sweep},b2WorldManifold.b2WorldManifold=function(){this.m_normal=new b2Vec2},b2WorldManifold.prototype.b2WorldManifold=function(){this.m_points=new Vector(b2Settings.b2_maxManifoldPoints);for(var t=0;t<b2Settings.b2_maxManifoldPoints;t++)this.m_points[t]=new b2Vec2},b2WorldManifold.prototype.Initialize=function(t,e,i,n,r){if(void 0===i&&(i=0),void 0===r&&(r=0),0!=t.m_pointCount){var o,s,a=0,l=0,c=0,u=0,h=0,p=0,d=0;switch(t.m_type){case b2Manifold.e_circles:s=e.R,o=t.m_localPoint;var f=e.position.x+s.col1.x*o.x+s.col2.x*o.y,m=e.position.y+s.col1.y*o.x+s.col2.y*o.y;s=n.R,o=t.m_points[0].m_localPoint;var y=n.position.x+s.col1.x*o.x+s.col2.x*o.y,_=n.position.y+s.col1.y*o.x+s.col2.y*o.y,x=y-f,g=_-m,v=x*x+g*g;if(v>Number.MIN_VALUE*Number.MIN_VALUE){var b=Math.sqrt(v);this.m_normal.x=x/b,this.m_normal.y=g/b}else this.m_normal.x=1,this.m_normal.y=0;var w=f+i*this.m_normal.x,C=m+i*this.m_normal.y,S=y-r*this.m_normal.x,T=_-r*this.m_normal.y;this.m_points[0].x=.5*(w+S),this.m_points[0].y=.5*(C+T);break;case b2Manifold.e_faceA:for(s=e.R,o=t.m_localPlaneNormal,l=s.col1.x*o.x+s.col2.x*o.y,c=s.col1.y*o.x+s.col2.y*o.y,s=e.R,o=t.m_localPoint,u=e.position.x+s.col1.x*o.x+s.col2.x*o.y,h=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=l,this.m_normal.y=c,a=0;a<t.m_pointCount;a++)s=n.R,o=t.m_points[a].m_localPoint,p=n.position.x+s.col1.x*o.x+s.col2.x*o.y,d=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[a].x=p+.5*(i-(p-u)*l-(d-h)*c-r)*l,this.m_points[a].y=d+.5*(i-(p-u)*l-(d-h)*c-r)*c;break;case b2Manifold.e_faceB:for(s=n.R,o=t.m_localPlaneNormal,l=s.col1.x*o.x+s.col2.x*o.y,c=s.col1.y*o.x+s.col2.y*o.y,s=n.R,o=t.m_localPoint,u=n.position.x+s.col1.x*o.x+s.col2.x*o.y,h=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=-l,this.m_normal.y=-c,a=0;a<t.m_pointCount;a++)s=e.R,o=t.m_points[a].m_localPoint,p=e.position.x+s.col1.x*o.x+s.col2.x*o.y,d=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[a].x=p+.5*(r-(p-u)*l-(d-h)*c-i)*l,this.m_points[a].y=d+.5*(r-(p-u)*l-(d-h)*c-i)*c}}},ClipVertex.ClipVertex=function(){this.v=new b2Vec2,this.id=new b2ContactID},ClipVertex.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},Features.Features=function(){},Object.defineProperty(Features.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(Features.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(Features.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(Features.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(Features.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(Features.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(Features.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(Features.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}}),function(){Box2D.Common.b2Color,Box2D.Common.b2internal;var t=Box2D.Common.b2Settings,e=Box2D.Collision.Shapes.b2CircleShape,i=Box2D.Collision.Shapes.b2EdgeChainDef,n=Box2D.Collision.Shapes.b2EdgeShape,r=Box2D.Collision.Shapes.b2MassData,o=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,a=Box2D.Common.Math.b2Mat22,l=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),c=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform),u=Box2D.Common.Math.b2Vec2,h=(Box2D.Common.Math.b2Vec3,Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance),p=Box2D.Collision.b2DistanceInput,d=Box2D.Collision.b2DistanceOutput,f=Box2D.Collision.b2DistanceProxy,m=(Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache);Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape),e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new u},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,e)){var i=t instanceof e?t:null;this.m_p.SetV(i.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return(n=e.x-n)*n+(r=e.y-r)*r<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,r=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),o=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-r,a=e.p1.y-o,l=s*s+a*a-this.m_radius*this.m_radius,c=e.p2.x-e.p1.x,u=e.p2.y-e.p1.y,h=s*c+a*u,p=c*c+u*u,d=h*h-p*l;if(d<0||p<Number.MIN_VALUE)return!1;var f=-(h+Math.sqrt(d));return 0<=f&&f<=e.maxFraction*p&&(f/=p,t.fraction=f,t.normal.x=s+f*c,t.normal.y=a+f*u,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,r-this.m_radius),t.upperBound.Set(n+this.m_radius,r+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=l.MulX(i,this.m_p),o=-(l.Dot(t,r)-e);if(o<-this.m_radius+Number.MIN_VALUE)return 0;if(o>this.m_radius)return n.SetV(r),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=o*o,c=s*(Math.asin(o/this.m_radius)+Math.PI/2)+o*Math.sqrt(s-a),u=-2/3*Math.pow(s-a,1.5)/c;return n.x=r.x+t.x*u,n.y=r.y+t.y*u,c},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=s.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(n,Box2D.Collision.Shapes.b2Shape),n.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,n.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new u,this.m_v1=new u,this.m_v2=new u,this.m_coreV1=new u,this.m_coreV2=new u,this.m_normal=new u,this.m_direction=new u,this.m_cornerDir1=new u,this.m_cornerDir2=new u},n.prototype.TestPoint=function(t,e){return!1},n.prototype.RayCast=function(t,e,i){var n,r=e.p2.x-e.p1.x,o=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,c=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),u=100*Number.MIN_VALUE,h=-(r*l+o*c);if(h>u){var p=e.p1.x-s,d=e.p1.y-a,f=p*l+d*c;if(0<=f&&f<=e.maxFraction*h){var m=-r*d+o*p;if(-u*h<=m&&m<=h*(1+u)){f/=h,t.fraction=f;var y=Math.sqrt(l*l+c*c);return t.normal.x=l/y,t.normal.y=c/y,!0}}}return!1},n.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),r=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),o=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<o?(t.lowerBound.x=n,t.upperBound.x=o):(t.lowerBound.x=o,t.upperBound.x=n),r<s?(t.lowerBound.y=r,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=r)},n.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},n.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=new u(t.x*e,t.y*e),o=l.MulX(i,this.m_v1),s=l.MulX(i,this.m_v2),a=l.Dot(t,o)-e,c=l.Dot(t,s)-e;if(a>0){if(c>0)return 0;o.x=-c/(a-c)*o.x+a/(a-c)*s.x,o.y=-c/(a-c)*o.y+a/(a-c)*s.y}else c>0&&(s.x=-c/(a-c)*o.x+a/(a-c)*s.x,s.y=-c/(a-c)*o.y+a/(a-c)*s.y);return n.x=(r.x+o.x+s.x)/3,n.y=(r.y+o.y+s.y)/3,.5*((o.x-r.x)*(s.y-r.y)-(o.y-r.y)*(s.x-r.x))},n.prototype.GetLength=function(){return this.m_length},n.prototype.GetVertex1=function(){return this.m_v1},n.prototype.GetVertex2=function(){return this.m_v2},n.prototype.GetCoreVertex1=function(){return this.m_coreV1},n.prototype.GetCoreVertex2=function(){return this.m_coreV2},n.prototype.GetNormalVector=function(){return this.m_normal},n.prototype.GetDirectionVector=function(){return this.m_direction},n.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},n.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},n.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},n.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},n.prototype.GetFirstVertex=function(t){var e=t.R;return new u(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},n.prototype.GetNextEdge=function(){return this.m_nextEdge},n.prototype.GetPrevEdge=function(){return this.m_prevEdge},n.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,r=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),o=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return r*e+o*i>s*e+a*i?(this.s_supportVec.x=r,this.s_supportVec.y=o):(this.s_supportVec.x=s,this.s_supportVec.y=a),this.s_supportVec},n.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=s.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},n.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},n.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},r.b2MassData=function(){this.mass=0,this.center=new u(0,0),this.I=0},Box2D.inherit(o,Box2D.Collision.Shapes.b2Shape),o.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,o.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},o.prototype.Copy=function(){var t=new o;return t.Set(this),t},o.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,o)){var e=t instanceof o?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},o.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new Vector,r=0;for(r=0;r<t.length;++r)i=t[r],n.push(i);this.SetAsVector(n,e)},o.AsArray=function(t,e){void 0===e&&(e=0);var i=new o;return i.SetAsArray(t,e),i},o.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i);var n=0;for(n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(e[n]);for(n=0;n<this.m_vertexCount;++n){var r=parseInt(n),s=parseInt(n+1<this.m_vertexCount?n+1:0),a=l.SubtractVV(this.m_vertices[s],this.m_vertices[r]);t.b2Assert(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(l.CrossVF(a,1)),this.m_normals[n].Normalize()}this.m_centroid=o.ComputeCentroid(this.m_vertices,this.m_vertexCount)},o.AsVector=function(t,e){void 0===e&&(e=0);var i=new o;return i.SetAsVector(t,e),i},o.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},o.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new o;return i.SetAsBox(t,e),i},o.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var r=new c;r.position=i,r.R.Set(n);for(var o=0;o<this.m_vertexCount;++o)this.m_vertices[o]=l.MulX(r,this.m_vertices[o]),this.m_normals[o]=l.MulMV(r.R,this.m_normals[o])},o.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var r=new o;return r.SetAsOrientedBox(t,e,i,n),r},o.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=l.CrossVF(l.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},o.AsEdge=function(t,e){var i=new o;return i.SetAsEdge(t,e),i},o.prototype.TestPoint=function(t,e){for(var i,n=t.R,r=e.x-t.position.x,o=e.y-t.position.y,s=r*n.col1.x+o*n.col1.y,a=r*n.col2.x+o*n.col2.y,l=0;l<this.m_vertexCount;++l){if(r=s-(i=this.m_vertices[l]).x,o=a-i.y,(i=this.m_normals[l]).x*r+i.y*o>0)return!1}return!0},o.prototype.RayCast=function(t,e,i){var n,r,o=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y;var c=a*(n=i.R).col1.x+l*n.col1.y,u=a*n.col2.x+l*n.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y;for(var h=a*(n=i.R).col1.x+l*n.col1.y-c,p=a*n.col2.x+l*n.col2.y-u,d=parseInt(-1),f=0;f<this.m_vertexCount;++f){a=(r=this.m_vertices[f]).x-c,l=r.y-u;var m=(r=this.m_normals[f]).x*a+r.y*l,y=r.x*h+r.y*p;if(0==y){if(m<0)return!1}else y<0&&m<o*y?(o=m/y,d=f):y>0&&m<s*y&&(s=m/y);if(s<o-Number.MIN_VALUE)return!1}return d>=0&&(t.fraction=o,n=i.R,r=this.m_normals[d],t.normal.x=n.col1.x*r.x+n.col2.x*r.y,t.normal.y=n.col1.y*r.x+n.col2.y*r.y,!0)},o.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],r=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),o=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=r,a=o,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var c=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),u=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);r=r<c?r:c,o=o<u?o:u,s=s>c?s:c,a=a>u?a:u}t.lowerBound.x=r-this.m_radius,t.lowerBound.y=o-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},o.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,r=0,o=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],l=s+1<this.m_vertexCount?this.m_vertices[parseInt(s+1)]:this.m_vertices[0],c=a.x-0,u=a.y-0,h=l.x-0,p=l.y-0,d=c*p-u*h,f=.5*d;r+=f,i+=f*(1/3)*(0+a.x+l.x),n+=f*(1/3)*(0+a.y+l.y);o+=d*(1/3*(.25*(c*c+h*c+h*h)+(0*c+0*h))+0+(1/3*(.25*(u*u+p*u+p*p)+(0*u+0*p))+0))}t.mass=e*r,i*=1/r,n*=1/r,t.center.Set(i,n),t.I=e*o},o.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=l.MulTMV(i.R,t),s=e-l.Dot(t,i.position),a=new Vector_a2j_Number,c=0,h=parseInt(-1),p=parseInt(-1),d=!1,f=0;for(f=0;f<this.m_vertexCount;++f){a[f]=l.Dot(o,this.m_vertices[f])-s;var m=a[f]<-Number.MIN_VALUE;f>0&&(m?d||(h=f-1,c++):d&&(p=f-1,c++)),d=m}switch(c){case 0:if(d){var y=new r;return this.ComputeMass(y,1),n.SetV(l.MulX(i,y.center)),y.mass}return 0;case 1:-1==h?h=this.m_vertexCount-1:p=this.m_vertexCount-1}var _,x=parseInt((h+1)%this.m_vertexCount),g=parseInt((p+1)%this.m_vertexCount),v=(0-a[h])/(a[x]-a[h]),b=(0-a[p])/(a[g]-a[p]),w=new u(this.m_vertices[h].x*(1-v)+this.m_vertices[x].x*v,this.m_vertices[h].y*(1-v)+this.m_vertices[x].y*v),C=new u(this.m_vertices[p].x*(1-b)+this.m_vertices[g].x*b,this.m_vertices[p].y*(1-b)+this.m_vertices[g].y*b),S=0,T=new u,D=this.m_vertices[x];for(f=x;f!=g;){_=(f=(f+1)%this.m_vertexCount)==g?C:this.m_vertices[f];var A=.5*((D.x-w.x)*(_.y-w.y)-(D.y-w.y)*(_.x-w.x));S+=A,T.x+=A*(w.x+D.x+_.x)/3,T.y+=A*(w.y+D.y+_.y)/3,D=_}return T.Multiply(1/S),n.SetV(l.MulX(i,T)),S},o.prototype.GetVertexCount=function(){return this.m_vertexCount},o.prototype.GetVertices=function(){return this.m_vertices},o.prototype.GetNormals=function(){return this.m_normals},o.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},o.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},o.prototype.Validate=function(){return!1},o.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=s.e_polygonShape,this.m_centroid=new u,this.m_vertices=new Vector,this.m_normals=new Vector},o.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new u,this.m_normals[e]=new u},o.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new u,n=0,r=0;r<e;++r){var o=t[r],s=r+1<e?t[parseInt(r+1)]:t[0],a=o.x-0,l=o.y-0,c=s.x-0,h=.5*(a*(s.y-0)-l*c);n+=h,i.x+=h*(1/3)*(0+o.x+s.x),i.y+=h*(1/3)*(0+o.y+s.y)}return i.x*=1/n,i.y*=1/n,i},o.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,r=new Vector(i+1);for(n=0;n<i;++n)r[n]=e[n];r[i]=r[0];var o=Number.MAX_VALUE;for(n=1;n<=i;++n){for(var s=r[parseInt(n-1)],a=r[n].x-s.x,l=r[n].y-s.y,c=Math.sqrt(a*a+l*l),u=-(l/=c),h=a/=c,p=Number.MAX_VALUE,d=Number.MAX_VALUE,f=-Number.MAX_VALUE,m=-Number.MAX_VALUE,y=0;y<i;++y){var _=r[y].x-s.x,x=r[y].y-s.y,g=a*_+l*x,v=u*_+h*x;g<p&&(p=g),v<d&&(d=v),g>f&&(f=g),v>m&&(m=v)}var b=(f-p)*(m-d);if(b<.95*o){o=b,t.R.col1.x=a,t.R.col1.y=l,t.R.col2.x=u,t.R.col2.y=h;var w=.5*(p+f),C=.5*(d+m),S=t.R;t.center.x=s.x+(S.col1.x*w+S.col2.x*C),t.center.y=s.y+(S.col1.y*w+S.col2.y*C),t.extents.x=.5*(f-p),t.extents.y=.5*(m-d)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new a}),s.b2Shape=function(){},s.prototype.Copy=function(){return null},s.prototype.Set=function(t){this.m_radius=t.m_radius},s.prototype.GetType=function(){return this.m_type},s.prototype.TestPoint=function(t,e){return!1},s.prototype.RayCast=function(t,e,i){return!1},s.prototype.ComputeAABB=function(t,e){},s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},s.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},s.TestOverlap=function(t,e,i,n){var r=new p;r.proxyA=new f,r.proxyA.Set(t),r.proxyB=new f,r.proxyB.Set(i),r.transformA=e,r.transformB=n,r.useRadii=!0;var o=new m;o.count=0;var s=new d;return h.Distance(s,o,r),s.distance<10*Number.MIN_VALUE},s.prototype.b2Shape=function(){this.m_type=s.e_unknownShape,this.m_radius=t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=Box2D.Common.b2Color,e=(Box2D.Common.b2internal,Box2D.Common.b2Settings),i=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math);Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},t.prototype.Set=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){Box2D.Collision.b2AABB,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings;var t=Box2D.Common.Math.b2Mat22,e=Box2D.Common.Math.b2Mat33,i=Box2D.Common.Math.b2Math,n=Box2D.Common.Math.b2Sweep,r=Box2D.Common.Math.b2Transform,o=Box2D.Common.Math.b2Vec2,s=Box2D.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new o,this.col2=new o},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,r=this.col2.y,o=e*r-i*n;return 0!=o&&(o=1/o),t.col1.x=o*r,t.col2.x=-o*i,t.col1.y=-o*n,t.col2.y=o*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new s,this.col2=new s,this.col3=new s},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,a=n*s-r*o;return 0!=a&&(a=1/a),t.x=a*(s*e-r*i),t.y=a*(n*i-o*e),t},e.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var r=this.col1.x,o=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,c=this.col2.z,u=this.col3.x,h=this.col3.y,p=this.col3.z,d=r*(l*p-c*h)+o*(c*u-a*p)+s*(a*h-l*u);return 0!=d&&(d=1/d),t.x=d*(e*(l*p-c*h)+i*(c*u-a*p)+n*(a*h-l*u)),t.y=d*(r*(i*p-n*h)+o*(n*u-e*p)+s*(e*h-i*u)),t.z=d*(r*(l*n-c*i)+o*(c*e-a*n)+s*(a*i-l*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){return void 0===e&&(e=0),new o(e*t.y,-e*t.x)},i.CrossFV=function(t,e){return void 0===t&&(t=0),new o(-t*e.y,t*e.x)},i.MulMV=function(t,e){return new o(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},i.MulTMV=function(t,e){return new o(i.Dot(e,t.col1),i.Dot(e,t.col2))},i.MulX=function(t,e){var n=i.MulMV(t.R,e);return n.x+=t.position.x,n.y+=t.position.y,n},i.MulXT=function(t,e){var n=i.SubtractVV(e,t.position),r=n.x*t.R.col1.x+n.y*t.R.col1.y;return n.y=n.x*t.R.col2.x+n.y*t.R.col2.y,n.x=r,n},i.AddVV=function(t,e){return new o(t.x+e.x,t.y+e.y)},i.SubtractVV=function(t,e){return new o(t.x-e.x,t.y-e.y)},i.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},i.MulFV=function(t,e){return void 0===t&&(t=0),new o(t*e.x,t*e.y)},i.AddMM=function(e,n){return t.FromVV(i.AddVV(e.col1,n.col1),i.AddVV(e.col2,n.col2))},i.MulMM=function(e,n){return t.FromVV(i.MulMV(e,n.col1),i.MulMV(e,n.col2))},i.MulTMM=function(e,n){var r=new o(i.Dot(e.col1,n.col1),i.Dot(e.col2,n.col1)),s=new o(i.Dot(e.col1,n.col2),i.Dot(e.col2,n.col2));return t.FromVV(r,s)},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){return new o(i.Abs(t.x),i.Abs(t.y))},i.AbsM=function(e){return t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2))},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,e){return new o(i.Min(t.x,e.x),i.Min(t.y,e.y))},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){return new o(i.Max(t.x,e.x),i.Max(t.y,e.y))},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:t>i?i:t},i.ClampV=function(t,e,n){return i.MaxV(e,i.MinV(t,n))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,(t|=t>>16&65535)+1},i.IsPowerOfTwo=function(t){return void 0===t&&(t=0),t>0&&0==(t&t-1)},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new o(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new o(1,0),new o(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new r(i.b2Vec2_zero,i.b2Mat22_identity)}),n.b2Sweep=function(){this.localCenter=new o,this.c0=new o,this.c=new o},n.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},n.prototype.Copy=function(){var t=new n;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},n.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},n.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},r.b2Transform=function(){this.position=new o,this.R=new t},r.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},r.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},r.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},r.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},r.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},o.b2Vec2=function(){},o.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},o.prototype.SetZero=function(){this.x=0,this.y=0},o.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},o.prototype.SetV=function(t){this.x=t.x,this.y=t.y},o.prototype.GetNegative=function(){return new o(-this.x,-this.y)},o.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},o.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new o(t,e)},o.prototype.Copy=function(){return new o(this.x,this.y)},o.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},o.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},o.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},o.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},o.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},o.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},o.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},o.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},o.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},o.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},o.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},o.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},o.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},s.b2Vec3=function(){},s.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetZero=function(){this.x=this.y=this.z=0},s.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},s.prototype.GetNegative=function(){return new s(-this.x,-this.y,-this.z)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},s.prototype.Copy=function(){return new s(this.x,this.y,this.z)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){Box2D.Dynamics.Controllers.b2ControllerEdge,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33;var t=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Sweep,i=Box2D.Common.Math.b2Transform,n=Box2D.Common.Math.b2Vec2,r=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),o=(Box2D.Common.b2internal,Box2D.Common.b2Settings),s=Box2D.Collision.b2AABB,a=(Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint),l=(Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase),c=(Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput),u=Box2D.Collision.b2RayCastOutput,h=(Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase,Box2D.Collision.Shapes.b2CircleShape),p=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),d=Box2D.Collision.Shapes.b2MassData,f=Box2D.Collision.Shapes.b2PolygonShape,m=Box2D.Collision.Shapes.b2Shape,y=Box2D.Dynamics.b2Body,_=Box2D.Dynamics.b2BodyDef,x=Box2D.Dynamics.b2ContactFilter,g=Box2D.Dynamics.b2ContactImpulse,v=Box2D.Dynamics.b2ContactListener,b=Box2D.Dynamics.b2ContactManager,w=Box2D.Dynamics.b2DebugDraw,C=Box2D.Dynamics.b2DestructionListener,S=Box2D.Dynamics.b2FilterData,T=Box2D.Dynamics.b2Fixture,D=Box2D.Dynamics.b2FixtureDef,A=Box2D.Dynamics.b2Island,B=Box2D.Dynamics.b2TimeStep,M=Box2D.Dynamics.b2World,P=(Box2D.Dynamics.Contacts.b2CircleContact,Box2D.Dynamics.Contacts.b2Contact),E=(Box2D.Dynamics.Contacts.b2ContactConstraint,Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Box2D.Dynamics.Contacts.b2ContactEdge,Box2D.Dynamics.Contacts.b2ContactFactory),I=(Box2D.Dynamics.Contacts.b2ContactRegister,Box2D.Dynamics.Contacts.b2ContactResult,Box2D.Dynamics.Contacts.b2ContactSolver),R=(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Box2D.Dynamics.Contacts.b2NullContact,Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,Box2D.Dynamics.Contacts.b2PolygonContact,Box2D.Dynamics.Contacts.b2PositionSolverManifold,Box2D.Dynamics.Controllers.b2Controller,Box2D.Dynamics.Joints.b2DistanceJoint,Box2D.Dynamics.Joints.b2DistanceJointDef,Box2D.Dynamics.Joints.b2FrictionJoint,Box2D.Dynamics.Joints.b2FrictionJointDef,Box2D.Dynamics.Joints.b2GearJoint,Box2D.Dynamics.Joints.b2GearJointDef,Box2D.Dynamics.Joints.b2Jacobian,Box2D.Dynamics.Joints.b2Joint),O=(Box2D.Dynamics.Joints.b2JointDef,Box2D.Dynamics.Joints.b2JointEdge,Box2D.Dynamics.Joints.b2LineJoint,Box2D.Dynamics.Joints.b2LineJointDef,Box2D.Dynamics.Joints.b2MouseJoint,Box2D.Dynamics.Joints.b2MouseJointDef,Box2D.Dynamics.Joints.b2PrismaticJoint,Box2D.Dynamics.Joints.b2PrismaticJointDef,Box2D.Dynamics.Joints.b2PulleyJoint);Box2D.Dynamics.Joints.b2PulleyJointDef,Box2D.Dynamics.Joints.b2RevoluteJoint,Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2WeldJoint,Box2D.Dynamics.Joints.b2WeldJointDef;y.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new n,this.m_force=new n},y.prototype.connectEdges=function(e,i,n){void 0===n&&(n=0);var r=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x),s=Math.tan(.5*(r-n)),a=t.MulFV(s,i.GetDirectionVector());a=t.SubtractVV(a,i.GetNormalVector()),a=t.MulFV(o.b2_toiSlop,a),a=t.AddVV(a,i.GetVertex1());var l=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());l.Normalize();var c=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,a,l,c),i.SetPrevEdge(e,a,l,c),r},y.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new T;if(e.Create(this,this.m_xf,t),this.m_flags&y.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=M.e_newFixture,e},y.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new D;return i.shape=t,i.density=e,this.CreateFixture(i)},y.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,!0;break}i=e,e=e.m_next}for(var n=this.m_contactList;n;){var r=n.contact;n=n.next;var o=r.GetFixtureA(),s=r.GetFixtureB();t!=o&&t!=s||this.m_world.m_contactManager.Destroy(r)}if(this.m_flags&y.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(a)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},y.prototype.SetPositionAndAngle=function(t,e){var i;if(void 0===e&&(e=0),1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var o=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},y.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},y.prototype.GetTransform=function(){return this.m_xf},y.prototype.GetPosition=function(){return this.m_xf.position},y.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},y.prototype.GetAngle=function(){return this.m_sweep.a},y.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},y.prototype.GetWorldCenter=function(){return this.m_sweep.c},y.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},y.prototype.SetLinearVelocity=function(t){this.m_type!=y.b2_staticBody&&this.m_linearVelocity.SetV(t)},y.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},y.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=y.b2_staticBody&&(this.m_angularVelocity=t)},y.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},y.prototype.GetDefinition=function(){var t=new _;return t.type=this.GetType(),t.allowSleep=(this.m_flags&y.e_allowSleepFlag)==y.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&y.e_fixedRotationFlag)==y.e_fixedRotationFlag,t.bullet=(this.m_flags&y.e_bulletFlag)==y.e_bulletFlag,t.awake=(this.m_flags&y.e_awakeFlag)==y.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},y.prototype.ApplyForce=function(t,e){this.m_type==y.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},y.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==y.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},y.prototype.ApplyImpulse=function(t,e){this.m_type==y.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},y.prototype.Split=function(e){for(var i,n=this.GetLinearVelocity().Copy(),r=this.GetAngularVelocity(),o=this.GetWorldCenter(),s=this.m_world.CreateBody(this.GetDefinition()),a=this.m_fixtureList;a;)if(e(a)){var l=a.m_next;i?i.m_next=l:this.m_fixtureList=l,this.m_fixtureCount--,a.m_next=s.m_fixtureList,s.m_fixtureList=a,s.m_fixtureCount++,a.m_body=s,a=l}else i=a,a=a.m_next;this.ResetMassData(),s.ResetMassData();var c=this.GetWorldCenter(),u=s.GetWorldCenter(),h=t.AddVV(n,t.CrossFV(r,t.SubtractVV(c,o))),p=t.AddVV(n,t.CrossFV(r,t.SubtractVV(u,o)));return this.SetLinearVelocity(h),s.SetLinearVelocity(p),this.SetAngularVelocity(r),s.SetAngularVelocity(r),this.SynchronizeFixtures(),s.SynchronizeFixtures(),s},y.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=r,e=i}n.m_fixtureCount=0;var n=this,r=t;n.GetWorldCenter(),r.GetWorldCenter(),n.GetLinearVelocity().Copy(),r.GetLinearVelocity().Copy(),n.GetAngularVelocity(),r.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},y.prototype.GetMass=function(){return this.m_mass},y.prototype.GetInertia=function(){return this.m_I},y.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},y.prototype.SetMassData=function(e){if(o.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==y.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&y.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},y.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=y.b2_staticBody&&this.m_type!=y.b2_kinematicBody){for(var e=n.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var r=i.GetMassData();this.m_mass+=r.mass,e.x+=r.center.x*r.mass,e.y+=r.center.y*r.mass,this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&y.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,o.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-s.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-s.x)}},y.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},y.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},y.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},y.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},y.prototype.GetLinearVelocityFromWorldPoint=function(t){return new n(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},y.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new n(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},y.prototype.GetLinearDamping=function(){return this.m_linearDamping},y.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},y.prototype.GetAngularDamping=function(){return this.m_angularDamping},y.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},y.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==y.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},y.prototype.GetType=function(){return this.m_type},y.prototype.SetBullet=function(t){t?this.m_flags|=y.e_bulletFlag:this.m_flags&=~y.e_bulletFlag},y.prototype.IsBullet=function(){return(this.m_flags&y.e_bulletFlag)==y.e_bulletFlag},y.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=y.e_allowSleepFlag:(this.m_flags&=~y.e_allowSleepFlag,this.SetAwake(!0))},y.prototype.SetAwake=function(t){t?(this.m_flags|=y.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~y.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},y.prototype.IsAwake=function(){return(this.m_flags&y.e_awakeFlag)==y.e_awakeFlag},y.prototype.SetFixedRotation=function(t){t?this.m_flags|=y.e_fixedRotationFlag:this.m_flags&=~y.e_fixedRotationFlag,this.ResetMassData()},y.prototype.IsFixedRotation=function(){return(this.m_flags&y.e_fixedRotationFlag)==y.e_fixedRotationFlag},y.prototype.SetActive=function(t){var e,i;if(t!=this.IsActive())if(t)for(this.m_flags|=y.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~y.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var r=n;n=n.next,this.m_world.m_contactManager.Destroy(r.contact)}this.m_contactList=null}},y.prototype.IsActive=function(){return(this.m_flags&y.e_activeFlag)==y.e_activeFlag},y.prototype.IsSleepingAllowed=function(){return(this.m_flags&y.e_allowSleepFlag)==y.e_allowSleepFlag},y.prototype.GetFixtureList=function(){return this.m_fixtureList},y.prototype.GetJointList=function(){return this.m_jointList},y.prototype.GetControllerList=function(){return this.m_controllerList},y.prototype.GetContactList=function(){return this.m_contactList},y.prototype.GetNext=function(){return this.m_next},y.prototype.GetUserData=function(){return this.m_userData},y.prototype.SetUserData=function(t){this.m_userData=t},y.prototype.GetWorld=function(){return this.m_world},y.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=y.e_bulletFlag),t.fixedRotation&&(this.m_flags|=y.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=y.e_allowSleepFlag),t.awake&&(this.m_flags|=y.e_awakeFlag),t.active&&(this.m_flags|=y.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==y.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},y.prototype.SynchronizeFixtures=function(){var t=y.s_xf1;t.R.Set(this.m_sweep.a0);var e,i=t.R,n=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(i.col1.x*n.x+i.col2.x*n.y),t.position.y=this.m_sweep.c0.y-(i.col1.y*n.x+i.col2.y*n.y);var r=this.m_world.m_contactManager.m_broadPhase;for(e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(r,t,this.m_xf)},y.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},y.prototype.ShouldCollide=function(t){if(this.m_type!=y.b2_dynamicBody&&t.m_type!=y.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},y.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new i,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),_.b2BodyDef=function(){this.position=new n,this.linearVelocity=new n},_.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=y.b2_staticBody,this.active=!0,this.inertiaScale=1},x.b2ContactFilter=function(){},x.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();return i.groupIndex==n.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits)},x.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof T?t:null,e)},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new x}),g.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(o.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(o.b2_maxManifoldPoints)},v.b2ContactListener=function(){},v.prototype.BeginContact=function(t){},v.prototype.EndContact=function(t){},v.prototype.PreSolve=function(t,e){},v.prototype.PostSolve=function(t,e){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new v}),b.b2ContactManager=function(){},b.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=x.b2_defaultFilter,this.m_contactListener=v.b2_defaultListener,this.m_contactFactory=new E(this.m_allocator),this.m_broadPhase=new l},b.prototype.AddPair=function(t,e){var i=t instanceof T?t:null,n=e instanceof T?e:null,r=i.GetBody(),o=n.GetBody();if(r!=o){for(var s=o.GetContactList();s;){if(s.other==r){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=o.ShouldCollide(r)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var c=this.m_contactFactory.Create(i,n);i=c.GetFixtureA(),n=c.GetFixtureB(),r=i.m_body,o=n.m_body,c.m_prev=null,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=o,c.m_nodeA.prev=null,c.m_nodeA.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=c.m_nodeA),r.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=r,c.m_nodeB.prev=null,c.m_nodeB.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeB),o.m_contactList=c.m_nodeB,++this.m_world.m_contactCount}}},b.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},b.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},b.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();if(0!=n.IsAwake()||0!=r.IsAwake()){if(t.m_flags&P.e_filterFlag){if(0==r.ShouldCollide(n)){var o=t;t=o.GetNext(),this.Destroy(o);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){t=(o=t).GetNext(),this.Destroy(o);continue}t.m_flags&=~P.e_filterFlag}var s=e.m_proxy,a=i.m_proxy;0!=this.m_broadPhase.TestOverlap(s,a)?(t.Update(this.m_contactListener),t=t.GetNext()):(t=(o=t).GetNext(),this.Destroy(o))}else t=t.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new a}),w.b2DebugDraw=function(){},w.prototype.b2DebugDraw=function(){},w.prototype.SetFlags=function(t){void 0===t&&(t=0)},w.prototype.GetFlags=function(){},w.prototype.AppendFlags=function(t){void 0===t&&(t=0)},w.prototype.ClearFlags=function(t){void 0===t&&(t=0)},w.prototype.SetSprite=function(t){},w.prototype.GetSprite=function(){},w.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},w.prototype.GetDrawScale=function(){},w.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},w.prototype.GetLineThickness=function(){},w.prototype.SetAlpha=function(t){void 0===t&&(t=0)},w.prototype.GetAlpha=function(){},w.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},w.prototype.GetFillAlpha=function(){},w.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},w.prototype.GetXFormScale=function(){},w.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},w.prototype.DrawSegment=function(t,e,i){},w.prototype.DrawTransform=function(t){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),C.b2DestructionListener=function(){},C.prototype.SayGoodbyeJoint=function(t){},C.prototype.SayGoodbyeFixture=function(t){},S.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},S.prototype.Copy=function(){var t=new S;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},T.b2Fixture=function(){this.m_filter=new S},T.prototype.GetType=function(){return this.m_shape.GetType()},T.prototype.GetShape=function(){return this.m_shape},T.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.SetSensor(n.IsSensor()||r.IsSensor()),e=e.next}},T.prototype.IsSensor=function(){return this.m_isSensor},T.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.FlagForFiltering(),e=e.next}},T.prototype.GetFilterData=function(){return this.m_filter.Copy()},T.prototype.GetBody=function(){return this.m_body},T.prototype.GetNext=function(){return this.m_next},T.prototype.GetUserData=function(){return this.m_userData},T.prototype.SetUserData=function(t){this.m_userData=t},T.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},T.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},T.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new d),this.m_shape.ComputeMass(t,this.m_density),t},T.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},T.prototype.GetDensity=function(){return this.m_density},T.prototype.GetFriction=function(){return this.m_friction},T.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},T.prototype.GetRestitution=function(){return this.m_restitution},T.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},T.prototype.GetAABB=function(){return this.m_aabb},T.prototype.b2Fixture=function(){this.m_aabb=new s,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},T.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},T.prototype.Destroy=function(){this.m_shape=null},T.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},T.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},T.prototype.Synchronize=function(e,i,n){if(this.m_proxy){var r=new s,o=new s;this.m_shape.ComputeAABB(r,i),this.m_shape.ComputeAABB(o,n),this.m_aabb.Combine(r,o);var a=t.SubtractVV(n.position,i.position);e.MoveProxy(this.m_proxy,this.m_aabb,a)}},D.b2FixtureDef=function(){this.filter=new S},D.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},A.b2Island=function(){},A.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},A.prototype.Initialize=function(t,e,i,n,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_contactSolver=o,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},A.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},A.prototype.Solve=function(e,i,n){var r,s=0,a=0;for(s=0;s<this.m_bodyCount;++s)(r=this.m_bodies[s]).GetType()==y.b2_dynamicBody&&(r.m_linearVelocity.x+=e.dt*(i.x+r.m_invMass*r.m_force.x),r.m_linearVelocity.y+=e.dt*(i.y+r.m_invMass*r.m_force.y),r.m_angularVelocity+=e.dt*r.m_invI*r.m_torque,r.m_linearVelocity.Multiply(t.Clamp(1-e.dt*r.m_linearDamping,0,1)),r.m_angularVelocity*=t.Clamp(1-e.dt*r.m_angularDamping,0,1));this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var l=this.m_contactSolver;for(l.InitVelocityConstraints(e),s=0;s<this.m_jointCount;++s)this.m_joints[s].InitVelocityConstraints(e);for(s=0;s<e.velocityIterations;++s){for(a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(e);l.SolveVelocityConstraints()}for(s=0;s<this.m_jointCount;++s)this.m_joints[s].FinalizeVelocityConstraints();for(l.FinalizeVelocityConstraints(),s=0;s<this.m_bodyCount;++s)if((r=this.m_bodies[s]).GetType()!=y.b2_staticBody){var c=e.dt*r.m_linearVelocity.x,u=e.dt*r.m_linearVelocity.y;c*c+u*u>o.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=o.b2_maxTranslation*e.inv_dt,r.m_linearVelocity.y*=o.b2_maxTranslation*e.inv_dt);var h=e.dt*r.m_angularVelocity;h*h>o.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-o.b2_maxRotation*e.inv_dt:r.m_angularVelocity=o.b2_maxRotation*e.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=e.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=e.dt*r.m_linearVelocity.y,r.m_sweep.a+=e.dt*r.m_angularVelocity,r.SynchronizeTransform()}for(s=0;s<e.positionIterations;++s){var p=l.SolvePositionConstraints(o.b2_contactBaumgarte),d=!0;for(a=0;a<this.m_jointCount;++a){var f=this.m_joints[a].SolvePositionConstraints(o.b2_contactBaumgarte);d=d&&f}if(p&&d)break}if(this.Report(l.m_constraints),n){var m=Number.MAX_VALUE,_=o.b2_linearSleepTolerance*o.b2_linearSleepTolerance,x=o.b2_angularSleepTolerance*o.b2_angularSleepTolerance;for(s=0;s<this.m_bodyCount;++s)(r=this.m_bodies[s]).GetType()!=y.b2_staticBody&&(0==(r.m_flags&y.e_allowSleepFlag)&&(r.m_sleepTime=0,m=0),0==(r.m_flags&y.e_allowSleepFlag)||r.m_angularVelocity*r.m_angularVelocity>x||t.Dot(r.m_linearVelocity,r.m_linearVelocity)>_?(r.m_sleepTime=0,m=0):(r.m_sleepTime+=e.dt,m=t.Min(m,r.m_sleepTime)));if(m>=o.b2_timeToSleep)for(s=0;s<this.m_bodyCount;++s)(r=this.m_bodies[s]).SetAwake(!1)}},A.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var r=this.m_bodies[e];if(r.GetType()!=y.b2_staticBody){var s=t.dt*r.m_linearVelocity.x,a=t.dt*r.m_linearVelocity.y;s*s+a*a>o.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=o.b2_maxTranslation*t.inv_dt,r.m_linearVelocity.y*=o.b2_maxTranslation*t.inv_dt);var l=t.dt*r.m_angularVelocity;l*l>o.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-o.b2_maxRotation*t.inv_dt:r.m_angularVelocity=o.b2_maxRotation*t.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=t.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=t.dt*r.m_linearVelocity.y,r.m_sweep.a+=t.dt*r.m_angularVelocity,r.SynchronizeTransform()}}for(e=0;e<t.positionIterations;++e){var c=n.SolvePositionConstraints(.75),u=!0;for(i=0;i<this.m_jointCount;++i){var h=this.m_joints[i].SolvePositionConstraints(o.b2_contactBaumgarte);u=u&&h}if(c&&u)break}this.Report(n.m_constraints)},A.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],r=0;r<n.pointCount;++r)A.s_impulse.normalImpulses[r]=n.points[r].normalImpulse,A.s_impulse.tangentImpulses[r]=n.points[r].tangentImpulse;this.m_listener.PostSolve(i,A.s_impulse)}},A.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},A.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},A.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new g}),B.b2TimeStep=function(){},B.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},M.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new b,this.m_contactSolver=new I,this.m_island=new A},M.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,M.m_warmStarting=!0,M.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new _;this.m_groundBody=this.CreateBody(i)},M.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},M.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},M.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},M.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},M.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},M.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},M.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},M.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new y(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},M.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var r=n;n=n.nextController,r.controller.RemoveBody(t)}for(var o=t.m_contactList;o;){var s=o;o=o.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},M.prototype.CreateJoint=function(t){var e=R.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next;return e},M.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,R.Destroy(t,null),--this.m_jointCount,0==e)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next},M.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},M.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},M.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},M.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},M.prototype.SetWarmStarting=function(t){M.m_warmStarting=t},M.prototype.SetContinuousPhysics=function(t){M.m_continuousPhysics=t},M.prototype.GetBodyCount=function(){return this.m_bodyCount},M.prototype.GetJointCount=function(){return this.m_jointCount},M.prototype.GetContactCount=function(){return this.m_contactCount},M.prototype.SetGravity=function(t){this.m_gravity=t},M.prototype.GetGravity=function(){return this.m_gravity},M.prototype.GetGroundBody=function(){return this.m_groundBody},M.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&M.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~M.e_newFixture),this.m_flags|=M.e_locked;var n=M.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,n.inv_dt=t>0?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=M.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),M.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~M.e_locked},M.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},M.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,o,a,l,c=this.m_debugDraw.GetFlags(),u=(new n,new n,new n,new s,new s,[new n,new n,new n,new n]),h=new r(0,0,0);if(c&w.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(l=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?(h.Set(.5,.5,.3),this.DrawShape(i,l,h)):t.GetType()==y.b2_staticBody?(h.Set(.5,.9,.5),this.DrawShape(i,l,h)):t.GetType()==y.b2_kinematicBody?(h.Set(.5,.5,.9),this.DrawShape(i,l,h)):0==t.IsAwake()?(h.Set(.6,.6,.6),this.DrawShape(i,l,h)):(h.Set(.9,.7,.7),this.DrawShape(i,l,h));if(c&w.e_jointBit)for(o=this.m_jointList;o;o=o.m_next)this.DrawJoint(o);if(c&w.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw);if(c&w.e_pairBit){h.Set(.3,.9,.9);for(var d=this.m_contactManager.m_contactList;d;d=d.GetNext()){var f=d.GetFixtureA(),m=d.GetFixtureB(),_=f.GetAABB().GetCenter(),x=m.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(_,x,h)}}if(c&w.e_aabbBit)for(a=this.m_contactManager.m_broadPhase,u=[new n,new n,new n,new n],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var g=a.GetFatAABB(e.m_proxy);u[0].Set(g.lowerBound.x,g.lowerBound.y),u[1].Set(g.upperBound.x,g.lowerBound.y),u[2].Set(g.upperBound.x,g.upperBound.y),u[3].Set(g.lowerBound.x,g.upperBound.y),this.m_debugDraw.DrawPolygon(u,4,h)}if(c&w.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)(l=M.s_xf).R=t.m_xf.R,l.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(l)}},M.prototype.QueryAABB=function(t,e){var i=this.m_contactManager.m_broadPhase;i.Query(function(e){return t(i.GetUserData(e))},e)},M.prototype.QueryShape=function(t,e,n){void 0===n&&(n=null),null==n&&(n=new i).SetIdentity();var r=this.m_contactManager.m_broadPhase;var o=new s;e.ComputeAABB(o,n),r.Query(function(i){var o=r.GetUserData(i)instanceof T?r.GetUserData(i):null;return!m.TestOverlap(e,n,o.GetShape(),o.GetBody().GetTransform())||t(o)},o)},M.prototype.QueryPoint=function(t,e){var i=this.m_contactManager.m_broadPhase;var n=new s;n.lowerBound.Set(e.x-o.b2_linearSlop,e.y-o.b2_linearSlop),n.upperBound.Set(e.x+o.b2_linearSlop,e.y+o.b2_linearSlop),i.Query(function(n){var r=i.GetUserData(n)instanceof T?i.GetUserData(n):null;return!r.TestPoint(e)||t(r)},n)},M.prototype.RayCast=function(t,e,i){var r=this.m_contactManager.m_broadPhase,o=new u;var s=new c(e,i);r.RayCast(function(s,a){var l=r.GetUserData(a),c=l instanceof T?l:null;if(c.RayCast(o,s)){var u=o.fraction,h=new n((1-u)*e.x+u*i.x,(1-u)*e.y+u*i.y);return t(c,h,o.normal,u)}return s.maxFraction},s)},M.prototype.RayCastOne=function(t,e){var i;return this.RayCast(function(t,e,n,r){return void 0===r&&(r=0),i=t,r},t,e),i},M.prototype.RayCastAll=function(t,e){var i=new Vector;return this.RayCast(function(t,e,n,r){return void 0===r&&(r=0),i[i.length]=t,1},t,e),i},M.prototype.GetBodyList=function(){return this.m_bodyList},M.prototype.GetJointList=function(){return this.m_jointList},M.prototype.GetContactList=function(){return this.m_contactList},M.prototype.IsLocked=function(){return(this.m_flags&M.e_locked)>0},M.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~y.e_islandFlag;for(var r=this.m_contactList;r;r=r.m_next)r.m_flags&=~P.e_islandFlag;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;parseInt(this.m_bodyCount);for(var s=this.s_stack,a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&y.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=y.b2_staticBody){n.Clear();var l=0;for(s[l++]=a,a.m_flags|=y.e_islandFlag;l>0;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=y.b2_staticBody){for(var c,u=e.m_contactList;u;u=u.next)u.contact.m_flags&P.e_islandFlag||1!=u.contact.IsSensor()&&0!=u.contact.IsEnabled()&&0!=u.contact.IsTouching()&&(n.AddContact(u.contact),u.contact.m_flags|=P.e_islandFlag,(c=u.other).m_flags&y.e_islandFlag||(s[l++]=c,c.m_flags|=y.e_islandFlag));for(var h=e.m_jointList;h;h=h.next)1!=h.joint.m_islandFlag&&0!=(c=h.other).IsActive()&&(n.AddJoint(h.joint),h.joint.m_islandFlag=!0,c.m_flags&y.e_islandFlag||(s[l++]=c,c.m_flags|=y.e_islandFlag))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var p=0;p<n.m_bodyCount;++p)(e=n.m_bodies[p]).GetType()==y.b2_staticBody&&(e.m_flags&=~y.e_islandFlag)}for(p=0;p<s.length&&s[p];++p)s[p]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=y.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},M.prototype.SolveTOI=function(t){var e,i,n,r,s,a,l,c=this.m_island;c.Initialize(this.m_bodyCount,o.b2_maxTOIContactsPerIsland,o.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var u,h=M.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~y.e_islandFlag,e.m_sweep.t0=0;for(u=this.m_contactList;u;u=u.m_next)u.m_flags&=~(P.e_toiFlag|P.e_islandFlag);for(l=this.m_jointList;l;l=l.m_next)l.m_islandFlag=!1;for(;;){var p=null,d=1;for(u=this.m_contactList;u;u=u.m_next)if(1!=u.IsSensor()&&0!=u.IsEnabled()&&0!=u.IsContinuous()){var f=1;if(u.m_flags&P.e_toiFlag)f=u.m_toi;else{if(i=u.m_fixtureA,n=u.m_fixtureB,r=i.m_body,s=n.m_body,!(r.GetType()==y.b2_dynamicBody&&0!=r.IsAwake()||s.GetType()==y.b2_dynamicBody&&0!=s.IsAwake()))continue;var m=r.m_sweep.t0;r.m_sweep.t0<s.m_sweep.t0?(m=s.m_sweep.t0,r.m_sweep.Advance(m)):s.m_sweep.t0<r.m_sweep.t0&&(m=r.m_sweep.t0,s.m_sweep.Advance(m)),f=u.ComputeTOI(r.m_sweep,s.m_sweep),o.b2Assert(0<=f&&f<=1),f>0&&f<1&&(f=(1-f)*m+f)>1&&(f=1),u.m_toi=f,u.m_flags|=P.e_toiFlag}Number.MIN_VALUE<f&&f<d&&(p=u,d=f)}if(null==p||1-100*Number.MIN_VALUE<d)break;if(i=p.m_fixtureA,n=p.m_fixtureB,r=i.m_body,s=n.m_body,M.s_backupA.Set(r.m_sweep),M.s_backupB.Set(s.m_sweep),r.Advance(d),s.Advance(d),p.Update(this.m_contactManager.m_contactListener),p.m_flags&=~P.e_toiFlag,1!=p.IsSensor()&&0!=p.IsEnabled()){if(0!=p.IsTouching()){var _=r;_.GetType()!=y.b2_dynamicBody&&(_=s),c.Clear();var x=0,g=0;for(h[x+g++]=_,_.m_flags|=y.e_islandFlag;g>0;)if(e=h[x++],--g,c.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==y.b2_dynamicBody){for(a=e.m_contactList;a&&c.m_contactCount!=c.m_contactCapacity;a=a.next)if(!(a.contact.m_flags&P.e_islandFlag)&&1!=a.contact.IsSensor()&&0!=a.contact.IsEnabled()&&0!=a.contact.IsTouching()){c.AddContact(a.contact),a.contact.m_flags|=P.e_islandFlag;var v=a.other;v.m_flags&y.e_islandFlag||(v.GetType()!=y.b2_staticBody&&(v.Advance(d),v.SetAwake(!0)),h[x+g]=v,++g,v.m_flags|=y.e_islandFlag)}for(var b=e.m_jointList;b;b=b.next)c.m_jointCount!=c.m_jointCapacity&&1!=b.joint.m_islandFlag&&0!=(v=b.other).IsActive()&&(c.AddJoint(b.joint),b.joint.m_islandFlag=!0,v.m_flags&y.e_islandFlag||(v.GetType()!=y.b2_staticBody&&(v.Advance(d),v.SetAwake(!0)),h[x+g]=v,++g,v.m_flags|=y.e_islandFlag))}var w=M.s_timestep;w.warmStarting=!1,w.dt=(1-d)*t.dt,w.inv_dt=1/w.dt,w.dtRatio=0,w.velocityIterations=t.velocityIterations,w.positionIterations=t.positionIterations,c.SolveTOI(w);var C=0;for(C=0;C<c.m_bodyCount;++C)if((e=c.m_bodies[C]).m_flags&=~y.e_islandFlag,0!=e.IsAwake()&&e.GetType()==y.b2_dynamicBody)for(e.SynchronizeFixtures(),a=e.m_contactList;a;a=a.next)a.contact.m_flags&=~P.e_toiFlag;for(C=0;C<c.m_contactCount;++C)(u=c.m_contacts[C]).m_flags&=~(P.e_toiFlag|P.e_islandFlag);for(C=0;C<c.m_jointCount;++C)(l=c.m_joints[C]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else r.m_sweep.Set(M.s_backupA),s.m_sweep.Set(M.s_backupB),r.SynchronizeTransform(),s.SynchronizeTransform()}},M.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,r=i.m_xf,o=n.position,s=r.position,a=t.GetAnchorA(),l=t.GetAnchorB(),c=M.s_jointColor;switch(t.m_type){case R.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,c);break;case R.e_pulleyJoint:var u=t instanceof O?t:null,h=u.GetGroundAnchorA(),p=u.GetGroundAnchorB();this.m_debugDraw.DrawSegment(h,a,c),this.m_debugDraw.DrawSegment(p,l,c),this.m_debugDraw.DrawSegment(h,p,c);break;case R.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,c);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(o,a,c),this.m_debugDraw.DrawSegment(a,l,c),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,c)}},M.prototype.DrawShape=function(e,i,n){switch(e.m_type){case m.e_circleShape:var r=e instanceof h?e:null,o=t.MulX(i,r.m_p),s=r.m_radius,a=i.R.col1;this.m_debugDraw.DrawSolidCircle(o,s,a,n);break;case m.e_polygonShape:var l=0,c=e instanceof f?e:null,u=parseInt(c.GetVertexCount()),d=c.GetVertices(),y=new Vector(u);for(l=0;l<u;++l)y[l]=t.MulX(i,d[l]);this.m_debugDraw.DrawSolidPolygon(y,u,n);break;case m.e_edgeShape:var _=e instanceof p?e:null;this.m_debugDraw.DrawSegment(t.MulX(i,_.GetVertex1()),t.MulX(i,_.GetVertex2()),n)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new B,Box2D.Dynamics.b2World.s_xf=new i,Box2D.Dynamics.b2World.s_backupA=new e,Box2D.Dynamics.b2World.s_backupB=new e,Box2D.Dynamics.b2World.s_timestep=new B,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new r(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),i=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),n=Box2D.Collision.Shapes.b2Shape,r=Box2D.Dynamics.Contacts.b2CircleContact,o=Box2D.Dynamics.Contacts.b2Contact,s=Box2D.Dynamics.Contacts.b2ContactConstraint,a=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,c=Box2D.Dynamics.Contacts.b2ContactFactory,u=Box2D.Dynamics.Contacts.b2ContactRegister,h=Box2D.Dynamics.Contacts.b2ContactResult,p=Box2D.Dynamics.Contacts.b2ContactSolver,d=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,f=Box2D.Dynamics.Contacts.b2NullContact,m=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,y=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,_=Box2D.Dynamics.Contacts.b2PolygonContact,x=Box2D.Dynamics.Contacts.b2PositionSolverManifold,g=Box2D.Dynamics.b2Body,v=(Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep),b=(Box2D.Dynamics.b2World,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),w=Box2D.Common.Math.b2Mat22,C=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),S=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),T=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision),D=Box2D.Collision.b2ContactID,A=(Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold),B=(Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact),M=Box2D.Collision.b2TOIInput,P=Box2D.Collision.b2WorldManifold;Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(r,Box2D.Dynamics.Contacts.b2Contact),r.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,r.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},r.Create=function(t){return new r},r.Destroy=function(t,e){},r.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},r.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();T.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},o.b2Contact=function(){this.m_nodeA=new l,this.m_nodeB=new l,this.m_manifold=new A,this.m_oldManifold=new A},o.prototype.GetManifold=function(){return this.m_manifold},o.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)},o.prototype.IsTouching=function(){return(this.m_flags&o.e_touchingFlag)==o.e_touchingFlag},o.prototype.IsContinuous=function(){return(this.m_flags&o.e_continuousFlag)==o.e_continuousFlag},o.prototype.SetSensor=function(t){t?this.m_flags|=o.e_sensorFlag:this.m_flags&=~o.e_sensorFlag},o.prototype.IsSensor=function(){return(this.m_flags&o.e_sensorFlag)==o.e_sensorFlag},o.prototype.SetEnabled=function(t){t?this.m_flags|=o.e_enabledFlag:this.m_flags&=~o.e_enabledFlag},o.prototype.IsEnabled=function(){return(this.m_flags&o.e_enabledFlag)==o.e_enabledFlag},o.prototype.GetNext=function(){return this.m_next},o.prototype.GetFixtureA=function(){return this.m_fixtureA},o.prototype.GetFixtureB=function(){return this.m_fixtureB},o.prototype.FlagForFiltering=function(){this.m_flags|=o.e_filterFlag},o.prototype.b2Contact=function(){},o.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=o.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=o.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=g.b2_dynamicBody||i.IsBullet()||n.GetType()!=g.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=o.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},o.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=o.e_enabledFlag;var i=!1,r=(this.m_flags&o.e_touchingFlag)==o.e_touchingFlag,s=this.m_fixtureA.m_body,a=this.m_fixtureB.m_body,l=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&o.e_sensorFlag){if(l){var c=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape(),h=s.GetTransform(),p=a.GetTransform();i=n.TestOverlap(c,h,u,p)}this.m_manifold.m_pointCount=0}else{if(s.GetType()!=g.b2_dynamicBody||s.IsBullet()||a.GetType()!=g.b2_dynamicBody||a.IsBullet()?this.m_flags|=o.e_continuousFlag:this.m_flags&=~o.e_continuousFlag,l){this.Evaluate(),i=this.m_manifold.m_pointCount>0;for(var d=0;d<this.m_manifold.m_pointCount;++d){var f=this.m_manifold.m_points[d];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var m=f.m_id,y=0;y<this.m_oldManifold.m_pointCount;++y){var _=this.m_oldManifold.m_points[y];if(_.m_id.key==m.key){f.m_normalImpulse=_.m_normalImpulse,f.m_tangentImpulse=_.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=r&&(s.SetAwake(!0),a.SetAwake(!0))}i?this.m_flags|=o.e_touchingFlag:this.m_flags&=~o.e_touchingFlag,0==r&&1==i&&t.BeginContact(this),1==r&&0==i&&t.EndContact(this),0==(this.m_flags&o.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},o.prototype.Evaluate=function(){},o.prototype.ComputeTOI=function(t,e){return o.s_input.proxyA.Set(this.m_fixtureA.GetShape()),o.s_input.proxyB.Set(this.m_fixtureB.GetShape()),o.s_input.sweepA=t,o.s_input.sweepB=e,o.s_input.tolerance=b.b2_linearSlop,B.TimeOfImpact(o.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new M}),s.b2ContactConstraint=function(){this.localPlaneNormal=new S,this.localPoint=new S,this.normal=new S,this.normalMass=new w,this.K=new w},s.prototype.b2ContactConstraint=function(){this.points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.points[t]=new a},a.b2ContactConstraintPoint=function(){this.localPoint=new S,this.rA=new S,this.rB=new S},l.b2ContactEdge=function(){},c.b2ContactFactory=function(){},c.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},c.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},c.prototype.InitializeRegisters=function(){this.m_registers=new Vector(n.e_shapeTypeCount);for(var t=0;t<n.e_shapeTypeCount;t++){this.m_registers[t]=new Vector(n.e_shapeTypeCount);for(var e=0;e<n.e_shapeTypeCount;e++)this.m_registers[t][e]=new u}this.AddType(r.Create,r.Destroy,n.e_circleShape,n.e_circleShape),this.AddType(m.Create,m.Destroy,n.e_polygonShape,n.e_circleShape),this.AddType(_.Create,_.Destroy,n.e_polygonShape,n.e_polygonShape),this.AddType(d.Create,d.Destroy,n.e_edgeShape,n.e_circleShape),this.AddType(y.Create,y.Destroy,n.e_polygonShape,n.e_edgeShape)},c.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),r=parseInt(e.GetType()),o=this.m_registers[n][r];if(o.pool)return i=o.pool,o.pool=i.m_next,o.poolCount--,i.Reset(t,e),i;var s=o.createFcn;return null!=s?o.primary?((i=s(this.m_allocator)).Reset(t,e),i):((i=s(this.m_allocator)).Reset(e,t),i):null},c.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t,(0,n.destroyFcn)(t,this.m_allocator)},u.b2ContactRegister=function(){},h.b2ContactResult=function(){this.position=new S,this.normal=new S,this.id=new D},p.b2ContactSolver=function(){this.m_step=new v,this.m_constraints=new Vector},p.prototype.b2ContactSolver=function(){},p.prototype.Initialize=function(t,e,i,n){var r;void 0===i&&(i=0),this.m_step.Set(t),this.m_allocator=n;var o=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new s;for(o=0;o<i;++o){var a=(r=e[o]).m_fixtureA,l=r.m_fixtureB,c=a.m_shape,u=l.m_shape,h=c.m_radius,d=u.m_radius,f=a.m_body,m=l.m_body,y=r.GetManifold(),_=b.b2MixFriction(a.GetFriction(),l.GetFriction()),x=b.b2MixRestitution(a.GetRestitution(),l.GetRestitution()),g=f.m_linearVelocity.x,v=f.m_linearVelocity.y,w=m.m_linearVelocity.x,C=m.m_linearVelocity.y,S=f.m_angularVelocity,T=m.m_angularVelocity;b.b2Assert(y.m_pointCount>0),p.s_worldManifold.Initialize(y,f.m_xf,h,m.m_xf,d);var D=p.s_worldManifold.m_normal.x,A=p.s_worldManifold.m_normal.y,B=this.m_constraints[o];B.bodyA=f,B.bodyB=m,B.manifold=y,B.normal.x=D,B.normal.y=A,B.pointCount=y.m_pointCount,B.friction=_,B.restitution=x,B.localPlaneNormal.x=y.m_localPlaneNormal.x,B.localPlaneNormal.y=y.m_localPlaneNormal.y,B.localPoint.x=y.m_localPoint.x,B.localPoint.y=y.m_localPoint.y,B.radius=h+d,B.type=y.m_type;for(var M=0;M<B.pointCount;++M){var P=y.m_points[M],E=B.points[M];E.normalImpulse=P.m_normalImpulse,E.tangentImpulse=P.m_tangentImpulse,E.localPoint.SetV(P.m_localPoint);var I=E.rA.x=p.s_worldManifold.m_points[M].x-f.m_sweep.c.x,R=E.rA.y=p.s_worldManifold.m_points[M].y-f.m_sweep.c.y,O=E.rB.x=p.s_worldManifold.m_points[M].x-m.m_sweep.c.x,k=E.rB.y=p.s_worldManifold.m_points[M].y-m.m_sweep.c.y,L=I*A-R*D,F=O*A-k*D;L*=L,F*=F;var N=f.m_invMass+m.m_invMass+f.m_invI*L+m.m_invI*F;E.normalMass=1/N;var V=f.m_mass*f.m_invMass+m.m_mass*m.m_invMass;V+=f.m_mass*f.m_invI*L+m.m_mass*m.m_invI*F,E.equalizedMass=1/V;var j=-D,G=I*j-R*A,U=O*j-k*A;G*=G,U*=U;var z=f.m_invMass+m.m_invMass+f.m_invI*G+m.m_invI*U;E.tangentMass=1/z,E.velocityBias=0;var X=w+-T*k-g- -S*R,W=C+T*O-v-S*I,J=B.normal.x*X+B.normal.y*W;J<-b.b2_velocityThreshold&&(E.velocityBias+=-B.restitution*J)}if(2==B.pointCount){var H=B.points[0],q=B.points[1],Y=f.m_invMass,$=f.m_invI,K=m.m_invMass,Z=m.m_invI,Q=H.rA.x*A-H.rA.y*D,tt=H.rB.x*A-H.rB.y*D,et=q.rA.x*A-q.rA.y*D,it=q.rB.x*A-q.rB.y*D,nt=Y+K+$*Q*Q+Z*tt*tt,rt=Y+K+$*et*et+Z*it*it,ot=Y+K+$*Q*et+Z*tt*it;nt*nt<100*(nt*rt-ot*ot)?(B.K.col1.Set(nt,ot),B.K.col2.Set(ot,rt),B.K.GetInverse(B.normalMass)):B.pointCount=1}}},p.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,r=i.bodyB,o=n.m_invMass,s=n.m_invI,a=r.m_invMass,l=r.m_invI,c=i.normal.x,u=i.normal.y,h=u,p=-c,d=0,f=0;if(t.warmStarting)for(f=i.pointCount,d=0;d<f;++d){var m=i.points[d];m.normalImpulse*=t.dtRatio,m.tangentImpulse*=t.dtRatio;var y=m.normalImpulse*c+m.tangentImpulse*h,_=m.normalImpulse*u+m.tangentImpulse*p;n.m_angularVelocity-=s*(m.rA.x*_-m.rA.y*y),n.m_linearVelocity.x-=o*y,n.m_linearVelocity.y-=o*_,r.m_angularVelocity+=l*(m.rB.x*_-m.rB.y*y),r.m_linearVelocity.x+=a*y,r.m_linearVelocity.y+=a*_}else for(f=i.pointCount,d=0;d<f;++d){var x=i.points[d];x.normalImpulse=0,x.tangentImpulse=0}}},p.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,r=0,o=0,s=0,a=0,l=0,c=0,u=0,h=0,p=0,d=0,f=0,m=0,y=0;y<this.m_constraintCount;++y){var _=this.m_constraints[y],x=_.bodyA,g=_.bodyB,v=x.m_angularVelocity,b=g.m_angularVelocity,w=x.m_linearVelocity,S=g.m_linearVelocity,T=x.m_invMass,D=x.m_invI,A=g.m_invMass,B=g.m_invI,M=_.normal.x,P=_.normal.y,E=P,I=-M,R=_.friction;for(i=0;i<_.pointCount;i++)t=_.points[i],r=(S.x-b*t.rB.y-w.x+v*t.rA.y)*E+(S.y+b*t.rB.x-w.y-v*t.rA.x)*I,o=t.tangentMass*-r,s=R*t.normalImpulse,l=(o=(a=C.Clamp(t.tangentImpulse+o,-s,s))-t.tangentImpulse)*E,c=o*I,w.x-=T*l,w.y-=T*c,v-=D*(t.rA.x*c-t.rA.y*l),S.x+=A*l,S.y+=A*c,b+=B*(t.rB.x*c-t.rB.y*l),t.tangentImpulse=a;parseInt(_.pointCount);if(1==_.pointCount)t=_.points[0],n=(S.x+-b*t.rB.y-w.x- -v*t.rA.y)*M+(S.y+b*t.rB.x-w.y-v*t.rA.x)*P,o=-t.normalMass*(n-t.velocityBias),l=(o=(a=(a=t.normalImpulse+o)>0?a:0)-t.normalImpulse)*M,c=o*P,w.x-=T*l,w.y-=T*c,v-=D*(t.rA.x*c-t.rA.y*l),S.x+=A*l,S.y+=A*c,b+=B*(t.rB.x*c-t.rB.y*l),t.normalImpulse=a;else{var O=_.points[0],k=_.points[1],L=O.normalImpulse,F=k.normalImpulse,N=(S.x-b*O.rB.y-w.x+v*O.rA.y)*M+(S.y+b*O.rB.x-w.y-v*O.rA.x)*P,V=(S.x-b*k.rB.y-w.x+v*k.rA.y)*M+(S.y+b*k.rB.x-w.y-v*k.rA.x)*P,j=N-O.velocityBias,G=V-k.velocityBias;j-=(e=_.K).col1.x*L+e.col2.x*F,G-=e.col1.y*L+e.col2.y*F;for(;;){var U=-((e=_.normalMass).col1.x*j+e.col2.x*G),z=-(e.col1.y*j+e.col2.y*G);if(U>=0&&z>=0){p=(u=U-L)*M,d=u*P,f=(h=z-F)*M,m=h*P,w.x-=T*(p+f),w.y-=T*(d+m),v-=D*(O.rA.x*d-O.rA.y*p+k.rA.x*m-k.rA.y*f),S.x+=A*(p+f),S.y+=A*(d+m),b+=B*(O.rB.x*d-O.rB.y*p+k.rB.x*m-k.rB.y*f),O.normalImpulse=U,k.normalImpulse=z;break}if(U=-O.normalMass*j,z=0,N=0,V=_.K.col1.y*U+G,U>=0&&V>=0){p=(u=U-L)*M,d=u*P,f=(h=z-F)*M,m=h*P,w.x-=T*(p+f),w.y-=T*(d+m),v-=D*(O.rA.x*d-O.rA.y*p+k.rA.x*m-k.rA.y*f),S.x+=A*(p+f),S.y+=A*(d+m),b+=B*(O.rB.x*d-O.rB.y*p+k.rB.x*m-k.rB.y*f),O.normalImpulse=U,k.normalImpulse=z;break}if(U=0,z=-k.normalMass*G,N=_.K.col2.x*z+j,V=0,z>=0&&N>=0){p=(u=U-L)*M,d=u*P,f=(h=z-F)*M,m=h*P,w.x-=T*(p+f),w.y-=T*(d+m),v-=D*(O.rA.x*d-O.rA.y*p+k.rA.x*m-k.rA.y*f),S.x+=A*(p+f),S.y+=A*(d+m),b+=B*(O.rB.x*d-O.rB.y*p+k.rB.x*m-k.rB.y*f),O.normalImpulse=U,k.normalImpulse=z;break}if(U=0,z=0,V=G,(N=j)>=0&&V>=0){p=(u=U-L)*M,d=u*P,f=(h=z-F)*M,m=h*P,w.x-=T*(p+f),w.y-=T*(d+m),v-=D*(O.rA.x*d-O.rA.y*p+k.rA.x*m-k.rA.y*f),S.x+=A*(p+f),S.y+=A*(d+m),b+=B*(O.rB.x*d-O.rB.y*p+k.rB.x*m-k.rB.y*f),O.normalImpulse=U,k.normalImpulse=z;break}break}}x.m_angularVelocity=v,g.m_angularVelocity=b}},p.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var r=i.m_points[n],o=e.points[n];r.m_normalImpulse=o.normalImpulse,r.m_tangentImpulse=o.tangentImpulse}},p.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],r=n.bodyA,o=n.bodyB,s=r.m_mass*r.m_invMass,a=r.m_mass*r.m_invI,l=o.m_mass*o.m_invMass,c=o.m_mass*o.m_invI;p.s_psm.Initialize(n);for(var u=p.s_psm.m_normal,h=0;h<n.pointCount;h++){var d=n.points[h],f=p.s_psm.m_points[h],m=p.s_psm.m_separations[h],y=f.x-r.m_sweep.c.x,_=f.y-r.m_sweep.c.y,x=f.x-o.m_sweep.c.x,g=f.y-o.m_sweep.c.y;e=e<m?e:m;var v=C.Clamp(t*(m+b.b2_linearSlop),-b.b2_maxLinearCorrection,0),w=-d.equalizedMass*v,S=w*u.x,T=w*u.y;r.m_sweep.c.x-=s*S,r.m_sweep.c.y-=s*T,r.m_sweep.a-=a*(y*T-_*S),r.SynchronizeTransform(),o.m_sweep.c.x+=l*S,o.m_sweep.c.y+=l*T,o.m_sweep.a+=c*(x*T-g*S),o.SynchronizeTransform()}}return e>-1.5*b.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new P,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new x}),Box2D.inherit(d,Box2D.Dynamics.Contacts.b2Contact),d.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,d.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},d.Create=function(t){return new d},d.Destroy=function(t,e){},d.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},d.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},d.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,r){},Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact),f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,f.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},f.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},f.prototype.Evaluate=function(){},Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact),m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,m.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},m.Create=function(t){return new m},m.Destroy=function(t,e){},m.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),b.b2Assert(t.GetType()==n.e_polygonShape),b.b2Assert(e.GetType()==n.e_circleShape)},m.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;T.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},Box2D.inherit(y,Box2D.Dynamics.Contacts.b2Contact),y.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,y.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.Create=function(t){return new y},y.Destroy=function(t,e){},y.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),b.b2Assert(t.GetType()==n.e_polygonShape),b.b2Assert(e.GetType()==n.e_edgeShape)},y.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},y.prototype.b2CollidePolyAndEdge=function(t,e,i,n,r){},Box2D.inherit(_,Box2D.Dynamics.Contacts.b2Contact),_.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,_.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},_.Create=function(t){return new _},_.Destroy=function(t,e){},_.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},_.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();T.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},x.b2PositionSolverManifold=function(){},x.prototype.b2PositionSolverManifold=function(){this.m_normal=new S,this.m_separations=new Vector_a2j_Number(b.b2_maxManifoldPoints),this.m_points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.m_points[t]=new S},x.prototype.Initialize=function(t){b.b2Assert(t.pointCount>0);var e,i,n=0,r=0,o=0,s=0,a=0;switch(t.type){case A.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var u=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),h=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),p=u-l,d=h-c,f=p*p+d*d;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var m=Math.sqrt(f);this.m_normal.x=p/m,this.m_normal.y=d/m}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+u),this.m_points[0].y=.5*(c+h),this.m_separations[0]=p*this.m_normal.x+d*this.m_normal.y-t.radius;break;case A.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-a)*this.m_normal.y-t.radius,this.m_points[n].x=r,this.m_points[n].y=o;break;case A.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-a)*this.m_normal.y-t.radius,this.m_points[n].Set(r,o);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new S,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new S})}(),function(){Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;var t=Box2D.Common.Math.b2Mat22,e=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),i=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),n=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),r=(Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape,Box2D.Collision.Shapes.b2Shape,Box2D.Dynamics.Controllers.b2BuoyancyController),o=Box2D.Dynamics.Controllers.b2ConstantAccelController,s=Box2D.Dynamics.Controllers.b2ConstantForceController,a=Box2D.Dynamics.Controllers.b2Controller,l=Box2D.Dynamics.Controllers.b2ControllerEdge,c=Box2D.Dynamics.Controllers.b2GravityController,u=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller),r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,r.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.offset=0,this.density=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},r.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var n=e.body;if(0!=n.IsAwake()){for(var r=new i,o=new i,s=0,a=0,l=n.GetFixtureList();l;l=l.GetNext()){var c=new i,u=l.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),c);s+=u,r.x+=u*c.x,r.y+=u*c.y;var h=0;a+=u*(h=(this.useDensity,1)),o.x+=u*c.x*h,o.y+=u*c.y*h}if(r.x/=s,r.y/=s,o.x/=a,o.y/=a,!(s<Number.MIN_VALUE)){var p=this.gravity.GetNegative();p.Multiply(this.density*s),n.ApplyForce(p,o);var d=n.GetLinearVelocityFromWorldPoint(r);d.Subtract(this.velocity),d.Multiply(-this.linearDrag*s),n.ApplyForce(d,r),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}}}}},r.prototype.Draw=function(t){var e=1e3,r=new i,o=new i;r.x=this.normal.x*this.offset+this.normal.y*e,r.y=this.normal.y*this.offset-this.normal.x*e,o.x=this.normal.x*this.offset-this.normal.y*e,o.y=this.normal.y*this.offset+this.normal.x*e;var s=new n(0,0,1);t.DrawSegment(r,o,s)},Box2D.inherit(o,Box2D.Dynamics.Controllers.b2Controller),o.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,o.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},o.prototype.Step=function(t){for(var e=new i(this.A.x*t.dt,this.A.y*t.dt),n=this.m_bodyList;n;n=n.nextBody){var r=n.body;r.IsAwake()&&r.SetLinearVelocity(new i(r.GetLinearVelocity().x+e.x,r.GetLinearVelocity().y+e.y))}},Box2D.inherit(s,Box2D.Dynamics.Controllers.b2Controller),s.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},s.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},a.b2Controller=function(){},a.prototype.Step=function(t){},a.prototype.Draw=function(t){},a.prototype.AddBody=function(t){var e=new l;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},a.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},a.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetWorld=function(){return this.m_world},a.prototype.GetBodyList=function(){return this.m_bodyList},l.b2ControllerEdge=function(){},Box2D.inherit(c,Box2D.Dynamics.Controllers.b2Controller),c.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,c.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},c.prototype.Step=function(t){var e=null,n=null,r=null,o=0,s=null,a=null,l=null,c=0,u=0,h=0,p=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(r=(n=e.body).GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)(h=(c=(l=(a=s.body).GetWorldCenter()).x-r.x)*c+(u=l.y-r.y)*u)<Number.MIN_VALUE||((p=new i(c,u)).Multiply(this.G/h/Math.sqrt(h)*o*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,r),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l));else for(e=this.m_bodyList;e;e=e.nextBody)for(r=(n=e.body).GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)(h=(c=(l=(a=s.body).GetWorldCenter()).x-r.x)*c+(u=l.y-r.y)*u)<Number.MIN_VALUE||((p=new i(c,u)).Multiply(this.G/h*o*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,r),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l))},Box2D.inherit(u,Box2D.Dynamics.Controllers.b2Controller),u.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,u.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},u.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,this.maxTimestep=t>0||e>0?1/Math.max(t,e):0},u.prototype.Step=function(t){var n=t.dt;if(!(n<=Number.MIN_VALUE)){n>this.maxTimestep&&this.maxTimestep>0&&(n=this.maxTimestep);for(var r=this.m_bodyList;r;r=r.nextBody){var o=r.body;if(o.IsAwake()){var s=o.GetWorldVector(e.MulMV(this.T,o.GetLocalVector(o.GetLinearVelocity())));o.SetLinearVelocity(new i(o.GetLinearVelocity().x+s.x*n,o.GetLinearVelocity().y+s.y*n))}}}}}(),function(){Box2D.Common.b2Color,Box2D.Common.b2internal;var t=Box2D.Common.b2Settings,e=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,n=Box2D.Common.Math.b2Math,r=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),o=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,a=Box2D.Dynamics.Joints.b2DistanceJointDef,l=Box2D.Dynamics.Joints.b2FrictionJoint,c=Box2D.Dynamics.Joints.b2FrictionJointDef,u=Box2D.Dynamics.Joints.b2GearJoint,h=Box2D.Dynamics.Joints.b2GearJointDef,p=Box2D.Dynamics.Joints.b2Jacobian,d=Box2D.Dynamics.Joints.b2Joint,f=Box2D.Dynamics.Joints.b2JointDef,m=Box2D.Dynamics.Joints.b2JointEdge,y=Box2D.Dynamics.Joints.b2LineJoint,_=Box2D.Dynamics.Joints.b2LineJointDef,x=Box2D.Dynamics.Joints.b2MouseJoint,g=Box2D.Dynamics.Joints.b2MouseJointDef,v=Box2D.Dynamics.Joints.b2PrismaticJoint,b=Box2D.Dynamics.Joints.b2PrismaticJointDef,w=Box2D.Dynamics.Joints.b2PulleyJoint,C=Box2D.Dynamics.Joints.b2PulleyJointDef,S=Box2D.Dynamics.Joints.b2RevoluteJoint,T=Box2D.Dynamics.Joints.b2RevoluteJointDef,D=Box2D.Dynamics.Joints.b2WeldJoint,A=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint),s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u=new r},s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},s.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},s.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},s.prototype.GetLength=function(){return this.m_length},s.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},s.prototype.GetFrequency=function(){return this.m_frequencyHz},s.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},s.prototype.GetDampingRatio=function(){return this.m_dampingRatio},s.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},s.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},s.prototype.InitVelocityConstraints=function(e){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,c=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n,this.m_u.x=o.m_sweep.c.x+l-r.m_sweep.c.x-s,this.m_u.y=o.m_sweep.c.y+c-r.m_sweep.c.y-a;var u=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);u>t.b2_linearSlop?this.m_u.Multiply(1/u):this.m_u.SetZero();var h=s*this.m_u.y-a*this.m_u.x,p=l*this.m_u.y-c*this.m_u.x,d=r.m_invMass+r.m_invI*h*h+o.m_invMass+o.m_invI*p*p;if(this.m_mass=0!=d?1/d:0,this.m_frequencyHz>0){var f=u-this.m_length,m=2*Math.PI*this.m_frequencyHz,y=2*this.m_mass*this.m_dampingRatio*m,_=this.m_mass*m*m;this.m_gamma=e.dt*(y+e.dt*_),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=f*e.dt*_*this.m_gamma,this.m_mass=d+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var x=this.m_impulse*this.m_u.x,g=this.m_impulse*this.m_u.y;r.m_linearVelocity.x-=r.m_invMass*x,r.m_linearVelocity.y-=r.m_invMass*g,r.m_angularVelocity-=r.m_invI*(s*g-a*x),o.m_linearVelocity.x+=o.m_invMass*x,o.m_linearVelocity.y+=o.m_invMass*g,o.m_angularVelocity+=o.m_invI*(l*g-c*x)}else this.m_impulse=0},s.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var c=i.m_linearVelocity.x+-i.m_angularVelocity*o,u=i.m_linearVelocity.y+i.m_angularVelocity*r,h=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,d=this.m_u.x*(h-c)+this.m_u.y*(p-u),f=-this.m_mass*(d+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var m=f*this.m_u.x,y=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*m,i.m_linearVelocity.y-=i.m_invMass*y,i.m_angularVelocity-=i.m_invI*(r*y-o*m),n.m_linearVelocity.x+=n.m_invMass*m,n.m_linearVelocity.y+=n.m_invMass*y,n.m_angularVelocity+=n.m_invI*(a*y-l*m)},s.prototype.SolvePositionConstraints=function(e){var i;if(void 0===e&&(e=0),this.m_frequencyHz>0)return!0;var r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y,l=i.col1.x*s+i.col2.x*a;a=i.col1.y*s+i.col2.y*a,s=l,i=o.m_xf.R;var c=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;l=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=l;var h=o.m_sweep.c.x+c-r.m_sweep.c.x-s,p=o.m_sweep.c.y+u-r.m_sweep.c.y-a,d=Math.sqrt(h*h+p*p);h/=d,p/=d;var f=d-this.m_length;f=n.Clamp(f,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var m=-this.m_mass*f;this.m_u.Set(h,p);var y=m*this.m_u.x,_=m*this.m_u.y;return r.m_sweep.c.x-=r.m_invMass*y,r.m_sweep.c.y-=r.m_invMass*_,r.m_sweep.a-=r.m_invI*(s*_-a*y),o.m_sweep.c.x+=o.m_invMass*y,o.m_sweep.c.y+=o.m_invMass*_,o.m_sweep.a+=o.m_invI*(c*_-u*y),r.SynchronizeTransform(),o.SynchronizeTransform(),n.Abs(f)<t.b2_linearSlop},Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef),a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,a.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},a.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},a.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var r=n.x-i.x,o=n.y-i.y;this.length=Math.sqrt(r*r+o*o),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint),l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,l.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_linearMass=new e,this.m_linearImpulse=new r},l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},l.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},l.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},l.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},l.prototype.GetMaxForce=function(){return this.m_maxForce},l.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},l.prototype.GetMaxTorque=function(){return this.m_maxTorque},l.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},l.prototype.InitVelocityConstraints=function(t){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchorA.x-r.m_sweep.localCenter.x,a=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=o.m_xf.R;var l=this.m_localAnchorB.x-o.m_sweep.localCenter.x,c=this.m_localAnchorB.y-o.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=n;var u=r.m_invMass,h=o.m_invMass,p=r.m_invI,d=o.m_invI,f=new e;if(f.col1.x=u+h,f.col2.x=0,f.col1.y=0,f.col2.y=u+h,f.col1.x+=p*a*a,f.col2.x+=-p*s*a,f.col1.y+=-p*s*a,f.col2.y+=p*s*s,f.col1.x+=d*c*c,f.col2.x+=-d*l*c,f.col1.y+=-d*l*c,f.col2.y+=d*l*l,f.GetInverse(this.m_linearMass),this.m_angularMass=p+d,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var m=this.m_linearImpulse;r.m_linearVelocity.x-=u*m.x,r.m_linearVelocity.y-=u*m.y,r.m_angularVelocity-=p*(s*m.y-a*m.x+this.m_angularImpulse),o.m_linearVelocity.x+=h*m.x,o.m_linearVelocity.y+=h*m.y,o.m_angularVelocity+=d*(l*m.y-c*m.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},l.prototype.SolveVelocityConstraints=function(t){var e,i=0,o=this.m_bodyA,s=this.m_bodyB,a=o.m_linearVelocity,l=o.m_angularVelocity,c=s.m_linearVelocity,u=s.m_angularVelocity,h=o.m_invMass,p=s.m_invMass,d=o.m_invI,f=s.m_invI;e=o.m_xf.R;var m=this.m_localAnchorA.x-o.m_sweep.localCenter.x,y=this.m_localAnchorA.y-o.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*y,y=e.col1.y*m+e.col2.y*y,m=i,e=s.m_xf.R;var _=this.m_localAnchorB.x-s.m_sweep.localCenter.x,x=this.m_localAnchorB.y-s.m_sweep.localCenter.y;i=e.col1.x*_+e.col2.x*x,x=e.col1.y*_+e.col2.y*x,_=i;var g=0,v=u-l,b=-this.m_angularMass*v,w=this.m_angularImpulse;g=t.dt*this.m_maxTorque,this.m_angularImpulse=n.Clamp(this.m_angularImpulse+b,-g,g),l-=d*(b=this.m_angularImpulse-w),u+=f*b;var C=c.x-u*x-a.x+l*y,S=c.y+u*_-a.y-l*m,T=n.MulMV(this.m_linearMass,new r(-C,-S)),D=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(T),g=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>g*g&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(g)),T=n.SubtractVV(this.m_linearImpulse,D),a.x-=h*T.x,a.y-=h*T.y,l-=d*(m*T.y-y*T.x),c.x+=p*T.x,c.y+=p*T.y,u+=f*(_*T.y-x*T.x),o.m_angularVelocity=l,s.m_angularVelocity=u},l.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},c.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_frictionJoint,this.maxForce=0,this.maxTorque=0},c.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},Box2D.inherit(u,Box2D.Dynamics.Joints.b2Joint),u.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,u.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_J=new p},u.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},u.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},u.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},u.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,r=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=r;var o=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*o)},u.prototype.GetRatio=function(){return this.m_ratio},u.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},u.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,r=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==d.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof S?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),n=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof v?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),n=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==d.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof S?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),r=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof v?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),r=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*r,this.m_impulse=0},u.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,r=this.m_ground2,o=this.m_bodyA,s=this.m_bodyB,a=0,l=0,c=0,u=0,h=0,p=0,d=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,d+=o.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=o.m_xf.R,c=this.m_localAnchor1.x-o.m_sweep.localCenter.x,u=this.m_localAnchor1.y-o.m_sweep.localCenter.y,p=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,h=(c=p)*l-u*a,this.m_J.linearA.Set(-a,-l),this.m_J.angularA=-h,d+=o.m_invMass+o.m_invI*h*h),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,d+=this.m_ratio*this.m_ratio*s.m_invI):(e=r.m_xf.R,i=this.m_prismatic2.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,c=this.m_localAnchor2.x-s.m_sweep.localCenter.x,u=this.m_localAnchor2.y-s.m_sweep.localCenter.y,p=e.col1.x*c+e.col2.x*u,u=e.col1.y*c+e.col2.y*u,h=(c=p)*l-u*a,this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l),this.m_J.angularB=-this.m_ratio*h,d+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*h*h)),this.m_mass=d>0?1/d:0,t.warmStarting?(o.m_linearVelocity.x+=o.m_invMass*this.m_impulse*this.m_J.linearA.x,o.m_linearVelocity.y+=o.m_invMass*this.m_impulse*this.m_J.linearA.y,o.m_angularVelocity+=o.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},u.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),r=-this.m_mass*n;this.m_impulse+=r,e.m_linearVelocity.x+=e.m_invMass*r*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*r*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*r*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*r*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*r*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*r*this.m_J.angularB},u.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i=this.m_bodyA,n=this.m_bodyB,r=0,o=0;r=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),o=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var s=this.m_constant-(r+this.m_ratio*o),a=-this.m_mass*s;return i.m_sweep.c.x+=i.m_invMass*a*this.m_J.linearA.x,i.m_sweep.c.y+=i.m_invMass*a*this.m_J.linearA.y,i.m_sweep.a+=i.m_invI*a*this.m_J.angularA,n.m_sweep.c.x+=n.m_invMass*a*this.m_J.linearB.x,n.m_sweep.c.y+=n.m_invMass*a*this.m_J.linearB.y,n.m_sweep.a+=n.m_invI*a*this.m_J.angularB,i.SynchronizeTransform(),n.SynchronizeTransform(),0<t.b2_linearSlop},Box2D.inherit(h,Box2D.Dynamics.Joints.b2JointDef),h.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,h.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},h.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},p.b2Jacobian=function(){this.linearA=new r,this.linearB=new r},p.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},p.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},p.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},d.b2Joint=function(){this.m_edgeA=new m,this.m_edgeB=new m,this.m_localCenterA=new r,this.m_localCenterB=new r},d.prototype.GetType=function(){return this.m_type},d.prototype.GetAnchorA=function(){return null},d.prototype.GetAnchorB=function(){return null},d.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},d.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},d.prototype.GetBodyA=function(){return this.m_bodyA},d.prototype.GetBodyB=function(){return this.m_bodyB},d.prototype.GetNext=function(){return this.m_next},d.prototype.GetUserData=function(){return this.m_userData},d.prototype.SetUserData=function(t){this.m_userData=t},d.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},d.Create=function(t,e){var i=null;switch(t.type){case d.e_distanceJoint:i=new s(t instanceof a?t:null);break;case d.e_mouseJoint:i=new x(t instanceof g?t:null);break;case d.e_prismaticJoint:i=new v(t instanceof b?t:null);break;case d.e_revoluteJoint:i=new S(t instanceof T?t:null);break;case d.e_pulleyJoint:i=new w(t instanceof C?t:null);break;case d.e_gearJoint:i=new u(t instanceof h?t:null);break;case d.e_lineJoint:i=new y(t instanceof _?t:null);break;case d.e_weldJoint:i=new D(t instanceof A?t:null);break;case d.e_frictionJoint:i=new l(t instanceof c?t:null)}return i},d.Destroy=function(t,e){},d.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},d.prototype.InitVelocityConstraints=function(t){},d.prototype.SolveVelocityConstraints=function(t){},d.prototype.FinalizeVelocityConstraints=function(){},d.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),f.b2JointDef=function(){},f.prototype.b2JointDef=function(){this.type=d.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},m.b2JointEdge=function(){},Box2D.inherit(y,Box2D.Dynamics.Joints.b2Joint),y.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,y.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new e,this.m_impulse=new r},y.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},y.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},y.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},y.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},y.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},y.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+r,u=i.m_sweep.c.x+s-l,h=i.m_sweep.c.y+a-c,p=e.GetWorldVector(this.m_localXAxis1),d=e.m_linearVelocity,f=i.m_linearVelocity,m=e.m_angularVelocity,y=i.m_angularVelocity;return u*(-m*p.y)+h*(m*p.x)+(p.x*(f.x+-y*a-d.x- -m*r)+p.y*(f.y+y*s-d.y-m*n))},y.prototype.IsLimitEnabled=function(){return this.m_enableLimit},y.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},y.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},y.prototype.GetUpperLimit=function(){return this.m_upperTranslation},y.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},y.prototype.IsMotorEnabled=function(){return this.m_enableMotor},y.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},y.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},y.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},y.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},y.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},y.prototype.GetMotorForce=function(){return this.m_motorImpulse},y.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},y.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(r.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var a=r.GetTransform();o.GetTransform();i=r.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=o.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var p=o.m_sweep.c.x+u-r.m_sweep.c.x-l,f=o.m_sweep.c.y+h-r.m_sweep.c.y-c;this.m_invMassA=r.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=r.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(n.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(f+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(n.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(f+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var m=this.m_invMassA,y=this.m_invMassB,_=this.m_invIA,x=this.m_invIB;if(this.m_K.col1.x=m+y+_*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+y+_*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_enableLimit){var g=this.m_axis.x*p+this.m_axis.y*f;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=d.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=d.e_atLowerLimit&&(this.m_limitState=d.e_atLowerLimit,this.m_impulse.y=0):g>=this.m_upperTranslation?this.m_limitState!=d.e_atUpperLimit&&(this.m_limitState=d.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=d.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var v=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,C=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;r.m_linearVelocity.x-=this.m_invMassA*v,r.m_linearVelocity.y-=this.m_invMassA*b,r.m_angularVelocity-=this.m_invIA*w,o.m_linearVelocity.x+=this.m_invMassB*v,o.m_linearVelocity.y+=this.m_invMassB*b,o.m_angularVelocity+=this.m_invIB*C}else this.m_impulse.SetZero(),this.m_motorImpulse=0},y.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,o=e.m_linearVelocity,s=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,c=0,u=0,h=0,p=0;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var f=this.m_axis.x*(a.x-o.x)+this.m_axis.y*(a.y-o.y)+this.m_a2*l-this.m_a1*s,m=this.m_motorMass*(this.m_motorSpeed-f),y=this.m_motorImpulse,_=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+m,-_,_),c=(m=this.m_motorImpulse-y)*this.m_axis.x,u=m*this.m_axis.y,h=m*this.m_a1,p=m*this.m_a2,o.x-=this.m_invMassA*c,o.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}var x=this.m_perp.x*(a.x-o.x)+this.m_perp.y*(a.y-o.y)+this.m_s2*l-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var g=this.m_axis.x*(a.x-o.x)+this.m_axis.y*(a.y-o.y)+this.m_a2*l-this.m_a1*s,v=this.m_impulse.Copy(),b=this.m_K.Solve(new r,-x,-g);this.m_impulse.Add(b),this.m_limitState==d.e_atLowerLimit?this.m_impulse.y=n.Max(this.m_impulse.y,0):this.m_limitState==d.e_atUpperLimit&&(this.m_impulse.y=n.Min(this.m_impulse.y,0));var w=-x-(this.m_impulse.y-v.y)*this.m_K.col2.x,C=0;C=0!=this.m_K.col1.x?w/this.m_K.col1.x+v.x:v.x,this.m_impulse.x=C,b.x=this.m_impulse.x-v.x,b.y=this.m_impulse.y-v.y,c=b.x*this.m_perp.x+b.y*this.m_axis.x,u=b.x*this.m_perp.y+b.y*this.m_axis.y,h=b.x*this.m_s1+b.y*this.m_a1,p=b.x*this.m_s2+b.y*this.m_a2,o.x-=this.m_invMassA*c,o.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}else{var S=0;S=0!=this.m_K.col1.x?-x/this.m_K.col1.x:0,this.m_impulse.x+=S,c=S*this.m_perp.x,u=S*this.m_perp.y,h=S*this.m_s1,p=S*this.m_s2,o.x-=this.m_invMassA*c,o.y-=this.m_invMassA*u,s-=this.m_invIA*h,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}e.m_linearVelocity.SetV(o),e.m_angularVelocity=s,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},y.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var o,s=this.m_bodyA,a=this.m_bodyB,l=s.m_sweep.c,c=s.m_sweep.a,u=a.m_sweep.c,h=a.m_sweep.a,p=0,d=0,f=0,m=0,y=0,_=0,x=!1,g=0,v=e.FromAngle(c),b=e.FromAngle(h);o=v;var w=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y;p=o.col1.x*w+o.col2.x*C,C=o.col1.y*w+o.col2.y*C,w=p,o=b;var S=this.m_localAnchor2.x-this.m_localCenterB.x,T=this.m_localAnchor2.y-this.m_localCenterB.y;p=o.col1.x*S+o.col2.x*T,T=o.col1.y*S+o.col2.y*T,S=p;var D=u.x+S-l.x-w,A=u.y+T-l.y-C;if(this.m_enableLimit){this.m_axis=n.MulMV(v,this.m_localXAxis1),this.m_a1=(D+w)*this.m_axis.y-(A+C)*this.m_axis.x,this.m_a2=S*this.m_axis.y-T*this.m_axis.x;var B=this.m_axis.x*D+this.m_axis.y*A;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(g=n.Clamp(B,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),_=n.Abs(B),x=!0):B<=this.m_lowerTranslation?(g=n.Clamp(B-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),_=this.m_lowerTranslation-B,x=!0):B>=this.m_upperTranslation&&(g=n.Clamp(B-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),_=B-this.m_upperTranslation,x=!0)}this.m_perp=n.MulMV(v,this.m_localYAxis1),this.m_s1=(D+w)*this.m_perp.y-(A+C)*this.m_perp.x,this.m_s2=S*this.m_perp.y-T*this.m_perp.x;var M=new r,P=this.m_perp.x*D+this.m_perp.y*A;if(_=n.Max(_,n.Abs(P)),0,x)d=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,y=this.m_invIB,this.m_K.col1.x=d+f+m*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=m*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=d+f+m*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_K.Solve(M,-P,-g);else{d=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,y=this.m_invIB;var E=d+f+m*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,I=0;I=0!=E?-P/E:0,M.x=I,M.y=0}var R=M.x*this.m_perp.x+M.y*this.m_axis.x,O=M.x*this.m_perp.y+M.y*this.m_axis.y,k=M.x*this.m_s1+M.y*this.m_a1,L=M.x*this.m_s2+M.y*this.m_a2;return l.x-=this.m_invMassA*R,l.y-=this.m_invMassA*O,c-=this.m_invIA*k,u.x+=this.m_invMassB*R,u.y+=this.m_invMassB*O,h+=this.m_invIB*L,s.m_sweep.a=c,a.m_sweep.a=h,s.SynchronizeTransform(),a.SynchronizeTransform(),_<=t.b2_linearSlop&&0<=t.b2_angularSlop},Box2D.inherit(_,Box2D.Dynamics.Joints.b2JointDef),_.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,_.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},_.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},_.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},Box2D.inherit(x,Box2D.Dynamics.Joints.b2Joint),x.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,x.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new r,this.m_target=new r,this.m_impulse=new r,this.m_mass=new e,this.m_C=new r},x.prototype.GetAnchorA=function(){return this.m_target},x.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},x.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},x.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},x.prototype.GetTarget=function(){return this.m_target},x.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},x.prototype.GetMaxForce=function(){return this.m_maxForce},x.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},x.prototype.GetFrequency=function(){return this.m_frequencyHz},x.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},x.prototype.GetDampingRatio=function(){return this.m_dampingRatio},x.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},x.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},x.prototype.InitVelocityConstraints=function(t){var e,i=this.m_bodyB,n=i.GetMass(),r=2*Math.PI*this.m_frequencyHz,o=2*n*this.m_dampingRatio*r,s=n*r*r;this.m_gamma=t.dt*(o+t.dt*s),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*s*this.m_gamma,e=i.m_xf.R;var a=this.m_localAnchor.x-i.m_sweep.localCenter.x,l=this.m_localAnchor.y-i.m_sweep.localCenter.y,c=e.col1.x*a+e.col2.x*l;l=e.col1.y*a+e.col2.y*l,a=c;var u=i.m_invMass,h=i.m_invI;this.K1.col1.x=u,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=u,this.K2.col1.x=h*l*l,this.K2.col2.x=-h*a*l,this.K2.col1.y=-h*a*l,this.K2.col2.y=h*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=i.m_sweep.c.x+a-this.m_target.x,this.m_C.y=i.m_sweep.c.y+l-this.m_target.y,i.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,i.m_linearVelocity.x+=u*this.m_impulse.x,i.m_linearVelocity.y+=u*this.m_impulse.y,i.m_angularVelocity+=h*(a*this.m_impulse.y-l*this.m_impulse.x)},x.prototype.SolveVelocityConstraints=function(t){var e,i,n=this.m_bodyB,r=0;e=n.m_xf.R;var o=this.m_localAnchor.x-n.m_sweep.localCenter.x,s=this.m_localAnchor.y-n.m_sweep.localCenter.y;r=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=r;var a=n.m_linearVelocity.x+-n.m_angularVelocity*s,l=n.m_linearVelocity.y+n.m_angularVelocity*o;e=this.m_mass,r=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,i=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(e.col1.x*r+e.col2.x*i),u=-(e.col1.y*r+e.col2.y*i),h=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=u;var d=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>d*d&&this.m_impulse.Multiply(d/this.m_impulse.Length()),c=this.m_impulse.x-h,u=this.m_impulse.y-p,n.m_linearVelocity.x+=n.m_invMass*c,n.m_linearVelocity.y+=n.m_invMass*u,n.m_angularVelocity+=n.m_invI*(o*u-s*c)},x.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef),g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,g.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new r},g.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(v,Box2D.Dynamics.Joints.b2Joint),v.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,v.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new i,this.m_impulse=new o},v.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},v.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},v.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},v.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},v.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1);return s.x*r+s.y*o},v.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=o;var l=e.m_sweep.c.x+n,c=e.m_sweep.c.y+r,u=i.m_sweep.c.x+s-l,h=i.m_sweep.c.y+a-c,p=e.GetWorldVector(this.m_localXAxis1),d=e.m_linearVelocity,f=i.m_linearVelocity,m=e.m_angularVelocity,y=i.m_angularVelocity;return u*(-m*p.y)+h*(m*p.x)+(p.x*(f.x+-y*a-d.x- -m*r)+p.y*(f.y+y*s-d.y-m*n))},v.prototype.IsLimitEnabled=function(){return this.m_enableLimit},v.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},v.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},v.prototype.GetUpperLimit=function(){return this.m_upperTranslation},v.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},v.prototype.IsMotorEnabled=function(){return this.m_enableMotor},v.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},v.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},v.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},v.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},v.prototype.GetMotorForce=function(){return this.m_motorImpulse},v.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},v.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(r.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var a=r.GetTransform();o.GetTransform();i=r.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=s,i=o.m_xf.R;var u=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var p=o.m_sweep.c.x+u-r.m_sweep.c.x-l,f=o.m_sweep.c.y+h-r.m_sweep.c.y-c;this.m_invMassA=r.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=r.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(n.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(f+c)*this.m_axis.x,this.m_a2=u*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(n.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(f+c)*this.m_perp.x,this.m_s2=u*this.m_perp.y-h*this.m_perp.x;var m=this.m_invMassA,y=this.m_invMassB,_=this.m_invIA,x=this.m_invIB;if(this.m_K.col1.x=m+y+_*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1+x*this.m_s2,this.m_K.col1.z=_*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+x,this.m_K.col2.z=_*this.m_a1+x*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+y+_*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_enableLimit){var g=this.m_axis.x*p+this.m_axis.y*f;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=d.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=d.e_atLowerLimit&&(this.m_limitState=d.e_atLowerLimit,this.m_impulse.z=0):g>=this.m_upperTranslation?this.m_limitState!=d.e_atUpperLimit&&(this.m_limitState=d.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=d.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var v=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,C=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;r.m_linearVelocity.x-=this.m_invMassA*v,r.m_linearVelocity.y-=this.m_invMassA*b,r.m_angularVelocity-=this.m_invIA*w,o.m_linearVelocity.x+=this.m_invMassB*v,o.m_linearVelocity.y+=this.m_invMassB*b,o.m_angularVelocity+=this.m_invIB*C}else this.m_impulse.SetZero(),this.m_motorImpulse=0},v.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,s=e.m_linearVelocity,a=e.m_angularVelocity,l=i.m_linearVelocity,c=i.m_angularVelocity,u=0,h=0,p=0,f=0;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var m=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*c-this.m_a1*a,y=this.m_motorMass*(this.m_motorSpeed-m),_=this.m_motorImpulse,x=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+y,-x,x),u=(y=this.m_motorImpulse-_)*this.m_axis.x,h=y*this.m_axis.y,p=y*this.m_a1,f=y*this.m_a2,s.x-=this.m_invMassA*u,s.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*f}var g=this.m_perp.x*(l.x-s.x)+this.m_perp.y*(l.y-s.y)+this.m_s2*c-this.m_s1*a,v=c-a;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var b=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*c-this.m_a1*a,w=this.m_impulse.Copy(),C=this.m_K.Solve33(new o,-g,-v,-b);this.m_impulse.Add(C),this.m_limitState==d.e_atLowerLimit?this.m_impulse.z=n.Max(this.m_impulse.z,0):this.m_limitState==d.e_atUpperLimit&&(this.m_impulse.z=n.Min(this.m_impulse.z,0));var S=-g-(this.m_impulse.z-w.z)*this.m_K.col3.x,T=-v-(this.m_impulse.z-w.z)*this.m_K.col3.y,D=this.m_K.Solve22(new r,S,T);D.x+=w.x,D.y+=w.y,this.m_impulse.x=D.x,this.m_impulse.y=D.y,C.x=this.m_impulse.x-w.x,C.y=this.m_impulse.y-w.y,C.z=this.m_impulse.z-w.z,u=C.x*this.m_perp.x+C.z*this.m_axis.x,h=C.x*this.m_perp.y+C.z*this.m_axis.y,p=C.x*this.m_s1+C.y+C.z*this.m_a1,f=C.x*this.m_s2+C.y+C.z*this.m_a2,s.x-=this.m_invMassA*u,s.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*f}else{var A=this.m_K.Solve22(new r,-g,-v);this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,u=A.x*this.m_perp.x,h=A.x*this.m_perp.y,p=A.x*this.m_s1+A.y,f=A.x*this.m_s2+A.y,s.x-=this.m_invMassA*u,s.y-=this.m_invMassA*h,a-=this.m_invIA*p,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*h,c+=this.m_invIB*f}e.m_linearVelocity.SetV(s),e.m_angularVelocity=a,i.m_linearVelocity.SetV(l),i.m_angularVelocity=c},v.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var s,a,l=this.m_bodyA,c=this.m_bodyB,u=l.m_sweep.c,h=l.m_sweep.a,p=c.m_sweep.c,d=c.m_sweep.a,f=0,m=0,y=0,_=0,x=0,g=0,v=!1,b=0,w=e.FromAngle(h),C=e.FromAngle(d);s=w;var S=this.m_localAnchor1.x-this.m_localCenterA.x,T=this.m_localAnchor1.y-this.m_localCenterA.y;f=s.col1.x*S+s.col2.x*T,T=s.col1.y*S+s.col2.y*T,S=f,s=C;var D=this.m_localAnchor2.x-this.m_localCenterB.x,A=this.m_localAnchor2.y-this.m_localCenterB.y;f=s.col1.x*D+s.col2.x*A,A=s.col1.y*D+s.col2.y*A,D=f;var B=p.x+D-u.x-S,M=p.y+A-u.y-T;if(this.m_enableLimit){this.m_axis=n.MulMV(w,this.m_localXAxis1),this.m_a1=(B+S)*this.m_axis.y-(M+T)*this.m_axis.x,this.m_a2=D*this.m_axis.y-A*this.m_axis.x;var P=this.m_axis.x*B+this.m_axis.y*M;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(b=n.Clamp(P,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),g=n.Abs(P),v=!0):P<=this.m_lowerTranslation?(b=n.Clamp(P-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),g=this.m_lowerTranslation-P,v=!0):P>=this.m_upperTranslation&&(b=n.Clamp(P-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),g=P-this.m_upperTranslation,v=!0)}this.m_perp=n.MulMV(w,this.m_localYAxis1),this.m_s1=(B+S)*this.m_perp.y-(M+T)*this.m_perp.x,this.m_s2=D*this.m_perp.y-A*this.m_perp.x;var E=new o,I=this.m_perp.x*B+this.m_perp.y*M,R=d-h-this.m_refAngle;if(g=n.Max(g,n.Abs(I)),a=n.Abs(R),v)m=this.m_invMassA,y=this.m_invMassB,_=this.m_invIA,x=this.m_invIB,this.m_K.col1.x=m+y+_*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1+x*this.m_s2,this.m_K.col1.z=_*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+x,this.m_K.col2.z=_*this.m_a1+x*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+y+_*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_K.Solve33(E,-I,-R,-b);else{m=this.m_invMassA,y=this.m_invMassB,_=this.m_invIA,x=this.m_invIB;var O=m+y+_*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,k=_*this.m_s1+x*this.m_s2,L=_+x;this.m_K.col1.Set(O,k,0),this.m_K.col2.Set(k,L,0);var F=this.m_K.Solve22(new r,-I,-R);E.x=F.x,E.y=F.y,E.z=0}var N=E.x*this.m_perp.x+E.z*this.m_axis.x,V=E.x*this.m_perp.y+E.z*this.m_axis.y,j=E.x*this.m_s1+E.y+E.z*this.m_a1,G=E.x*this.m_s2+E.y+E.z*this.m_a2;return u.x-=this.m_invMassA*N,u.y-=this.m_invMassA*V,h-=this.m_invIA*j,p.x+=this.m_invMassB*N,p.y+=this.m_invMassB*V,d+=this.m_invIB*G,l.m_sweep.a=h,c.m_sweep.a=d,l.SynchronizeTransform(),c.SynchronizeTransform(),g<=t.b2_linearSlop&&a<=t.b2_angularSlop},Box2D.inherit(b,Box2D.Dynamics.Joints.b2JointDef),b.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,b.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},b.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},b.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(w,Box2D.Dynamics.Joints.b2Joint),w.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,w.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u1=new r,this.m_u2=new r},w.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},w.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},w.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},w.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},w.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},w.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},w.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},w.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},w.prototype.GetRatio=function(){return this.m_ratio},w.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=n.Min(t.maxLengthA,this.m_constant-this.m_ratio*w.b2_minPulleyLength),this.m_maxLength2=n.Min(t.maxLengthB,(this.m_constant-w.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},w.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB;i=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*o+i.col2.x*s;s=i.col1.y*o+i.col2.y*s,o=a,i=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=a;var u=n.m_sweep.c.x+o,h=n.m_sweep.c.y+s,p=r.m_sweep.c.x+l,f=r.m_sweep.c.y+c,m=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,_=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,x=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(u-m,h-y),this.m_u2.Set(p-_,f-x);var g=this.m_u1.Length(),v=this.m_u2.Length();g>t.b2_linearSlop?this.m_u1.Multiply(1/g):this.m_u1.SetZero(),v>t.b2_linearSlop?this.m_u2.Multiply(1/v):this.m_u2.SetZero(),this.m_constant-g-this.m_ratio*v>0?(this.m_state=d.e_inactiveLimit,this.m_impulse=0):this.m_state=d.e_atUpperLimit,g<this.m_maxLength1?(this.m_limitState1=d.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=d.e_atUpperLimit,v<this.m_maxLength2?(this.m_limitState2=d.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=d.e_atUpperLimit;var b=o*this.m_u1.y-s*this.m_u1.x,w=l*this.m_u2.y-c*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*b*b,this.m_limitMass2=r.m_invMass+r.m_invI*w*w,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var C=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,S=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,T=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,D=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*C,n.m_linearVelocity.y+=n.m_invMass*S,n.m_angularVelocity+=n.m_invI*(o*S-s*C),r.m_linearVelocity.x+=r.m_invMass*T,r.m_linearVelocity.y+=r.m_invMass*D,r.m_angularVelocity+=r.m_invI*(l*D-c*T)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},w.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,r=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*o+e.col2.x*s;s=e.col1.y*o+e.col2.y*s,o=a,e=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=a;var u=0,h=0,p=0,f=0,m=0,y=0,_=0,x=0,g=0,v=0,b=0;this.m_state==d.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*o,p=r.m_linearVelocity.x+-r.m_angularVelocity*c,f=r.m_linearVelocity.y+r.m_angularVelocity*l,g=-(this.m_u1.x*u+this.m_u1.y*h)-this.m_ratio*(this.m_u2.x*p+this.m_u2.y*f),v=this.m_pulleyMass*-g,b=this.m_impulse,this.m_impulse=n.Max(0,this.m_impulse+v),m=-(v=this.m_impulse-b)*this.m_u1.x,y=-v*this.m_u1.y,_=-this.m_ratio*v*this.m_u2.x,x=-this.m_ratio*v*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*y,i.m_angularVelocity+=i.m_invI*(o*y-s*m),r.m_linearVelocity.x+=r.m_invMass*_,r.m_linearVelocity.y+=r.m_invMass*x,r.m_angularVelocity+=r.m_invI*(l*x-c*_)),this.m_limitState1==d.e_atUpperLimit&&(u=i.m_linearVelocity.x+-i.m_angularVelocity*s,h=i.m_linearVelocity.y+i.m_angularVelocity*o,g=-(this.m_u1.x*u+this.m_u1.y*h),v=-this.m_limitMass1*g,b=this.m_limitImpulse1,this.m_limitImpulse1=n.Max(0,this.m_limitImpulse1+v),m=-(v=this.m_limitImpulse1-b)*this.m_u1.x,y=-v*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*y,i.m_angularVelocity+=i.m_invI*(o*y-s*m)),this.m_limitState2==d.e_atUpperLimit&&(p=r.m_linearVelocity.x+-r.m_angularVelocity*c,f=r.m_linearVelocity.y+r.m_angularVelocity*l,g=-(this.m_u2.x*p+this.m_u2.y*f),v=-this.m_limitMass2*g,b=this.m_limitImpulse2,this.m_limitImpulse2=n.Max(0,this.m_limitImpulse2+v),_=-(v=this.m_limitImpulse2-b)*this.m_u2.x,x=-v*this.m_u2.y,r.m_linearVelocity.x+=r.m_invMass*_,r.m_linearVelocity.y+=r.m_invMass*x,r.m_angularVelocity+=r.m_invI*(l*x-c*_))},w.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,r=this.m_bodyA,o=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,u=0,h=0,p=0,f=0,m=0,y=0,_=0,x=0,g=0,v=0,b=0,w=0,C=0,S=0;return this.m_state==d.e_atUpperLimit&&(i=r.m_xf.R,u=this.m_localAnchor1.x-r.m_sweep.localCenter.x,h=this.m_localAnchor1.y-r.m_sweep.localCenter.y,C=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=C,i=o.m_xf.R,p=this.m_localAnchor2.x-o.m_sweep.localCenter.x,f=this.m_localAnchor2.y-o.m_sweep.localCenter.y,C=i.col1.x*p+i.col2.x*f,f=i.col1.y*p+i.col2.y*f,p=C,m=r.m_sweep.c.x+u,y=r.m_sweep.c.y+h,_=o.m_sweep.c.x+p,x=o.m_sweep.c.y+f,this.m_u1.Set(m-s,y-a),this.m_u2.Set(_-l,x-c),g=this.m_u1.Length(),v=this.m_u2.Length(),g>t.b2_linearSlop?this.m_u1.Multiply(1/g):this.m_u1.SetZero(),v>t.b2_linearSlop?this.m_u2.Multiply(1/v):this.m_u2.SetZero(),b=this.m_constant-g-this.m_ratio*v,S=n.Max(S,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),m=-(w=-this.m_pulleyMass*b)*this.m_u1.x,y=-w*this.m_u1.y,_=-this.m_ratio*w*this.m_u2.x,x=-this.m_ratio*w*this.m_u2.y,r.m_sweep.c.x+=r.m_invMass*m,r.m_sweep.c.y+=r.m_invMass*y,r.m_sweep.a+=r.m_invI*(u*y-h*m),o.m_sweep.c.x+=o.m_invMass*_,o.m_sweep.c.y+=o.m_invMass*x,o.m_sweep.a+=o.m_invI*(p*x-f*_),r.SynchronizeTransform(),o.SynchronizeTransform()),this.m_limitState1==d.e_atUpperLimit&&(i=r.m_xf.R,u=this.m_localAnchor1.x-r.m_sweep.localCenter.x,h=this.m_localAnchor1.y-r.m_sweep.localCenter.y,C=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=C,m=r.m_sweep.c.x+u,y=r.m_sweep.c.y+h,this.m_u1.Set(m-s,y-a),(g=this.m_u1.Length())>t.b2_linearSlop?(this.m_u1.x*=1/g,this.m_u1.y*=1/g):this.m_u1.SetZero(),b=this.m_maxLength1-g,S=n.Max(S,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),m=-(w=-this.m_limitMass1*b)*this.m_u1.x,y=-w*this.m_u1.y,r.m_sweep.c.x+=r.m_invMass*m,r.m_sweep.c.y+=r.m_invMass*y,r.m_sweep.a+=r.m_invI*(u*y-h*m),r.SynchronizeTransform()),this.m_limitState2==d.e_atUpperLimit&&(i=o.m_xf.R,p=this.m_localAnchor2.x-o.m_sweep.localCenter.x,f=this.m_localAnchor2.y-o.m_sweep.localCenter.y,C=i.col1.x*p+i.col2.x*f,f=i.col1.y*p+i.col2.y*f,p=C,_=o.m_sweep.c.x+p,x=o.m_sweep.c.y+f,this.m_u2.Set(_-l,x-c),(v=this.m_u2.Length())>t.b2_linearSlop?(this.m_u2.x*=1/v,this.m_u2.y*=1/v):this.m_u2.SetZero(),b=this.m_maxLength2-v,S=n.Max(S,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),_=-(w=-this.m_limitMass2*b)*this.m_u2.x,x=-w*this.m_u2.y,o.m_sweep.c.x+=o.m_invMass*_,o.m_sweep.c.y+=o.m_invMass*x,o.m_sweep.a+=o.m_invI*(p*x-f*_),o.SynchronizeTransform()),S<t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef),C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,C.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new r,this.groundAnchorB=new r,this.localAnchorA=new r,this.localAnchorB=new r},C.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},C.prototype.Initialize=function(t,e,i,n,r,o,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(r),this.localAnchorB=this.bodyB.GetLocalPoint(o);var a=r.x-i.x,l=r.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var c=o.x-n.x,u=o.y-n.y;this.lengthB=Math.sqrt(c*c+u*u),this.ratio=s;var h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=h-this.ratio*w.b2_minPulleyLength,this.maxLengthB=(h-w.b2_minPulleyLength)/this.ratio},Box2D.inherit(S,Box2D.Dynamics.Joints.b2Joint),S.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,S.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new o,this.impulse2=new r,this.reduced=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_impulse=new o,this.m_mass=new i},S.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},S.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},S.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},S.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},S.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},S.prototype.IsLimitEnabled=function(){return this.m_enableLimit},S.prototype.EnableLimit=function(t){this.m_enableLimit=t},S.prototype.GetLowerLimit=function(){return this.m_lowerAngle},S.prototype.GetUpperLimit=function(){return this.m_upperAngle},S.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},S.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},S.prototype.EnableMotor=function(t){this.m_enableMotor=t},S.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},S.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},S.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},S.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},S.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit},S.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit,i=r.m_xf.R;var a=this.m_localAnchor1.x-r.m_sweep.localCenter.x,l=this.m_localAnchor1.y-r.m_sweep.localCenter.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=o.m_xf.R;var c=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;s=i.col1.x*c+i.col2.x*u,u=i.col1.y*c+i.col2.y*u,c=s;var h=r.m_invMass,p=o.m_invMass,f=r.m_invI,m=o.m_invI;if(this.m_mass.col1.x=h+p+l*l*f+u*u*m,this.m_mass.col2.x=-l*a*f-u*c*m,this.m_mass.col3.x=-l*f-u*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+p+a*a*f+c*c*m,this.m_mass.col3.y=a*f+c*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+m,this.m_motorMass=1/(f+m),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var y=o.m_sweep.a-r.m_sweep.a-this.m_referenceAngle;n.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=d.e_equalLimits:y<=this.m_lowerAngle?(this.m_limitState!=d.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=d.e_atLowerLimit):y>=this.m_upperAngle?(this.m_limitState!=d.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=d.e_atUpperLimit):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=d.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var _=this.m_impulse.x,x=this.m_impulse.y;r.m_linearVelocity.x-=h*_,r.m_linearVelocity.y-=h*x,r.m_angularVelocity-=f*(a*x-l*_+this.m_motorImpulse+this.m_impulse.z),o.m_linearVelocity.x+=p*_,o.m_linearVelocity.y+=p*x,o.m_angularVelocity+=m*(c*x-u*_+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},S.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,r=this.m_bodyB,o=0,s=0,a=0,l=0,c=0,u=i.m_linearVelocity,h=i.m_angularVelocity,p=r.m_linearVelocity,f=r.m_angularVelocity,m=i.m_invMass,y=r.m_invMass,_=i.m_invI,x=r.m_invI;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var g=f-h-this.m_motorSpeed,v=this.m_motorMass*-g,b=this.m_motorImpulse,w=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+v,-w,w),h-=_*(v=this.m_motorImpulse-b),f+=x*v}if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=r.m_xf.R,l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=o;var C=p.x+-f*c-u.x- -h*a,S=p.y+f*l-u.y-h*s,T=f-h;this.m_mass.Solve33(this.impulse3,-C,-S,-T),this.m_limitState==d.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==d.e_atLowerLimit?this.m_impulse.z+this.impulse3.z<0&&(this.m_mass.Solve22(this.reduced,-C,-S),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0):this.m_limitState==d.e_atUpperLimit&&this.m_impulse.z+this.impulse3.z>0&&(this.m_mass.Solve22(this.reduced,-C,-S),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0),u.x-=m*this.impulse3.x,u.y-=m*this.impulse3.y,h-=_*(s*this.impulse3.y-a*this.impulse3.x+this.impulse3.z),p.x+=y*this.impulse3.x,p.y+=y*this.impulse3.y,f+=x*(l*this.impulse3.y-c*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*s+e.col2.x*a,a=e.col1.y*s+e.col2.y*a,s=o,e=r.m_xf.R,l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,c=this.m_localAnchor2.y-r.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=o;var D=p.x+-f*c-u.x- -h*a,A=p.y+f*l-u.y-h*s;this.m_mass.Solve22(this.impulse2,-D,-A),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,u.x-=m*this.impulse2.x,u.y-=m*this.impulse2.y,h-=_*(s*this.impulse2.y-a*this.impulse2.x),p.x+=y*this.impulse2.x,p.y+=y*this.impulse2.y,f+=x*(l*this.impulse2.y-c*this.impulse2.x)}i.m_linearVelocity.SetV(u),i.m_angularVelocity=h,r.m_linearVelocity.SetV(p),r.m_angularVelocity=f},S.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,r,o=0,s=this.m_bodyA,a=this.m_bodyB,l=0,c=0,u=0,h=0;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var p=a.m_sweep.a-s.m_sweep.a-this.m_referenceAngle,f=0;this.m_limitState==d.e_equalLimits?(o=n.Clamp(p-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),f=-this.m_motorMass*o,l=n.Abs(o)):this.m_limitState==d.e_atLowerLimit?(l=-(o=p-this.m_lowerAngle),o=n.Clamp(o+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),f=-this.m_motorMass*o):this.m_limitState==d.e_atUpperLimit&&(l=o=p-this.m_upperAngle,o=n.Clamp(o-t.b2_angularSlop,0,t.b2_maxAngularCorrection),f=-this.m_motorMass*o),s.m_sweep.a-=s.m_invI*f,a.m_sweep.a+=a.m_invI*f,s.SynchronizeTransform(),a.SynchronizeTransform()}i=s.m_xf.R;var m=this.m_localAnchor1.x-s.m_sweep.localCenter.x,y=this.m_localAnchor1.y-s.m_sweep.localCenter.y;c=i.col1.x*m+i.col2.x*y,y=i.col1.y*m+i.col2.y*y,m=c,i=a.m_xf.R;var _=this.m_localAnchor2.x-a.m_sweep.localCenter.x,x=this.m_localAnchor2.y-a.m_sweep.localCenter.y;c=i.col1.x*_+i.col2.x*x,x=i.col1.y*_+i.col2.y*x,_=c;var g=a.m_sweep.c.x+_-s.m_sweep.c.x-m,v=a.m_sweep.c.y+x-s.m_sweep.c.y-y,b=g*g+v*v,w=Math.sqrt(b);r=w;var C=s.m_invMass,T=a.m_invMass,D=s.m_invI,A=a.m_invI,B=10*t.b2_linearSlop;if(b>B*B){var M=1/(C+T);u=M*-g,h=M*-v;s.m_sweep.c.x-=.5*C*u,s.m_sweep.c.y-=.5*C*h,a.m_sweep.c.x+=.5*T*u,a.m_sweep.c.y+=.5*T*h,g=a.m_sweep.c.x+_-s.m_sweep.c.x-m,v=a.m_sweep.c.y+x-s.m_sweep.c.y-y}return this.K1.col1.x=C+T,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=C+T,this.K2.col1.x=D*y*y,this.K2.col2.x=-D*m*y,this.K2.col1.y=-D*m*y,this.K2.col2.y=D*m*m,this.K3.col1.x=A*x*x,this.K3.col2.x=-A*_*x,this.K3.col1.y=-A*_*x,this.K3.col2.y=A*_*_,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(S.tImpulse,-g,-v),u=S.tImpulse.x,h=S.tImpulse.y,s.m_sweep.c.x-=s.m_invMass*u,s.m_sweep.c.y-=s.m_invMass*h,s.m_sweep.a-=s.m_invI*(m*h-y*u),a.m_sweep.c.x+=a.m_invMass*u,a.m_sweep.c.y+=a.m_invMass*h,a.m_sweep.a+=a.m_invI*(_*h-x*u),s.SynchronizeTransform(),a.SynchronizeTransform(),r<=t.b2_linearSlop&&l<=t.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new r}),Box2D.inherit(T,Box2D.Dynamics.Joints.b2JointDef),T.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,T.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},T.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},T.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(D,Box2D.Dynamics.Joints.b2Joint),D.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,D.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_impulse=new o,this.m_mass=new i},D.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},D.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},D.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},D.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},D.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},D.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var a=this.m_localAnchorB.x-r.m_sweep.localCenter.x,l=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var c=n.m_invMass,u=r.m_invMass,h=n.m_invI,p=r.m_invI;this.m_mass.col1.x=c+u+s*s*h+l*l*p,this.m_mass.col2.x=-s*o*h-l*a*p,this.m_mass.col3.x=-s*h-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=c+u+o*o*h+a*a*p,this.m_mass.col3.y=o*h+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=h+p,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=c*this.m_impulse.x,n.m_linearVelocity.y-=c*this.m_impulse.y,n.m_angularVelocity-=h*(o*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),r.m_linearVelocity.x+=u*this.m_impulse.x,r.m_linearVelocity.y+=u*this.m_impulse.y,r.m_angularVelocity+=p*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},D.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB,s=n.m_linearVelocity,a=n.m_angularVelocity,l=r.m_linearVelocity,c=r.m_angularVelocity,u=n.m_invMass,h=r.m_invMass,p=n.m_invI,d=r.m_invI;e=n.m_xf.R;var f=this.m_localAnchorA.x-n.m_sweep.localCenter.x,m=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*f+e.col2.x*m,m=e.col1.y*f+e.col2.y*m,f=i,e=r.m_xf.R;var y=this.m_localAnchorB.x-r.m_sweep.localCenter.x,_=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*y+e.col2.x*_,_=e.col1.y*y+e.col2.y*_,y=i;var x=l.x-c*_-s.x+a*m,g=l.y+c*y-s.y-a*f,v=c-a,b=new o;this.m_mass.Solve33(b,-x,-g,-v),this.m_impulse.Add(b),s.x-=u*b.x,s.y-=u*b.y,a-=p*(f*b.y-m*b.x+b.z),l.x+=h*b.x,l.y+=h*b.y,c+=d*(y*b.y-_*b.x+b.z),n.m_angularVelocity=a,r.m_angularVelocity=c},D.prototype.SolvePositionConstraints=function(e){var i;void 0===e&&(e=0);var r=0,s=this.m_bodyA,a=this.m_bodyB;i=s.m_xf.R;var l=this.m_localAnchorA.x-s.m_sweep.localCenter.x,c=this.m_localAnchorA.y-s.m_sweep.localCenter.y;r=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=r,i=a.m_xf.R;var u=this.m_localAnchorB.x-a.m_sweep.localCenter.x,h=this.m_localAnchorB.y-a.m_sweep.localCenter.y;r=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=r;var p=s.m_invMass,d=a.m_invMass,f=s.m_invI,m=a.m_invI,y=a.m_sweep.c.x+u-s.m_sweep.c.x-l,_=a.m_sweep.c.y+h-s.m_sweep.c.y-c,x=a.m_sweep.a-s.m_sweep.a-this.m_referenceAngle,g=10*t.b2_linearSlop,v=Math.sqrt(y*y+_*_),b=n.Abs(x);v>g&&(f*=1,m*=1),this.m_mass.col1.x=p+d+c*c*f+h*h*m,this.m_mass.col2.x=-c*l*f-h*u*m,this.m_mass.col3.x=-c*f-h*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=p+d+l*l*f+u*u*m,this.m_mass.col3.y=l*f+u*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+m;var w=new o;return this.m_mass.Solve33(w,-y,-_,-x),s.m_sweep.c.x-=p*w.x,s.m_sweep.c.y-=p*w.y,s.m_sweep.a-=f*(l*w.y-c*w.x+w.z),a.m_sweep.c.x+=d*w.x,a.m_sweep.c.y+=d*w.y,a.m_sweep.a+=m*(u*w.y-h*w.x+w.z),s.SynchronizeTransform(),a.SynchronizeTransform(),v<=t.b2_linearSlop&&b<=t.b2_angularSlop},Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef),A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,A.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},A.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_weldJoint,this.referenceAngle=0},A.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2DebugDraw.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},b2DebugDraw.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},b2DebugDraw.prototype.b2DebugDraw=function(){this.m_drawFlags=0},b2DebugDraw.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},b2DebugDraw.prototype.GetFlags=function(){return this.m_drawFlags},b2DebugDraw.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},b2DebugDraw.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},b2DebugDraw.prototype.SetSprite=function(t){this.m_ctx=t},b2DebugDraw.prototype.GetSprite=function(){return this.m_ctx},b2DebugDraw.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},b2DebugDraw.prototype.GetDrawScale=function(){return this.m_drawScale},b2DebugDraw.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},b2DebugDraw.prototype.GetLineThickness=function(){return this.m_lineThickness},b2DebugDraw.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},b2DebugDraw.prototype.GetAlpha=function(){return this.m_alpha},b2DebugDraw.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},b2DebugDraw.prototype.GetFillAlpha=function(){return this.m_fillAlpha},b2DebugDraw.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},b2DebugDraw.prototype.GetXFormScale=function(){return this.m_xformScale},b2DebugDraw.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.stroke()}},b2DebugDraw.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.fill(),n.stroke()}},b2DebugDraw.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*r,t.y*r,e*r,0,2*Math.PI,!0),n.closePath(),n.stroke()}},b2DebugDraw.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var r=this.m_ctx,o=this.m_drawScale,s=t.x*o,a=t.y*o;r.moveTo(0,0),r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.fillStyle=this._color(n.color,this.m_fillAlpha),r.arc(s,a,e*o,0,2*Math.PI,!0),r.moveTo(s,a),r.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),r.closePath(),r.fill(),r.stroke()}},b2DebugDraw.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,r=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*r,t.y*r),n.lineTo(e.x*r,e.y*r),n.closePath(),n.stroke()},b2DebugDraw.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()},i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs,tagpro.ready(function(){tagpro.world=new function(){var t=tagpro.events.gravity?tagpro.events.gravity.map(function(t){return t.gravity})[0]:{x:0,y:0},e=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(t.x,t.y),!0),i={},n={},r=[];this._objectBodies=n,this._b2World=e;var o=performance.now()+1e3/60;setTimeout(function(){!1},5e3),this.update=function(t){if(1===tagpro.state){var s=performance.now();if(!(o-s>1e3/60)){for(var a in i){var l=(f=i[a]).player;if(f.SetAwake(!0),l.draw&&!l.dead){var c=f.GetPosition(),u=f.GetAngle();(d=l.sync)&&(d.frame--,d.step.x>0&&c.x<d.to.x||d.step.x<0&&c.x>d.to.x?c.x+=d.step.x:d.step.x=0,d.step.y>0&&c.y<d.to.y||d.step.y<0&&c.y>d.to.y?c.y+=d.step.y:d.step.y=0,d.step.a>0&&u<d.to.a||d.step.a<0&&u>d.to.a?u+=d.step.a:d.step.a=0,d.frame<=0&&(l.sync=null));var h=f.GetLinearVelocity();tagpro.events.playerControls?tagpro.events.playerControls.forEach(function(t){t.playerControls(l,f,h)}):1==tagpro.state&&(l.left&&h.x>-l.ms&&(h.x-=l.ac),l.right&&h.x<l.ms&&(h.x+=l.ac),l.up&&h.y>-l.ms&&(h.y-=l.ac),l.down&&h.y<l.ms&&(h.y+=l.ac)),f.SetPosition(c),f.SetAngle(u),f.SetLinearVelocity(h),l.speed=h.Length(),l.x=100*c.x,l.y=100*c.y,l.angle=u,tagpro.events.playerUpdate&&tagpro.events.playerUpdate.forEach(function(t){t.playerUpdate(l,f)})}else f.SetPosition(new Box2D.Common.Math.b2Vec2(-100,-100))}for(var a in r.forEach(function(t){!function(t){for(var e in i){var n=i[e],r=n.player;if(!r.dead){var o=n.GetWorldCenter(),s=new Box2D.Common.Math.b2Vec2(0,0);if(s.Add(o),s.Subtract(t.position),!(s.Length()>2.6)){var a=.06*n.GetMass()/Math.pow(s.Length(),2);s.NegativeSelf(),s.Multiply(a),n.ApplyImpulse(s,o)}}}}(t)}),n){var p=(f=n[a]).object;if(f.SetAwake(!0),p.draw){var d;c=f.GetPosition();(d=p.sync)&&(d.frame--,d.step.x>0&&c.x<d.to.x||d.step.x<0&&c.x>d.to.x?c.x+=d.step.x:d.step.x=0,d.step.y>0&&c.y<d.to.y||d.step.y<0&&c.y>d.to.y?c.y+=d.step.y:d.step.y=0,d.frame<=0&&(p.sync=null)),f.SetPosition(c),p.x=100*c.x,p.y=100*c.y,tagpro.events.objectUpdate&&tagpro.events.objectUpdate.forEach(function(t){t.objectUpdate(e,p,f)})}else f.SetPosition(new Box2D.Common.Math.b2Vec2(-100,-100))}for(var a in e.Step(1/60,8,3),i){var f=i[a];if(!(l=f.player).dead){h=f.GetLinearVelocity(),c=f.GetPosition(),u=f.GetAngle();l.speed=h.Length(),l.x=100*c.x,l.y=100*c.y,l.angle=u}}if(tagpro.events.update&&tagpro.events.update.forEach(function(t){t.update()}),o+=1e3/60,(s=performance.now())>=o){if(t>=10)return void(o=s);tagpro.world.update((t||0)+1)}}}};var s=new Box2D.Dynamics.b2FixtureDef,a=new Box2D.Dynamics.b2BodyDef;s.density=1,s.friction=.5,s.restitution=.2,s.filter.categoryBits=-1,a.type=Box2D.Dynamics.b2Body.b2_staticBody,tagpro.events.setWallPhysics&&tagpro.events.setWallPhysics.forEach(function(t){t.setWallPhysics(Box2D,a,s)}),function t(e){tagpro.map?e():setTimeout(function(){t(e)},0)}(function(){for(var t=tagpro.map,i=0,n=t.length;i!=n;i++)for(var r=0,o=t[0].length;r!=o;r++){if(1==parseInt(t[i][r]))s.shape=new Box2D.Collision.Shapes.b2PolygonShape,1.1==t[i][r]?s.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(-.2,.2),new Box2D.Common.Math.b2Vec2(-.2,-.2),new Box2D.Common.Math.b2Vec2(.2,.2)]):1.2==t[i][r]?s.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(-.2,-.2),new Box2D.Common.Math.b2Vec2(.2,-.2),new Box2D.Common.Math.b2Vec2(-.2,.2)]):1.3==t[i][r]?s.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(.2,-.2),new Box2D.Common.Math.b2Vec2(.2,.2),new Box2D.Common.Math.b2Vec2(-.2,-.2)]):1.4==t[i][r]?s.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(.2,.2),new Box2D.Common.Math.b2Vec2(-.2,.2),new Box2D.Common.Math.b2Vec2(.2,-.2)]):s.shape.SetAsBox(.2,.2),a.position.Set(.4*i,.4*r),e.CreateBody(a).CreateFixture(s)}}),this.syncObject=function(t,i){var r=n[t.id]||(n[t.id]=this.objectCreators[t.type](t,e));if(r&&t.draw){if(r.SetAwake(!0),i)t.sync=null,r.SetPosition(new Box2D.Common.Math.b2Vec2(t.rx,t.ry));else{var o=r.GetPosition();t.sync={to:{x:t.rx,y:t.ry},frame:Math.ceil((tagpro.fps||60)/10)},t.sync.step={x:(t.sync.to.x-o.x)/t.sync.frame,y:(t.sync.to.y-o.y)/t.sync.frame},0==t.sync.frame&&(t.sync=null)}r.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(t.lx,t.ly)),r.SetAngularVelocity(t.a)}},this.syncPlayer=function(t,n){var r=i[t.id]||function(t){if(void 0!=t.rx&&void 0!=t.ry&&void 0!=t.lx&&void 0!=t.ly&&void 0!=t.a){t.sync=null;var n=new Box2D.Dynamics.b2FixtureDef,r=new Box2D.Dynamics.b2BodyDef;n.density=1,n.friction=.5,n.restitution=.2,n.shape=new Box2D.Collision.Shapes.b2CircleShape(.19),r.type=Box2D.Dynamics.b2Body.b2_dynamicBody,r.linearDamping=.5,r.angularDamping=.5,tagpro.events.setPlayerPhysics&&tagpro.events.setPlayerPhysics.forEach(function(t){t.setPlayerPhysics(Box2D,r,n)});var o=e.CreateBody(r),s=o.CreateFixture(n);return o.SetPosition(new Box2D.Common.Math.b2Vec2(t.rx,t.ry)),t.x=100*t.rx,t.y=100*t.ry,t.angle=t.ra,o.player=t,o.fixture=s,i[t.id]=o,o}}(t);if(r){if(r.SetAwake(!0),n)t.sync=null,r.SetPosition(new Box2D.Common.Math.b2Vec2(t.rx,t.ry)),r.SetAngle(t.ra),t.x=100*t.rx,t.y=100*t.ry;else{if(t.dead||!t.draw)return;var o=r.GetPosition(),s=r.GetAngle();t.sync={to:{x:t.rx,y:t.ry,a:t.ra},frame:Math.ceil((tagpro.fps||60)/10)},t.sync.step={x:(t.sync.to.x-o.x)/t.sync.frame,y:(t.sync.to.y-o.y)/t.sync.frame,a:(t.sync.to.a-s)/t.sync.frame},0==t.sync.frame&&(t.sync=null)}r.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(t.lx,t.ly)),r.SetAngularVelocity(t.a),r.fixture.GetDensity()!=t.den&&(r.fixture.SetDensity(t.den),r.ResetMassData())}},this.destoryPlayer=function(t){var n=i[t];n&&(e.DestroyBody(n),delete i[t])},this.createGravityWell=function(t,e){r.push({position:new Box2D.Common.Math.b2Vec2(t,e)})},this.objectCreators={marsball:function(t){if(void 0!=t.rx&&void 0!=t.ry&&void 0!=t.lx&&void 0!=t.ly&&void 0!=t.a){var i=new Box2D.Dynamics.b2FixtureDef,n=new Box2D.Dynamics.b2BodyDef;i.density=2,i.friction=.5,i.restitution=.6,i.shape=new Box2D.Collision.Shapes.b2CircleShape(.39),n.type=Box2D.Dynamics.b2Body.b2_dynamicBody,n.linearDamping=.5,n.angularDamping=.5,t.sensor&&(i.isSensor=!0);var r=e.CreateBody(n);return r.CreateFixture(i),r.SetPosition(new Box2D.Common.Math.b2Vec2(t.rx,t.ry)),t.x=100*t.rx,t.y=100*t.ry,r.object=t,r}}}}}),tagpro.ready(function(){tagpro.musicPlayer=new function(){var t=$("audio#music"),e=["mp3","m4a","ogg"],i=!1,n=!1,r=this;this.list=[],this.current=null,this.disabled=!1,this.next=function(){if(tagpro.music&&!r.disabled&&(i=!1,n)){var o=tagpro.musicPlayer.list.shift();o.volume=parseFloat(o.volume||.5),tagpro.musicPlayer.list.push(o),tagpro.musicPlayer.mute(),tagpro.musicPlayer.current=o,(t=$("<audio id='music' volume='"+o.volume+"' autoplay='true'>").appendTo($(document.body)))[0].volume=o.volume*tagpro.volumeCoefficient,e.forEach(function(e){t.append("<source type='audio/"+e+"' src='http://"+tagproConfig.cdn+"/sounds/music/"+o.url+"."+e+"'></source>")}),t.on("ended",tagpro.musicPlayer.next)}},this.refreshVolume=function(){t&&t.length&&(t[0].volume=t[0].getAttribute("volume")*tagpro.volumeCoefficient)},this.mute=function(){i=!0,t&&t.length&&(t[0].pause(),t.remove(),tagpro.musicPlayer.current=null)},this.disable=function(){r.disabled||(r.disabled=!0,r.mute())},this.keyBindings={190:this.next},$(document).on("keyup",function(t){if(!tagpro.disableControls){var e=tagpro.musicPlayer.keyBindings[t.which];e&&e()}}),this.setList=function(){$.ajax({timeout:1e3,dataType:"json",url:"http://"+tagproConfig.musicHost+"/music?callback=?",success:function(t){for(;t.length;)tagpro.musicPlayer.list.push(t.splice(Math.floor(Math.random()*t.length),1)[0]);n=!0,!i&&tagpro.music&&tagpro.musicPlayer.next()}})},setTimeout(function(){if(tagpro.musicPlayer.setList()){if(n=!0,i||!tagpro.music)return;tagpro.musicPlayer.next()}})}}),tagpro.ready(function(){tagpro.sound=void 0,tagpro.music=void 0,tagpro.volume=void 0,tagpro.volumeCoefficient=1;var t=function(t,e){$.cookie(t,e,{expires:36500,path:"/",domain:tagproConfig.cookieHost}),tagpro[t]=e},e=function(t){t&&"music"!=t||(tagpro.music?tagpro.musicPlayer.next():tagpro.musicPlayer.mute()),t&&"sound"!=t||tagpro.sound||$("audio").not("#music").each(function(){this.play&&(this.pause(),4==this.readyState&&(this.currentTime=0))}),t&&"volume"!=t||(tagpro.volumeCoefficient=Math.pow(10,tagpro.volume/20),tagpro.musicPlayer.refreshVolume())};$(window).ready(function(){tagpro.sound=$.cookie("sound"),tagpro.music=$.cookie("music"),tagpro.volume=$.cookie("volume"),void 0==tagpro.sound&&t("sound",!0),void 0==tagpro.music&&t("music",!1),void 0==tagpro.volume?t("volume",0):tagpro.volume=Math.min(parseInt(tagpro.volume),0)}),$.fn.soundControl=function(){$(this);var i=$(this).find("#soundEffects"),n=$(this).find("#soundMusic");$slider=$(this).find("#volumeSlider");var r=function(){tagpro.sound?i.removeClass("off"):i.addClass("off"),tagpro.music?n.removeClass("off"):n.addClass("off"),$slider.val(tagpro.volume)};i.click(function(i){i.preventDefault(),t("sound",!tagpro.sound),r(),e("sound")}),n.click(function(i){i.preventDefault(),t("music",!tagpro.music),r(),e("music")}),$slider.change(function(i){t("volume",parseInt($slider.val())),e("volume")}),$slider.on("input",function(t){var i,n;i="volume",n=parseInt($slider.val()),tagpro[i]=n,e("volume")}),r(),e()},$(document).ready(function(){$("div#sound").soundControl()})}),tagpro.ready(function(){function t(t){if(window.tagproAnalyticsCollector=t,window.tagproAnalyticsListener)try{window.tagproAnalyticsListener()}catch(t){console.error(t)}}function e(t,e){var i=this,n="",r=0,o=0;this.empty=!0,this.time=t,this.emptySize=e,this.write=function(t,e){for(;e--;)r<<=1,t&1<<e&&(r|=1,i.empty=!1),8==++o&&(n+=String.fromCharCode(r),r=0,o=0)},this.tally=function(t){for(;t--;)i.write(1,1);i.write(0,1)},this.finish=function(t){var e=i.time-t-1;e<0&&(e=0);for(var r=8-(o+2&7)&7,s=0,a=1<<r;a<=e;a+=1<<r)s=a,r+=8;return i.write(r>>>3,2),i.write(e-s,r),n},this.pad=function(){return i.write(0,8-(7&o)&7),n}}var i="",n=0,r="",o={},s=new Uint32Array(2),a="",l=new Uint8Array(2),c=new Uint32Array(2),u=0,h={},p=!0,d=!1,f=!1,m=new Date,y=0,_=m.getTime(),x=1,g=NaN,v=0,b=["Red","Blue"],w=new Uint32Array(2),C={},S=0,T=[new e(0,0),new e(0,0)],D=[[],[]],A=0,B=0;function M(l,c){var h=Date.now();if(p&&(p=!1,d)){var D={server:i,port:n,group:r,date:m.getTime()/1e3>>>0,finished:l,map:{name:o.name||"Untitled",author:o.author||"Unknown"},teams:[{name:b[0],score:w[0]},{name:b[1],score:w[1]}]};if(f){D.timeLimit=v,D.duration=Math.max((.06*(h-_)>>>0)+y,x)-g,D.map.marsballs=u,D.map.width=s[0],D.map.tiles=btoa(a),D.players=[],D.teams[0].splats=btoa(T[0].pad()),D.teams[1].splats=btoa(T[1].pad());for(var A=1;A<=S;A++)if(A in C){var B=[A],M=C[A];if(M.timeline.length||M.initialTeam){var P="",E=g,I=function(){for(var t=7,i=0,n=new Uint32Array(3);;){var r,o=0,s=1/0;i<M.timeline.length&&(o=1,s=M.timeline[i].time);for(var a=0;a<3;a++)n[a]<M.toggles[a].length&&(M.toggles[a][n[a]]<s?(o=2<<a,s=M.toggles[a][n[a]]):M.toggles[a][n[a]]==s&&(o|=2<<a));if(!o)break;1&o?r=M.timeline[i]:(r=new e(s,t)).write(0,t);for(a=0;a<3;a++)r.write(M.toggles[a][n[a]]==s,1);P+=r.finish(E),E=s,1&o&&(i++,t=r.emptySize);for(a=0;a<3;a++)o&2<<a&&n[a]++}};I();var R=M.auth,O=M.name,k=M.flair,L=M.initialTeam;if(M.lastTime&&M.lastName)for(var F=A+1;F<=S;F++)if(F in C){var N=C[F];if(N.firstTime>M.lastTime&&N.firstName==M.lastName&&(!M.lastAuth||N.auth&&N.name==M.name)&&N.degree==M.degree&&(M=N,!R&&M.name&&(O=M.name),M.auth&&(R=!0),M.flair&&(k=M.flair),I(),B.push(F),!M.lastTime||!M.lastName))break}D.players.push({auth:R,name:O,flair:k,degree:M.degree,score:M.score,points:M.points,team:L,events:btoa(P)})}for(var V in B)delete C[B[V]]}}t({status:"postGame",recording:f,data:D,upload:c})}}function P(){M(!1,!1)}t({status:"initialized"}),tagpro.socket.on("groupId",function(t){r=t||""}),tagpro.socket.on("map",function(t){if(""==a){t.info&&(o=t.info),(s[0]=t.tiles.length)&&(s[1]=t.tiles[0].length);var i=0,n=0;function r(){if(n){var t=new e(n,0);t.write(i,6),a+=t.finish(0)}}for(var u=0;u<s[1];u++)for(var h=0;h<s[0];h++){var p=10*t.tiles[h][u]>>>0;p<10?p=0:p<20?p-=9:p<90?p=4+(p/10>>>0):p<100?p-=77:p<130?p=7+(p/10>>>0):p<140?p-=110:p=8+(p/10>>>0),p==i?n++:(r(),i=p,n=1)}r();for(var d=0;d<2;d++){var f=40*s[d];if(f){var m=f-1;l[d]=32,4294901760&m||(l[d]-=16,m<<=16),4278190080&m||(l[d]-=8,m<<=8),4026531840&m||(l[d]-=4,m<<=4),3221225472&m||(l[d]-=2,m<<=2),2147483648&m||(l[d]-=1)}c[d]=20+((1<<l[d])-f>>>1)}}}),tagpro.socket.on("teamNames",function(t){t.redTeamName&&(b[0]=t.redTeamName),t.blueTeamName&&(b[1]=t.blueTeamName)}),tagpro.socket.on("score",function(t){"r"in t&&(w[0]=t.r),"b"in t&&(w[1]=t.b)}),tagpro.socket.on("time",function(e){var r=new Date,o=r.getTime();if(3==e.state)f||(f=!0,t({status:"preGame"}));else if(!d)if(d=!0,i=location.hostname,n=parseInt(location.port,10),m=r,f){var s=(.06*(o-_)>>>0)+y+Math.round(.06*e.time);v=Math.round(e.time/15e3)/4,g=s-3600*v,B=A,t({status:"inGame",recording:!0,data:{server:i,port:n,date:o/1e3>>>0,timeLimit:v}})}else t({status:"inGame",recording:!1,data:{server:i,port:n,date:o/1e3>>>0}})}),tagpro.socket.on("end",function(t){M(!0,!0)}),tagpro.socket.on("disconnect",P),document.getElementById("exit").addEventListener("click",P),tagpro.socket.on("object",function(t){"marsball"!=t.type||t.id in h||(u++,h[t.id]=null)}),tagpro.socket.on("playerLeft",function(t){var i=Date.now(),n=C[t];if(n){if(d){n.lastTime=(.06*(i-_)>>>0)+y,n.timeline.length&&n.timeline[n.timeline.length-1].time>=n.lastTime&&(n.lastTime=n.timeline[n.timeline.length-1].time+1),n.team=0,n.score>0&&(n.score=0);var o=new e(n.lastTime,7);o.write(3,2),o.write(0,1),o.tally(0),o.tally(0),n.flag||o.write(0,1),o.tally(0),o.tally(0);for(var s=1;s<16;s<<=1)n.powers&s&&o.write(0,1);n.timeline.push(o)}else delete C[t];--A<=1&&B>=4&&r&&(M(!1,!0),tagpro.showOptions())}}),tagpro.socket.on("splat",function(t){d&&D[t.t-1].push(t)}),tagpro.socket.on("p",function(t){var i=Date.now(),n=t.t||0;n?(y=n,_=i,n<=g&&(g=n-1)):n=(.06*(i-_)>>>0)+y,n<x&&(n=x),t=t.u||t;for(var r=new Uint32Array(2),o=0;o<t.length;o++){var s=t[o],a=C[s.id];a?a.message++:(++A>B&&d&&(B=A),s.id>S&&(S=s.id),a=C[s.id]={firstTime:d?n:0,lastTime:0,firstName:"",lastName:"",lastAuth:!1,auth:!1,name:"",flair:0,degree:0,score:0,points:0,team:0,initialTeam:0,flag:0,potato:0,powers:0,"s-pops":0,"s-captures":0,"s-grabs":0,"s-returns":0,"s-tags":0,"s-powerups":0,"s-prevent":0,"s-support":0,timeline:[],toggles:[[],[],[]],message:d?0:1}),s.name&&(a.auth||(a.name=s.name),a.firstName||(a.firstName=s.name),a.lastName=s.name),(a.lastAuth=s.auth)&&(a.auth=!0),s.flair&&(a.flair=1+(s.flair.x|s.flair.y<<4)),s.degree&&(a.degree=s.degree),"score"in s&&(a.score=s.score),"points"in s&&(a.points=s.points);var u=function(t){var e=0;return t in s&&(s[t]>a[t]&&a.message>1&&(e=s[t]-a[t]),a[t]=s[t]),e},h=u("s-pops"),p=u("s-captures"),f=u("s-grabs"),m=u("s-returns"),v=u("s-tags"),b=u("s-powerups"),w=u("s-prevent"),M=u("s-support");if(d){h&&(a.team||s.team)&&r[(a.team||s.team)-1]++;var P=!(h||a.team&&s.team&&s.team!=a.team),E="flag"in s?s.flag?s.flag:0:a.flag,I=new e(n,P&&E?6:7);s.team&&s.team!=a.team?(a.team?I.write(2,2):I.write(2|s.team-1,2),a.team=s.team):I.write(0,1),I.write(h?1:0,1),I.tally(m),I.tally(v>m?v-m:0),a.flag||I.write(f?1:0,1),I.tally(p),"potatoFlag"in s&&(a.potato=s.potatoFlag?1:0),P&&((a.flag||f)&&p&&I.write(E?1:0,1),!a.flag&&f&&E&&I.write((3==E)<<1|a.potato,2)),a.flag=E,I.tally(b),["grip","bomb","tagpro","speed"].forEach(function(t,e){var i=1<<e;a.powers&i?t in s&&!s[t]?(a.powers^=i,I.write(1,1)):(I.write(0,1),I.emptySize++):s[t]?b-- >0&&(a.powers|=i,I.write(1,1),I.emptySize++):b>0&&I.write(0,1)}),I.empty||(a.timeline.push(I),x=n+1);var R=function(t,e){var i=a.toggles[e],r=i.length-1,o=Math.max(n-t,g+1);o<=i[r]+1?i[r]=n:(i.push(o),i.push(n))};switch(1==w&&R(60,0),M){case 1:R(300,1);break;case 2:R(300,2);break;case 3:R(300,1),R(300,2)}}else s.team&&(a.team=a.initialTeam=s.team)}for(var O=0;O<2;O++){var k;if(D[O].length>r[O]&&D[O].splice(0,D[O].length-r[O]),r[O])for(T[O].tally(D[O].length);k=D[O].shift();)T[O].write(Math.min(Math.max(k.x+c[0],0),(1<<l[0])-1),l[0]),T[O].write(Math.min(Math.max(k.y+c[1],0),(1<<l[1])-1),l[1])}})});var io=window.io;window.io=null,window.PIXI=null}function restoreFocus(){$(document).find("#volumeSlider").focus()}function generateId(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<16;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function createRenderer(){var t={};tagpro.renderer=t,tagpro.viewport={followPlayer:!0,centerLock:!1,source:{x:0,y:0}},tagpro.zooming=0,$.cookie.json=!0,PIXI.dontSayHello=!0,t.options={disableParticles:!!$.cookie("disableParticles"),forceCanvasRenderer:!!$.cookie("forceCanvasRenderer"),disableViewportScaling:!!$.cookie("disableViewportScaling"),disableBallSpin:!!$.cookie("disableBallSpin"),transparent:!1},t.particleDefinitions=tagpro.particleDefinitions,t.canvas=$("#viewport").get(0),t.stage=new PIXI.Container,t.canvas_width=1280,t.canvas_height=800,t.layers={},t.dynamicSprites={},t.frameRates=[],t.emitters=[],t.explosions=[],t.fadingSplats=[],t.frameCount=0,t.zoomThreshold=1.4,t.debug=!1,t.sayHello=function(){console.image("http://"+location.host+"/images/console.png"),console.log("TagPro version "+tagpro.version);var e=t.renderer.type===PIXI.WEBGL_RENDERER?"WebGL":"Canvas";console.log("Powered by PixiJS. Currently running in "+e+" mode"),console.log("Developers: LuckySpammer, steppin, NewCompte, AnkhMorpork, Ly, ylambda")},t.resizeView=function(){if(t.renderer){var e,i,n=$(window),r=n.outerWidth(),o=n.outerHeight();r>t.canvas_width&&(r=t.canvas_width),o>t.canvas_height&&(o=t.canvas_height),e=0,(i=Math.round(r*t.canvas_height/t.canvas_width))>o?(e=Math.round(o*t.canvas_width/t.canvas_height),i=o):e=r,t.renderer.resize(e,i)}},t.resizeAndCenterView=function(){t.resizeView(),t.centerView()},t.centerView=function(){var e=$("#viewport"),i=$("#viewportDiv"),n=$(window).height(),r=$(window).width(),o=$("#options");e.css({position:"absolute",left:(r-e.outerWidth())/2,top:(n-e.outerHeight())/2}),i.css({position:"absolute",width:e.outerWidth(),height:e.outerHeight(),left:(r-e.outerWidth())/2,top:(n-e.outerHeight())/2});var s=($(window).height()-o.height())/2-200;o.css({position:"absolute",left:($(window).width()-o.width())/2,top:s<100?100:s}),tagpro.ui.resize(e.width(),e.height()),t.vpWidth=e.width(),t.vpHeight=e.height(),tagpro.chat.resize()},t.start=function(){t.renderer=t.createRenderer(),t.sayHello(),$(window).resize(t.resizeAndCenterView),t.resizeAndCenterView(),t.particleTexture=t.createParticle("#particle"),t.particleFireTexture=t.createParticle("#particleFire"),t.gameContainer=t.createGameContainer(t.stage),t.createBackground(t.gameContainer)},t.destroyPlayer=function(e){if(e.sprites){var i,n,r=t.emitters.indexOf(e.sprites.emitter);for(i in-1!==r&&t.emitters.splice(r,1),e.sprites.emitter&&(e.sprites.emitter.destroy(),e.sprites.emitter=null),e.sprite&&e.sprite.parent.removeChild(e.sprite),e.sprites)e.sprites.hasOwnProperty(i)&&(n=e.sprites[i])&&n.parent.removeChild(n)}},t.measurePerformance=function(){t.frameCount+=1;var e=performance.now();if(t.lastFrameTime){var i=1e3/(e-t.lastFrameTime);isFinite(i)&&t.frameRates.push(i),t.frameRates.length>300&&t.frameRates.shift()}if(t.frameRates.length>=60){var n=t.frameRates.reduce(function(t,e){return t+e});tagpro.fps=5*Math.round(n/t.frameRates.length/5)}else tagpro.fps=0},t.render=function(){requestAnimationFrame(t.render),tagpro.world.update(),t.updateGraphics(),tagpro.ui.update(),t.renderer.render(t.stage),t.measurePerformance(),t.lastFrameTime=performance.now()},t.createLayers=function(){t.createMidground(t.gameContainer),t.createForeground(t.gameContainer),t.createOverlay(t.gameContainer),t.createUI(t.gameContainer)},t.createRenderer=function(){var e={view:t.canvas,antialias:!0,transparent:!!t.options.transparent};return t.options.forceCanvasRenderer?new PIXI.CanvasRenderer(t.canvas_width,t.canvas_height,e):PIXI.autoDetectRenderer(t.canvas_width,t.canvas_height,e)},t.createMidground=function(e){t.layers.midground||(t.layers.midground=new PIXI.Container,t.layers.splats=new PIXI.particles.ParticleContainer,t.layers.midground.addChild(t.layers.splats)),e.addChild(t.layers.midground)},t.createOverlay=function(e){t.layers.overlay=new PIXI.particles.ParticleContainer,e.addChild(t.layers.overlay)},t.createGameContainer=function(t){var e=new PIXI.Container;return t.addChild(e),e},t.createBackground=function(){t.layers.background=new PIXI.Container,t.createLayers(),t.drawBackground()},t.createForeground=function(e){t.layers.foreground||(t.layers.foreground=new PIXI.Container),e.addChild(t.layers.foreground)},t.createUI=function(){t.layers.ui=new PIXI.Container,t.stage.addChild(t.layers.ui)},t.clearBackground=function(){t.layers.background.removeChildren()},t.readyToDrawBackground=function(){return tagpro.map&&tagpro.tiles.image},t.drawMarsball=function(e,i){tagpro.spectator&&(e.draw=!0),e.sprite=tagpro.tiles.draw(t.layers.foreground,"marsball",i,80,80),e.sprite.keep=!0,e.draw||(e.sprite.visible=!1)},t.createGravityWellEmitter=function(e,i){if(t.options.disableParticles){var n=new PIXI.Graphics;n.alpha=.075,n.beginFill(0).drawCircle(e,i,260),t.layers.foreground.addChild(n)}else{var r=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture,t.particleFireTexture],tagpro.particleDefinitions.gravityWell);r.updateSpawnPos(e,i),t.emitters.push(r)}},t.drawBackgroundTiles=function(e){for(var i={x:0,y:0},n=0,r=tagpro.map.length;n!==r;n++){i.x=40*n;for(var o=0,s=tagpro.map[0].length;o!==s;o++)i.y=40*o,tagpro.tiles.drawLayers(e,n,o,i,t.layers.midground),22===tagpro.map[n][o]&&(t.createGravityWellEmitter(i.x+20,i.y+20),tagpro.world.createGravityWell(.4*n,.4*o))}t.afterDrawBackground()},t.afterDrawBackground=function(){},t.drawStartingSplats=function(){if(tagpro.map.splats)for(var e=0;e<tagpro.map.splats.length;e++){var i=tagpro.map.splats[e];t.drawSplat(i.x,i.y,i.t)}},t.drawBackground=function(){if(!t.readyToDrawBackground())return setTimeout(t.drawBackground,0),!1;t.drawBackgroundTiles(t.layers.background),t.createBackgroundTexture(t.layers.background),t.layers.backgroundDrawn||(t.gameContainer.addChildAt(t.layers.background,0),t.drawStartingSplats(),requestAnimationFrame(t.render)),t.drawDynamicTiles(),t.layers.backgroundDrawn=!0,tagpro.chat.resize()},t.drawDynamicTile=function(e,i){var n=tagpro.tiles[tagpro.map[e][i]];if(n){var r,o={x:40*e,y:40*i};if(n instanceof PIXI.extras.AnimatedSprite||n.frameTiles)r=t.drawAnimation(n,o);else{if(!n.dynamic)return;r=tagpro.tiles.draw(t.layers.midground,tagpro.map[e][i],o)}t.dynamicSprites[e]||(t.dynamicSprites[e]={}),t.dynamicSprites[e][i]=r}},t.drawDynamicTiles=function(){for(var e=0;e<tagpro.map.length;e++)for(var i=0;i<tagpro.map[0].length;i++)t.drawDynamicTile(e,i)},t.drawAnimation=function(e,i){var n=e.textures||e.frameTiles.map(function(t){return tagpro.tiles.getTexture(t)}),r=new PIXI.SpriteClip(n);return r.x=i.x,r.y=i.y,r.alpha=e.alpha,e.blink?r.fps=4:r.fps=6+Math.random()/10,r.play(),t.layers.midground.addChild(r),r},t.chunkifyBackground=function(e){t.backgroundChunks=[];var i=e.baseTexture,n=40*tagpro.map.length,r=40*tagpro.map[0].length,o=1024;if(t.renderer.gl){var s=t.renderer.gl.getParameter(t.renderer.gl.MAX_TEXTURE_SIZE);o>s&&(o=Math.pow(2,Math.round(Math.log(s/2)/Math.log(2))),console.log("Chunk size was too large. Reducing to closest power of two below gl.MAX_TEXTURE_SIZE, which is "+o))}t.layers.background.removeChildren();for(var a=0;a<n;a+=o)for(var l=0;l<r;l+=o){var c=a+o>n?n-a:o,u=l+o>r?r-l:o,h=document.createElement("canvas");h.width=h.height=o,h.getContext("2d").drawImage(i.source,a,l,c,u,0,0,c,u);var p=PIXI.Texture.fromCanvas(h),d=new PIXI.Sprite(p);d.x=a,d.y=l,t.backgroundChunks.push(d),t.layers.background.addChild(d)}},t.createBackgroundTexture=function(e){var i=PIXI.RenderTexture.create(40*tagpro.map.length,40*tagpro.map[0].length);(new PIXI.CanvasRenderer).render(e,i),t.chunkifyBackground(i)},t.updateDeathStatus=function(t,e){t.toUpdate&&(e.x=-1e3,e.y=-1e3,t.sprite.x=-1e3,t.sprite.y=-1e3,t.toUpdate=!1)},t.getLockedPosition=function(t){return{x:t.x,y:t.y}},t.updatePlayerColor=function(t){var e=(1===t.team?"red":"blue")+"ball";if(t.sprites.actualBall.tileId!==e){var i=tagpro.tiles.getTexture(e),n=new PIXI.Texture(i);t.sprites.actualBall.texture=n,t.sprites.actualBall.tileId=e}},t.drawPlayer=function(e,i){tagpro.spectator&&(e.draw=!0);var n=t.getLockedPosition(e);return t.updateFlagsFromPlayer(e),t.updatePlayerSpritePosition(e),t.updateDeathStatus(e,n),t.updatePlayerFlag(e,n),t.updatePlayerPowerUps(e,i,n),t.updatePlayerVisibility(e),t.updatePlayerColor(e),n},t.drawPlayers=function(e){for(var i in tagpro.players)if(tagpro.players.hasOwnProperty(i)){var n=tagpro.players[i];t.drawPlayer(n,e)}},t.drawDegree=function(e){tagpro.settings.ui.degrees&&(!e.sprites.degrees&&e.degree&&(e.sprites.degrees=t.veryPrettyText(e.degree+""),e.sprites.info.addChild(e.sprites.degrees)),e.sprites.degrees&&(e.sprites.degrees.x=25,e.sprites.degrees.y=-10))},t.prettyText=function(t,e){return new PIXI.Text(t,{fontFamily:"Arial",fontSize:"8pt",fontWeight:"bold",fill:e||"#FFFFFF",stroke:"#000000",strokeThickness:3,lineJoin:"round"})},t.veryPrettyText=function(t,e){var i=document.createElement("canvas");i.width=128,i.height=32;var n=i.getContext("2d");n.clearRect(0,0,i.width,i.height),n.font="bold 11px arial",n.fillStyle=e||"#ffffff",n.strokeStyle="#000000",n.shadowColor="#000000",n.shadowOffsetX=0,n.shadowOffsetY=0,n.lineWidth=2,n.shadowBlur=10,n.strokeText(t,16,16),n.shadowBlur=0,n.fillText(t,16,16);var r=PIXI.Texture.fromCanvas(i);return new PIXI.Sprite(r)},t.largeText=function(t,e){return new PIXI.Text(t,{fontFamily:"Arial",fontSize:"48pt",fontWeight:"bold",fill:e||"#ffffff",stroke:"black",strokeThickness:3,lineJoin:"round"})},t.drawName=function(e,i){if(!e.sprites.name||i){if(e.sprites.name&&e.sprites.info.removeChild(e.sprites.name),!tagpro.settings.ui.names)return;var n=e.auth?"#BFFF00":"#ffffff";e.sprites.name=t.veryPrettyText(e.name,n),e.sprites.info.addChild(e.sprites.name)}e.sprites.name.x=20,e.sprites.name.y=-21,e.sprites.name.visible=!!tagpro.settings.ui.names},t.getFlairTexture=function(t,e){var i=PIXI.utils.TextureCache[t];if(!i){var n=document.createElement("canvas");n.width=16,n.height=16,n.getContext("2d").drawImage($("#flair").get(0),16*e.x,16*e.y,16,16,0,0,16,16),i=PIXI.Texture.fromCanvas(n),PIXI.utils.TextureCache[t]=i}return i},t.drawFlair=function(e){if(e.sprites.flair&&e.sprites.flair.flairName!==e.flair&&(e.sprites.info.removeChild(e.sprites.flair),e.sprites.flair=null),e.flair&&!e.sprites.flair){var i="flair-"+e.flair.x+","+e.flair.y,n=t.getFlairTexture(i,e.flair);if(e.sprites.flair=new PIXI.Sprite(n),e.sprites.flair.pivot.x=8,e.sprites.flair.pivot.y=8,e.sprites.flair.x=20,e.sprites.flair.y=-9,e.sprites.info.addChild(e.sprites.flair),e.sprites.flair.flairName=e.flair,e.sprites.rotation=0,e.rotateFlairSpeed=0,"Arc Reactor"===e.flair.description&&!t.options.disableParticles){var r=new PIXI.particles.Emitter(t.layers.midground,[t.particleTexture],tagpro.particleDefinitions.arcReactor);t.emitters.push(r),e.flairEmitter=r,e.flairEmitter.keep=!0}}if(e.sprites.flair&&"Level 4 Donor"===e.flair.description&&(e.lastFrame||(e.lastFrame={"s-captures":0,"s-tags":0}),e.lastFrame["s-captures"]===e["s-captures"]&&e.lastFrame["s-tags"]===e["s-tags"]||(e.tween=new Tween(.4,-.38,4e3,"quadOut"),e.rotateFlairSpeed=e.tween.getValue()),e.rotateFlairSpeed>.02&&(e.rotateFlairSpeed=e.tween.getValue()),e.rotateFlairSpeed=Math.max(.02,e.rotateFlairSpeed),e.sprites.flair.rotation+=e.rotateFlairSpeed,e.lastFrame["s-captures"]=e["s-captures"],e.lastFrame["s-tags"]=e["s-tags"]),!e.flair&&e.sprites.flair&&e.sprites.info.removeChild(e.sprites.flair),e.flairEmitter){var o=e.sprite.visible&&!e.dead,s=o;e.flairEmitter.emit=o,e.flairEmitter.updateOwnerPos(e.x+20,e.y-9),s&&e.flairEmitter.resetPositionTracking()}},t.createParticle=function(t){var e=document.createElement("canvas"),i=$(t)[0];return e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0),PIXI.Texture.fromCanvas(e)},t.createExplosion=function(e,i){if(t.options.disableParticles){var n=new PIXI.Graphics;n.tagpro={started:performance.now(),length:150,x:e,y:i,size:200},t.layers.foreground.addChild(n),t.explosions.push(n)}else{var r=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture],tagpro.particleDefinitions.explosion);r.updateSpawnPos(e,i),t.emitters.push(r)}},t.updateExplosions=function(){if(t.options.disableParticles){var e=performance.now();t.explosions.slice().forEach(function(i){var n=e-i.tagpro.started;if(n>=i.tagpro.length)return t.layers.foreground.removeChild(i),void t.explosions.splice(t.explosions.indexOf(i),1);var r=i.tagpro.size*(n/i.tagpro.length);i.alpha=1-n/i.tagpro.length,i.clear().beginFill(i.tagpro.color||16776960).drawCircle(i.tagpro.x+20,i.tagpro.y+20,r)})}},t.updateFadingSplats=function(){var e=performance.now();t.fadingSplats.slice().forEach(function(i){if(e>=i.fadeUntil)return t.layers.splats.removeChild(i),void t.fadingSplats.splice(t.fadingSplats.indexOf(i),1);i.alpha=1-(e-i.fadeStart)/(i.fadeUntil-i.fadeStart)})},t.startDeathEmitter=function(e,i,n,r){if(!t.options.disableParticles){var o=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture],tagpro.particleDefinitions.death);o.startColor=PIXI.particles.ParticleUtils.hexToRGB(e),o.stopColor=PIXI.particles.ParticleUtils.hexToRGB(i),o.updateSpawnPos(n,r),t.emitters.push(o)}},t.drawBallPop=function(e,i,n){var r=new PIXI.Graphics;r.tagpro={started:performance.now(),length:150,x:e-20,y:i-20,size:60,color:1===n?16711680:255},t.layers.foreground.addChild(r),t.explosions.push(r)},t.drawSplat=function(e,i,n,r,o,s){var a;a=1===n?"ff0000":"0000ff",r&&(t.options.disableParticles?t.drawBallPop(e+19,i+19,n):t.startDeathEmitter(a,"ffffff",e+19,i+19)),t.addSplat(n,e,i,o,s)},t.addSplat=function(e,i,n,r,o){var s=Math.floor(Math.random()*tagpro.tiles.splats.red.length),a=(1===e?tagpro.tiles.splats.red:tagpro.tiles.splats.blue)[s],l=new PIXI.Sprite(a);l.x=i+20,l.y=n+20,l.width=90*(.8+.2*Math.random()),l.height=90*(.8+.2*Math.random()),l.anchor.x=.5,l.anchor.y=.5,o&&(l.scale.x=o,l.scale.y=o),l.rotation=2*Math.random()*Math.PI,l.alpha=1,r&&(l.fadeStart=performance.now(),l.fadeUntil=l.fadeStart+5e3,t.fadingSplats.push(l)),t.layers.splats.addChild(l)},t.createPlayerEmitter=function(e){t.options.disableParticles||(e.sprites.emitter=new PIXI.particles.Emitter(t.layers.midground,[t.particleTexture,t.particleFireTexture],tagpro.particleDefinitions.playerEmitter),e.sprites.emitter.keep=!0,t.emitters.push(e.sprites.emitter),e.sprites.emitter.emit=!1)},t.updateMarsBall=function(e,i){e.sprite||t.drawMarsball(e,i),e.draw?e.sprite.visible=!0:e.sprite.visible=!!tagpro.spectator,e.sprite.x=i.x,e.sprite.y=i.y},t.updateObjects=function(){for(var e in tagpro.objects)if(tagpro.objects.hasOwnProperty(e)){var i=tagpro.objects[e],n={x:Math.round(i.x-20),y:Math.round(i.y-20)};t.updateMarsBall(i,n)}},t.updateGraphics=function(){t.updatePlayers(),t.updateExplosions(),t.updateFadingSplats(),t.updateCamera(),t.updateObjects(),t.updateBackgroundVisibility(),t.options.disableParticles||t.updateEmitters()},t.checkIfVisible=function(){return!0},t.updateBackgroundVisibility=function(){for(var e=0;e<t.backgroundChunks.length;e++){var i=t.backgroundChunks[e];i&&(i.visible=t.checkIfVisible(i.x,i.y,i.width,i.height))}},t.centerContainerToPoint=function(e,i){var n=t.options.disableViewportScaling?1:(this.vpHeight/t.canvas_height).toFixed(2);t.gameContainer.x=this.vpWidth/2-e/tagpro.zoom*n,t.gameContainer.y=this.vpHeight/2-i/tagpro.zoom*n},t.updateCameraPosition=function(e){-1e3!==e.sprite.x&&-1e3!==e.sprite.y&&t.centerContainerToPoint(e.sprite.x+19,e.sprite.y+19)},t.updateCameraZoom=function(){var e=t.options.disableViewportScaling?1:this.vpHeight/t.canvas_height;tagpro.spectator?tagpro.zoom=tagpro.zoom+tagpro.zooming>.1?tagpro.zoom+tagpro.zooming:tagpro.zoom:tagpro.zoom=1;var i=new PIXI.Point(1/tagpro.zoom*e,1/tagpro.zoom*e),n=new PIXI.Point(tagpro.zoom,tagpro.zoom);for(var r in t.gameContainer.scale=i,tagpro.players)if(tagpro.players.hasOwnProperty(r)){var o=tagpro.players[r],s=o.sprites.info;if(s.x=19-19*tagpro.zoom,s.scale=n,o.sprites){var a=tagpro.zoom<t.zoomThreshold;o.sprites.flair&&(o.sprites.flair.visible=a),o.sprites.degrees&&(o.sprites.degrees.visible=a)}}},t.centerCameraPosition=function(){var e=tagpro.map.length||0,i=tagpro.map[0]?tagpro.map[0].length:0;t.centerContainerToPoint(e/2*40,i/2*40)},t.updateCamera=function(e){e=e||tagpro.playerId;var i=tagpro.players[e];t.updateCameraZoom(),tagpro.viewport.followPlayer&&i?t.updateCameraPosition(i):t.centerCameraPosition()},t.resetFlagStatuses=function(){tagpro.ui.blueFlagTaken=!1,tagpro.ui.redFlagTaken=!1,tagpro.ui.yellowFlagTakenByRed=!1,tagpro.ui.yellowFlagTakenByBlue=!1,tagpro.ui.bluePotatoTaken=!1,tagpro.ui.redPotatoTaken=!1,tagpro.ui.yellowPotatoTakenByRed=!1,tagpro.ui.yellowPotatoTakenByBlue=!1},t.updateFlagsFromPlayer=function(t){t.flag&&(t.potatoFlag?(tagpro.ui.bluePotatoTaken=tagpro.ui.bluePotatoTaken||2===t.flag,tagpro.ui.redPotatoTaken=tagpro.ui.redPotatoTaken||1===t.flag,tagpro.ui.yellowPotatoTakenByRed=tagpro.ui.yellowPotatoTakenByRed||1===t.team&&3===t.flag,tagpro.ui.yellowPotatoTakenByBlue=tagpro.ui.yellowPotatoTakenByBlue||2===t.team&&3===t.flag):(tagpro.ui.blueFlagTaken=tagpro.ui.blueFlagTaken||2===t.flag,tagpro.ui.redFlagTaken=tagpro.ui.redFlagTaken||1===t.flag,tagpro.ui.yellowFlagTakenByRed=tagpro.ui.yellowFlagTakenByRed||1===t.team&&3===t.flag,tagpro.ui.yellowFlagTakenByBlue=tagpro.ui.yellowFlagTakenByBlue||2===t.team&&3===t.flag))},t.setupPlayerSprites=function(t){t.sprites={tagpro:null,grip:null,flag:null,ball:null,bomb:null}},t.createBallSprite=function(t){var e=1===t.team?"redball":"blueball";t.sprites.actualBall=tagpro.tiles.draw(t.sprites.ball,e,{x:20,y:20}),t.sprites.actualBall.anchor.x=.5,t.sprites.actualBall.anchor.y=.5,t.sprites.actualBall.tileId=e},t.addPlayerSprite=function(e){t.createBallSprite(e),t.layers.foreground.addChild(e.sprite)},t.createPlayerSprite=function(e){e.sprite=new PIXI.Container,e.sprites.ball=new PIXI.Container,e.sprite.addChild(e.sprites.ball),e.sprite.interactive=!0,e.sprite.click=function(){tagpro.kick.player(e)},e.sprite.id=e.id,t.addPlayerSprite(e)},t.updatePlayerSpritePosition=function(e){e.sprite.x=e.x,e.sprite.y=e.y,t.options.disableBallSpin||(e.sprites.actualBall.rotation=e.angle)},t.checkSelfDestruct=function(e){if(e.sprites.flag&&e.selfDestructSoon&&!e.sprites.selfDestructSoon)t.options.disableParticles||(e.sprites.selfDestructSoon=new PIXI.particles.Emitter(e.sprites.flag,[t.particleTexture],tagpro.particleDefinitions.rollingBomb),t.emitters.push(e.sprites.selfDestructSoon));else if(!e.selfDestructSoon&&e.sprites.selfDestructSoon){e.sprites.selfDestructSoon.emit=!1,e.sprites.flag.removeChild(e.sprites.selfDestructSoon);var i=t.emitters.indexOf(e.sprites.selfDestructSoon);t.emitters.splice(i,1),e.sprites.selfDestructSoon.destroy(),e.sprites.selfDestructSoon=null}},t.updatePlayerFlag=function(e){var i;(e.sprites.flagLayer||(e.sprites.flagLayer=new PIXI.Container,e.sprites.info.addChildAt(e.sprites.flagLayer,0)),t.checkSelfDestruct(e),e.flag)?(1===e.flag?i=e.potatoFlag?"redpotato":"redflag":2===e.flag?i=e.potatoFlag?"bluepotato":"blueflag":3===e.flag&&(i=e.potatoFlag?"yellowpotato":"yellowflag"),e.sprites.flag&&e.sprites.flag.name===i||(e.sprites.flag=tagpro.tiles.draw(e.sprites.flagLayer,i,{x:13,y:-32},null,null,null,!0),e.sprites.flag.name=i)):e.sprites.flag&&(e.sprites.flagLayer.removeChild(e.sprites.flag),e.sprites.flag=null)},t.updateGrip=function(t,e,i){t.grip?t.sprites.grip?(t.sprites.grip.x=i.x,t.sprites.grip.y=i.y+23):t.sprites.grip=tagpro.tiles.draw(e,"grip",{x:i.x,y:i.y+23},17,17):t.sprites.grip&&(e.removeChild(t.sprites.grip),t.sprites.grip=null)},t.updateTagpro=function(e){if(e.tagpro){if(!e.sprites.tagproTint){var i=e.sprites.tagproTint=new PIXI.Graphics;i.beginFill(65280,.25).lineStyle(2,65280).drawCircle(20,20,20),e.sprites.ball.addChild(i),t.options.disableParticles||(e.sprites.tagproSparks=new PIXI.particles.Emitter(e.sprites.ball,[t.particleFireTexture],tagpro.particleDefinitions.tagproSparks),e.sprites.tagproSparks.player=e.id,t.emitters.push(e.sprites.tagproSparks))}}else if(e.sprites.tagproTint&&(e.sprites.ball.removeChild(e.sprites.tagproTint),e.sprites.tagproTint=null),e.sprites.tagproSparks){e.sprites.tagproSparks.emit=!1;var n=t.emitters.indexOf(e.sprites.tagproSparks);t.emitters.splice(n,1),e.sprites.tagproSparks.destroy(),e.sprites.tagproSparks=null}},t.updateRollingBomb=function(e){if(e.bomb)if(e.sprites.bomb)e.sprites.bomb.alpha=Math.abs(.75*Math.sin(performance.now()/150));else{t.options.disableParticles||(e.sprites.rollingBomb=new PIXI.particles.Emitter(e.sprites.ball,[t.particleTexture],tagpro.particleDefinitions.rollingBomb),t.emitters.push(e.sprites.rollingBomb));var i=e.sprites.bomb=new PIXI.Graphics;i.beginFill(16776960,.75).drawCircle(20,20,20),e.sprites.ball.addChild(i)}else e.sprites.bomb&&(e.sprites.ball.removeChild(e.sprites.bomb),e.sprites.bomb=null),e.sprites.rollingBomb&&(e.sprites.rollingBomb instanceof PIXI.particles.Emitter?(e.sprites.rollingBomb.emit=!1,t.emitters.splice(t.emitters.indexOf(e.sprites.rollingBomb),1),e.sprites.rollingBomb.destroy()):e.sprites.rollingBomb.visible=!1,e.sprites.rollingBomb=null)},t.updatePlayerPowerUps=function(e,i,n){t.updateGrip(e,i,n),t.updateTagpro(e),t.updateRollingBomb(e)},t.updatePlayerVisibility=function(t){for(var e in t.sprites)if(t.sprites.hasOwnProperty(e)){var i=t.sprites[e];i&&(i.visible=t.sprite.visible)}},t.updatePlayerEmitter=function(t){var e=t.sprite.visible&&!t.dead&&(t.ac>.025||(t.speed||0)>1.5*t.ms),i=e&&!t.sprites.emitter.emit;t.sprites.emitter.emit=e,t.sprites.emitter.updateOwnerPos(t.x,t.y),i&&t.sprites.emitter.resetPositionTracking()},t.updatePlayer=function(e){if(e.sprites||t.setupPlayerSprites(e),e.sprite||t.createPlayerSprite(e),e.sprites.emitter||t.createPlayerEmitter(e),e.sprite.visible||!e.draw||e.dead||(e.toUpdate=!0),!e.sprites.info){var i=e.sprites.info=new PIXI.Container;e.sprite.addChild(i)}e.sprite.visible=!!e.draw&&!e.dead,t.drawDegree(e),t.drawName(e),t.drawFlair(e),t.options.disableParticles||t.updatePlayerEmitter(e)},t.updatePlayers=function(){for(var e in t.resetFlagStatuses(),tagpro.players)if(tagpro.players.hasOwnProperty(e)){var i=tagpro.players[e];t.updatePlayer(i)}t.drawPlayers(t.layers.foreground)},t.updateEmitters=function(){var e=performance.now();t.renderDelta||(t.renderDelta=e);var i=[];t.emitters.forEach(function(n){n.emit||n.particleCount>0?n.update(.001*(e-t.renderDelta)):n.keep||i.push(n)}),i.forEach(function(e){var i=t.emitters.indexOf(e);-1!==i&&t.emitters.splice(i,1)}),t.renderDelta=performance.now()},t.updateDynamicTile=function(e){tagpro.map[e.x][e.y]=e.v,t.dynamicSprites[e.x]&&t.layers.midground.removeChild(t.dynamicSprites[e.x][e.y]),t.drawDynamicTile(e.x,e.y)},t.handleMapUpdate=function(e){if(tagpro.map){Array.isArray(e)||(e=[e]);for(var i=0,n=e.length;i!==n;i++){var r=e[i];t.updateDynamicTile(r)}}},t.drawSpawn=function(e,i,n,r){if(t.layers.foreground){var o=1===n?"redball":"blueball",s=tagpro.tiles.draw(t.layers.foreground,o,{x:e,y:i},null,null,.25,!0);setTimeout(function(){s.parent.removeChild(s)},r)}else setTimeout(t.drawSpawn,0,e,i,n,r)},tagpro.socket.on("mapupdate",t.handleMapUpdate),tagpro.socket.on("bomb",function(e){t.createExplosion(e.x,e.y)}),tagpro.socket.on("splat",function(e){t.drawSplat(e.x,e.y,e.t,!0,e.temp)}),tagpro.socket.on("spawn",function(e){t.drawSpawn(e.x,e.y,e.t,e.w)}),tagpro.ready.after(t.start)}}();
