function restoreFocus(){$(document).find("#volumeSlider").focus()}function generateId(){var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<16;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function createRenderer(){var e=40,t={};tagpro.renderer=t,tagpro.viewport={followPlayer:!0,centerLock:!1,source:{x:0,y:0}},tagpro.zooming=0,$.cookie.json=!0,PIXI.dontSayHello=!0,t.options={disableParticles:!!$.cookie("disableParticles"),forceCanvasRenderer:!!$.cookie("forceCanvasRenderer"),disableViewportScaling:!!$.cookie("disableViewportScaling"),disableBallSpin:!!$.cookie("disableBallSpin"),transparent:!1},t.particleDefinitions=tagpro.particleDefinitions,t.canvas=$("#viewport").get(0),t.stage=new PIXI.Container,t.canvas_width=1280,t.canvas_height=800,t.layers={},t.dynamicSprites={},t.frameRates=[],t.emitters=[],t.explosions=[],t.fadingSplats=[],t.frameCount=0,t.zoomThreshold=1.4,t.debug=!1,t.sayHello=function(){console.image("http://"+location.host+"/images/console.png"),console.log("TagPro version "+tagpro.version);var e=t.renderer.type===PIXI.WEBGL_RENDERER?"WebGL":"Canvas";console.log("Powered by PixiJS. Currently running in "+e+" mode"),console.log("Developers: LuckySpammer, steppin, NewCompte, AnkhMorpork, Ly, ylambda")},t.resizeView=function(){if(!t.renderer)return;var e=$(window),n=e.outerWidth(),r=e.outerHeight(),i,s;n>t.canvas_width&&(n=t.canvas_width),r>t.canvas_height&&(r=t.canvas_height),s=Math.round(n*t.canvas_height/t.canvas_width),i=0,s>r?(i=Math.round(r*t.canvas_width/t.canvas_height),s=r):i=n,t.renderer.resize(i,s)},t.resizeAndCenterView=function(){t.resizeView(),t.centerView()},t.centerView=function(){var e=$("#viewport"),n=$("#viewportDiv"),r=$(window).height(),i=$(window).width(),s=$("#options");e.css({position:"absolute",left:(i-e.outerWidth())/2,top:(r-e.outerHeight())/2}),n.css({position:"absolute",width:e.outerWidth(),height:e.outerHeight(),left:(i-e.outerWidth())/2,top:(r-e.outerHeight())/2});var o=($(window).height()-s.height())/2-200;s.css({position:"absolute",left:($(window).width()-s.width())/2,top:o<100?100:o}),tagpro.ui.resize(e.width(),e.height()),t.vpWidth=e.width(),t.vpHeight=e.height(),tagpro.chat.resize()},t.start=function(){t.renderer=t.createRenderer(),t.sayHello(),$(window).resize(t.resizeAndCenterView),t.resizeAndCenterView(),t.particleTexture=t.createParticle("#particle"),t.particleFireTexture=t.createParticle("#particleFire"),t.gameContainer=t.createGameContainer(t.stage),t.createBackground(t.gameContainer)},t.destroyPlayer=function(e){if(!e.sprites)return;var n=t.emitters.indexOf(e.sprites.emitter),r,i;n!==-1&&t.emitters.splice(n,1),e.sprites.emitter&&(e.sprites.emitter.destroy(),e.sprites.emitter=null),e.sprite&&e.sprite.parent.removeChild(e.sprite);for(r in e.sprites)e.sprites.hasOwnProperty(r)&&(i=e.sprites[r],i&&i.parent.removeChild(i))},t.measurePerformance=function(){t.frameCount+=1;var e=performance.now(),n=300;if(t.lastFrameTime){var r=e-t.lastFrameTime,i=1e3/r;isFinite(i)&&t.frameRates.push(i),t.frameRates.length>n&&t.frameRates.shift()}if(t.frameRates.length>=n/5){var s=t.frameRates.reduce(function(e,t){return e+t});tagpro.fps=Math.round(s/t.frameRates.length/5)*5}else tagpro.fps=0},t.render=function(){requestAnimationFrame(t.render),tagpro.world.update(),t.updateGraphics(),tagpro.ui.update(),t.renderer.render(t.stage),t.measurePerformance(),t.lastFrameTime=performance.now()},t.createLayers=function(){t.createMidground(t.gameContainer),t.createForeground(t.gameContainer),t.createOverlay(t.gameContainer),t.createUI(t.gameContainer)},t.createRenderer=function(){var e={view:t.canvas,antialias:!0,transparent:!!t.options.transparent};return t.options.forceCanvasRenderer?new PIXI.CanvasRenderer(t.canvas_width,t.canvas_height,e):PIXI.autoDetectRenderer(t.canvas_width,t.canvas_height,e)},t.createMidground=function(e){t.layers.midground||(t.layers.midground=new PIXI.Container,t.layers.splats=new PIXI.particles.ParticleContainer,t.layers.midground.addChild(t.layers.splats)),e.addChild(t.layers.midground)},t.createOverlay=function(e){t.layers.overlay=new PIXI.particles.ParticleContainer,e.addChild(t.layers.overlay)},t.createGameContainer=function(e){var t=new PIXI.Container;return e.addChild(t),t},t.createBackground=function(){t.layers.background=new PIXI.Container,t.createLayers(),t.drawBackground()},t.createForeground=function(e){t.layers.foreground||(t.layers.foreground=new PIXI.Container),e.addChild(t.layers.foreground)},t.createUI=function(){t.layers.ui=new PIXI.Container,t.stage.addChild(t.layers.ui)},t.clearBackground=function(){t.layers.background.removeChildren()},t.readyToDrawBackground=function(){return tagpro.map&&tagpro.tiles.image},t.drawMarsball=function(e,n){tagpro.spectator&&(e.draw=!0),e.sprite=tagpro.tiles.draw(t.layers.foreground,"marsball",n,80,80),e.sprite.keep=!0,e.draw||(e.sprite.visible=!1)},t.createGravityWellEmitter=function(e,n){if(t.options.disableParticles){var r=new PIXI.Graphics;r.alpha=.075,r.beginFill(0).drawCircle(e,n,260),t.layers.foreground.addChild(r)}else{var i=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture,t.particleFireTexture],tagpro.particleDefinitions.gravityWell);i.updateSpawnPos(e,n),t.emitters.push(i)}},t.drawBackgroundTiles=function(n){var r={x:0,y:0};for(var i=0,s=tagpro.map.length;i!==s;i++){r.x=i*e;for(var o=0,u=tagpro.map[0].length;o!==u;o++)r.y=o*e,tagpro.tiles.drawLayers(n,i,o,r,t.layers.midground),tagpro.map[i][o]===22&&(t.createGravityWellEmitter(r.x+e/2,r.y+e/2),tagpro.world.createGravityWell(i*.4,o*.4))}t.afterDrawBackground()},t.afterDrawBackground=function(){},t.drawStartingSplats=function(){if(tagpro.map.splats)for(var e=0;e<tagpro.map.splats.length;e++){var n=tagpro.map.splats[e];t.drawSplat(n.x,n.y,n.t)}},t.drawBackground=function(){if(!t.readyToDrawBackground())return setTimeout(t.drawBackground,0),!1;t.drawBackgroundTiles(t.layers.background),t.createBackgroundTexture(t.layers.background),t.layers.backgroundDrawn||(t.gameContainer.addChildAt(t.layers.background,0),t.drawStartingSplats(),requestAnimationFrame(t.render)),t.drawDynamicTiles(),t.layers.backgroundDrawn=!0,tagpro.chat.resize()},t.drawDynamicTile=function(n,r){var i=tagpro.tiles[tagpro.map[n][r]];if(!i)return;var s={x:n*e,y:r*e},o;if(i instanceof PIXI.extras.AnimatedSprite||i.frameTiles)o=t.drawAnimation(i,s);else{if(!i.dynamic)return;o=tagpro.tiles.draw(t.layers.midground,tagpro.map[n][r],s)}t.dynamicSprites[n]||(t.dynamicSprites[n]={}),t.dynamicSprites[n][r]=o},t.drawDynamicTiles=function(){for(var e=0;e<tagpro.map.length;e++)for(var n=0;n<tagpro.map[0].length;n++)t.drawDynamicTile(e,n)},t.drawAnimation=function(e,n){var r=e.textures||e.frameTiles.map(function(e){return tagpro.tiles.getTexture(e)}),i=new PIXI.SpriteClip(r);return i.x=n.x,i.y=n.y,i.alpha=e.alpha,e.blink?i.fps=4:i.fps=6+Math.random()/10,i.play(),t.layers.midground.addChild(i),i},t.chunkifyBackground=function(n){t.backgroundChunks=[];var r=n.baseTexture,i=tagpro.map.length*e,s=tagpro.map[0].length*e,o=1024;if(t.renderer.gl){var u=t.renderer.gl.getParameter(t.renderer.gl.MAX_TEXTURE_SIZE);o>u&&(o=Math.pow(2,Math.round(Math.log(u/2)/Math.log(2))),console.log("Chunk size was too large. Reducing to closest power of two below gl.MAX_TEXTURE_SIZE, which is "+o))}t.layers.background.removeChildren();for(var a=0;a<i;a+=o)for(var f=0;f<s;f+=o){var l=a+o>i?i-a:o,c=f+o>s?s-f:o,h=document.createElement("canvas");h.width=h.height=o;var p=h.getContext("2d");p.drawImage(r.source,a,f,l,c,0,0,l,c);var d=PIXI.Texture.fromCanvas(h),v=new PIXI.Sprite(d);v.x=a,v.y=f,t.backgroundChunks.push(v),t.layers.background.addChild(v)}},t.createBackgroundTexture=function(n){var r=PIXI.RenderTexture.create(tagpro.map.length*e,tagpro.map[0].length*e),i=new PIXI.CanvasRenderer;i.render(n,r),t.chunkifyBackground(r)},t.updateDeathStatus=function(e,t){e.toUpdate&&(t.x=-1e3,t.y=-1e3,e.sprite.x=-1e3,e.sprite.y=-1e3,e.toUpdate=!1)},t.getLockedPosition=function(e){return{x:e.x,y:e.y}},t.updatePlayerColor=function(e){var t=e.team===1?"red":"blue",n=t+"ball";if(e.sprites.actualBall.tileId!==n){var r=tagpro.tiles.getTexture(n),i=new PIXI.Texture(r);e.sprites.actualBall.texture=i,e.sprites.actualBall.tileId=n}},t.drawPlayer=function(e,n){tagpro.spectator&&(e.draw=!0);var r=t.getLockedPosition(e);return t.updateFlagsFromPlayer(e),t.updatePlayerSpritePosition(e),t.updateDeathStatus(e,r),t.updatePlayerFlag(e,r),t.updatePlayerPowerUps(e,n,r),t.updatePlayerVisibility(e),t.updatePlayerColor(e),tagpro.events.afterDrawPlayer&&tagpro.events.afterDrawPlayer.forEach(function(t){t.afterDrawPlayer(e)}),r},t.drawPlayers=function(e){for(var n in tagpro.players){if(!tagpro.players.hasOwnProperty(n))continue;var r=tagpro.players[n];t.drawPlayer(r,e)}},t.drawDegree=function(e){tagpro.settings.ui.degrees&&(!e.sprites.degrees&&e.degree&&(e.sprites.degrees=t.veryPrettyText(e.degree+"Â°"),e.sprites.info.addChild(e.sprites.degrees)),e.sprites.degrees&&(e.sprites.degrees.x=25,e.sprites.degrees.y=-10))},t.prettyText=function(e,t){return new PIXI.Text(e,{fontFamily:"Arial",fontSize:"8pt",fontWeight:"bold",fill:t||"#FFFFFF",stroke:"#000000",strokeThickness:3,lineJoin:"round"})},t.veryPrettyText=function(e,t){var n=document.createElement("canvas");n.width=128,n.height=32;var r=n.getContext("2d");r.clearRect(0,0,n.width,n.height),r.font="bold 11px arial",r.fillStyle=t||"#ffffff",r.strokeStyle="#000000",r.shadowColor="#000000",r.shadowOffsetX=0,r.shadowOffsetY=0,r.lineWidth=2,r.shadowBlur=10,r.strokeText(e,16,16),r.shadowBlur=0,r.fillText(e,16,16);var i=PIXI.Texture.fromCanvas(n);return new PIXI.Sprite(i)},t.largeText=function(e,t){return new PIXI.Text(e,{fontFamily:"Arial",fontSize:"48pt",fontWeight:"bold",fill:t||"#ffffff",stroke:"black",strokeThickness:3,lineJoin:"round"})},t.drawName=function(e,n){if(!e.sprites.name||n){e.sprites.name&&e.sprites.info.removeChild(e.sprites.name);if(!tagpro.settings.ui.names)return;var r=e.auth?"#BFFF00":"#ffffff";e.sprites.name=t.veryPrettyText(e.name,r),e.sprites.info.addChild(e.sprites.name)}e.sprites.name.x=20,e.sprites.name.y=-21,e.sprites.name.visible=tagpro.settings.ui.names?!0:!1},t.getFlairTexture=function(e,t){var n=PIXI.utils.TextureCache[e];if(!n){var r=document.createElement("canvas");r.width=16,r.height=16;var i=r.getContext("2d");i.drawImage($("#flair").get(0),t.x*16,t.y*16,16,16,0,0,16,16),n=PIXI.Texture.fromCanvas(r),PIXI.utils.TextureCache[e]=n}return n},t.drawFlair=function(e){e.sprites.flair&&e.sprites.flair.flairName!==e.flair&&(e.sprites.info.removeChild(e.sprites.flair),e.sprites.flair=null);if(e.flair&&!e.sprites.flair){var n="flair-"+e.flair.x+","+e.flair.y,r=t.getFlairTexture(n,e.flair);e.sprites.flair=new PIXI.Sprite(r),e.sprites.flair.pivot.x=8,e.sprites.flair.pivot.y=8,e.sprites.flair.x=20,e.sprites.flair.y=-9,e.sprites.info.addChild(e.sprites.flair),e.sprites.flair.flairName=e.flair,e.sprites.rotation=0,e.rotateFlairSpeed=0;if(e.flair.description==="Arc Reactor"&&!t.options.disableParticles){var i=new PIXI.particles.Emitter(t.layers.midground,[t.particleTexture],tagpro.particleDefinitions.arcReactor);t.emitters.push(i),e.flairEmitter=i,e.flairEmitter.keep=!0}}if(e.sprites.flair&&e.flair.description==="Level 4 Donor"){e.lastFrame||(e.lastFrame={"s-captures":0,"s-tags":0});if(e.lastFrame["s-captures"]!==e["s-captures"]||e.lastFrame["s-tags"]!==e["s-tags"])e.tween=new Tween(.4,-0.38,4e3,"quadOut"),e.rotateFlairSpeed=e.tween.getValue();e.rotateFlairSpeed>.02&&(e.rotateFlairSpeed=e.tween.getValue()),e.rotateFlairSpeed=Math.max(.02,e.rotateFlairSpeed),e.sprites.flair.rotation+=e.rotateFlairSpeed,e.lastFrame["s-captures"]=e["s-captures"],e.lastFrame["s-tags"]=e["s-tags"]}!e.flair&&e.sprites.flair&&e.sprites.info.removeChild(e.sprites.flair);if(e.flairEmitter){var s=e.sprite.visible&&!e.dead,o=s;e.flairEmitter.emit=s,e.flairEmitter.updateOwnerPos(e.x+20,e.y-9),o&&e.flairEmitter.resetPositionTracking()}},t.createParticle=function(e){var t=document.createElement("canvas"),n=$(e)[0];t.width=n.width,t.height=n.height;var r=t.getContext("2d");return r.drawImage(n,0,0),PIXI.Texture.fromCanvas(t)},t.createExplosion=function(e,n){if(t.options.disableParticles){var r=new PIXI.Graphics;r.tagpro={started:performance.now(),length:150,x:e,y:n,size:200},t.layers.foreground.addChild(r),t.explosions.push(r)}else{var i=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture],tagpro.particleDefinitions.explosion);i.updateSpawnPos(e,n),t.emitters.push(i)}},t.updateExplosions=function(){if(!t.options.disableParticles)return;var e=performance.now();t.explosions.slice().forEach(function(n){var r=e-n.tagpro.started;if(r>=n.tagpro.length){t.layers.foreground.removeChild(n),t.explosions.splice(t.explosions.indexOf(n),1);return}var i=n.tagpro.size*(r/n.tagpro.length);n.alpha=1-r/n.tagpro.length,n.clear().beginFill(n.tagpro.color||16776960).drawCircle(n.tagpro.x+20,n.tagpro.y+20,i)})},t.updateFadingSplats=function(){var e=performance.now();t.fadingSplats.slice().forEach(function(n){if(e>=n.fadeUntil){t.layers.splats.removeChild(n),t.fadingSplats.splice(t.fadingSplats.indexOf(n),1);return}n.alpha=1-(e-n.fadeStart)/(n.fadeUntil-n.fadeStart)})},t.startDeathEmitter=function(e,n,r,i){if(t.options.disableParticles)return;var s=new PIXI.particles.Emitter(t.layers.foreground,[t.particleTexture],tagpro.particleDefinitions.death);s.startColor=PIXI.particles.ParticleUtils.hexToRGB(e),s.stopColor=PIXI.particles.ParticleUtils.hexToRGB(n),s.updateSpawnPos(r,i),t.emitters.push(s)},t.drawBallPop=function(e,n,r){var i=new PIXI.Graphics;i.tagpro={started:performance.now(),length:150,x:e-20,y:n-20,size:60,color:r===1?16711680:255},t.layers.foreground.addChild(i),t.explosions.push(i)},t.drawSplat=function(e,n,r,i,s,o){var u,a;r===1?u="ff0000":u="0000ff",a="ffffff",i&&(t.options.disableParticles?t.drawBallPop(e+19,n+19,r):t.startDeathEmitter(u,a,e+19,n+19)),t.addSplat(r,e,n,s,o)},t.addSplat=function(e,n,r,i,s){var o=Math.floor(Math.random()*tagpro.tiles.splats.red.length),u;e===1?u=tagpro.tiles.splats.red:u=tagpro.tiles.splats.blue;var a=u[o],f=new PIXI.Sprite(a);f.x=n+20,f.y=r+20,f.width=90*(.8+.2*Math.random()),f.height=90*(.8+.2*Math.random()),f.anchor.x=.5,f.anchor.y=.5,s&&(f.scale.x=s,f.scale.y=s),f.rotation=Math.random()*2*Math.PI,f.alpha=1,i&&(f.fadeStart=performance.now(),f.fadeUntil=f.fadeStart+5e3,t.fadingSplats.push(f)),t.layers.splats.addChild(f)},t.createPlayerEmitter=function(e){if(t.options.disableParticles)return;e.sprites.emitter=new PIXI.particles.Emitter(t.layers.midground,[t.particleTexture,t.particleFireTexture],tagpro.particleDefinitions.playerEmitter),e.sprites.emitter.keep=!0,t.emitters.push(e.sprites.emitter),e.sprites.emitter.emit=!1},t.updateMarsBall=function(e,n){e.sprite||t.drawMarsball(e,n),e.draw?e.sprite.visible=!0:e.sprite.visible=!!tagpro.spectator,e.sprite.x=n.x,e.sprite.y=n.y},t.updateObjects=function(){for(var e in tagpro.objects){if(!tagpro.objects.hasOwnProperty(e))continue;var n=tagpro.objects[e],r={x:Math.round(n.x-20),y:Math.round(n.y-20)};t.updateMarsBall(n,r)}},t.updateGraphics=function(){t.updatePlayers(),t.updateExplosions(),t.updateFadingSplats(),t.updateCamera(),t.updateObjects(),t.updateBackgroundVisibility(),t.options.disableParticles||t.updateEmitters()},t.checkIfVisible=function(){return!0},t.updateBackgroundVisibility=function(){for(var e=0;e<t.backgroundChunks.length;e++){var n=t.backgroundChunks[e];if(!n)continue;n.visible=t.checkIfVisible(n.x,n.y,n.width,n.height)}},t.centerContainerToPoint=function(e,n){var r=t.options.disableViewportScaling?1:(this.vpHeight/t.canvas_height).toFixed(2);t.gameContainer.x=this.vpWidth/2-e/tagpro.zoom*r,t.gameContainer.y=this.vpHeight/2-n/tagpro.zoom*r},t.updateCameraPosition=function(e){e.sprite.x!==-1e3&&e.sprite.y!==-1e3&&t.centerContainerToPoint(e.sprite.x+19,e.sprite.y+19)},t.updateCameraZoom=function(){var e=t.options.disableViewportScaling?1:this.vpHeight/t.canvas_height;tagpro.spectator?tagpro.zoom=tagpro.zoom+tagpro.zooming>.1?tagpro.zoom+tagpro.zooming:tagpro.zoom:tagpro.zoom=1;var n=new PIXI.Point(1/tagpro.zoom*e,1/tagpro.zoom*e),r=new PIXI.Point(tagpro.zoom,tagpro.zoom);t.gameContainer.scale=n;for(var i in tagpro.players){if(!tagpro.players.hasOwnProperty(i))continue;var s=tagpro.players[i],o=s.sprites.info;o.x=19-tagpro.zoom*19,o.scale=r;if(s.sprites){var u=tagpro.zoom<t.zoomThreshold;s.sprites.flair&&(s.sprites.flair.visible=u),s.sprites.degrees&&(s.sprites.degrees.visible=u)}}},t.centerCameraPosition=function(){var n=tagpro.map.length||0,r=tagpro.map[0]?tagpro.map[0].length:0;t.centerContainerToPoint(n/2*e,r/2*e)},t.updateCamera=function(e){e=e||tagpro.playerId;var n=tagpro.players[e];t.updateCameraZoom(),tagpro.viewport.followPlayer&&n?t.updateCameraPosition(n):t.centerCameraPosition()},t.resetFlagStatuses=function(){tagpro.ui.blueFlagTaken=!1,tagpro.ui.redFlagTaken=!1,tagpro.ui.yellowFlagTakenByRed=!1,tagpro.ui.yellowFlagTakenByBlue=!1,tagpro.ui.bluePotatoTaken=!1,tagpro.ui.redPotatoTaken=!1,tagpro.ui.yellowPotatoTakenByRed=!1,tagpro.ui.yellowPotatoTakenByBlue=!1},t.updateFlagsFromPlayer=function(e){e.flag&&(e.potatoFlag?(tagpro.ui.bluePotatoTaken=tagpro.ui.bluePotatoTaken||e.flag===2,tagpro.ui.redPotatoTaken=tagpro.ui.redPotatoTaken||e.flag===1,tagpro.ui.yellowPotatoTakenByRed=tagpro.ui.yellowPotatoTakenByRed||e.team===1&&e.flag===3,tagpro.ui.yellowPotatoTakenByBlue=tagpro.ui.yellowPotatoTakenByBlue||e.team===2&&e.flag===3):(tagpro.ui.blueFlagTaken=tagpro.ui.blueFlagTaken||e.flag===2,tagpro.ui.redFlagTaken=tagpro.ui.redFlagTaken||e.flag===1,tagpro.ui.yellowFlagTakenByRed=tagpro.ui.yellowFlagTakenByRed||e.team===1&&e.flag===3,tagpro.ui.yellowFlagTakenByBlue=tagpro.ui.yellowFlagTakenByBlue||e.team===2&&e.flag===3))},t.setupPlayerSprites=function(e){e.sprites={tagpro:null,grip:null,flag:null,ball:null,bomb:null}},t.createBallSprite=function(e){var t=e.team===1?"redball":"blueball";e.sprites.actualBall=tagpro.tiles.draw(e.sprites.ball,t,{x:20,y:20}),e.sprites.actualBall.anchor.x=.5,e.sprites.actualBall.anchor.y=.5,e.sprites.actualBall.tileId=t},t.addPlayerSprite=function(e){t.createBallSprite(e),t.layers.foreground.addChild(e.sprite)},t.createPlayerSprite=function(e){e.sprite=new PIXI.Container,e.sprites.ball=new PIXI.Container,e.sprite.addChild(e.sprites.ball),e.sprite.interactive=!0,e.sprite.click=function(){tagpro.kick.player(e)},e.sprite.id=e.id,t.addPlayerSprite(e)},t.updatePlayerSpritePosition=function(e){e.sprite.x=e.x,e.sprite.y=e.y,t.options.disableBallSpin||(e.sprites.actualBall.rotation=e.angle)},t.checkSelfDestruct=function(e){if(e.sprites.flag&&e.selfDestructSoon&&!e.sprites.selfDestructSoon)t.options.disableParticles||(e.sprites.selfDestructSoon=new PIXI.particles.Emitter(e.sprites.flag,[t.particleTexture],tagpro.particleDefinitions.rollingBomb),t.emitters.push(e.sprites.selfDestructSoon));else if(!e.selfDestructSoon&&e.sprites.selfDestructSoon){e.sprites.selfDestructSoon.emit=!1,e.sprites.flag.removeChild(e.sprites.selfDestructSoon);var n=t.emitters.indexOf(e.sprites.selfDestructSoon);t.emitters.splice(n,1),e.sprites.selfDestructSoon.destroy(),e.sprites.selfDestructSoon=null}},t.updatePlayerFlag=function(e){e.sprites.flagLayer||(e.sprites.flagLayer=new PIXI.Container,e.sprites.info.addChildAt(e.sprites.flagLayer,0)),t.checkSelfDestruct(e);if(e.flag){var n;e.flag===1?n=e.potatoFlag?"redpotato":"redflag":e.flag===2?n=e.potatoFlag?"bluepotato":"blueflag":e.flag===3&&(n=e.potatoFlag?"yellowpotato":"yellowflag");if(!e.sprites.flag||e.sprites.flag.name!==n)e.sprites.flag=tagpro.tiles.draw(e.sprites.flagLayer,n,{x:13,y:-32},null,null,null,!0),e.sprites.flag.name=n}else e.sprites.flag&&(e.sprites.flagLayer.removeChild(e.sprites.flag),e.sprites.flag=null)},t.updateGrip=function(e,t,n){e.grip?e.sprites.grip?(e.sprites.grip.x=n.x,e.sprites.grip.y=n.y+23):e.sprites.grip=tagpro.tiles.draw(t,"grip",{x:n.x,y:n.y+23},17,17):e.sprites.grip&&(t.removeChild(e.sprites.grip),e.sprites.grip=null)},t.updateTagpro=function(e){if(e.tagpro){if(!e.sprites.tagproTint){var n=e.sprites.tagproTint=new PIXI.Graphics;n.beginFill(65280,.25).lineStyle(2,65280).drawCircle(20,20,20),e.sprites.ball.addChild(n),t.options.disableParticles||(e.sprites.tagproSparks=new PIXI.particles.Emitter(e.sprites.ball,[t.particleFireTexture],tagpro.particleDefinitions.tagproSparks),e.sprites.tagproSparks.player=e.id,t.emitters.push(e.sprites.tagproSparks))}}else{e.sprites.tagproTint&&(e.sprites.ball.removeChild(e.sprites.tagproTint),e.sprites.tagproTint=null);if(e.sprites.tagproSparks){e.sprites.tagproSparks.emit=!1;var r=t.emitters.indexOf(e.sprites.tagproSparks);t.emitters.splice(r,1),e.sprites.tagproSparks.destroy(),e.sprites.tagproSparks=null}}},t.updateRollingBomb=function(e){if(e.bomb)if(!e.sprites.bomb){t.options.disableParticles||(e.sprites.rollingBomb=new PIXI.particles.Emitter(e.sprites.ball,[t.particleTexture],tagpro.particleDefinitions.rollingBomb),t.emitters.push(e.sprites.rollingBomb));var n=e.sprites.bomb=new PIXI.Graphics;n.beginFill(16776960,.75).drawCircle(20,20,20),e.sprites.ball.addChild(n)}else e.sprites.bomb.alpha=Math.abs(.75*Math.sin(performance.now()/150));else e.sprites.bomb&&(e.sprites.ball.removeChild(e.sprites.bomb),e.sprites.bomb=null),e.sprites.rollingBomb&&(e.sprites.rollingBomb instanceof PIXI.particles.Emitter?(e.sprites.rollingBomb.emit=!1,t.emitters.splice(t.emitters.indexOf(e.sprites.rollingBomb),1),e.sprites.rollingBomb.destroy()):e.sprites.rollingBomb.visible=!1,e.sprites.rollingBomb=null)},t.updatePlayerPowerUps=function(e,n,r){t.updateGrip(e,n,r),t.updateTagpro(e),t.updateRollingBomb(e)},t.updatePlayerVisibility=function(e){for(var t in e.sprites)if(e.sprites.hasOwnProperty(t)){var n=e.sprites[t];n&&(n.visible=e.sprite.visible)}},t.updatePlayerEmitter=function(e){var t=e.sprite.visible&&!e.dead&&(e.ac>.025||(e.speed||0)>e.ms*1.5),n=t&&!e.sprites.emitter.emit;e.sprites.emitter.emit=t,e.sprites.emitter.updateOwnerPos(e.x,e.y),n&&e.sprites.emitter.resetPositionTracking()},t.updatePlayer=function(e){e.sprites||t.setupPlayerSprites(e),e.sprite||t.createPlayerSprite(e),e.sprites.emitter||t.createPlayerEmitter(e),!e.sprite.visible&&e.draw&&!e.dead&&(e.toUpdate=!0);if(!e.sprites.info){var n=e.sprites.info=new PIXI.Container;e.sprite.addChild(n)}e.sprite.visible=!!e.draw&&!e.dead,t.drawDegree(e),t.drawName(e),t.drawFlair(e),t.options.disableParticles||t.updatePlayerEmitter(e)},t.updatePlayers=function(){t.resetFlagStatuses(),tagpro.events.beforeUpdatePlayers&&tagpro.events.beforeUpdatePlayers.forEach(function(e){e.beforeUpdatePlayers()});for(var e in tagpro.players){if(!tagpro.players.hasOwnProperty(e))continue;var n=tagpro.players[e];t.updatePlayer(n)}t.drawPlayers(t.layers.foreground)},t.updateEmitters=function(){var e=performance.now();t.renderDelta||(t.renderDelta=e);var n=[];t.emitters.forEach(function(r){r.emit||r.particleCount>0?r.update((e-t.renderDelta)*.001):r.keep||n.push(r)}),n.forEach(function(e){var n=t.emitters.indexOf(e);n!==-1&&t.emitters.splice(n,1)}),t.renderDelta=performance.now()},t.updateDynamicTile=function(e){tagpro.map[e.x][e.y]=e.v,t.dynamicSprites[e.x]&&t.layers.midground.removeChild(t.dynamicSprites[e.x][e.y]),t.drawDynamicTile(e.x,e.y)},t.handleMapUpdate=function(e){if(tagpro.map){Array.isArray(e)||(e=[e]);for(var n=0,r=e.length;n!==r;n++){var i=e[n];t.updateDynamicTile(i)}}},t.drawSpawn=function(e,n,r,i){if(!t.layers.foreground){setTimeout(t.drawSpawn,0,e,n,r,i);return}var s=r===1?"redball":"blueball",o=tagpro.tiles.draw(t.layers.foreground,s,{x:e,y:n},null,null,.25,!0);setTimeout(function(){o.parent.removeChild(o)},i)},tagpro.socket.on("mapupdate",t.handleMapUpdate),tagpro.socket.on("bomb",function(e){t.createExplosion(e.x,e.y)}),tagpro.socket.on("splat",function(e){t.drawSplat(e.x,e.y,e.t,!0,e.temp)}),tagpro.socket.on("spawn",function(e){t.drawSpawn(e.x,e.y,e.t,e.w)}),tagpro.ready.after(t.start)}(function(window,undefined){function isArraylike(e){var t=e.length,n=jQuery.type(e);return jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||n!=="function"&&(t===0||typeof t=="number"&&t>0&&t-1 in e)}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(core_rnotwhite)||[],function(e,n){t[n]=!0}),t}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?JSON.parse(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(isSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return core_indexOf.call(t,e)>=0!==n})}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=e.length,r=0;for(;r<n;r++)data_priv.set(e[r],"globalEval",!t||data_priv.get(t[r],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=data_priv.set(t,s),f=s.events;if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&manipulation_rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function vendorPropName(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function isHidden(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)}function getStyles(e){return window.getComputedStyle(e,null)}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",css_defaultDisplay(r.nodeName)))):s[o]||(i=isHidden(r),(n&&n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(jQuery.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function css_defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(iframe[0].contentWindow||iframe[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function actualDisplay(e,t){var n=jQuery(t.createElement(e)).appendTo(t.body),r=jQuery.css(n[0],"display");return n.remove(),r}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTween(e,t,n){var r,i=(tweeners[t]||[]).concat(tweeners["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return jQuery.map(l,createTween,f),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&isHidden(e),p=data_priv.get(e,"fxshow");n.queue||(u=jQuery._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,jQuery.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],jQuery.css(e,"display")==="inline"&&jQuery.css(e,"float")==="none"&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(rfxtypes.exec(i)){delete t[r],s=s||i==="toggle";if(i===(h?"hide":"show")){if(i!=="show"||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||jQuery.style(e,r)}}if(!jQuery.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=data_priv.access(e,"fxshow",{}),s&&(p.hidden=!h),h?jQuery(e).show():f.done(function(){jQuery(e).hide()}),f.done(function(){var t;data_priv.remove(e,"fxshow");for(t in l)jQuery.style(e,t,l[t])});for(r in l)o=createTween(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function genFx(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=cssExpand[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var rootjQuery,readyList,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="2.0.3",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(e,t){return new jQuery.fn.init(e,t,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()},completed=function(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(e,t,n){var r,i;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?r=[null,e,null]:r=rquickExpr.exec(e);if(r&&(r[1]||!t)){if(r[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(r[1])&&jQuery.isPlainObject(t))for(r in t)jQuery.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=document.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=document,this.selector=e,this}return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},ready:function(e){return jQuery.ready.promise().done(e),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u=2),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),a===u&&(o=this,--u);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?class2type[core_toString.call(e)]||"object":typeof e},isPlainObject:function(e){if(jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e))return!1;try{if(e.constructor&&!core_hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&jQuery(i).remove(),jQuery.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":core_trim.call(e)},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):core_push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:core_indexOf.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if(typeof n=="number")for(;i<n;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(u[u.length]=r);return core_concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=core_slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(core_slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()}),rootjQuery=jQuery(document),function(e,t){function st(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;(t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[];if(!e||typeof e!="string")return n;if((a=t.nodeType)!==1&&a!==9)return[];if(d&&!i){if(s=Y.exec(e))if(u=s[1]){if(a===9){o=t.getElementById(u);if(!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return P.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return P.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){m=p=b,g=t,E=a===9&&e;if(a===1&&t.nodeName.toLowerCase()!=="object"){l=vt(e),(p=t.getAttribute("id"))?m=p.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+mt(l[f]);g=V.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return P.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Tt(e.replace(z,"$1"),t,n,i)}function ot(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function ut(e){return e[b]=!0,e}function at(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ft(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function lt(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ct(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function pt(e){return ut(function(t){return t=+t,ut(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function dt(){}function vt(e,t){var n,r,i,o,u,a,f,l=T[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){if(!n||(r=W.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(i=[]);n=!1;if(r=X.exec(u))n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),u=u.slice(n.length);for(o in s.filter)(r=Q[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?st.error(e):T(e,a).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var r=t.dir,s=n&&r==="parentNode",o=S++;return t.first?function(t,n,i){while(t=t[r])if(t.nodeType===1||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if(t.nodeType===1||s)if(e(t,n,u))return!0}else while(t=t[r])if(t.nodeType===1||s){l=t[b]||(t[b]={});if((f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else{f=l[r]=[c],f[1]=e(t,n,u)||i;if(f[1]===!0)return!0}}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function wt(e,t,n,r,i,s){return r&&!r[b]&&(r=wt(r)),i&&!i[b]&&(i=wt(i,s)),ut(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||xt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?bt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=bt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?B.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=bt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):P.apply(o,g)})}function Et(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return B.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;a<i;a++)if(n=s.relative[e[a].type])h=[gt(yt(h),n)];else{n=s.filter[e[a].type].apply(null,e[a].matches);if(n[b]){r=++a;for(;r<i;r++)if(s.relative[e[r].type])break;return wt(a>1&&yt(h),a>1&&mt(e.slice(0,a-1).concat({value:e[a-2].type===" "?"*":""})).replace(z,"$1"),n,a<r&&Et(e.slice(a,r)),r<i&&Et(e=e.slice(r)),r<i&&mt(e))}h.push(n)}return yt(h)}function St(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=p!=null,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=x==null?1:Math.random()||.1;S&&(f=a!==h&&a,i=n);for(;(d=T[b])!=null;b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}y+=b;if(r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)!w[b]&&!g[b]&&(g[b]=_.call(c));g=bt(g)}P.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&st.uniqueSort(c)}return S&&(E=N,f=x),w};return r?ut(u):u}function xt(e,t,n){var r=0,i=t.length;for(;r<i;r++)st(e,t[r],n);return n}function Tt(e,t,n,i){var o,u,f,l,c,h=vt(e);if(!i&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&r.getById&&t.nodeType===9&&d&&s.relative[u[1].type]){t=(s.find.ID(f.matches[0].replace(nt,rt),t)||[])[0];if(!t)return n;e=e.slice(u.shift().value.length)}o=Q.needsContext.test(e)?0:u.length;while(o--){f=u[o];if(s.relative[l=f.type])break;if(c=s.find[l])if(i=c(f.matches[0].replace(nt,rt),V.test(u[0].type)&&t.parentNode||t)){u.splice(o,1),e=i.length&&mt(u);if(!e)return P.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,V.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,x=ot(),T=ot(),N=ot(),C=!1,k=function(e,t){return e===t?(C=!0,0):0},L=typeof t,A=1<<31,O={}.hasOwnProperty,M=[],_=M.pop,D=M.push,P=M.push,H=M.slice,B=M.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",I="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",q=I.replace("w","w#"),R="\\["+F+"*("+I+")"+F+"*(?:([*^$|!~]?=)"+F+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+q+")|)|)"+F+"*\\]",U=":("+I+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+R.replace(3,8)+")*)|.*)\\)|)",z=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),X=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),V=new RegExp(F+"*[+~]"),$=new RegExp("="+F+"*([^\\]'\"]*)"+F+"*\\]","g"),J=new RegExp(U),K=new RegExp("^"+q+"$"),Q={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I.replace("w","w*")+")"),ATTR:new RegExp("^"+R),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},G=/^[^{]+\{\s*\[native \w/,Y=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{P.apply(M=H.call(w.childNodes),w.childNodes),M[w.childNodes.length].nodeType}catch(it){P={apply:M.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=st.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},r=st.support={},c=st.setDocument=function(e){var t=e?e.ownerDocument||e:w,n=t.defaultView;if(t===h||t.nodeType!==9||!t.documentElement)return h;h=t,p=t.documentElement,d=!u(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){c()}),r.attributes=at(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=at(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=at(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),r.getById=at(function(e){return p.appendChild(e).id=b,!t.getElementsByName||!t.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==L&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&d)return t.getElementsByClassName(e)},m=[],v=[];if(r.qsa=G.test(t.querySelectorAll))at(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+F+"*(?:value|"+j+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),at(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")});return(r.matchesSelector=G.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&at(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",U)}),v=v.length&&new RegExp(v.join("|")),m=m.length&&new RegExp(m.join("|")),y=G.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=p.compareDocumentPosition?function(e,n){if(e===n)return C=!0,0;var i=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);if(i)return i&1||!r.sortDetached&&n.compareDocumentPosition(e)===i?e===t||y(w,e)?-1:n===t||y(w,n)?1:l?B.call(l,e)-B.call(l,n):0:i&4?-1:1;return e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,s=e.parentNode,o=n.parentNode,u=[e],a=[n];if(e===n)return C=!0,0;if(!s||!o)return e===t?-1:n===t?1:s?-1:o?1:l?B.call(l,e)-B.call(l,n):0;if(s===o)return lt(e,n);r=e;while(r=r.parentNode)u.unshift(r);r=n;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?lt(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},t},st.matches=function(e,t){return st(e,null,null,t)},st.matchesSelector=function(e,t){(e.ownerDocument||e)!==h&&c(e),t=t.replace($,"='$1']");if(r.matchesSelector&&d&&(!m||!m.test(t))&&(!v||!v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch(i){}return st(t,h,null,[e]).length>0},st.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},st.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&O.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},st.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},st.uniqueSort=function(e){var t,n=[],i=0,s=0;C=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(k);if(C){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=st.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r];r++)n+=o(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(i===3||i===4)return e.nodeValue;return n},s=st.selectors={cacheLength:50,createPseudo:ut,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||st.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&st.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=vt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&x(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=st.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){y&&((c[b]||(c[b]={}))[e]=[E,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||st.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?ut(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=B.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ut(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[b]?ut(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ut(function(e){return function(t){return st(e,t).length>0}}),contains:ut(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ut(function(e){return K.test(e||"")||st.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,n){return[n<0?n+t:n]}),even:pt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:pt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:pt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:pt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ct(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=ht(n);dt.prototype=s.filters=s.pseudos,s.setFilters=new dt,a=st.compile=function(e,t){var n,r=[],i=[],s=N[e+" "];if(!s){t||(t=vt(e)),n=t.length;while(n--)s=Et(t[n]),s[b]?r.push(s):i.push(s);s=N(e,St(i,r))}return s},r.sortStable=b.split("").sort(k).join("")===b,r.detectDuplicates=C,c(),r.sortDetached=at(function(e){return e.compareDocumentPosition(h.createElement("div"))&1}),at(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ft("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!r.attributes||!at(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ft("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),at(function(e){return e.getAttribute("disabled")==null})||ft(j,function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),jQuery.find=st,jQuery.expr=st.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=st.uniqueSort,jQuery.text=st.getText,jQuery.isXMLDoc=st.isXML,jQuery.contains=st.contains}(window);var optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return u&&(!n||a)&&(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=s[0],u=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=core_slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?core_slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),jQuery.support=function(e){var t=document.createElement("input"),n=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("select"),s=i.appendChild(document.createElement("option"));return t.type?(t.type="checkbox",e.checkOn=t.value!=="",e.optSelected=s.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,t.checked=!0,e.noCloneChecked=t.cloneNode(!0).checked,i.disabled=!0,e.optDisabled=!s.disabled,t=document.createElement("input"),t.value="t",t.type="radio",e.radioValue=t.value==="t",t.setAttribute("checked","t"),t.setAttribute("name","t"),n.appendChild(t),e.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in window,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle=r.style.backgroundClip==="content-box",jQuery(function(){var t,n,i="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",s=document.getElementsByTagName("body")[0];if(!s)return;t=document.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(t).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",jQuery.swap(s,s.style.zoom!=null?{zoom:1}:{},function(){e.boxSizing=r.offsetWidth===4}),window.getComputedStyle&&(e.pixelPosition=(window.getComputedStyle(r,null)||{}).top!=="1%",e.boxSizingReliable=(window.getComputedStyle(r,null)||{width:"4px"}).width==="4px",n=r.appendChild(document.createElement("div")),n.style.cssText=r.style.cssText=i,n.style.marginRight=n.style.width="0",r.style.width="1px",e.reliableMarginRight=!parseFloat((window.getComputedStyle(n,null)||{}).marginRight)),s.removeChild(t)}),e):e}({});var data_user,data_priv,rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;Data.uid=1,Data.accepts=function(e){return e.nodeType?e.nodeType===1||e.nodeType===9:!0},Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))jQuery.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&typeof t=="string"&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,jQuery.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):(i=jQuery.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(core_rnotwhite)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},data_user=new Data,data_priv=new Data,jQuery.extend({acceptData:Data.accepts,hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length){o=data_user.get(i);if(i.nodeType===1&&!data_priv.get(i,"hasDataAttrs")){n=i.attributes;for(;s<n.length;s++)r=n[s].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.slice(5)),dataAttr(i,r,o[r]));data_priv.set(i,"hasDataAttrs",!0)}}return o}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):jQuery.access(this,function(t){var n,r=jQuery.camelCase(e);if(i&&t===undefined){n=data_user.get(i,e);if(n!==undefined)return n;n=data_user.get(i,r);if(n!==undefined)return n;n=dataAttr(i,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},delay:function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({attr:function(e,t){return jQuery.access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})},prop:function(e,t){return jQuery.access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=jQuery.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=arguments.length===0||typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?jQuery.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=jQuery(this),s=e.match(core_rnotwhite)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===core_strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,jQuery(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(jQuery.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(jQuery(r).val(),s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===core_strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.bool.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(core_rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!jQuery.support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(e,t){var n=jQuery.expr.attrHandle[t]||jQuery.find.attr;jQuery.expr.attrHandle[t]=function(e,t,r){var i=jQuery.expr.attrHandle[t],s=r?undefined:(jQuery.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return jQuery.expr.attrHandle[t]=i,s}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(e){return typeof jQuery===core_strundefined||!!e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(o.elem,arguments)},o.elem=e),t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=core_hasOwn.call(e,"type")?e.type:e,p=core_hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&jQuery.acceptData(s)&&f.apply&&f.apply(s,t)===!1&&e.preventDefault();return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=core_slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=document),e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){n++===0&&document.addEventListener(e,r,!0)},teardown:function(){--n===0&&document.removeEventListener(e,r,!0)}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if(typeof e!="string")return this.pushStack(jQuery(e).filter(function(){for(t=0;t<i;t++)if(jQuery.contains(r[t],this))return!0}));for(t=0;t<i;t++)jQuery.find(e,r[t],n);return n=this.pushStack(i>1?jQuery.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(winnow(this,e||[],!0))},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},is:function(e){return!!winnow(this,typeof e=="string"&&rneedsContext.test(e)?jQuery(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?core_indexOf.call(jQuery(e),this[0]):core_indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?jQuery(e,t):jQuery.makeArray(e&&e.nodeType?[e]:e),r=jQuery.merge(this.get(),n);return this.pushStack(jQuery.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return e.contentDocument||jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),rparentsprev.test(e)&&i.reverse()),this.pushStack(i)}}),jQuery.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(e){return jQuery.access(this,function(e){return e===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return jQuery.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=jQuery.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],s=e[t++];s&&(r&&r.parentNode!==s&&(r=this.nextSibling),jQuery(this).remove(),s.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=core_concat.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,p=e[0],d=jQuery.isFunction(p);if(d||!(l<=1||typeof p!="string"||jQuery.support.checkClone||!rchecked.test(p)))return this.each(function(r){var i=c.eq(r);d&&(e[0]=p.call(this,r,i.html())),i.domManip(e,t,n)});if(l){r=jQuery.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,r.childNodes.length===1&&(r=i);if(i){s=jQuery.map(getAll(r,"script"),disableScript),o=s.length;for(;f<l;f++)u=r,f!==h&&(u=jQuery.clone(u,!0,!0),o&&jQuery.merge(s,getAll(u,"script"))),t.call(this[f],u,f);if(o){a=s[s.length-1].ownerDocument,jQuery.map(s,restoreScript);for(f=0;f<o;f++)u=s[f],rscriptType.test(u.type||"")&&!data_priv.access(u,"globalEval")&&jQuery.contains(a,u)&&(u.src?jQuery._evalUrl(u.src):jQuery.globalEval(u.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),core_push.apply(r,n.get());return this.pushStack(r)}}),jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!jQuery.support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;l<c;l++){i=e[l];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(p,i.nodeType?[i]:i);else if(!rhtml.test(i))p.push(t.createTextNode(i));else{s=s||h.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;jQuery.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}}h.textContent="",l=0;while(i=p[l++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(h.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return h},cleanData:function(e){var t,n,r,i,s,o,u=jQuery.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(Data.accepts(n)){s=n[data_priv.expando];if(s&&(t=data_priv.cache[s])){r=Object.keys(t.events||{});if(r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?jQuery.event.remove(n,i):jQuery.removeEvent(n,i,t.handle);data_priv.cache[s]&&delete data_priv.cache[s]}}delete data_user.cache[n[data_user.expando]]}},_evalUrl:function(e){return jQuery.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var curCSS,iframe,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(e,t){return jQuery.access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||s==="number"&&isNaN(n))return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!jQuery.support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),curCSS=function(e,t,n){var r,i,s,o=n||getStyles(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(u===""&&!jQuery.contains(e.ownerDocument,e)&&(u=jQuery.style(e,t)),rnumnonpx.test(u)&&rmargin.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&rdisplayswap.test(jQuery.css(e,"display"))?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]={get:function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!manipulation_rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204||l.type==="HEAD"?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(ajax_rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+ajax_nonce++):r+(ajax_rquery.test(r)?"&":"?")+"_="+ajax_nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(ajax_rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrSupported=jQuery.ajaxSettings.xhr(),xhrSuccessStatus={0:200,1223:204},xhrId=0,xhrCallbacks={};window.ActiveXObject&&jQuery(window).on("unload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]();xhrCallbacks=undefined}),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,jQuery.support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(jQuery.support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s,o=e.xhr();o.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[s],t=o.onload=o.onerror=null,e==="abort"?o.abort():e==="error"?r(o.status||404,o.statusText):r(xhrSuccessStatus[o.status]||o.status,o.statusText,typeof o.responseText=="string"?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=xhrCallbacks[s=xhrId++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=rfxnum.exec(t),s=i&&i[3]||(jQuery.cssNumber[e]?"":"px"),o=(jQuery.cssNumber[e]||s!=="px"&&+r)&&rfxnum.exec(jQuery.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,jQuery.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var e,t=jQuery.timers,n=0;fxNow=jQuery.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){e()&&jQuery.timers.push(e)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length}),jQuery.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==core_strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return jQuery.access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return jQuery.access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof module=="object"&&module&&typeof module.exports=="object"?module.exports=jQuery:typeof define=="function"&&define.amd&&define("jquery",[],function(){return jQuery}),typeof window=="object"&&typeof window.document=="object"&&(window.jQuery=window.$=jQuery)})(window),window.Modernizr=function(e,t,n){function x(e){f.cssText=e}function T(e,t){return x(prefixes.join(e+";")+(t||""))}function N(e,t){return typeof e===t}function C(e,t){return!!~(""+e).indexOf(t)}function k(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:N(s,"function")?s.bind(r||t):s}return!1}var r="2.6.2",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l,c={}.toString,h="Webkit Moz O ms",p=h.split(" "),d=h.toLowerCase().split(" "),v={},m={},g={},y=[],b=y.slice,w,E={}.hasOwnProperty,S;!N(E,"undefined")&&!N(E.call,"undefined")?S=function(e,t){return E.call(e,t)}:S=function(e,t){return t in e&&N(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=b.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(b.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(b.call(arguments)))};return i}),v.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},v.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e};for(var L in v)S(v,L)&&(w=L.toLowerCase(),i[w]=v[L](),y.push((i[w]?"":"no-")+w));return i.addTest=function(e,t){if(typeof e=="object")for(var r in e)S(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof s!="undefined"&&s&&(o.className+=" "+(t?"":"no-")+e),i[e]=t}return i},x(""),a=l=null,function(e,t){function l(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function c(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function h(e){var t=a[e[o]];return t||(t={},u++,e[o]=u,a[u]=t),t}function p(e,n,s){n||(n=t);if(f)return n.createElement(e);s||(s=h(n));var o;return s.cache[e]?o=s.cache[e].cloneNode():i.test(e)?o=(s.cache[e]=s.createElem(e)).cloneNode():o=s.createElem(e),o.canHaveChildren&&!r.test(e)?s.frag.appendChild(o):o}function d(e,n){e||(e=t);if(f)return e.createDocumentFragment();n=n||h(e);var r=n.frag.cloneNode(),i=0,s=c(),o=s.length;for(;i<o;i++)r.createElement(s[i]);return r}function v(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?p(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function m(e){e||(e=t);var n=h(e);return g.shivCSS&&!s&&!n.hasCSS&&(n.hasCSS=!!l(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),f||v(e,n),e}var n=e.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,i=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,s,o="_html5shiv",u=0,a={},f;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,f=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){s=!0,f=!0}})();var g={elements:n.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:n.shivCSS!==!1,supportsUnknownElements:f,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:m,createElement:p,createDocumentFragment:d};e.html5=g,m(t)}(this,t),i._version=r,i._domPrefixes=d,i._cssomPrefixes=p,o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+y.join(" "):""),i}(this,this.document),function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c=t.createElement(e),d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[]),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,u){var a=t(e),f=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]),a.instead?a.instead(e,i,s,o,u):(T[a.url]?a.noexec=!0:T[a.url]=1,s.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":n,a.noexec,a.attrs,a.timeout),(r(i)||r(f))&&s.load(function(){l(),i&&i(a.origUrl,u,o),f&&f(a.origUrl,u,o),T[a.url]=2})))}function u(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var a,f,c=this.yepnope.loader;if(i(e))o(e,0,c,0);else if(S(e))for(a=0;a<e.length;a++)f=e[a],i(f)?o(f,0,c,0):S(f)?k(f):Object(f)===f&&u(f,c);else Object(e)===e&&u(e,c)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("cookies",function(){if(navigator.cookieEnabled)return!0;document.cookie="cookietest=1";var e=document.cookie.indexOf("cookietest=")!=-1;return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}),tagproConfig={},tagpro={version:"3.2.1",socket:null,players:null,chat:null,playerId:null,teamNames:null,score:null,state:null,sound:null,zoom:1,zooming:0,serverPort:null,serverHost:null,socketPort:null,socketHost:null,viewport:{followPlayer:!0,centerLock:!1,source:{x:0,y:0}},TILE_SIZE:40,kongregate:!1,settings:{ui:{allChat:!0,teamChat:!0,groupChat:!0,systemChat:!0,tutorialChat:!1,spectatorInfo:!0,performanceInfo:!0,names:!0,teamNames:"always",degrees:!0,matchState:!0}},keys:{left:[37,65,97],up:[38,87,119],right:[39,68,100],down:[40,83,115],space:[32],chatToTeam:[222,84],chatToGroup:[186,71,103],chatToAll:[13],chatAsMod:[],sendChat:[13],cancelChat:[27],nickCompleteChat:[9],showOptions:[27],zoomOut:[173,189,109],zoomIn:[61,187,107],resetZoom:[90],centerZoom:[67],specNext:[81],specPrev:[87],specRedFC:[65],specBlueFC:[83],toggleAutoJoin:[32]},ping:{current:0,history:[],avg:0},host:document.location.host,gameEndsAt:null,disableControls:0,spectator:!1,spectators:0,movement:[],joinGame:function(e){location.href=e},api:{redrawBackground:function(){console.error("The redrawBackground function has been deprecated.")}},events:{register:function(e){for(var t in e)tagpro.events[t]||(tagpro.events[t]=[]),eventFunc={},eventFunc[t]=e[t],tagpro.events[t].push(eventFunc)}},resourcesLoaded:!1,_readyCallbacks:[],_afterReadyCallbacks:[],ready:function(e){if(tagpro.resourcesLoaded){e();return}tagpro._readyCallbacks.push(e)}},tagpro.ready.after=function(e){tagpro.resourcesLoaded?e():tagpro._afterReadyCallbacks.push(e)},$(document).ready(function(){function e(e,t){var n=$.cookie(e);$.removeCookie(e);var r=$.cookie(e)==undefined;(n==undefined||r)&&$.cookie(e,n||t,{expires:36500,path:"/",domain:tagproConfig.cookieHost})}function n(e){var t=0,n,r,i;if(e.length==0)return t;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t}function r(){tagpro.resourcesLoaded=!0,tagpro._readyCallbacks.forEach(function(e){e()}),tagpro._readyCallbacks=[],tagpro._afterReadyCallbacks.forEach(function(e){e()}),tagpro._afterReadyCallbacks=[]}e("music","false"),e("sound","true"),e("disableParticles","false"),e("forceCanvasRenderer","false"),e("disableViewportScaling","true"),e("disableTutorialChat","false"),e("tileRespawnWarnings","blink"),$(".js-copyright-date").text((new Date).getFullYear());if(window.location.pathname!="/kongregate"&&window.location.pathname!="/auth/link-accounts/close"){tagpro.kongregate=!!$.cookie("kongregate");if(!tagproConfig.isHomeServer&&window.self===window.top){$.removeCookie("kongregate",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-username",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-token",{domain:tagproConfig.cookieHost}),$.removeCookie("kongregate-userId",{domain:tagproConfig.cookieHost});if(tagpro.kongregate)return document.location.href="/logout";tagpro.kongregate=!1}}if(window.location.pathname!="/kongregate"&&tagpro.kongregate){var t=["tagpro.gg","koalabeast.com","localhost","jukejuice.com","127.0.0.1"];$("a").each(function(){var e=$(this),n=e.attr("href");if(!n)return;n=n.toLowerCase();var r=!t.some(function(e){return n.indexOf(e)>-1});r&&n.substr(0,4)!="http"&&(r=!1),e.hasClass("ensureExternal")&&(r=!0),r&&e.attr("target","_parent")})}setTimeout(function(){var e=$("#loadingMessage"),t=$("#assets img"),n=0;t.each(function(){$(this).prop("crossOrigin","Anonymous").attr("src",$(this).attr("src"))}),setTimeout(function(){if(tagpro.resourcesLoaded)return;t.not("[data-load]").each(function(){e.append($("<div></div>").css({"font-weight":"normal","font-size":"50%"}).text($(this).attr("id")+"..."))})},1e4);var i=function(){t.each(function(){var e=$(this)[0];if(e.loaded)return;e.complete&&e.naturalWidth>0&&(e.loaded=!0,n++)}),n<t.length?setTimeout(i,0):r()};i()},0),$(".header .nav .group-indicator").bind("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){this.classList.remove("js-animate"),this.offsetWidth=this.offsetWidth,this.classList.add("js-animate")}).addClass("js-animate"),$(".header .nav .mobile-menu-toggle").click(function(){$(".header .nav").toggleClass("mobile-expanded").find("li").slideToggle()}),window.onerror=function(){if($(".js-console-error").length)return;message="We are seeing some odd errors. This could have something to do with your TagPro addons and scripts. You might need to disable them until they are updated by the author.";var e=tagpro.helpers.displayError(message);e.find(".msg").addClass("js-console-error")}}),$(document).keydown(function(e){if(e.keyCode!=8)return;var t=e.target.nodeName.toLowerCase();if(t=="input"||t=="textarea")return;e.preventDefault()}),tagpro.helpers={pad:function(e,t){e=e.toString(),t=t.toString();var n=t+e,r=t.length>e.length?t.length:e.length;return n.substr(n.length-r)},timeFromSeconds:function(e,t){t==undefined&&(t=!1);var n=tagpro.helpers.pad;e=parseFloat(e);var r=parseInt(e/3600),i=parseInt(e/60)%60,s=e%60,o=n(i,"00")+":"+n(s,"00");if(!t||r>0)o=n(r,"00")+":"+o;return o},rebaseToCDN:function(e){return e.charAt(0)=="/"&&e.charAt(1)!="/"?"http://"+tagproConfig.cdn+e:e},displayError:function(e){var t=$("<div></div>").addClass("col-md-8 col-md-offset-2"),n=$("<div></div>").addClass("msg msg-warning").css("margin-bottom",20);return n.text(e),t.append(n),$("body:not(.game-page) > .container > .row").first().prepend(t),t}},$(window).on("load",restoreFocus()),$(document).ready(function(){$(document).find("#viewport").click(function(){setTimeout(restoreFocus(),100)})}),tagpro.sendPingStatistics=function(){return;var e},function(){function r(e,t){e instanceof Uint8Array||(e.buffer instanceof ArrayBuffer?e=new Uint8Array(e.buffer):e=new Uint8Array(e));var r=~~t^-1;for(var i=0;i<e.length;i++)r=n[(r^e[i])&255]^r>>>8;return r^-1}var e={};e.DEBUG=!1,e.cache={},e.clearCache=function(){this.cache={}},e.uid=function(){var n=this.data();return t(n.canvasFingerprint+":"+t(n.fonts.join(":"))+":"+JSON.stringify(n.screen)+":"+JSON.stringify(n.browser)+":"+JSON.stringify(n.webgl)+":"+JSON.stringify(e.pluginNames()))},e.match=function(t){return e.uid()===t},e.data=function(){return{canvasFingerprint:e.canvas(),fonts:e.fonts(),browser:e.browser(),plugins:e.pluginNames(),screen:e.screen(),webgl:e.webgl()}},e.screen=function(){return{width:screen.width,height:screen.height,colorDepth:screen.colorDepth,pixelDepth:screen.pixelDepth}},e.browser=function(){return{userAgent:navigator.userAgent,cookies:navigator.cookieEnabled,java:navigator.javaEnabled(),dnt:navigator.doNotTrack,lang:navigator.language}},e.PLUGINS=["Google Talk Plugin Video Renderer","Google Talk Plugin","Java Applet Plug-in","QuickTime Plug-in 7.7.3","Default Browser Helper","Shockwave Flash","AdobeAAMDetect","AdobeExManDetect","iPhotoPhotocast","SharePoint Browser Plug-in","Google Earth Plug-in","RealPlayer Plugin.plugin","DivX Web Player","Wacom Pressure Plug-In","Microsoft Office Live Plug-in","Widevine Content Decryption Module","Chrome Remote Desktop Viewer","Chrome PDF Viewer","Native Client","Google Talk Plugin Video Renderer","Unity Player","Default Browser Helper","Silverlight Plug-In","Wacom Tablet Plug-In","WebKit-integrierte PDF"],e.plugins=function(){if(!navigator.plugins)return null;var e=[];return this.PLUGINS.forEach(function(t){var n=navigator.plugins[t];n!==undefined&&(e[t]=n)}),e.sort()},e.pluginNames=function(){return navigator.plugins?this.PLUGINS.filter(function(e){return navigator.plugins[e]!==undefined?!0:!1}):null},e.canvas=function(){if(e.cache.canvas!==undefined)return e.cache.canvas;var t=document.createElement("canvas");t.width=280,t.height=60,this.DEBUG||(t.style.display="none"),t.id="beaver-bird-canvas",document.body.appendChild(t);var n=t.getContext("2d"),i="BeaverBird is watching you";n.fillStyle="rgb(178, 214, 232)",n.fillRect(10,20,60,80),n.fillStyle="#111",n.font="16pt Arial",n.fillText(i,2,40),n.strokeStyle="rgb(120, 186, 176)",n.arc(80,10,20,0,Math.PI),n.stroke();var s=n.getImageData(0,0,280,60);this.DEBUG||document.body.removeChild(t);var o=r(s.data).toString();return e.cache.canvas=o,o},e.matchCanvas=function(t){return t===e.canvas()},e.fonts=function(t){if(this.cache.fonts!==undefined)return this.cache.fonts;var n=["Arial","Times New Roman","Helvetica","Open Sans","Source Sans Pro","Comic Sans MS","Century","Century Gothic","Monaco","Lato","Geneva","Futura","Fantasque Sans Mono","Courier","Courier New","Corsiva Hebrew","Comic Neue","Cambria","Calibri","TI-Nspire","Adobe Braille","Adobe Hebrew","Apple LiGothic","Apple Farben-Emoji","Avenir","Avenir Next","Batang","Bell MT","Birch Std","Damascus","Microsoft Sans Serif","Minion Pro","Times","Roboto","Oswald","Droid Sans","Droid Serif","Roboto Condensed","Ubuntu","Raleway","Lobster","Ubuntu Condensed","Helvetica Neue"];typeof t!="undefined"&&(n=t);var r="wwzrllTNMLllllliiimmqÃmmmmiiillâï¸ð»llplÃ¶ðÂ©_~Ã±",i=[{name:"serif"},{name:"sans-serif"},{name:"monospace"}],s=document.createElement("span");s.innerHTML=r,s.style.fontSize="86px",i.forEach(function(e){s.style.fontFamily=e.name,document.body.appendChild(s),e.width=s.offsetWidth,e.height=s.offsetHeight,document.body.removeChild(s)}),this.DEBUG&&console.log(i);var o=[];n.forEach(function(t){var n=!1;i.forEach(function(e){s.style.fontFamily=t+","+e.name,document.body.appendChild(s);if(s.offsetWidth!==e.width||s.offsetHeight!==e.height)n=!0;document.body.removeChild(s)}),n&&(e.DEBUG&&console.log("found font:",t),o.push(t))}),e.DEBUG&&console.log("found",o.length,"fonts");var u=o.sort();return this.cache.fonts=u,u},e.matchFonts=function(e){var t=this.fonts(),n=!1;return e.forEach(function(e){t.indexOf(e)===-1&&(n=!0)}),!n},e.WEBGL_PARAMETERS=["VENDOR","RENDERER","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_RENDERBUFFER_SIZE","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],e.webgl=function(){var e={},t=document.createElement("canvas"),n=function(t){if(!window.WebGLRenderingContext)return null;var n=null;try{n=t.getContext("webgl")||t.getContext("moz-webgl")||t.getContext("experimental-webgl")||t.getContext("webkit-3d")}catch(r){}return n}(t);return n===null?null:(e.parameters={},this.WEBGL_PARAMETERS.forEach(function(t){n[t.toUpperCase()]!==undefined&&(e.parameters[t.toLowerCase()]=n.getParameter(n[t.toUpperCase()]))}),e.extensions=n.getSupportedExtensions(),e)},typeof module!="undefined"&&module.exports?module.exports=e:window.BeaverBird=e;var t;(function(){"use strict";var e=function(e,t){return e+t&4294967295},n=function(t,n,r,i,s,o){return n=e(e(n,t),e(i,o)),e(n<<s|n>>>32-s,r)},r=function(e,t,r,i,s,o,u){return n(t&r|~t&i,e,t,s,o,u)},i=function(e,t,r,i,s,o,u){return n(t&i|r&~i,e,t,s,o,u)},s=function(e,t,r,i,s,o,u){return n(t^r^i,e,t,s,o,u)},o=function(e,t,r,i,s,o,u){return n(r^(t|~i),e,t,s,o,u)},u=function(t,n){var u=t[0],a=t[1],f=t[2],l=t[3];u=r(u,a,f,l,n[0],7,-680876936),l=r(l,u,a,f,n[1],12,-389564586),f=r(f,l,u,a,n[2],17,606105819),a=r(a,f,l,u,n[3],22,-1044525330),u=r(u,a,f,l,n[4],7,-176418897),l=r(l,u,a,f,n[5],12,1200080426),f=r(f,l,u,a,n[6],17,-1473231341),a=r(a,f,l,u,n[7],22,-45705983),u=r(u,a,f,l,n[8],7,1770035416),l=r(l,u,a,f,n[9],12,-1958414417),f=r(f,l,u,a,n[10],17,-42063),a=r(a,f,l,u,n[11],22,-1990404162),u=r(u,a,f,l,n[12],7,1804603682),l=r(l,u,a,f,n[13],12,-40341101),f=r(f,l,u,a,n[14],17,-1502002290),a=r(a,f,l,u,n[15],22,1236535329),u=i(u,a,f,l,n[1],5,-165796510),l=i(l,u,a,f,n[6],9,-1069501632),f=i(f,l,u,a,n[11],14,643717713),a=i(a,f,l,u,n[0],20,-373897302),u=i(u,a,f,l,n[5],5,-701558691),l=i(l,u,a,f,n[10],9,38016083),f=i(f,l,u,a,n[15],14,-660478335),a=i(a,f,l,u,n[4],20,-405537848),u=i(u,a,f,l,n[9],5,568446438),l=i(l,u,a,f,n[14],9,-1019803690),f=i(f,l,u,a,n[3],14,-187363961),a=i(a,f,l,u,n[8],20,1163531501),u=i(u,a,f,l,n[13],5,-1444681467),l=i(l,u,a,f,n[2],9,-51403784),f=i(f,l,u,a,n[7],14,1735328473),a=i(a,f,l,u,n[12],20,-1926607734),u=s(u,a,f,l,n[5],4,-378558),l=s(l,u,a,f,n[8],11,-2022574463),f=s(f,l,u,a,n[11],16,1839030562),a=s(a,f,l,u,n[14],23,-35309556),u=s(u,a,f,l,n[1],4,-1530992060),l=s(l,u,a,f,n[4],11,1272893353),f=s(f,l,u,a,n[7],16,-155497632),a=s(a,f,l,u,n[10],23,-1094730640),u=s(u,a,f,l,n[13],4,681279174),l=s(l,u,a,f,n[0],11,-358537222),f=s(f,l,u,a,n[3],16,-722521979),a=s(a,f,l,u,n[6],23,76029189),u=s(u,a,f,l,n[9],4,-640364487),l=s(l,u,a,f,n[12],11,-421815835),f=s(f,l,u,a,n[15],16,530742520),a=s(a,f,l,u,n[2],23,-995338651),u=o(u,a,f,l,n[0],6,-198630844),l=o(l,u,a,f,n[7],10,1126891415),f=o(f,l,u,a,n[14],15,-1416354905),a=o(a,f,l,u,n[5],21,-57434055),u=o(u,a,f,l,n[12],6,1700485571),l=o(l,u,a,f,n[3],10,-1894986606),f=o(f,l,u,a,n[10],15,-1051523),a=o(a,f,l,u,n[1],21,-2054922799),u=o(u,a,f,l,n[8],6,1873313359),l=o(l,u,a,f,n[15],10,-30611744),f=o(f,l,u,a,n[6],15,-1560198380),a=o(a,f,l,u,n[13],21,1309151649),u=o(u,a,f,l,n[4],6,-145523070),l=o(l,u,a,f,n[11],10,-1120210379),f=o(f,l,u,a,n[2],15,718787259),a=o(a,f,l,u,n[9],21,-343485551),t[0]=e(u,t[0]),t[1]=e(a,t[1]),t[2]=e(f,t[2]),t[3]=e(l,t[3])},a=function(e){var t=[],n;for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t},f=function(e){var t=[],n;for(n=0;n<64;n+=4)t[n>>2]=e[n]+(e[n+1]<<8)+(e[n+2]<<16)+(e[n+3]<<24);return t},l=function(e){var t=e.length,n=[1732584193,-271733879,-1732584194,271733878],r,i,s,o,f,l;for(r=64;r<=t;r+=64)u(n,a(e.substring(r-64,r)));e=e.substring(r-64),i=e.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<i;r+=1)s[r>>2]|=e.charCodeAt(r)<<(r%4<<3);s[r>>2]|=128<<(r%4<<3);if(r>55){u(n,s);for(r=0;r<16;r+=1)s[r]=0}return o=t*8,o=o.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=f,s[15]=l,u(n,s),n},c=function(e){var t=e.length,n=[1732584193,-271733879,-1732584194,271733878],r,i,s,o,a,l;for(r=64;r<=t;r+=64)u(n,f(e.subarray(r-64,r)));e=r-64<t?e.subarray(r-64):new Uint8Array(0),i=e.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<i;r+=1)s[r>>2]|=e[r]<<(r%4<<3);s[r>>2]|=128<<(r%4<<3);if(r>55){u(n,s);for(r=0;r<16;r+=1)s[r]=0}return o=t*8,o=o.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=a,s[15]=l,u(n,s),n},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],p=function(e){var t="",n;for(n=0;n<4;n+=1)t+=h[e>>n*8+4&15]+h[e>>n*8&15];return t},d=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=p(e[t]);return e.join("")},v=function(e){return d(l(e))};v("hello")!=="5d41402abc4b2a76b9719d911017c592"&&(e=function(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}),t=function(e,t){/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var n=l(e);return t?n:d(n)}})();var n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]}(),$(document).ready(function(){(window.location.port==tagproConfig.serverPort||window.location.port=="")&&$.post("/fingerprint",{id:BeaverBird.uid()})}),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof exports=="object"?e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(arguments.length>1&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}});if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")}(jQuery),+function(e){"use strict";function t(t,r){return this.each(function(){var s=e(this),u=s.data("bs.modal"),a=e.extend({},n.DEFAULTS,s.data(),"object"==typeof t&&t);u||s.data("bs.modal",u=new n(this,a)),"string"==typeof t?u[t](r):a.show&&u.show(r)})}var n=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.6",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},n.prototype.show=function(t){var r=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0)})}),this.backdrop(function(){var i=e.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.adjustDialog(),i&&r.$element[0].offsetWidth,r.$element.addClass("in"),r.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:t});i?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(n.TRANSITION_DURATION):r.$element.trigger("focus").trigger(s)}))},n.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(t){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&i;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){return this.ignoreBackdropClick?void (this.ignoreBackdropClick=!1):void (e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var u=function(){r.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):u()}else t&&t()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=n,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var r=e(this),i=r.attr("href"),s=e(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},s.data(),r.data());r.is("a")&&n.preventDefault(),s.one("show.bs.modal",function(e){e.isDefaultPrevented()||s.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),t.call(s,o,this)})}(jQuery);var Stats=function(){var e=Date.now(),t=e,n=0,r=Infinity,i=0,s=0,o=Infinity,u=0,a=0,f=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(e){e.preventDefault(),y(++f%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var c=document.createElement("div");c.id="fps",c.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(c);var h=document.createElement("div");h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",c.appendChild(h);var p=document.createElement("div");p.id="fpsGraph",p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(c.appendChild(p);74>p.children.length;){var d=document.createElement("span");d.style.cssText="width:1px;height:30px;float:left;background-color:#113",p.appendChild(d)}var v=document.createElement("div");v.id="ms",v.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(v);var m=document.createElement("div");m.id="msText",m.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="MS",v.appendChild(m);var g=document.createElement("div");g.id="msGraph",g.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(v.appendChild(g);74>g.children.length;)d=document.createElement("span"),d.style.cssText="width:1px;height:30px;float:left;background-color:#131",g.appendChild(d);var y=function(e){f=e;switch(f){case 0:c.style.display="block",v.style.display="none";break;case 1:c.style.display="none",v.style.display="block"}};return{REVISION:12,domElement:l,setMode:y,begin:function(){e=Date.now()},end:function(){var f=Date.now();n=f-e,r=Math.min(r,n),i=Math.max(i,n),m.textContent=n+" MS ("+r+"-"+i+")";var l=Math.min(30,30-30*(n/200));return g.appendChild(g.firstChild).style.height=l+"px",a++,f>t+1e3&&(s=Math.round(1e3*a/(f-t)),o=Math.min(o,s),u=Math.max(u,s),h.textContent=s+" FPS ("+o+"-"+u+")",l=Math.min(30,30-30*(s/100)),p.appendChild(p.firstChild).style.height=l+"px",t=f,a=0),f},update:function(){e=this.end()}}};"object"==typeof module&&(module.exports=Stats),$(document).ready(function(){if($("html").hasClass("no-cookies")){location.href="http://"+tagproConfig.serverHost+"/cookies";return}});var Sprite=function(e,t,n,r){var i={};this.createAnimation=function(e,t,n){return i[e]=new Sprite.Animation(t,n),i[e]},this.createInstance=function(s){return{start:(new Date).getTime(),animation:s,draw:function(n,r,s){var o=i[this.animation],u=Math.floor(((new Date).getTime()-this.start)%(o.frames.length*o.time)/o.time);n.drawImage(e,o.frames[u]*40,o.y*40,t,t,r,s,t,t)},drawFloor:n||!1,redrawFloor:r||!1}}};Sprite.Animation=function(e,t){this.y=e,this.time=t,this.frames=[],this.createFrame=function(e){this.frames.push(e)}},$(document).ready(function(){function e(e){var t=tagpro.pingTestServers,n=[],r=function(r,i){n.push({id:r.id,ping:i}),n.length===t.length&&(n=n.sort(function(e,t){return e.ping-t.ping}),e(n))};t.forEach(function(e){var t=io.connect("ws://"+e.host,{transports:["websocket"]});t.on("connect_error",function(){r(e,9999)}),t.on("connect",function(){var n=Date.now(),i=9999,s=0,o=function(){s++,s===0&&(t.disconnect(),r(e,i))},u=function(){s--;var e=setTimeout(o,5e3);t.emit("pingg",{},function(t){clearTimeout(e);var r=Date.now()-n+Math.random()*10;i=Math.min(i,r),o()})};u(),u(),u()})})}function t(e){var t=$("a.js-server"),n=0,r=function(){n++,n>=t.length&&e&&e()};t.each(function(){var e=$(this),n=io.connect("ws://"+e.attr("data-host")+":80",{transports:["websocket"]}),i=setTimeout(function(){e.find(".stats").text("error getting stats.").end(),tagpro.pingTest.showAll&&e.removeClass("js-hide"),r()},5e3);n.on("connect",function(){var s=(new Date).getTime();n.emit("stats",{},function(n){n.ping=(new Date).getTime()-s,clearTimeout(i),e.attr("data-ping",n.ping).find(".stats").text("Ping: "+n.ping+", Players: "+n.players+(n.playerCapacity?"/"+n.playerCapacity:"")),tagpro.pingTest.showAll||t.addClass("js-hide"),$("a.js-server").not(e).each(function(t){var r=$(this);tagpro.pingTest.showAll&&e.removeClass("js-hide");if(n.ping<parseInt(r.attr("data-ping")))return e.insertBefore(r),!1}),tagpro.pingTest.showAll||$("a.js-server").eq(0).removeClass("js-hide"),r()})})})}tagpro.oldPingTest={showAll:!0},tagpro.oldPingTest.run=t,tagpro.pingTest={showAll:!0},tagpro.pingTest.run=e}),tagpro.createSocket=function(){var e=io.connect(tagproConfig.gameSocket||document.location.href+"?r="+Math.round(Math.random()*1e7),{reconnect:!1});return tagpro.rawSocket=e,{on:function(t,n){var r=function(){try{n.apply(this,arguments)}catch(i){console.error("Unhandled socket.io on() error. Mod makers, handle your errors!"),console.error(i),e.removeListener(t,r)}};e.on(t,r)},emit:function(t,n){e.emit(t,n)}}},tagpro.createJoinerSocket=function(e){function s(e,t){var n=("Region "+e).replace(/\s/g,"_").toLowerCase();$('#regions .js-cookie[name="'+n+'"]').prop("checked",t)}function o(){return $("#regions .js-cookie:checked").map(function(){var e=$(this).data("region");return e}).get()}function u(e,t){var n=("Game Mode "+e).replace(/\s/g,"_").toLowerCase();$('#gameModes .js-cookie[name="'+n+'"]').prop("checked",t)}function a(){return $("#gameModes .js-cookie:checked").map(function(){var e=$(this).data("mode");return e}).get()}e!==!0&&(e=!1),tagpro.group&&tagpro.group.socket&&(tagpro.group.socket.playerLocation="joining"),$("#settings .js-cookie").each(function(){var e=$(this).attr("name"),t=$.cookie(e);typeof t=="string"&&(t=t==="true"),t=!!t,$(this).prop("checked",t)}),window.location.search.indexOf("events=1")!==-1&&$("#gameModes .js-cookie").each(function(){var e=$(this).data("mode"),t=$(this).data("modetype")==="event";u(e,t)});var t=Math.round(Math.random()*1e7),n=io.connect("http://"+tagproConfig.socketHost+"/games/find?r="+t),r=[],i;tagpro.rawJoinerSocket=n,$("#settings .btn.js-send-settings").click(function(){regions=o(),gameModes=a(),n.connected||($("#message").text("Connecting"),$("#subMessage").text(""),clearTimeout(i),n.connect()),$("#settings .js-cookie").each(function(){var e=$(this).prop("name"),t=!!$(this).prop("checked");$.cookie(e,t,{expires:36500,path:"/",domain:tagproConfig.cookieHost})}),n.emit("settings",{regions:regions,gameModes:gameModes})}),n.on("connect",function(){$("#spinner").show(),regions=o(),gameModes=a(),n.emit("settings",{regions:regions,gameModes:gameModes}),n.emit("spectate",e)}),n.on("settings",function(e,t,n){s("US East",!1),s("US West",!1),s("Europe",!1),s("Oceanic",!1),u("classic",!1);var r=e.regions;r.forEach(function(e){s(e,!0)});var i=e.gameModes;i.forEach(function(e){u(e,!0)}),t&&($("#settings .title").text("Group's Settings"),$("#settings .js-send-settings").hide(),$("#settings .js-cookie").prop("disabled",!0)),t||($("#settings .js-cookie").prop("disabled",!1),$("#settings .js-send-settings").show(),$("#settings .title").text("Settings")),$("#settings").show(),$("#joiner").show()}),n.on("ServerList",function(e){tagpro.pingTestServers=e,tagpro.pingTest.showAll=!1,tagpro.pingTest.run(function(e){r=e,n&&n.connected&&n.emit("pings",r)})}),n.on("WaitingForMembers",function(e){var t=Math.round(e/1e3);$("#message").text("Waiting on your group "+t)}),n.on("TrollControl",function(e){var t=Math.round(e/1e3);$("#message").text("Your ip has been flagged, waiting "+t),$("#flagged").show()}),n.on("WaitForEligibility",function(e){var t=Math.round(e/1e3);$("#message").text("Waiting for game eligibility "+t)}),n.on("CreatingWorld",function(){$("#message").text("Creating a new game")}),n.on("Full",function(e){if(e.considering){$("#message").text("Considering Servers:"),$("#subMessage").html(e.considering.join("<br />"));return}$("#message").text("Wow! All games are full. Waiting")}),n.on("Disabled",function(){$("#message").html("Sorry, this is a map testing server. <br> Joining is disabled."),$(".spinner").addClass("disable")}),n.on("FoundWorld",function(t){n.disconnect(),timeout=1e3,e||(timeout=0),tagpro.joinGameTimer=setTimeout(function(){t.spectate?$("#message").text("Spectating game"):$("#message").text("Joining game");if(tagproConfig&&tagproConfig.gameServer===t.s&&tagproConfig.gameId===t.g&&t.spectate===!1)return;document.location.href=t.url},timeout)}),n.on("GroupLeaderNotInTheJoiner",function(e){n.disconnect(),$("#message").text("The Group Leader is not in the joiner. Back to group"),setTimeout(function(){document.location.href="http://"+document.location.host+"/groups/"+e.groupId},2e3)}),n.on("disconnect",function(){$("#spinner").hide(),i=setTimeout(function(){$("#message").text("Lost connection")},5e3)})},tagpro.disconnectJoinerSocket=function(){tagpro.joinGameTimer&&clearTimeout(tagpro.joinGameTimer),tagpro.rawJoinerSocket&&(tagpro.rawJoinerSocket.removeAllListeners("disconnect"),tagpro.rawJoinerSocket.disconnect()),$("#joiner").hide()},tagpro.group={socket:null},$(document).ready(function(){function n(){setTimeout(n,3e4);if(!t.connected)return;t.emit("touch",t.playerLocation)}var e=$("#groupId").val();if(!e||e=="null")return;var t=io.connect("http://"+tagproConfig.socketHost+"/groups/"+e+"?r="+Math.round(Math.random()*1e7));t.playerLocation=null,tagpro.group.socket=t,setTimeout(n,3e3)}),tagpro.ready(function(){function h(e,t,n){var i=Math.abs(n);if(e.lastSync[t]==undefined||i>e.lastSync[t])e[t]=n>0,e.lastSync[t]=i,r[u]===e&&i>b&&(b=i)}function p(e){function t(e){var t=[0,0,0,0],n=[1,1,1,1],r=[3,0,4,2];if(e=="1")return n;if(Math.floor(e)=="1"){for(offset=Number((e+"").substr(-1))-1;offset>0;offset--)r.unshift(r.pop());return r}return t}function n(e,t){return quadArray=[0,0,0,0],baseMap[e]&&(baseMap[e][t]&&(quadArray[0]=baseMap[e][t][0]),baseMap[e][t-1]&&(quadArray[3]=baseMap[e][t-1][3])),baseMap[e-1]&&(baseMap[e-1][t]&&(quadArray[1]=baseMap[e-1][t][1]),baseMap[e-1][t-1]&&(quadArray[2]=baseMap[e-1][t-1][2])),quadArray}function r(e,t,n){subMap[e]&&(subMap[e][t]&&(subMap[e][t][0]=n[0]),subMap[e][t-1]&&(subMap[e][t-1][3]=n[3])),subMap[e-1]&&(subMap[e-1][t]&&(subMap[e-1][t][1]=n[1]),subMap[e-1][t-1]&&(subMap[e-1][t-1][2]=n[2]))}function s(e,t){function v(e,t){e||(o.push(s),u=!u),s+=t}var i=n(e,t),s=0,o=[],u=(i[3]==1||i[3]==2||i[3]==3)&&(i[0]==1||i[0]==2||i[0]==4),a=u;if(i[0]+i[1]+i[2]+i[3]==0)return r(e,t,i);if(!(i[0]!=1&&i[0]!=2||i[1]!=1&&i[1]!=2||i[2]!=1&&i[2]!=2||i[3]!=1&&i[3]!=2)){for(k=0;k<4;k++){var f=i[k]==2?"d":"";i[k]="1."+(k+1)+"00"+f}return r(e,t,i)}for(k=0;k<4;k++){var c=i[k];c==0?v(!u,2):c==1||c==2?v(u,2):c==3?(v(!u,1),v(u,1)):c==4&&(v(u,1),v(!u,1))}a?o.push(o.shift()):u&&o.push(0);for(k=0;k<o.length;k+=2)for(l=0;l<4;l++){var h=(o[k]+6*l)%8,p=(o[k+1]+6*l)%8;if(h<p&&(h<2||p==2||p==1)||h>p&&(p>0||h<2)){var d=i[l]==2?"d":"";i[l]="1."+(l+1)+o[k]+o[k+1]+d}}r(e,t,i)}baseMap=[],subMap=[];for(i=0;i<e.length;i++){baseMap[i]=[],subMap[i]=[];for(j=0;j<e[0].length;j++)baseMap[i][j]=t(e[i][j]),subMap[i][j]=[]}for(i=0;i<=e.length;i++)for(j=0;j<=e[0].length;j++)s(i,j);return subMap}function d(e){function s(r,i){var s=!0,o,u=[r,i],a=[],f={};while(u.length>0){var l=u.shift(),c=u.shift();if(f[l+","+c])continue;f[l+","+c]=!0;var h=e[l]&&e[l][c]||0;if(t.indexOf(h)!=-1)o!==undefined&&o!=h?o=2:o=h;else{var p=tagpro.tiles[e[l][c]];if(p&&p.drawFloor){p.redrawFloor&&(s=!1);var d=Array.isArray(p.drawFloor)?p.drawFloor:[{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}];d.forEach(function(t){var n=l+t.x,r=c+t.y;if(e[n]&&e[n][r]&&tagpro.tiles[e[n][r]]&&Array.isArray(tagpro.tiles[e[n][r]].drawFloor)&&!tagpro.tiles[e[n][r]].drawFloor.some(function(e){return e.x==-t.x&&e.y==-t.y}))return;u.push(n),u.push(r)}),a.push(l),a.push(c)}}}if(o===undefined||!o&&!s)o=2;while(a.length>0){var l=a.shift(),c=a.shift();n[l][c]=o}}var t=[0,2,11,12,17,18,23],n=[];for(var r=0;r<e.length;r++){n[r]=[];for(var i=0;i<e[0].length;i++)n[r][i]=-1}for(var r=0;r<e.length;r++)for(var i=0;i<e[0].length;i++)n[r][i]==-1&&tagpro.tiles[e[r][i]]&&tagpro.tiles[e[r][i]].drawFloor&&s(r,i);return n}function v(e,t,n,r){if(n){var i=e.volume+t;i>1&&(i=1),i<0&&(i=0),e.volume=i,e.rampTimeout=setTimeout(function(){v(e,t,n-1,r)},10);return}r&&r()}function w(e,n){var i;n?i="keyup":i="keydown";var s=r[u];if(!s)return;if(!s.pressing[e]&&i=="keydown"||s.pressing[e]&&i=="keyup"){var o=b++;s.pressing[e]=!n,t.emit(i,{k:e,t:o}),tagpro.ping.avg&&setTimeout(function(){h(s,e,o)},tagpro.ping.avg/2)}}function E(e){zoomCursor=e?zoomCursor+1:zoomCursor-1,zoomCursor>=zoomValues.length&&(zoomCursor=zoomValues.length-1),zoomCursor<0&&(zoomCursor=0)}function S(e){tagpro.keys.specNext.indexOf(e.keyCode)!=-1&&(t.emit("next"),tagpro.viewport.centerLock=!1),tagpro.keys.specPrev.indexOf(e.keyCode)!=-1&&(t.emit("prev"),tagpro.viewport.centerLock=!1),tagpro.keys.specRedFC.indexOf(e.keyCode)!=-1&&(t.emit("redflagcarrier"),tagpro.viewport.centerLock=!1),tagpro.keys.specBlueFC.indexOf(e.keyCode)!=-1&&(t.emit("blueflagcarrier"),tagpro.viewport.centerLock=!1),tagpro.keys.zoomOut.indexOf(e.keyCode)!=-1&&(tagpro.zooming=.025),tagpro.keys.zoomIn.indexOf(e.keyCode)!=-1&&(tagpro.zooming=-0.025),tagpro.keys.centerZoom.indexOf(e.keyCode)!=-1&&(tagpro.viewport.followPlayer=!tagpro.viewport.followPlayer,tagpro.viewport.centerLock=!tagpro.viewport.followPlayer),tagpro.keys.toggleAutoJoin.indexOf(e.keyCode)!=-1&&t.emit("join")}var e=!1,t=tagpro.createSocket(),n={},r={},s={},o=null,u=null,a=0,f=1,c="";tagpro.socket=t,tagpro.joinerSocket=null,tagpro.teamNames=n,tagpro.players=r,tagpro.objects=s,tagpro.chat={},tagpro.playerId=null,tagpro.score={},tagpro.state=1,tagpro.sendKeyPress=w,tagpro.group.socket&&(tagpro.group.socket.playerLocation="game"),t.on("id",function(e){u=e,tagpro.playerId=u,tagpro.viewport.centerLock||(tagpro.viewport.followPlayer=!0)}),t.on("settings",function(e){tagpro.settings=e;for(var n in r)var i=r[n];t.emit("loaded",{container:window.self!=window.top})}),t.on("tips",function(e){e=!!e,$("#tutorialButton").text(e?"Disable Tips":"Enable Tips")}),t.on("teamNames",function(e){tagpro.teamNames=e}),t.on("spectator",function(e){var t=tagpro.spectator;tagpro.spectator=e.type;var n=e.joiner||!1;n&&!tagpro.rawJoinerSocket&&tagpro.createJoinerSocket(),n||tagpro.disconnectJoinerSocket(),tagpro.spectator||(tagpro.zoom=1,tagpro.viewport.centerLock=!1,tagpro.viewport.followPlayer=!0);if(tagpro.spectator&&!t){tagpro.viewport.centerLock=!0,tagpro.viewport.followPlayer=!1;var r=document.getElementById("viewport"),i=tagpro.map.length*40/r.width,s=tagpro.map[0].length*40/r.height;tagpro.zoom=Math.max(i,s)}}),t.on("spectators",function(e){tagpro.spectators=e}),setTimeout(function(){u==null&&(location.href="http://"+tagproConfig.serverHost)},1e4),t.on("p",function(e){var t=e.t||null;e=e.u||e;for(var n=0,i=e.length;n!=i;n++){var s=e[n],o=r[s.id];o||(o=s,r[o.id]=o,o.lastSync={},o.pressing={});var u=!1,a=!1;for(var f in s){if(f=="up"||f=="down"||f=="left"||f=="right"){h(o,f,s[f]);continue}if(!(t==null||o.lastSync[f]==undefined||t>o.lastSync[f]))continue;o[f]=s[f],t&&(o.lastSync[f]=t);if(f=="rx"||f=="ry"||f=="lx"||f=="ly"||f=="a"||f=="den"||f=="dead"||f=="draw")u=!0;if(f=="dead"||f=="draw"||f=="directSet")a=!0;o.sprites&&(f=="name"||f=="auth")&&tagpro.renderer.drawName(o,!0)}(a||u)&&tagpro.world&&tagpro.world.syncPlayer(o,a)}}),t.on("object",function(e){s[e.id]||(s[e.id]=e);var t=s[e.id],n=!1,r=!1;for(var i in e){t[i]=e[i];if(i=="rx"||i=="ry"||i=="lx"||i=="ly"||i=="a"||i=="draw")n=!0;i=="draw"&&(r=!0)}n&&tagpro.world.syncObject(t,r)}),t.on("playerLeft",function(e){if(f==2)return;tagpro.world.destoryPlayer(e),tagpro.renderer.destroyPlayer(tagpro.players[e]),delete r[e]}),t.on("map",function(e){o=e.tiles,tagpro.map=o,tagpro.wallMap=p(o),tagpro.floorMap=d(o),tagpro.map.splats=e.splats,e.info&&$("div#mapInfo").removeClass("hide").text("Map: "+(e.info.name||"Untitled")+" by "+(e.info.author||"Unknown"))}),t.on("time",function(e){e.state===5?tagpro.overtimeStartedAt=(new Date).getTime()-e.time:tagpro.gameEndsAt=new Date((new Date).getTime()+e.time),tagpro.state===3&&(e.state||1)===1?tagpro.playSound("cheering"):tagpro.state===1&&e.state===5,tagpro.state=e.state||1}),tagpro.playSound=function(e,t){if(!tagpro.sound)return;var n=$("audio#"+e).get(0);if(n&&n.play){n.volume=t||1,n.volume*=tagpro.volumeCoefficient;if(t==0)n.pause(),n.currentTime=0;else{if($(n).attr("data-ramp")){n.rampTimeout&&clearTimeout(n.rampTimeout);var r=n.volume;n.volume=0;var i=.01,s=Math.ceil(Math.abs((r-n.volume)/i));v(n,i,s)}n.play()}}},tagpro.stopSound=function(e){var t=$("audio#"+e).get(0);if(!t||!t.pause)return;if($(t).attr("data-ramp")){t.rampTimeout&&clearTimeout(t.rampTimeout);var n=0,r=-0.01,i=Math.ceil(Math.abs((n-t.volume)/r));v(t,r,i,function(){t.pause(),t.currentTime=0})}},t.on("sound",function(e){if(tagpro.viewport.followPlayer)tagpro.playSound(e.s,e.v);else switch(e.s){case"cheering":case"sigh":tagpro.playSound("cheering",1);break;case"drop":case"friendlydrop":tagpro.playSound("friendlydrop",1);break;case"alert":case"friendlyalert":tagpro.playSound("friendlyalert",.5);break;default:}}),t.on("stopSound",function(e){tagpro.stopSound(e)}),t.on("score",function(e){tagpro.score=e});var m=!1,g="";t.on("full",function(){m=!0,location.href="http://"+tagproConfig.serverHost+"/games/find?r="+(new Date).getTime()}),t.on("private",function(e){m=!0,e&&e.groupId?location.href="http://"+tagproConfig.serverHost+"/groups/"+e.groupId:location.href="http://"+tagproConfig.serverHost+"/?err=private"}),t.on("banned",function(){m=!0,location.href="http://"+tagproConfig.serverHost+"/banned"}),t.on("vpn",function(){m=!0,location.href="http://"+tagproConfig.serverHost+"/vpn"}),t.on("duplicate",function(){m=!0,location.href="http://"+tagproConfig.serverHost+"/?err=duplicate"}),t.on("joinWorld",function(e){m=!0,location.href="http://"+location.hostname+":"+e+"/?alert=true"}),t.on("disconnectReason",function(e){g=e}),t.on("disconnect",function(e){g=g||e;if(tagpro.group.socket&&tagpro.group.socket.redirecting)return;f!=2&&!m&&(y?location.href="http://"+tagproConfig.serverHost+"/groups/"+y:location.href="http://"+tagproConfig.serverHost+"/?err="+g)}),t.on("end",function(e){f=2,tagpro.state=2,c=e.winner,tagpro.winner=e.winner,tagpro.showOptions();if(C&&!tagpro.spectator){var t=$("#mapRatingContainer"),n=$("#mapRating");t.show();if(!n.val()||L%10===0)n.addClass("shake").addClass("shake-slow").addClass("shake-constant"),setTimeout(function(){n.removeClass("shake").removeClass("shake-slow").removeClass("shake-constant")},1500)}$("div.news").fadeIn();var r=25e3;tagpro.spectator==="waiting"&&(r=24900),setTimeout(function(){e.groupId?location.href="http://"+tagproConfig.serverHost+"/groups/"+e.groupId:location.href="http://"+tagproConfig.serverHost+"/games/find?r="+(new Date).getTime()},r),tagpro.sendPingStatistics()});var y=null;t.on("groupId",function(e){if(!e)return;y=e,$("#exit").attr("href","http://"+tagproConfig.serverHost+"/groups/"+y)});var b=1;$(document).keydown(function(e){if(tagpro.disableControls)return;tagpro.keys.resetZoom.indexOf(e.keyCode)!=-1&&(tagpro.zoom=1);if(tagpro.spectator)return S(e);var t=null;tagpro.keys.left.indexOf(e.keyCode)>-1&&(t="left"),tagpro.keys.up.indexOf(e.keyCode)>-1&&(t="up"),tagpro.keys.right.indexOf(e.keyCode)>-1&&(t="right"),tagpro.keys.down.indexOf(e.keyCode)>-1&&(t="down"),tagpro.keys.space.indexOf(e.keyCode)>-1&&(t="space"),t&&(e.preventDefault(),w(t),tagpro.events.keyDown&&tagpro.events.keyDown.forEach(function(e){e.keyDown(t)}))}),$(document).keyup(function(e){var n=null;tagpro.keys.zoomOut.indexOf(e.keyCode)!=-1&&(tagpro.zooming=0),tagpro.keys.zoomIn.indexOf(e.keyCode)!=-1&&(tagpro.zooming=0);if(tagpro.disableControls||tagpro.spectator)return;tagpro.keys.left.indexOf(e.keyCode)>-1&&(n="left"),tagpro.keys.up.indexOf(e.keyCode)>-1&&(n="up"),tagpro.keys.right.indexOf(e.keyCode)>-1&&(n="right"),tagpro.keys.down.indexOf(e.keyCode)>-1&&(n="down"),tagpro.keys.space.indexOf(e.keyCode)>-1&&(n="space");if(n){e.preventDefault();var i=r[u];if(i&&i.pressing[n]){var s=b++;i.pressing[n]=!1,t.emit("keyup",{k:n,t:s}),tagpro.ping.avg&&setTimeout(function(){h(i,n,-s)},tagpro.ping.avg/2)}}}),zoomValues=[1,20/15,20/12,2,2.5,20/6,4],zoomCursor=0;var x=!1;tagpro.showOptions=function(){if(x)return;x=!0;var e=$("div#options");e.find("#name").val(tagpro.players[tagpro.playerId].name);var t=function(){var n=e.find("tbody.stats"),i=n.find("tr.template"),s=[];n.find("tr").not(".template").remove();for(var o in r)s.push(r[o]);s.sort(function(e,t){return t.score-e.score}),tagpro.events.sortPlayers&&tagpro.events.sortPlayers.forEach(function(e){e.sortPlayers(s)}),s.forEach(function(e){var t=i.clone().data("model",e).removeClass("template").appendTo(n).find("td");t.eq(0).find(".scoreName").text(e.name).addClass(e.team==1?"team-red":"team-blue").end().find(".scoreAuth").html(e.auth?"&#x2713;":"").end(),t.eq(1).text(e.score),t.eq(2).text(e["s-tags"]),t.eq(3).text(e["s-pops"]),t.eq(4).text(e["s-grabs"]),t.eq(5).text(e["s-drops"]),t.eq(6).text(tagpro.helpers.timeFromSeconds(e["s-hold"],!0)),t.eq(7).text(e["s-captures"]),t.eq(8).text(tagpro.helpers.timeFromSeconds(e["s-prevent"],!0)),t.eq(9).text(e["s-returns"]),t.eq(10).text(e["s-support"]),t.eq(11).text(e["s-powerups"]),t.eq(12).text(e["points"]==0?"-":e.points),t.find("a.kick").attr("href",e.id)}),tagpro.musicPlayer.current?$("div#musicInfo").removeClass("hide").text("Music: "+(tagpro.musicPlayer.current.name||"Untitled")+" by "+(tagpro.musicPlayer.current.author||"Unknown")):$("div#musicInfo").addClass("hide"),x&&setTimeout(t,1e3),tagpro.events.modifyScoreUI&&tagpro.events.modifyScoreUI.forEach(function(e){e.modifyScoreUI($("#options > table:first"))})};x&&t(),e.show()};var T=$("div#kick");$("#switchButton").click(function(e){e.preventDefault(),t.emit("switch")}),$("#tutorialButton").click(function(e){e.preventDefault();var n=$(this).text()==="Enable Tips";$.cookie("disableTutorialChat",!n,{expires:36500,path:"/",domain:tagproConfig.cookieHost}),t.emit("tips",n),tagpro.settings.ui.tutorialChat=n}),$(window).keydown(function(e){e.which==27&&e.preventDefault()}),$(document).keyup(function(e){e.preventDefault();if(tagpro.keys.showOptions.indexOf(e.keyCode)>-1){if(!x){tagpro.showOptions();return}x=!1,$("div#options").hide(),$("#name").blur()}});var N=function(){t.emit("name",$(this).val()),tagpro.group.socket&&tagpro.group.socket.emit("name",$(this).val())};$("#name").keyup(N).change(N).focus(function(){tagpro.disableControls=!0}).blur(function(){tagpro.disableControls=!1}),$("select#mapRating").change(function(){var e=parseInt($(this).val());if(e>1||e<-1)return;t.emit("mapRating",e)});var C=!1,L=0;t.on("mapRating",function(e){$("select#mapRating").val(e.rating),C=!0,L=e.plays}),$("select#preferredServer").change(function(){t.emit("preferredServer",$(this).val())}),t.on("preferredServer",function(e){$("select#preferredServer").val(e)});var A=$("div#sendToPreferred"),O=null;t.on("sendPreferred",function(e){A.find("span#preferredServer").text(e.name).end().css({left:$(document.body).width()/2-T.width()/2,top:$(document.body).height()/2-T.height()/2}).show();var t=8,n=$("span#countdown"),r=function(){t--,n.text(t),t>0?O=setTimeout(r,1e3):document.location=e.url+"games/find/?preferred=true"};r()}),$("a#sendToPreferredCancel").click(function(e){e.preventDefault(),A.hide(),clearTimeout(O),$("select#preferredServer").val(""),t.emit("preferredServer","")});if(e){var M=[];setInterval(function(){if(u==null)return;M.forEach(function(e){var t=$.Event("keyup");t.keyCode=e,$(document).trigger(t)}),M=[],M.push([37,39][Math.floor(Math.random()*2)]),M.push([38,40][Math.floor(Math.random()*2)]),M.forEach(function(e){var t=$.Event("keydown");t.keyCode=e,$(document).trigger(t)})},3e3)}var _=[],D=0,P=0,H=0;setInterval(function(){var e=(new Date).getTime(),n={sent:e,id:D++,time:null,lost:!1};_.push(n),t.emit("p",{id:n.id,c:tagpro.ping.avg}),P++,_.length>5&&_.shift();var r=0,i=0;_.forEach(function(t){if(t.lost)return;if(t.time>=1e3||t.time==null&&e-t.sent>=1e3){t.lost=!0,H++;return}t.time!=null&&(r++,i+=t.time)}),tagpro.ping.avg=Math.round(i/r)||0,tagpro.ping.current=tagpro.ping.avg,tagpro.ping.loss=H/P},2e3),t.on("pr",function(e){var t=(new Date).getTime(),n=_.filter(function(t){return t.id==e&&!t.lost});if(!n||!n.length)return;n=n[0],n.time=t-n.sent}),window.addEventListener("beforeunload",function(){m=!0})}),tagpro.ready(function(){function s(e,t,n,r){return tagpro.ui.sprites[n]=tagpro.tiles.draw(e,t,r,30,30),tagpro.ui.flags.push(tagpro.ui.sprites[n]),tagpro.ui.sprites[n]}function o(e,t,n){function r(e,r,i,s){return{tile:e,name:r,drawPos:{x:t.x+i,y:s|n.height-40},xOffset:i,yOffset:s|-40}}var i=[r("redflag","redFlag",110),r("blueflag","blueFlag",-110),r("yellowflag","yellowFlagTakenByRed",-80),r("yellowflag","yellowFlagTakenByBlue",80),r("redpotato","redPotatoTaken",110),r("bluepotato","bluePotatoTaken",-110),r("yellowpotato","yellowPotatoTakenByRed",-80),r("yellowpotato","yellowPotatoTakenByBlue",80)];for(var o=0;o<i.length;o++){var u=i[o],a=s(e,u.tile,u.name,u.drawPos);a.xOffset=u.xOffset,a.yOffset=u.yOffset,a.anchor.x=.5}}function u(e,t){function o(t){var o=0,u=t%2===0?r+i:0;o+=Math.floor((t-1)/2)*(r+i),tagpro.tiles.draw(n,e,{x:o,y:u},r,r,s)}var n=new PIXI.Container,r=20,i=2,s=.5,u=1;while(u<=t)o(u++);return n}function p(){tagpro.renderer.layers.ui.debug={};var e=tagpro.renderer.renderer.type==PIXI.WEBGL_RENDERER?"WebGL":"Canvas",t=tagpro.renderer.prettyText("Engine Type: "+e);t.x=10,t.y=100,tagpro.renderer.layers.ui.debug.engineType=t,tagpro.renderer.layers.ui.addChild(t);var n=tagpro.renderer.prettyText("");n.x=10,n.y=120,tagpro.renderer.layers.ui.debug.childCount=n,tagpro.renderer.layers.ui.addChild(n);var r=tagpro.renderer.prettyText("Particles: "+!tagpro.renderer.options.disableParticles);r.x=10,r.y=140,tagpro.renderer.layers.ui.debug.particles=r,tagpro.renderer.layers.ui.addChild(r);var i=tagpro.renderer.prettyText("Scaling: "+!tagpro.renderer.options.disableViewportScaling);i.x=10,i.y=160,tagpro.renderer.layers.ui.debug.viewport=i,tagpro.renderer.layers.ui.addChild(i);var s=tagpro.renderer.prettyText("");s.x=10,s.y=180,tagpro.renderer.layers.ui.debug.position=s,tagpro.renderer.layers.ui.addChild(s);var o=tagpro.renderer.prettyText("");o.x=10,o.y=200,tagpro.renderer.layers.ui.debug.realPosition=o,tagpro.renderer.layers.ui.addChild(o)}function d(){tagpro.renderer.layers.ui.debug||p();var e=v(),t="Sprite Count: "+e;tagpro.renderer.layers.ui.debug.childCount.text=t;var n=tagpro.playerId;if(n){var r=tagpro.players[n],i=r.x,s=r.y,o="X: "+i+", Y: "+s;tagpro.renderer.layers.ui.debug.position.text=o;var u=r.rx,a=r.ry,f="RX: "+u+", RY: "+a;tagpro.renderer.layers.ui.debug.realPosition.text=f}}function v(){function t(n){if(n.visible){e+=1;for(var r=0;r<n.children.length;r++){var i=n.children[r];t(i)}}}var e=0;return t(tagpro.renderer.stage),e}function m(){if(!tagpro.ui.enabled)return;n||(n=tagpro.renderer.layers.ui),tagpro.settings.ui.spectatorInfo&&tagpro.ui.spectatorInfo(n,t),tagpro.renderer.debug&&d();if(tagpro.settings.ui.matchState){tagpro.ui.scores(n,t,e),tagpro.ui.updateFlags(tagpro.renderer.layers.ui,t,e),tagpro.ui.updatePlayerIndicators();var s=Math.floor((tagpro.ping.loss||0)*100);tagpro.ui.performanceInfo(n,t,e,s),tagpro.ui.alignUI(),tagpro.events.afterUpdateUI&&tagpro.events.afterUpdateUI.forEach(function(e){e.afterUpdateUI()});if(tagpro.state==2)r||(tagpro.winner=="red"?(tagpro.ui.largeAlert(n,t,e,(tagpro.teamNames.redTeamName||"Blue")+" Wins!","#ff0000"),r=!0):tagpro.winner=="blue"?(tagpro.ui.largeAlert(n,t,e,(tagpro.teamNames.blueTeamName||"Red")+" Wins!","#0000ff"),r=!0):tagpro.winner=="tie"?(tagpro.ui.largeAlert(n,t,e,"It's a tie!"),r=!0):(tagpro.ui.largeAlert(n,t,e,tagpro.winner),r=!0));else if(tagpro.state==3&&!i){var o=tagpro.ui.largeAlert(n,t,e,"Match Begins Soon..."),u=function(){tagpro.state!=3?(n.removeChild(o),o.visible=!1):setTimeout(u,20)};setTimeout(u,20),i=!0}}}var e={width:0,height:0},t={x:0,y:0},n,r=!1,i=!1;setTimeout(function(){$("#loadingMessage").fadeOut(100),$("#viewportDiv").fadeIn(250),$("#viewport").fadeIn(250,function(){tagpro.chat.resize()})},0),tagpro.ui={redFlagTaken:!1,blueFlagTaken:!1,yellowFlagTakenByRed:!1,yellowFlagTakenByBlue:!1,enabled:!0,sprites:{},redPotatoTaken:!1,bluePotatoTaken:!1,yellowPotatoTakenByRed:!1,yellowPotatoTakenByBlue:!1,flags:[]},tagpro.ui.center=t,tagpro.ui.size=e,tagpro.ui.resize=function(n,r){e.width=n,e.height=r,t.x=n/2,t.y=r/2,tagpro.ui.alignUI()},tagpro.ui.scoreXOffset=0,tagpro.ui.alignUI=function(){if(!tagpro.ui.sprites){setTimeout(tagpro.ui.alignUI,1e3);return}var e=tagpro.ui.sprites,n=[!!e.redScore,!!e.blueScore,!!tagpro.ui.sprites.timer,!!e.performanceInfo,tagpro.ui.flags.length>0,!!e.xhr];if(n.every(function(e){return!!e})){var r=t.y*2;tagpro.ui.sprites.redScore.x=t.x-80-tagpro.ui.scoreXOffset,tagpro.ui.sprites.redScore.y=r-80,tagpro.ui.sprites.blueScore.x=t.x+80+tagpro.ui.scoreXOffset,tagpro.ui.sprites.blueScore.y=r-80,tagpro.ui.sprites.timer.x=t.x,tagpro.ui.sprites.timer.y=r-50,tagpro.ui.sprites.performanceInfo.x=10,tagpro.ui.sprites.performanceInfo.y=10,tagpro.ui.sprites.xhr.x=t.x-tagpro.ui.sprites.xhr.width/2,tagpro.ui.sprites.xhr.y=10;for(var i=0;i<tagpro.ui.flags.length;i++){var s=tagpro.ui.flags[i];s.x=t.x+s.xOffset,s.y=r+s.yOffset}}else setTimeout(tagpro.ui.alignUI,1e3)},tagpro.ui.scores=function(){var e="",t="",n=tagpro.settings.ui.teamNames=="always"||tagpro.settings.ui.teamNames=="spectating"&&tagpro.spectator==1;n&&tagpro.teamNames.redTeamName!=="Red"&&(e=tagpro.teamNames.redTeamName+" - "),n&&tagpro.teamNames.blueTeamName!=="Blue"&&(t=" - "+tagpro.teamNames.blueTeamName);var r=e+(tagpro.score.r?tagpro.score.r.toString():"0"),i=(tagpro.score.b?tagpro.score.b.toString():"0")+t;tagpro.ui.sprites.redScore?(tagpro.ui.sprites.redScore.text=r,tagpro.ui.sprites.blueScore.text=i):(tagpro.ui.sprites.redScore=new PIXI.Text(r,{fill:"#FF0000",fontFamily:"Arial",fontSize:"40pt",fontWeight:"bold"}),tagpro.ui.sprites.blueScore=new PIXI.Text(i,{fill:"#0000FF",fontFamily:"Arial",fontSize:"40pt",fontWeight:"bold"}),tagpro.ui.sprites.redScore.alpha=.5,tagpro.ui.sprites.blueScore.alpha=.5,tagpro.ui.sprites.redScore.anchor.x=1,tagpro.ui.sprites.blueScore.anchor.x=0,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.redScore),tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.blueScore))},tagpro.ui.updateFlags=function(e,t,n){tagpro.ui.sprites.redFlag||o(e,t,n);var r=[["redFlag","redFlagTaken"],["blueFlag","blueFlagTaken"],["yellowFlagTakenByRed",null],["yellowFlagTakenByBlue",null],["redPotatoTaken",null],["bluePotatoTaken",null],["yellowPotatoTakenByRed",null],["yellowPotatoTakenByBlue",null]];for(var i=0;i<r.length;i++){var s=r[i],u=tagpro.ui.sprites[s[0]],a;s[1]?a=!!tagpro.ui[s[1]]:a=!!tagpro.ui[s[0]],u.visible=a}e.globalAlpha=1},tagpro.ui.timer=function(e,t,n,r){var i=tagpro.ui.sprites.timer;i||(i=tagpro.ui.sprites.timer=new PIXI.Text("",{fill:"#FFFFFF",strokeThickness:4,stroke:"#000000",fontFamily:"Arial",fontSize:"30pt",fontWeight:"bold"}),i.alpha=.5,i.anchor.x=.5,e.addChild(tagpro.ui.sprites.timer)),i.text=r,i.visible=!!tagpro.settings.ui.matchState};var a=-1,f=-1,l=-1,c=-1;tagpro.ui.updatePlayerIndicators=function(){tagpro.ui.sprites.playerIndicators||(tagpro.ui.sprites.playerIndicators=new PIXI.Container);var e=0,t=0;for(var n in tagpro.players)tagpro.players.hasOwnProperty(n)&&(tagpro.players[n].team==1?e++:t++);var r=$("#viewport"),i=r.width(),s=r.height();if(e==a&&t==f&&i==l&&s==c)return;a=e,f=t,l=i,c=s;var o=u("redball",e);o.x=i/2-120-o.width,o.y=s-70;var h=u("blueball",t);h.x=i/2+120,h.y=s-70,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.playerIndicators),tagpro.ui.sprites.playerIndicators.removeChildren(),tagpro.ui.sprites.playerIndicators.addChild(o),tagpro.ui.sprites.playerIndicators.addChild(h)},tagpro.ui.spectatorInfo=function(e,t){var n=tagpro.ui.sprites.spectatorInfo1,r=tagpro.ui.sprites.spectatorInfo2;if(tagpro.spectator){n||(n=tagpro.ui.sprites.spectatorInfo1=tagpro.renderer.prettyText("You are spectating"),e.addChild(n),n.y=10,n.anchor.x=.5,n.alpha=.6),n.x=t.x;if(!r||tagpro.spectator!=tagpro.ui.lastSpectatorValue)r&&e.removeChild(r),r=tagpro.ui.sprites.spectatorInfo2=tagpro.renderer.prettyText("auto-join is "+(tagpro.spectator=="waiting"?"on":"off")),e.addChild(r),r.y=25,r.anchor.x=.5,r.alpha=.6,tagpro.ui.lastSpectatorValue=tagpro.spectator;r.x=t.x}else n&&e.removeChild(n),r&&e.removeChild(r)},tagpro.ui.performanceInfo=function(e,t,n,r){var i,s;tagpro.ui.sprites.performanceInfo||(tagpro.ui.xhrStartTime=performance.now(),tagpro.ui.sprites.performanceInfo=tagpro.renderer.prettyText(""),tagpro.ui.sprites.xhr=tagpro.renderer.prettyText(""),tagpro.ui.sprites.xhr.tint=16711680,tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.performanceInfo),tagpro.renderer.layers.ui.addChild(tagpro.ui.sprites.xhr)),i=tagpro.ui.sprites.performanceInfo,s=tagpro.ui.sprites.xhr;var o=!!tagpro.settings.ui.performanceInfo;i.visible=o,s.visible=performance.now()-tagpro.ui.xhrStartTime>1e3&&!!tagpro.rawSocket.io.engine.transport.polling;if(o){var u="FPS: "+Math.round(tagpro.fps)+", Ping: "+tagpro.ping.avg+(r?", Loss: "+r+"%":"");tagpro.rawSocket.io.engine.transport.polling&&(s.text="XHR Mode, this will be laggy! Check your firewall!"),i.text=u}},tagpro.ui.largeAlert=function(e,t,n,r,i){var s=tagpro.renderer.largeText(r,i);return s.x=Math.round(t.x-s.width/2),s.y=100,e.addChild(s),s};var h="";setInterval(function(){if(tagpro.gameEndsAt&&!tagpro.overtimeStartedAt){var r=tagpro.gameEndsAt-(new Date).getTime();tagpro.state===3&&(r+=1e3);var i="00"+Math.floor(r/6e4),s="00"+Math.floor(r%6e4/1e3),o=i.substr(i.length-2,2)+":"+s.substr(s.length-2,2);tagpro.state===2&&(o=h),n&&tagpro.ui.timer(n,t,e,o),o==="00:03"&&o!==h&&tagpro.state!==2&&tagpro.playSound("countdown",1),h=o}else if(tagpro.overtimeStartedAt){var u=(new Date).getTime()-tagpro.overtimeStartedAt,i="00"+Math.floor(u/6e4),s="00"+Math.floor(u%6e4/1e3),o=i.substr(i.length-2,2)+":"+s.substr(s.length-2,2);tagpro.state===2&&(o=h),n&&tagpro.ui.timer(n,t,e,o),h=o}},100),tagpro.ui.update=m}),tagpro.ready(function(){var e=$("div#kick");tagpro.kick={player:function(t){e.attr("data-id",t.id).find("#kickPlayer").text(" "+t.name).end().find("#kickSelect").prop("selectedIndex",0).end().css({left:($(window).width()-e.width())/2,top:($(window).height()-e.height())/2}).show()},clickBall:function(e){var t,n=e.pageX-$canvas.offset().left,r=e.pageY-$canvas.offset().top,i=40,s=null,o=-1;for(var u in tagpro.players){var a=tagpro.players[u],f=tagpro.helpers.toLockedPos({x:a.x,y:a.y}),l=f.x+20,c=f.y+20,h=Math.pow(l-n,2)+Math.pow(c-r,2);if(s===null||h<o)s=a,o=h}s&&o<Math.pow(i,2)&&tagpro.kick.player(s)}},$("tbody.stats").on("click","a.kick",function(e){e.preventDefault();var t=tagpro.players[parseInt($(this).attr("href"))];tagpro.kick.player(t)}),$("#kickSelect").change(function(t){tagpro.socket.emit("kick",{playerId:parseInt(e.attr("data-id")),reason:parseInt($(this).val())})}),$("#muteButton").click(function(t){t.preventDefault(),e.hide(),tagpro.socket.emit("mute",{playerId:parseInt(e.attr("data-id"))})}),$("#kickCancelButton").click(function(t){t.preventDefault(),e.hide()})}),tagpro.ready(function(){function p(e){var t=tagpro.settings.ui||{allChat:!0,teamChat:!0,groupChat:!0,systemChat:!0};if(!e.mod){if(!t.allChat&&e.to=="all"&&e.from)return;if(!t.teamChat&&e.to=="team")return;if(!t.groupChat&&e.to=="group")return;if(!t.systemChat&&e.to=="all"&&!e.from)return}var n=null,r=null,s=h.clone();typeof e.from=="number"?(n=tagpro.players[e.from],s.data("player",n)):typeof e.from=="string"&&(n={name:e.from,auth:!1}),(!n||!n.auth)&&s.children(".auth").remove(),n?(n.team?r=n.team==1?"#FFB5BD":"#CFCFFF":e.to=="group"?r="#E7E700":e.from=="ADMIN_GLOBAL_BROADCAST"?(r="#FF0000",n.name="ANNOUNCEMENT"):e.mod&&(r="#00B900"),s.children(".name").css({color:r}).text(n.name)):s.children(".name").remove();var o=r;e.to=="all"&&(o=e.c||null),e.to=="group"&&!e.from&&(o="#E7E700"),s.children(".message").css({color:o}).text(e.message).end(),i.append(s).scrollTop(i.get(0).scrollHeight),setTimeout(function(){s.remove()},2e4)}function d(i,o,u){e=!0,tagpro.disableControls=!0,t=i,n=o,r=u,s.val("").show().focus()}function v(){var e=s.val();g();if(e.length>70||e==""){m();return}n?tagpro.group.socket&&tagpro.group.socket.emit("chat",e):f.emit("chat",{toAll:!t,asMod:r,message:e}),m()}function m(){e=!1,tagpro.disableControls=!1,s.hide()}function g(){l="",c=""}function y(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function b(){var e=s.val(),t=Object.keys(tagpro.players).map(function(e){return tagpro.players[e].name}).sort(function(e,t){return e>t});if(l.length){var n=e.lastIndexOf(l);n+l.length===e.length&&(e=e.substr(0,n),e+=c);var r=t.indexOf(l.trim());r>-1&&(t=r+1===t.length?t:t.slice(r+1))}var i=e.split(" "),o=i[i.length-1];if(!i.length)return;var u=y(o),a=new RegExp("^"+u+".*","i"),f=o;t.some(function(e){return a.test(e)?(f=e+" ",!0):!1}),l=f,c=o,i[i.length-1]=f,s.val(i.join(" "))}var e=!1,t=!1,n=!1,r=!1,i=$("div#chatHistory"),s=$("input#chat"),o=$("canvas"),u=o.offset(),a=o.get(0).height,f=tagpro.socket,l="",c="";$(document).keydown(function(t){var n=tagpro.keys.chatToTeam.indexOf(t.keyCode)!=-1,r=tagpro.keys.chatToGroup.indexOf(t.keyCode)!=-1&&tagpro.group.socket,i=tagpro.keys.chatToAll.indexOf(t.keyCode)!=-1,s=tagpro.keys.chatAsMod&&tagpro.keys.chatAsMod.indexOf(t.keyCode)!=-1;if((n||r||i||s)&&!e){if($("#name").is(":focus"))return;d(n,r,s),t.preventDefault()}else tagpro.keys.sendChat.indexOf(t.keyCode)!=-1&&e&&v()});var h=$("<div><span class='auth'>&#10004</span><span class='name'></span><span class='message'></span></div>");f.on("chat",p),tagpro.group.socket&&tagpro.group.socket.on("chat",p),s.keydown(function(e){[37,38,39,40].indexOf(e.keyCode)>=0&&e.preventDefault();if(tagpro.keys.nickCompleteChat.indexOf(e.keyCode)>-1)return e.preventDefault(),b();tagpro.keys.cancelChat.indexOf(e.keyCode)>-1&&m(),g()}),tagpro.chat.resize=function(){u=o.offset(),a=o.get(0).height,s.css({left:u.left+10,top:u.top+a-40}),i.css({left:u.left+10,top:u.top+a-i.outerHeight()-50})},i.on("click","div",function(){var e=$(this).data("player");if(!e)return;tagpro.kick.player(e)})});var overrideableAssets={speedpad:"img#speedpad",speedpadRed:"img#speedpadred",speedpadBlue:"img#speedpadblue",portal:"img#portal",tiles:"img#tiles",splats:"img#splats",gravityWell:"img#gravityWell"};tagpro.loadAssets=function(e){var t=function(e){$(document).ready(function(){$("#assets").append(e)})};for(var n in e){var r=e[n],i=generateId(),s=new Image;s.crossOrigin=!0,s.src=r,s.id=i,s.className="asset",overrideableAssets[n]="img#"+i,t(s)}tagpro.loadAssets=function(){console.log("tagpro.loadAssets has already been called. Ignoring second invocation.")}},tagpro.ready(function(){function n(e,t,n,r,i){var s=[],o=new PIXI.Rectangle(0,0,t.width,t.height),u=function(e){var n=new PIXI.Rectangle(r*e,0,r,r);s.push(new PIXI.Texture(t,n))};if(n)u(e-1);else if(i)u(0),u(e-1);else for(var a=0;a<e-1;a++)u(a);return s}function r(e,r,i,s,o){t[r]||(t[r]=new PIXI.BaseTexture(e));var u=t[r],a=u.width/s;return n(a,u,i,s,o)}function i(e){var t=new PIXI.extras.AnimatedSprite(e);return t.playing=!0,t}function s(e,t,n,s,o){n=n||40;var u=$(e).get(0),a=r(u,e,t,n,s),f=i(a);return s&&(f.blink=!0),o&&(f.alpha=o),f}function o(t,n){return e==="blink"?s(t,!1,null,!0,.5):e==="alpha"?s(t,!1,null,!1,.35):n}function u(t,n,r,i,s){return e==="blink"?{x:t,y:n,drawFloor:!0,redrawFloor:!0,dynamic:!0,alpha:.5,blink:!0,frameTiles:r}:e==="alpha"?{x:t,y:n,drawFloor:!0,redrawFloor:!0,dynamic:!0,alpha:.35,blink:!1}:{x:i,y:s,drawFloor:!0,redrawFloor:!0,dynamic:!0}}function x(){var e=$(overrideableAssets.splats).get(0),t=new PIXI.BaseTexture(e),n=t.width/120,r=function(e,n){var r=new PIXI.Rectangle(120*e,120*n,120,120);return new PIXI.Texture(t,r)};tagpro.tiles.splats={red:[],blue:[]};for(var i=0;i<n-1;i++)tagpro.tiles.splats.red.push(r(i,0)),tagpro.tiles.splats.blue.push(r(i,1))}const e=$.cookie("tileRespawnWarnings")||"blink";var t={},a=s(overrideableAssets.speedpad),f=s(overrideableAssets.speedpad,!0),l=o(overrideableAssets.speedpad,f),c=s(overrideableAssets.speedpadRed),h=s(overrideableAssets.speedpadRed,!0),p=o(overrideableAssets.speedpadRed,h),d=s(overrideableAssets.speedpadBlue),v=s(overrideableAssets.speedpadBlue,!0),m=o(overrideableAssets.speedpadBlue,v),g=s(overrideableAssets.portal),y=s(overrideableAssets.portal,!0),b=o(overrideableAssets.portal,y);tagpro.tiles={1:{},1.1:{drawFloor:[{x:1,y:0},{x:0,y:-1}]},1.2:{drawFloor:[{x:1,y:0},{x:0,y:1}]},1.3:{drawFloor:[{x:-1,y:0},{x:0,y:1}]},1.4:{drawFloor:[{x:-1,y:0},{x:0,y:-1}]},2:{x:13,y:4},16:{x:13,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},yellowflag:{x:13,y:1,isFlag:!0,dynamic:!0},16.1:{x:13,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},3:{x:14,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},redflag:{x:14,y:1,isFlag:!0,dynamic:!0},3.1:{x:14,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},4:{x:15,y:1,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},blueflag:{x:15,y:1,isFlag:!0,dynamic:!0},4.1:{x:15,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},5:a,5.1:f,5.11:l,14:c,14.1:h,14.11:p,15:d,15.1:v,15.11:m,6:{x:12,y:8,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.1:{x:12,y:4,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.11:u(12,4,[6.1,6],12,8),grip:{x:12,y:4,dynamic:!0},6.2:{x:12,y:5,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.21:u(12,5,[6.2,6],12,8),bomb:{x:12,y:5,dynamic:!0},6.3:{x:12,y:6,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.31:u(12,6,[6.3,6],12,8),tagpro:{x:12,y:6,dynamic:!0},6.4:{x:12,y:7,drawFloor:!0,redrawFloor:!0,dynamic:!0},6.41:u(12,7,[6.4,6],12,8),speed:{x:12,y:7,dynamic:!0},17:{x:14,y:5,dynamic:!0},18:{x:15,y:5,dynamic:!0},7:{x:12,y:0,drawFloor:!0,redrawFloor:!1,dynamic:!0},21:{x:14,y:6,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},yellowpotato:{x:14,y:6,isFlag:!0,dynamic:!0},21.1:{x:15,y:6,drawFloor:!0,redrawFloor:!0,dynamic:!0},19:{x:14,y:7,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},redpotato:{x:14,y:7,isFlag:!0,dynamic:!0},19.1:{x:15,y:7,drawFloor:!0,redrawFloor:!0,dynamic:!0},20:{x:14,y:8,drawFloor:!0,redrawFloor:!0,isFlag:!0,dynamic:!0},bluepotato:{x:14,y:8,isFlag:!0,dynamic:!0},20.1:{x:15,y:8,drawFloor:!0,redrawFloor:!0,dynamic:!0},22:{x:0,y:0,drawFloor:!0,source:"gravityWell"},redball:{x:14,y:0},blueball:{x:15,y:0},8:{x:13,y:6,drawFloor:!0,redrawFloor:!1,dynamic:!0},9:{x:12,y:3,dynamic:!0},9.1:{x:13,y:3,dynamic:!0},9.2:{x:14,y:3,dynamic:!0},9.3:{x:15,y:3,dynamic:!0},10:{x:12,y:1,drawFloor:!0,redrawFloor:!0,dynamic:!0},10.1:{x:12,y:2,drawFloor:!0,redrawFloor:!0,dynamic:!0},10.11:u(12,1,[10,10.1],12,2),11:{x:14,y:4},12:{x:15,y:4},23:{x:13,y:5},marsball:{x:12,y:9,size:80,keep:!0},13:g,13.1:y,13.11:b,"1.310":{x:10.5,y:7.5,size:20},"1.410":{x:11,y:7.5,size:20},"1.110":{x:11,y:8,size:20},"1.210":{x:10.5,y:8,size:20},"1.310d":{x:.5,y:3.5,size:20},"1.410d":{x:1,y:3.5,size:20},"1.210d":{x:.5,y:4,size:20},1.321:{x:4.5,y:9.5,size:20},1.421:{x:5,y:9.5,size:20},1.121:{x:5,y:10,size:20},1.221:{x:4.5,y:10,size:20},"1.321d":{x:1.5,y:2.5,size:20},"1.421d":{x:2,y:2.5,size:20},"1.221d":{x:1.5,y:3,size:20},1.332:{x:6.5,y:9.5,size:20},1.432:{x:7,y:9.5,size:20},1.132:{x:7,y:10,size:20},1.232:{x:6.5,y:10,size:20},"1.332d":{x:9.5,y:2.5,size:20},"1.432d":{x:10,y:2.5,size:20},"1.132d":{x:10,y:3,size:20},1.343:{x:.5,y:7.5,size:20},1.443:{x:1,y:7.5,size:20},1.143:{x:1,y:8,size:20},1.243:{x:.5,y:8,size:20},"1.343d":{x:10.5,y:3.5,size:20},"1.443d":{x:11,y:3.5,size:20},"1.143d":{x:11,y:4,size:20},1.354:{x:1.5,y:6.5,size:20},1.454:{x:2,y:6.5,size:20},1.154:{x:2,y:7,size:20},1.254:{x:1.5,y:7,size:20},"1.454d":{x:9,y:1.5,size:20},"1.154d":{x:9,y:2,size:20},"1.254d":{x:8.5,y:2,size:20},1.365:{x:6.5,y:8.5,size:20},1.465:{x:7,y:8.5,size:20},1.165:{x:7,y:9,size:20},1.265:{x:6.5,y:9,size:20},"1.465d":{x:11,y:1.5,size:20},"1.165d":{x:11,y:2,size:20},"1.265d":{x:10.5,y:2,size:20},1.376:{x:4.5,y:8.5,size:20},1.476:{x:5,y:8.5,size:20},1.176:{x:5,y:9,size:20},1.276:{x:4.5,y:9,size:20},"1.376d":{x:.5,y:1.5,size:20},"1.176d":{x:1,y:2,size:20},"1.276d":{x:.5,y:2,size:20},1.307:{x:9.5,y:6.5,size:20},1.407:{x:10,y:6.5,size:20},1.107:{x:10,y:7,size:20},1.207:{x:9.5,y:7,size:20},"1.307d":{x:2.5,y:1.5,size:20},"1.107d":{x:3,y:2,size:20},"1.207d":{x:2.5,y:2,size:20},"1.320":{x:1.5,y:7.5,size:20},"1.420":{x:2,y:7.5,size:20},"1.220":{x:1.5,y:8,size:20},"1.320d":{x:10.5,y:.5,size:20},"1.420d":{x:11,y:.5,size:20},"1.220d":{x:10.5,y:1,size:20},1.331:{x:5.5,y:6.5,size:20},1.431:{x:6,y:6.5,size:20},1.131:{x:6,y:7,size:20},1.231:{x:5.5,y:7,size:20},"1.331d":{x:5.5,y:.5,size:20},"1.431d":{x:6,y:.5,size:20},1.342:{x:9.5,y:7.5,size:20},1.442:{x:10,y:7.5,size:20},1.142:{x:10,y:8,size:20},"1.342d":{x:.5,y:.5,size:20},"1.442d":{x:1,y:.5,size:20},"1.142d":{x:1,y:1,size:20},1.353:{x:4.5,y:5.5,size:20},1.453:{x:5,y:5.5,size:20},1.153:{x:5,y:6,size:20},1.253:{x:4.5,y:6,size:20},"1.453d":{x:7,y:1.5,size:20},"1.153d":{x:7,y:2,size:20},1.464:{x:4,y:9.5,size:20},1.164:{x:4,y:10,size:20},1.264:{x:3.5,y:10,size:20},"1.464d":{x:2,y:3.5,size:20},"1.164d":{x:2,y:4,size:20},"1.264d":{x:1.5,y:4,size:20},1.375:{x:5.5,y:2.5,size:20},1.475:{x:6,y:2.5,size:20},1.175:{x:6,y:4,size:20},1.275:{x:5.5,y:4,size:20},"1.175d":{x:6,y:3,size:20},"1.275d":{x:5.5,y:3,size:20},1.306:{x:7.5,y:9.5,size:20},1.106:{x:8,y:10,size:20},1.206:{x:7.5,y:10,size:20},"1.306d":{x:9.5,y:3.5,size:20},"1.106d":{x:10,y:4,size:20},"1.206d":{x:9.5,y:4,size:20},1.317:{x:6.5,y:5.5,size:20},1.417:{x:7,y:5.5,size:20},1.117:{x:7,y:6,size:20},1.217:{x:6.5,y:6,size:20},"1.317d":{x:4.5,y:1.5,size:20},"1.217d":{x:4.5,y:2,size:20},1.327:{x:7.5,y:8.5,size:20},1.427:{x:8,y:8.5,size:20},1.101:{x:4,y:5,size:20},1.227:{x:7.5,y:9,size:20},"1.327d":{x:8.5,y:3.5,size:20},"1.227d":{x:8.5,y:4,size:20},"1.330":{x:8.5,y:7.5,size:20},"1.430":{x:9,y:7.5,size:20},1.112:{x:2,y:0,size:20},"1.230":{x:8.5,y:8,size:20},"1.330d":{x:3.5,y:.5,size:20},"1.430d":{x:4,y:.5,size:20},1.341:{x:2.5,y:7.5,size:20},1.441:{x:3,y:7.5,size:20},1.141:{x:3,y:8,size:20},1.223:{x:9.5,y:0,size:20},"1.341d":{x:7.5,y:.5,size:20},"1.441d":{x:8,y:.5,size:20},1.352:{x:3.5,y:8.5,size:20},1.452:{x:4,y:8.5,size:20},1.152:{x:4,y:9,size:20},1.234:{x:7.5,y:5,size:20},"1.452d":{x:3,y:3.5,size:20},"1.152d":{x:3,y:4,size:20},1.345:{x:7.5,y:6.5,size:20},1.463:{x:10,y:8.5,size:20},1.163:{x:10,y:9,size:20},1.263:{x:9.5,y:9,size:20},"1.463d":{x:2,y:.5,size:20},"1.163d":{x:2,y:1,size:20},1.356:{x:6.5,y:7.5,size:20},1.474:{x:9,y:9.5,size:20},1.174:{x:9,y:10,size:20},1.274:{x:8.5,y:10,size:20},"1.174d":{x:10,y:5,size:20},"1.274d":{x:9.5,y:5,size:20},1.305:{x:2.5,y:9.5,size:20},1.467:{x:5,y:7.5,size:20},1.105:{x:3,y:10,size:20},1.205:{x:2.5,y:10,size:20},"1.105d":{x:2,y:5,size:20},"1.205d":{x:1.5,y:5,size:20},1.316:{x:1.5,y:8.5,size:20},"1.470":{x:4,y:6.5,size:20},1.116:{x:2,y:9,size:20},1.216:{x:1.5,y:9,size:20},"1.316d":{x:9.5,y:.5,size:20},"1.216d":{x:9.5,y:1,size:20},1.337:{x:10.5,y:9.5,size:20},1.437:{x:11,y:9.5,size:20},1.102:{x:0,y:7,size:20},1.237:{x:10.5,y:10,size:20},"1.337d":{x:10.5,y:4.5,size:20},"1.102d":{x:0,y:0,size:20},"1.340":{x:8.5,y:10.5,size:20},"1.440":{x:9,y:10.5,size:20},1.113:{x:6,y:8,size:20},1.213:{x:5.5,y:8,size:20},"1.340d":{x:3.5,y:2.5,size:20},"1.440d":{x:8,y:2.5,size:20},1.351:{x:.5,y:9.5,size:20},1.451:{x:1,y:9.5,size:20},1.151:{x:1,y:10,size:20},1.224:{x:11.5,y:7,size:20},"1.224d":{x:11.5,y:0,size:20},"1.451d":{x:1,y:4.5,size:20},1.335:{x:11.5,y:8.5,size:20},1.462:{x:0,y:5.5,size:20},1.162:{x:0,y:5,size:20},1.235:{x:11.5,y:9,size:20},"1.462d":{x:0,y:4.5,size:20},"1.162d":{x:0,y:6,size:20},1.346:{x:11.5,y:7.5,size:20},1.473:{x:8,y:6.5,size:20},1.173:{x:8,y:7,size:20},1.273:{x:7.5,y:7,size:20},"1.346d":{x:2.5,y:4.5,size:20},"1.173d":{x:9,y:3,size:20},1.357:{x:5.5,y:10.5,size:20},1.457:{x:6,y:10.5,size:20},1.104:{x:6,y:5,size:20},1.204:{x:5.5,y:5,size:20},"1.104d":{x:7,y:5,size:20},"1.204d":{x:4.5,y:5,size:20},1.315:{x:3.5,y:6.5,size:20},"1.460":{x:0,y:7.5,size:20},1.115:{x:4,y:7,size:20},1.215:{x:3.5,y:7,size:20},"1.460d":{x:9,y:4.5,size:20},"1.215d":{x:2.5,y:3,size:20},1.326:{x:11.5,y:5.5,size:20},1.471:{x:0,y:8.5,size:20},1.171:{x:0,y:9,size:20},1.226:{x:11.5,y:5,size:20},"1.326d":{x:11.5,y:4.5,size:20},"1.226d":{x:11.5,y:6,size:20},1.347:{x:9.5,y:10.5,size:20},1.447:{x:10,y:10.5,size:20},1.103:{x:9,y:6,size:20},1.203:{x:8.5,y:6,size:20},"1.347d":{x:3.5,y:1.5,size:20},"1.103d":{x:4,y:1,size:20},"1.350":{x:1.5,y:10.5,size:20},"1.450":{x:2,y:10.5,size:20},1.114:{x:3,y:6,size:20},1.214:{x:2.5,y:6,size:20},"1.214d":{x:7.5,y:1,size:20},"1.450d":{x:8,y:1.5,size:20},1.325:{x:4.5,y:7.5,size:20},1.461:{x:4,y:3.5,size:20},1.161:{x:4,y:4,size:20},1.225:{x:4.5,y:8,size:20},"1.225d":{x:8.5,y:5,size:20},"1.461d":{x:8,y:4.5,size:20},1.336:{x:7.5,y:3.5,size:20},1.472:{x:7,y:7.5,size:20},1.172:{x:7,y:8,size:20},1.236:{x:7.5,y:4,size:20},"1.336d":{x:3.5,y:4.5,size:20},"1.172d":{x:3,y:5,size:20},"1.300":{x:5.5,y:5.5,size:20},"1.400":{x:6,y:5.5,size:20},"1.100":{x:6,y:6,size:20},"1.200":{x:5.5,y:6,size:20},"1.300d":{x:5.5,y:8.5,size:20},"1.400d":{x:6,y:8.5,size:20},"1.100d":{x:6,y:10,size:20},"1.200d":{x:5.5,y:10,size:20}},tagpro.tiles.tileCanvases={};var w=$(overrideableAssets.tiles);tagpro.tiles.image=w[0],tagpro.tiles.images={gravityWell:$(overrideableAssets.gravityWell)[0]},tagpro.events.defineCustomTiles&&tagpro.events.defineCustomTiles.forEach(function(e){e.defineCustomTiles(tagpro.tiles)});var E=[],S=[];tagpro.tiles.createAnimation=s,tagpro.tiles.drawNext=function(){while(S.length)S.pop()()},this.firstLoad=!1,tagpro.tiles.drawWithZoom=function(e,t,n,r,i,s){return tagpro.tiles.draw(e,t,n,r,i,s,!0)},tagpro.tiles.getTexture=function(e,t,n){if(!PIXI.utils.TextureCache[e]){t||(t=tagpro.tiles[e]),n||(n=t.spread||0);var r=t.source?tagpro.tiles.images[t.source]:tagpro.tiles.image,i=document.createElement("canvas");i.width=t.size||40,i.height=t.size||40;var s=i.getContext("2d"),o=t.x*40-n,u=t.y*40-n,a=(t.size||40)+n*2;s.drawImage(r,o,u,a,a,0,0,a,a),PIXI.utils.TextureCache[e]=PIXI.Texture.fromCanvas(i)}return PIXI.utils.TextureCache[e]},tagpro.tiles.draw=function(e,t,n,r,i,s,o){var u=tagpro.tiles[t];if(!u||u.draw)return;var a=u.spread||0,f=u.size||r,l=u.size||i,c=function(){var f=tagpro.tiles.getTexture(t,u,a),l=new PIXI.Sprite(f);return l.position.x=n.x,l.position.y=n.y,l.width=r||40,l.height=i||40,l.alpha=u.alpha||s||1,o?e.addChildAt(l,0):e.addChild(l),l};if(!a)return c();S.push(c),n={x:n.x,y:n.y}},tagpro.tiles.animations={},tagpro.tiles.drawLayers=function(e,t,n,r,i){var s=tagpro.tiles[tagpro.map[t][n]];if(!s)return;var o=s instanceof PIXI.extras.AnimatedSprite;tagpro.tiles.draw(e,{x:1,y:0},r),tagpro.floorMap[t][n]&&tagpro.tiles.draw(e,tagpro.floorMap[t][n],r),o?tagpro.tiles.draw(e,2,r):Math.floor(tagpro.map[t][n])==1?(tagpro.tiles.draw(e,tagpro.wallMap[t][n][0],r,20,20),tagpro.tiles.draw(e,tagpro.wallMap[t][n][1],{x:r.x+20,y:r.y},20,20),tagpro.tiles.draw(e,tagpro.wallMap[t][n][2],{x:r.x+20,y:r.y+20},20,20),tagpro.tiles.draw(e,tagpro.wallMap[t][n][3],{x:r.x,y:r.y+20},20,20)):s.dynamic||tagpro.tiles.draw(e,tagpro.map[t][n],r)},x()}),$(document).ready(function(){var e=JSON.parse($.trim($("#textures").text()));if(!e)try{e=JSON.parse($.cookie("textures"))}catch(t){}if(e){var n={},r=["tiles","speedpad","speedpadRed","speedpadBlue","portal","splats","gravityWell"];r.forEach(function(t){e[t]&&(n[t]=tagpro.helpers.rebaseToCDN(e[t]))}),tagpro.loadAssets(n)}}),function(e){if(typeof exports=="object"&&typeof module!="undefined")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.PIXI=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){"use strict";"use restrict";function i(e){var t=32;return e&=-e,e&&t--,e&65535&&(t-=16),e&16711935&&(t-=8),e&252645135&&(t-=4),e&858993459&&(t-=2),e&1431655765&&(t-=1),t}var r=32;n.INT_BITS=r,n.INT_MAX=2147483647,n.INT_MIN=-1<<r-1,n.sign=function(e){return(e>0)-(e<0)},n.abs=function(e){var t=e>>r-1;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(e<t)},n.max=function(e,t){return e^(e^t)&-(e<t)},n.isPow2=function(e){return!(e&e-1)&&!!e},n.log2=function(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1},n.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},n.popCount=function(e){return e-=e>>>1&1431655765,e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24},n.countTrailingZeros=i,n.nextPow2=function(e){return e+=e===0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,27030>>>e&1};var s=new Array(256);(function(e){for(var t=0;t<256;++t){var n=t,r=t,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=n&1,--i;e[t]=r<<i&255}})(s),n.reverse=function(e){return s[e&255]<<24|s[e>>>8&255]<<16|s[e>>>16&255]<<8|s[e>>>24&255]},n.interleave2=function(e,t){return e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1},n.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=(e|e>>>1)&858993459,e=(e|e>>>2)&252645135,e=(e|e>>>4)&16711935,e=(e|e>>>16)&65535,e<<16>>16},n.interleave3=function(e,t,n){return e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,e|=t<<1,n&=1023,n=(n|n<<16)&4278190335,n=(n|n<<8)&251719695,n=(n|n<<4)&3272356035,n=(n|n<<2)&1227133513,e|n<<2},n.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=(e|e>>>2)&3272356035,e=(e|e>>>4)&251719695,e=(e|e>>>8)&4278190335,e=(e|e>>>16)&1023,e<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>i(e)+1}},{}],2:[function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r=t&&t.length,s=r?t[0]*n:e.length,u=i(e,0,s,n,!0),a=[];if(!u)return a;var f,l,h,p,d,v,m;r&&(u=c(e,t,u,n));if(e.length>80*n){f=h=e[0],l=p=e[1];for(var g=n;g<s;g+=n)d=e[g],v=e[g+1],d<f&&(f=d),v<l&&(l=v),d>h&&(h=d),v>p&&(p=v);m=Math.max(h-f,p-l)}return o(u,a,n,f,l,m),a}function i(e,t,n,r,i){var s,o;if(i===M(e,t,n,r)>0)for(s=t;s<n;s+=r)o=L(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=L(s,e[s],e[s+1],o);return o&&S(o,o.next)&&(A(o),o=o.next),o}function s(e,t){if(!e)return e;t||(t=e);var n=e,r;do{r=!1;if(!n.steiner&&(S(n,n.next)||E(n.prev,n,n.next)===0)){A(n),n=t=n.prev;if(n===n.next)return null;r=!0}else n=n.next}while(r||n!==t);return t}function o(e,t,n,r,i,c,h){if(!e)return;!h&&c&&v(e,r,i,c);var p=e,d,m;while(e.prev!==e.next){d=e.prev,m=e.next;if(c?a(e,r,i,c):u(e)){t.push(d.i/n),t.push(e.i/n),t.push(m.i/n),A(e),e=m.next,p=m.next;continue}e=m;if(e===p){h?h===1?(e=f(e,t,n),o(e,t,n,r,i,c,2)):h===2&&l(e,t,n,r,i,c):o(s(e),t,n,r,i,c,1);break}}}function u(e){var t=e.prev,n=e,r=e.next;if(E(t,n,r)>=0)return!1;var i=e.next.next;while(i!==e.prev){if(b(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&E(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,n,r){var i=e.prev,s=e,o=e.next;if(E(i,s,o)>=0)return!1;var u=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,a=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,f=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,l=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=g(u,a,t,n,r),h=g(f,l,t,n,r),p=e.nextZ;while(p&&p.z<=h){if(p!==e.prev&&p!==e.next&&b(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&E(p.prev,p,p.next)>=0)return!1;p=p.nextZ}p=e.prevZ;while(p&&p.z>=c){if(p!==e.prev&&p!==e.next&&b(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&E(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function f(e,t,n){var r=e;do{var i=r.prev,s=r.next.next;!S(i,s)&&x(i,r,r.next,s)&&N(i,s)&&N(s,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(s.i/n),A(r),A(r.next),r=e=s),r=r.next}while(r!==e);return r}function l(e,t,n,r,i,u){var a=e;do{var f=a.next.next;while(f!==a.prev){if(a.i!==f.i&&w(a,f)){var l=k(a,f);a=s(a,a.next),l=s(l,l.next),o(a,t,n,r,i,u),o(l,t,n,r,i,u);return}f=f.next}a=a.next}while(a!==e)}function c(e,t,n,r){var o=[],u,a,f,l,c;for(u=0,a=t.length;u<a;u++)f=t[u]*r,l=u<a-1?t[u+1]*r:e.length,c=i(e,f,l,r,!1),c===c.next&&(c.steiner=!0),o.push(y(c));o.sort(h);for(u=0;u<o.length;u++)p(o[u],n),n=s(n,n.next);return n}function h(e,t){return e.x-t.x}function p(e,t){t=d(e,t);if(t){var n=k(t,e);s(n,n.next)}}function d(e,t){var n=t,r=e.x,i=e.y,s=-Infinity,o;do{if(i<=n.y&&i>=n.next.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>s){s=u;if(u===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(r===s)return o.prev;var a=o,f=o.x,l=o.y,c=Infinity,h;n=o.next;while(n!==a)r>=n.x&&n.x>=f&&b(i<l?r:s,i,f,l,i<l?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),(h<c||h===c&&n.x>o.x)&&N(n,e)&&(o=n,c=h)),n=n.next;return o}function v(e,t,n,r){var i=e;do i.z===null&&(i.z=g(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,m(i)}function m(e){var t,n,r,i,s,o,u,a,f=1;do{n=e,e=null,s=null,o=0;while(n){o++,r=n,u=0;for(t=0;t<f;t++){u++,r=r.nextZ;if(!r)break}a=f;while(u>0||a>0&&r)u===0?(i=r,r=r.nextZ,a--):a===0||!r?(i=n,n=n.nextZ,u--):n.z<=r.z?(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,a--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,f*=2}while(o>1);return e}function g(e,t,n,r,i){return e=32767*(e-n)/i,t=32767*(t-r)/i,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function y(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function b(e,t,n,r,i,s,o,u){return(i-o)*(t-u)-(e-o)*(s-u)>=0&&(e-o)*(r-u)-(n-o)*(t-u)>=0&&(n-o)*(s-u)-(i-o)*(r-u)>=0}function w(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!T(e,t)&&N(e,t)&&N(t,e)&&C(e,t)}function E(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function S(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,n,r){return S(e,t)&&S(n,r)||S(e,r)&&S(n,t)?!0:E(e,t,n)>0!=E(e,t,r)>0&&E(n,r,e)>0!=E(n,r,t)>0}function T(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&x(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function N(e,t){return E(e.prev,e,e.next)<0?E(e,t,e.next)>=0&&E(e,e.prev,t)>=0:E(e,t,e.prev)<0||E(e,e.next,t)<0}function C(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do n.y>s!=n.next.y>s&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function k(e,t){var n=new O(e.i,e.x,e.y),r=new O(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function L(e,t,n,r){var i=new O(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function O(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(e,t,n,r){var i=0;for(var s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}t.exports=r,r.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(M(e,0,s,n));if(i)for(var u=0,a=t.length;u<a;u++){var f=t[u]*n,l=u<a-1?t[u+1]*n:e.length;o-=Math.abs(M(e,f,l,n))}var c=0;for(u=0;u<r.length;u+=3){var h=r[u]*n,p=r[u+1]*n,d=r[u+2]*n;c+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)},r.flatten=function(e){var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0;for(var i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},{}],3:[function(e,t,n){"use strict";function s(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function u(){this._events=new s,this._eventsCount=0}var r=Object.prototype.hasOwnProperty,i="~";Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),u.prototype.eventNames=function(){var t=[],n,s;if(this._eventsCount===0)return t;for(s in n=this._events)r.call(n,s)&&t.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(n)):t},u.prototype.listeners=function(t,n){var r=i?i+t:t,s=this._events[r];if(n)return!!s;if(!s)return[];if(s.fn)return[s.fn];for(var o=0,u=s.length,a=new Array(u);o<u;o++)a[o]=s[o].fn;return a},u.prototype.emit=function(t,n,r,s,o,u){var a=i?i+t:t;if(!this._events[a])return!1;var f=this._events[a],l=arguments.length,c,h;if(f.fn){f.once&&this.removeListener(t,f.fn,undefined,!0);switch(l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,n),!0;case 3:return f.fn.call(f.context,n,r),!0;case 4:return f.fn.call(f.context,n,r,s),!0;case 5:return f.fn.call(f.context,n,r,s,o),!0;case 6:return f.fn.call(f.context,n,r,s,o,u),!0}for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];f.fn.apply(f.context,c)}else{var p=f.length,d;for(h=0;h<p;h++){f[h].once&&this.removeListener(t,f[h].fn,undefined,!0);switch(l){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,n);break;case 3:f[h].fn.call(f[h].context,n,r);break;case 4:f[h].fn.call(f[h].context,n,r,s);break;default:if(!c)for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];f[h].fn.apply(f[h].context,c)}}}return!0},u.prototype.on=function(t,n,r){var s=new o(n,r||this),u=i?i+t:t;return this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],s]:this._events[u].push(s):(this._events[u]=s,this._eventsCount++),this},u.prototype.once=function(t,n,r){var s=new o(n,r||this,!0),u=i?i+t:t;return this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],s]:this._events[u].push(s):(this._events[u]=s,this._eventsCount++),this},u.prototype.removeListener=function(t,n,r,o){var u=i?i+t:t;if(!this._events[u])return this;if(!n)return--this._eventsCount===0?this._events=new s:delete this._events[u],this;var a=this._events[u];if(a.fn)a.fn===n&&(!o||a.once)&&(!r||a.context===r)&&(--this._eventsCount===0?this._events=new s:delete this._events[u]);else{for(var f=0,l=[],c=a.length;f<c;f++)(a[f].fn!==n||o&&!a[f].once||r&&a[f].context!==r)&&l.push(a[f]);l.length?this._events[u]=l.length===1?l[0]:l:--this._eventsCount===0?this._events=new s:delete this._events[u]}return this},u.prototype.removeAllListeners=function(t){var n;return t?(n=i?i+t:t,this._events[n]&&(--this._eventsCount===0?this._events=new s:delete this._events[n])):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=i,u.EventEmitter=u,"undefined"!=typeof t&&(t.exports=u)},{}],4:[function(t,n,r){(function(t){var r=/iPhone/i,i=/iPod/i,s=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,u=/Android/i,a=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,f=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,l=/Windows Phone/i,c=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,h=/BlackBerry/i,p=/BB10/i,d=/Opera Mini/i,v=/(CriOS|Chrome)(?=.*\bMobile\b)/i,m=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,g=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(e,t){return e.test(t)},b=function(e){var t=e||navigator.userAgent,n=t.split("[FBAN");typeof n[1]!="undefined"&&(t=n[0]),n=t.split("Twitter"),typeof n[1]!="undefined"&&(t=n[0]),this.apple={phone:y(r,t),ipod:y(i,t),tablet:!y(r,t)&&y(s,t),device:y(r,t)||y(i,t)||y(s,t)},this.amazon={phone:y(a,t),tablet:!y(a,t)&&y(f,t),device:y(a,t)||y(f,t)},this.android={phone:y(a,t)||y(o,t),tablet:!y(a,t)&&!y(o,t)&&(y(f,t)||y(u,t)),device:y(a,t)||y(f,t)||y(o,t)||y(u,t)},this.windows={phone:y(l,t),tablet:y(c,t),device:y(l,t)||y(c,t)},this.other={blackberry:y(h,t),blackberry10:y(p,t),opera:y(d,t),firefox:y(m,t),chrome:y(v,t),device:y(h,t)||y(p,t)||y(d,t)||y(m,t)||y(v,t)},this.seven_inch=y(g,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet;if(typeof window=="undefined")return this},w=function(){var e=new b;return e.Class=b,e};typeof n!="undefined"&&n.exports&&typeof window=="undefined"?n.exports=b:typeof n!="undefined"&&n.exports&&typeof window!="undefined"?n.exports=w():typeof e=="function"&&e.amd?e("isMobile",[],t.isMobile=w()):t.isMobile=w()})(this)},{}],5:[function(e,t,n){"use strict";function o(e){if(e===null||e===undefined)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function u(){try{if(!Object.assign)return!1;var e=new String("abc");e[5]="de";if(Object.getOwnPropertyNames(e)[0]==="5")return!1;var t={};for(var n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),Object.keys(Object.assign({},i)).join("")!=="abcdefghijklmnopqrst"?!1:!0}catch(s){return!1}}var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=u()?Object.assign:function(e,t){var n,u=o(e),a;for(var f=1;f<arguments.length;f++){n=Object(arguments[f]);for(var l in n)i.call(n,l)&&(u[l]=n[l]);if(r){a=r(n);for(var c=0;c<a.length;c++)s.call(n,a[c])&&(u[a[c]]=n[a[c]])}}return u}},{}],6:[function(e,t,n){var r=new ArrayBuffer(0),i=function(e,t,n,i){this.gl=e,this.buffer=e.createBuffer(),this.type=t||e.ARRAY_BUFFER,this.drawType=i||e.STATIC_DRAW,this.data=r,n&&this.upload(n),this._updateID=0};i.prototype.upload=function(e,t,n){n||this.bind();var r=this.gl;e=e||this.data,t=t||0,this.data.byteLength>=e.byteLength?r.bufferSubData(this.type,t,e):r.bufferData(this.type,e,this.drawType),this.data=e},i.prototype.bind=function(){var e=this.gl;e.bindBuffer(this.type,this.buffer)},i.createVertexBuffer=function(e,t,n){return new i(e,e.ARRAY_BUFFER,t,n)},i.createIndexBuffer=function(e,t,n){return new i(e,e.ELEMENT_ARRAY_BUFFER,t,n)},i.create=function(e,t,n,r){return new i(e,t,n,r)},i.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},t.exports=i},{}],7:[function(e,t,n){var r=e("./GLTexture"),i=function(e,t,n){this.gl=e,this.framebuffer=e.createFramebuffer(),this.stencil=null,this.texture=null,this.width=t||100,this.height=n||100};i.prototype.enableTexture=function(e){var t=this.gl;this.texture=e||new r(t),this.texture.bind(),this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.texture,0)},i.prototype.enableStencil=function(){if(this.stencil)return;var e=this.gl;this.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencil),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height)},i.prototype.clear=function(e,t,n,r){this.bind();var i=this.gl;i.clearColor(e,t,n,r),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},i.prototype.bind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer)},i.prototype.unbind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},i.prototype.resize=function(e,t){var n=this.gl;this.width=e,this.height=t,this.texture&&this.texture.uploadData(null,e,t),this.stencil&&(n.bindRenderbuffer(n.RENDERBUFFER,this.stencil),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t))},i.prototype.destroy=function(){var e=this.gl;this.texture&&this.texture.destroy(),e.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},i.createRGBA=function(e,t,n,s){var o=r.fromData(e,null,t,n);o.enableNearestScaling(),o.enableWrapClamp();var u=new i(e,t,n);return u.enableTexture(o),u.unbind(),u},i.createFloat32=function(e,t,n,s){var o=new r.fromData(e,s,t,n);o.enableNearestScaling(),o.enableWrapClamp();var u=new i(e,t,n);return u.enableTexture(o),u.unbind(),u},t.exports=i},{"./GLTexture":9}],8:[function(e,t,n){var r=e("./shader/compileProgram"),i=e("./shader/extractAttributes"),s=e("./shader/extractUniforms"),o=e("./shader/setPrecision"),u=e("./shader/generateUniformAccessObject"),a=function(e,t,n,a,f){this.gl=e,a&&(t=o(t,a),n=o(n,a)),this.program=r(e,t,n,f),this.attributes=i(e,this.program),this.uniformData=s(e,this.program),this.uniforms=u(e,this.uniformData)};a.prototype.bind=function(){this.gl.useProgram(this.program)},a.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null;var e=this.gl;e.deleteProgram(this.program)},t.exports=a},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18,"./shader/setPrecision":22}],9:[function(e,t,n){var r=function(e,t,n,r,i){this.gl=e,this.texture=e.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=t||-1,this.height=n||-1,this.format=r||e.RGBA,this.type=i||e.UNSIGNED_BYTE};r.prototype.upload=function(e){this.bind();var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var n=e.videoWidth||e.width,r=e.videoHeight||e.height;r!==this.height||n!==this.width?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,this.type,e):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.format,this.type,e),this.width=n,this.height=r};var i=!1;r.prototype.uploadData=function(e,t,n){this.bind();var r=this.gl;if(e instanceof Float32Array){if(!i){var s=r.getExtension("OES_texture_float");if(!s)throw new Error("floating point textures not available");i=!0}this.type=r.FLOAT}else this.type=this.type||r.UNSIGNED_BYTE;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t!==this.width||n!==this.height?r.texImage2D(r.TEXTURE_2D,0,this.format,t,n,0,this.format,this.type,e||null):r.texSubImage2D(r.TEXTURE_2D,0,0,0,t,n,this.format,this.type,e||null),this.width=t,this.height=n},r.prototype.bind=function(e){var t=this.gl;e!==undefined&&t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)},r.prototype.unbind=function(){var e=this.gl;e.bindTexture(e.TEXTURE_2D,null)},r.prototype.minFilter=function(e){var t=this.gl;this.bind(),this.mipmap?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR:t.NEAREST)},r.prototype.magFilter=function(e){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e?t.LINEAR:t.NEAREST)},r.prototype.enableMipmap=function(){var e=this.gl;this.bind(),this.mipmap=!0,e.generateMipmap(e.TEXTURE_2D)},r.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},r.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},r.prototype.enableWrapClamp=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},r.prototype.enableWrapRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)},r.prototype.enableWrapMirrorRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT)},r.prototype.destroy=function(){var e=this.gl;e.deleteTexture(this.texture)},r.fromSource=function(e,t,n){var i=new r(e);return i.premultiplyAlpha=n||!1,i.upload(t),i},r.fromData=function(e,t,n,i){var s=new r(e);return s.uploadData(t,n,i),s},t.exports=r},{}],10:[function(e,t,n){function i(e,t){this.nativeVaoExtension=null,i.FORCE_NATIVE||(this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=t;if(this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var n=e.getParameter(e.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(n),attribState:new Array(n)}}this.gl=e,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var r=e("./setVertexAttribArrays");i.prototype.constructor=i,t.exports=i,i.FORCE_NATIVE=!1,i.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},i.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},i.prototype.activate=function(){var e=this.gl,t=null;for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n];t!==i.buffer&&(i.buffer.bind(),t=i.buffer),e.vertexAttribPointer(i.attribute.location,i.attribute.size,i.type||e.FLOAT,i.normalized||!1,i.stride||0,i.start||0)}return r(e,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},i.prototype.addAttribute=function(e,t,n,r,i,s){return this.attributes.push({buffer:e,attribute:t,location:t.location,type:n||this.gl.FLOAT,normalized:r||!1,stride:i||0,start:s||0}),this.dirty=!0,this},i.prototype.addIndex=function(e){return this.indexBuffer=e,this.dirty=!0,this},i.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},i.prototype.draw=function(e,t,n){var r=this.gl;return this.indexBuffer?r.drawElements(e,t||this.indexBuffer.data.length,r.UNSIGNED_SHORT,(n||0)*2):r.drawArrays(e,n,t||this.getSize()),this},i.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},i.prototype.getSize=function(){var e=this.attributes[0];return e.buffer.data.length/(e.stride/4||e.attribute.size)}},{"./setVertexAttribArrays":13}],11:[function(e,t,n){var r=function(e,t){var n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);if(!n)throw new Error("This browser does not support webGL. Try using the canvas renderer");return n};t.exports=r},{}],12:[function(e,t,n){var r={createContext:e("./createContext"),setVertexAttribArrays:e("./setVertexAttribArrays"),GLBuffer:e("./GLBuffer"),GLFramebuffer:e("./GLFramebuffer"),GLShader:e("./GLShader"),GLTexture:e("./GLTexture"),VertexArrayObject:e("./VertexArrayObject"),shader:e("./shader")};typeof t!="undefined"&&t.exports&&(t.exports=r),typeof window!="undefined"&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=r)},{"./GLBuffer":6,"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(e,t,n){var r=function(e,t,n){var r;if(n){var i=n.tempAttribState,s=n.attribState;for(r=0;r<i.length;r++)i[r]=!1;for(r=0;r<t.length;r++)i[t[r].attribute.location]=!0;for(r=0;r<s.length;r++)s[r]!==i[r]&&(s[r]=i[r],n.attribState[r]?e.enableVertexAttribArray(r):e.disableVertexAttribArray(r))}else for(r=0;r<t.length;r++){var o=t[r];e.enableVertexAttribArray(o.attribute.location)}};t.exports=r},{}],14:[function(e,t,n){var r=function(e,t,n,r){var s=i(e,e.VERTEX_SHADER,t),o=i(e,e.FRAGMENT_SHADER,n),u=e.createProgram();e.attachShader(u,s),e.attachShader(u,o);if(r)for(var a in r)e.bindAttribLocation(u,r[a],a);return e.linkProgram(u),e.getProgramParameter(u,e.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(u,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),e.getProgramInfoLog(u)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(u)),e.deleteProgram(u),u=null),e.deleteShader(s),e.deleteShader(o),u},i=function(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.log(e.getShaderInfoLog(r)),null)};t.exports=r},{}],15:[function(e,t,n){var r=function(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return i(2*t);case"bvec3":return i(3*t);case"bvec4":return i(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},i=function(e){var t=new Array(e);for(var n=0;n<t.length;n++)t[n]=!1;return t};t.exports=r},{}],16:[function(e,t,n){var r=e("./mapType"),i=e("./mapSize"),s=function(e,t){var n={},s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(var u=0;u<s;u++){var a=e.getActiveAttrib(t,u),f=r(e,a.type);n[a.name]={type:f,size:i(f),location:e.getAttribLocation(t,a.name),pointer:o}}return n},o=function(e,t,n,r){gl.vertexAttribPointer(this.location,this.size,e||gl.FLOAT,t||!1,n||0,r||0)};t.exports=s},{"./mapSize":20,"./mapType":21}],17:[function(e,t,n){var r=e("./mapType"),i=e("./defaultValue"),s=function(e,t){var n={},s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(var o=0;o<s;o++){var u=e.getActiveUniform(t,o),a=u.name.replace(/\[.*?\]/,""),f=r(e,u.type);n[a]={type:f,size:u.size,location:e.getUniformLocation(t,a),value:i(f,u.size)}}return n};t.exports=s},{"./defaultValue":15,"./mapType":21}],18:[function(e,t,n){var r=function(e,t){var n={data:{}};n.gl=e;var r=Object.keys(t);for(var u=0;u<r.length;u++){var a=r[u],f=a.split("."),l=f[f.length-1],c=o(f,n),h=t[a];c.data[l]=h,c.gl=e,Object.defineProperty(c,l,{get:i(l),set:s(l,h)})}return n},i=function(e){var t=u.replace("%%",e);return new Function(t)},s=function(e,t){var n=a.replace(/%%/g,e),r;return t.size===1?r=f[t.type]:r=l[t.type],r&&(n+="\nthis.gl."+r+";"),new Function("value",n)},o=function(e,t){var n=t;for(var r=0;r<e.length-1;r++){var i=n[e[r]]||{data:{}};n[e[r]]=i,n=i}return n},u=["return this.data.%%.value;"].join("\n"),a=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),f={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},l={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};t.exports=r},{}],19:[function(e,t,n){t.exports={compileProgram:e("./compileProgram"),defaultValue:e("./defaultValue"),extractAttributes:e("./extractAttributes"),extractUniforms:e("./extractUniforms"),generateUniformAccessObject:e("./generateUniformAccessObject"),setPrecision:e("./setPrecision"),mapSize:e("./mapSize"),mapType:e("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21,"./setPrecision":22}],20:[function(e,t,n){var r=function(e){return i[e]},i={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};t.exports=r},{}],21:[function(e,t,n){var r=function(e,t){if(!i){var n=Object.keys(s);i={};for(var r=0;r<n.length;++r){var o=n[r];i[e[o]]=s[o]}}return i[t]},i=null,s={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};t.exports=r},{}],22:[function(e,t,n){var r=function(e,t){return e.substring(0,9)!=="precision"?"precision "+t+" float;\n"+e:e};t.exports=r},{}],23:[function(e,t,n){(function(e){function t(e,t){var n=0;for(var r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function s(e,t){if(e.filter)return e.filter(t);var n=[];for(var r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return r.exec(e).slice(1)};n.resolve=function(){var n="",r=!1;for(var i=arguments.length-1;i>=-1&&!r;i--){var o=i>=0?arguments[i]:e.cwd();if(typeof o!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!o)continue;n=o+"/"+n,r=o.charAt(0)==="/"}return n=t(s(n.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(e){var r=n.isAbsolute(e),i=o(e,-1)==="/";return e=t(s(e.split("/"),function(e){return!!e}),!r).join("/"),!e&&!r&&(e="."),e&&i&&(e+="/"),(r?"/":"")+e},n.isAbsolute=function(e){return e.charAt(0)==="/"},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(s(e,function(e,t){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){var t=0;for(;t<e.length;t++)if(e[t]!=="")break;var n=e.length-1;for(;n>=0;n--)if(e[n]!=="")break;return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);var i=r(e.split("/")),s=r(t.split("/")),o=Math.min(i.length,s.length),u=o;for(var a=0;a<o;a++)if(i[a]!==s[a]){u=a;break}var f=[];for(var a=u;a<i.length;a++)f.push("..");return f=f.concat(s.slice(u)),f.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=i(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)},n.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return i(e)[3]};var o="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,e("_process"))},{_process:24}],24:[function(e,t,n){function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function f(e){if(s===clearTimeout)return clearTimeout(e);if((s===u||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{return s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}function d(){if(!c||!h)return;c=!1,h.length?l=h.concat(l):p=-1,l.length&&v()}function v(){if(c)return;var e=a(d);c=!0;var t=l.length;while(t){h=l,l=[];while(++p<t)h&&h[p].run();p=-1,t=l.length}h=null,c=!1,f(e)}function m(e,t){this.fun=e,this.array=t}function g(){}var r=t.exports={},i,s;(function(){try{typeof setTimeout=="function"?i=setTimeout:i=o}catch(e){i=o}try{typeof clearTimeout=="function"?s=clearTimeout:s=u}catch(e){s=u}})();var l=[],c=!1,h,p=-1;r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),l.length===1&&!c&&a(v)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],25:[function(t,n,r){(function(t){(function(i){function C(e){throw new RangeError(E[e])}function k(e,t){var n=e.length,r=[];while(n--)r[n]=t(e[n]);return r}function L(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(w,".");var i=e.split("."),s=k(i,t).join(".");return r+s}function A(e){var t=[],n=0,r=e.length,i,s;while(n<r)i=e.charCodeAt(n++),i>=55296&&i<=56319&&n<r?(s=e.charCodeAt(n++),(s&64512)==56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),n--)):t.push(i);return t}function O(e){return k(e,function(e){var t="";return e>65535&&(e-=65536,t+=T(e>>>10&1023|55296),e=56320|e&1023),t+=T(e),t}).join("")}function M(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:l}function _(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function D(e,t,n){var r=0;e=n?x(e/d):e>>1,e+=x(e/t);for(;e>S*h>>1;r+=l)e=x(e/S);return x(r+(S+1)*e/(e+p))}function P(e){var t=[],n=e.length,r,i=0,s=m,o=v,u,a,p,d,y,b,w,E,S;u=e.lastIndexOf(g),u<0&&(u=0);for(a=0;a<u;++a)e.charCodeAt(a)>=128&&C("not-basic"),t.push(e.charCodeAt(a));for(p=u>0?u+1:0;p<n;){for(d=i,y=1,b=l;;b+=l){p>=n&&C("invalid-input"),w=M(e.charCodeAt(p++)),(w>=l||w>x((f-i)/y))&&C("overflow"),i+=w*y,E=b<=o?c:b>=o+h?h:b-o;if(w<E)break;S=l-E,y>x(f/S)&&C("overflow"),y*=S}r=t.length+1,o=D(i-d,r,d==0),x(i/r)>f-s&&C("overflow"),s+=x(i/r),i%=r,t.splice(i++,0,s)}return O(t)}function H(e){var t,n,r,i,s,o,u,a,p,d,y,b=[],w,E,S,N;e=A(e),w=e.length,t=m,n=0,s=v;for(o=0;o<w;++o)y=e[o],y<128&&b.push(T(y));r=i=b.length,i&&b.push(g);while(r<w){for(u=f,o=0;o<w;++o)y=e[o],y>=t&&y<u&&(u=y);E=r+1,u-t>x((f-n)/E)&&C("overflow"),n+=(u-t)*E,t=u;for(o=0;o<w;++o){y=e[o],y<t&&++n>f&&C("overflow");if(y==t){for(a=n,p=l;;p+=l){d=p<=s?c:p>=s+h?h:p-s;if(a<d)break;N=a-d,S=l-d,b.push(T(_(d+N%S,0))),a=x(N/S)}b.push(T(_(a,0))),s=D(n,E,r==i),n=0,++r}}++n,++t}return b.join("")}function B(e){return L(e,function(e){return y.test(e)?P(e.slice(4).toLowerCase()):e})}function j(e){return L(e,function(e){return b.test(e)?"xn--"+H(e):e})}var s=typeof r=="object"&&r&&!r.nodeType&&r,o=typeof n=="object"&&n&&!n.nodeType&&n,u=typeof t=="object"&&t;if(u.global===u||u.window===u||u.self===u)i=u;var a,f=2147483647,l=36,c=1,h=26,p=38,d=700,v=72,m=128,g="-",y=/^xn--/,b=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=l-c,x=Math.floor,T=String.fromCharCode,N;a={version:"1.4.1",ucs2:{decode:A,encode:O},decode:P,encode:H,toASCII:j,toUnicode:B};if(typeof e=="function"&&typeof e.amd=="object"&&e.amd)e("punycode",function(){return a});else if(s&&o)if(n.exports==s)o.exports=a;else for(N in a)a.hasOwnProperty(N)&&(s[N]=a[N]);else i.punycode=a})(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],26:[function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,s){t=t||"&",n=n||"=";var o={};if(typeof e!="string"||e.length===0)return o;var u=/\+/g;e=e.split(t);var a=1e3;s&&typeof s.maxKeys=="number"&&(a=s.maxKeys);var f=e.length;a>0&&f>a&&(f=a);for(var l=0;l<f;++l){var c=e[l].replace(u,"%20"),h=c.indexOf(n),p,d,v,m;h>=0?(p=c.substr(0,h),d=c.substr(h+1)):(p=c,d=""),v=decodeURIComponent(p),m=decodeURIComponent(d),r(o,v)?i(o[v])?o[v].push(m):o[v]=[o[v],m]:o[v]=m}return o};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},{}],27:[function(e,t,n){"use strict";function s(e,t){if(e.map)return e.map(t);var n=[];for(var r=0;r<e.length;r++)n.push(t(e[r],r));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,u){return t=t||"&",n=n||"=",e===null&&(e=undefined),typeof e=="object"?s(o(e),function(o){var u=encodeURIComponent(r(o))+n;return i(e[o])?s(e[o],function(e){return u+encodeURIComponent(r(e))}).join(t):u+encodeURIComponent(r(e[o]))}).join(t):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],28:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":26,"./encode":27}],29:[function(e,t,n){"use strict";function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function E(e,t,n){if(e&&i.isObject(e)&&e instanceof s)return e;var r=new s;return r.parse(e,t,n),r}function S(e){return i.isString(e)&&(e=E(e)),e instanceof s?e.format():s.prototype.format.call(e)}function x(e,t){return E(e,!1,!0).resolve(t)}function T(e,t){return e?E(e,!1,!0).resolveObject(t):t}var r=e("punycode"),i=e("./util");n.parse=E,n.resolve=x,n.resolveObject=T,n.format=S,n.Url=s;var o=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,f=["<",">",'"',"`"," ","\r","\n","	"],l=["{","}","|","\\","^","`"].concat(f),c=["'"].concat(l),h=["%","/","?",";","#"].concat(c),p=["/","?","#"],d=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=e("querystring");s.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),u=s!==-1&&s<e.indexOf("#")?"?":"#",f=e.split(u),l=/\\/g;f[0]=f[0].replace(l,"/"),e=f.join(u);var E=e;E=E.trim();if(!n&&e.split("#").length===1){var S=a.exec(E);if(S)return this.path=E,this.href=E,this.pathname=S[1],S[2]?(this.search=S[2],t?this.query=w.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var x=o.exec(E);if(x){x=x[0];var T=x.toLowerCase();this.protocol=T,E=E.substr(x.length)}if(n||x||E.match(/^\/\/[^@\/]+@[^@\/]+/)){var N=E.substr(0,2)==="//";N&&(!x||!y[x])&&(E=E.substr(2),this.slashes=!0)}if(!y[x]&&(N||x&&!b[x])){var C=-1;for(var k=0;k<p.length;k++){var L=E.indexOf(p[k]);L!==-1&&(C===-1||L<C)&&(C=L)}var A,O;C===-1?O=E.lastIndexOf("@"):O=E.lastIndexOf("@",C),O!==-1&&(A=E.slice(0,O),E=E.slice(O+1),this.auth=decodeURIComponent(A)),C=-1;for(var k=0;k<h.length;k++){var L=E.indexOf(h[k]);L!==-1&&(C===-1||L<C)&&(C=L)}C===-1&&(C=E.length),this.host=E.slice(0,C),E=E.slice(C),this.parseHost(),this.hostname=this.hostname||"";var M=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!M){var _=this.hostname.split(/\./);for(var k=0,D=_.length;k<D;k++){var P=_[k];if(!P)continue;if(!P.match(v)){var H="";for(var B=0,j=P.length;B<j;B++)P.charCodeAt(B)>127?H+="x":H+=P[B];if(!H.match(v)){var F=_.slice(0,k),I=_.slice(k+1),q=P.match(m);q&&(F.push(q[1]),I.unshift(q[2])),I.length&&(E="/"+I.join(".")+E),this.hostname=F.join(".");break}}}}this.hostname.length>d?this.hostname="":this.hostname=this.hostname.toLowerCase(),M||(this.hostname=r.toASCII(this.hostname));var R=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+R,this.href+=this.host,M&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),E[0]!=="/"&&(E="/"+E))}if(!g[T])for(var k=0,D=c.length;k<D;k++){var z=c[k];if(E.indexOf(z)===-1)continue;var W=encodeURIComponent(z);W===z&&(W=escape(z)),E=E.split(z).join(W)}var X=E.indexOf("#");X!==-1&&(this.hash=E.substr(X),E=E.slice(0,X));var V=E.indexOf("?");V!==-1?(this.search=E.substr(V),this.query=E.substr(V+1),t&&(this.query=w.parse(this.query)),E=E.slice(0,V)):t&&(this.search="",this.query={}),E&&(this.pathname=E),b[T]&&this.hostname&&!this.pathname&&(this.pathname="/");if(this.pathname||this.search){var R=this.pathname||"",$=this.search||"";this.path=R+$}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",s=!1,o="";this.host?s=e+this.host:this.hostname&&(s=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var u=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||b[t])&&s!==!1?(s="//"+(s||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):s||(s=""),r&&r.charAt(0)!=="#"&&(r="#"+r),u&&u.charAt(0)!=="?"&&(u="?"+u),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),u=u.replace("#","%23"),t+s+n+u+r},s.prototype.resolve=function(e){return this.resolveObject(E(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(i.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}var n=new s,r=Object.keys(this);for(var o=0;o<r.length;o++){var u=r[o];n[u]=this[u]}n.hash=e.hash;if(e.href==="")return n.href=n.format(),n;if(e.slashes&&!e.protocol){var a=Object.keys(e);for(var f=0;f<a.length;f++){var l=a[f];l!=="protocol"&&(n[l]=e[l])}return b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!b[e.protocol]){var c=Object.keys(e);for(var h=0;h<c.length;h++){var p=c[h];n[p]=e[p]}return n.href=n.format(),n}n.protocol=e.protocol;if(!e.host&&!y[e.protocol]){var d=(e.pathname||"").split("/");while(d.length&&!(e.host=d.shift()));e.host||(e.host=""),e.hostname||(e.hostname=""),d[0]!==""&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}else n.pathname=e.pathname;n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port;if(n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var g=n.pathname&&n.pathname.charAt(0)==="/",w=e.host||e.pathname&&e.pathname.charAt(0)==="/",E=w||g||n.host&&e.pathname,S=E,x=n.pathname&&n.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],T=n.protocol&&!b[n.protocol];T&&(n.hostname="",n.port=null,n.host&&(x[0]===""?x[0]=n.host:x.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(d[0]===""?d[0]=e.host:d.unshift(e.host)),e.host=null),E=E&&(d[0]===""||x[0]===""));if(w)n.host=e.host||e.host===""?e.host:n.host,n.hostname=e.hostname||e.hostname===""?e.hostname:n.hostname,n.search=e.search,n.query=e.query,x=d;else if(d.length)x||(x=[]),x.pop(),x=x.concat(d),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(T){n.hostname=n.host=x.shift();var N=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;N&&(n.auth=N.shift(),n.host=n.hostname=N.shift())}n.search=e.search,n.query=e.query;if(!i.isNull(n.pathname)||!i.isNull(n.search))n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"");return n.href=n.format(),n}if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;var C=x.slice(-1)[0],k=(n.host||e.host||x.length>1)&&(C==="."||C==="..")||C==="",L=0;for(var A=x.length;A>=0;A--)C=x[A],C==="."?x.splice(A,1):C===".."?(x.splice(A,1),L++):L&&(x.splice(A,1),L--);if(!E&&!S)for(;L--;L)x.unshift("..");E&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),k&&x.join("/").substr(-1)!=="/"&&x.push("");var O=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(T){n.hostname=n.host=O?"":x.length?x.shift():"";var N=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;N&&(n.auth=N.shift(),n.host=n.hostname=N.shift())}E=E||n.host&&x.length,E&&!O&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null);if(!i.isNull(n.pathname)||!i.isNull(n.search))n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"");return n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},s.prototype.parseHost=function(){var e=this.host,t=u.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":30,punycode:25,querystring:28}],30:[function(e,t,n){"use strict";t.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}},{}],31:[function(e,t,n){"use strict";t.exports=function(t,n,r){var i,s=t.length;if(n>=s||r===0)return;r=n+r>s?s-n:r;var o=s-r;for(i=n;i<o;++i)t[i]=t[i+r];t.length=o}},{}],32:[function(e,t,n){"use strict";function h(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{"default":e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("mini-signals"),s=p(i),o=e("parse-uri"),u=p(o),a=e("./async"),f=h(a),l=e("./Resource"),c=p(l),v=100,m=/(#[\w-]+)?$/,g=function(){function e(){var t=this,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;d(this,e),this.baseUrl=n,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,n){return t._loadResource(e,n)},this._queue=f.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new s.default,this.onError=new s.default,this.onLoad=new s.default,this.onStart=new s.default,this.onComplete=new s.default}return e.prototype.add=function(t,n,i,s){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}(typeof t=="undefined"?"undefined":r(t))==="object"&&(s=n||t.callback||t.onComplete,i=t,n=t.url,t=t.name||t.key||t.url),typeof n!="string"&&(s=i,i=n,n=t);if(typeof n!="string")throw new Error("No url passed to add resource to loader.");typeof i=="function"&&(s=i,i=null);if(this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');n=this._prepareUrl(n),this.resources[t]=new c.default(t,n,i),typeof s=="function"&&this.resources[t].onAfterMiddleware.once(s);if(this.loading){var u=i.parentResource,a=[];for(var f=0;f<u.children.length;++f)u.children[f].isComplete||a.push(u.children[f]);var l=u.progressChunk*(a.length+1),h=l/(a.length+2);u.children.push(this.resources[t]),u.progressChunk=h;for(var p=0;p<a.length;++p)a[p].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},e.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},e.prototype.use=function(t){return this._afterMiddleware.push(t),this},e.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var n=this.resources[t];n._onLoadBinding&&n._onLoadBinding.detach(),n.isLoading&&n.abort()}return this.resources={},this},e.prototype.load=function(t){typeof t=="function"&&this.onComplete.once(t);if(this.loading)return this;var n=100/this._queue._tasks.length;for(var r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=n;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},e.prototype._prepareUrl=function(t){var n=(0,u.default)(t,{strictMode:!0}),r=void 0;n.protocol||!n.path||t.indexOf("//")===0?r=t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?r=this.baseUrl+"/"+t:r=this.baseUrl+t;if(this.defaultQueryString){var i=m.exec(r)[0];r=r.substr(0,r.length-i.length),r.indexOf("?")!==-1?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=i}return r},e.prototype._loadResource=function(t,n){var r=this;t._dequeue=n,f.eachSeries(this._beforeMiddleware,function(e,n){e.call(r,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())},!0)},e.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},e.prototype._onLoad=function(t){var n=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),f.eachSeries(this._afterMiddleware,function(e,r){e.call(n,t,r)},function(){t.onAfterMiddleware.dispatch(t),n.progress+=t.progressChunk,n.onProgress.dispatch(n,t),t.error?n.onError.dispatch(t.error,n,t):n.onLoad.dispatch(n,t),n._resourcesParsing.splice(n._resourcesParsing.indexOf(t),1),n._queue.idle()&&n._resourcesParsing.length===0&&(n.progress=v,n._onComplete())},!0)},e}();n.default=g},{"./Resource":33,"./async":34,"mini-signals":38,"parse-uri":39}],33:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(){}function b(e,t,n){t&&t.indexOf(".")===0&&(t=t.substring(1));if(!t)return;e[t]=n}function w(e){return e.toString().replace("object ","")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("parse-uri"),s=a(i),o=e("mini-signals"),u=a(o),l=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),c=null,h=0,p=200,d=204,v=1223,m=2,y=function(){function e(t,n,r){f(this,e);if(typeof t!="string"||typeof n!="string")throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,n.indexOf("data:")===0),this.name=t,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=r.crossOrigin===!0?"anonymous":r.crossOrigin,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=g,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new u.default,this.onProgress=new u.default,this.onComplete=new u.default,this.onAfterMiddleware=new u.default}return e.setExtensionLoadType=function(n,r){b(e._loadTypeMap,n,r)},e.setExtensionXhrType=function(n,r){b(e._xhrTypeMap,n,r)},e.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null));if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},e.prototype.abort=function(n){if(this.error)return;this.error=new Error(n);if(this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else while(this.data.firstChild)this.data.removeChild(this.data.firstChild);this.complete()},e.prototype.load=function(n){var r=this;if(this.isLoading)return;if(this.isComplete){n&&setTimeout(function(){return n(r)},1);return}n&&this.onComplete.once(n),this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this);if(this.crossOrigin===!1||typeof this.crossOrigin!="string")this.crossOrigin=this._determineCrossOrigin(this.url);switch(this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement("image");break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement("audio");break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement("video");break;case e.LOAD_TYPE.XHR:default:l&&this.crossOrigin?this._loadXdr():this._loadXhr()}},e.prototype._hasFlag=function(t){return!!(this._flags&t)},e.prototype._setFlag=function(t,n){this._flags=n?this._flags|t:this._flags&~t},e.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&typeof window.Image!="undefined"?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},e.prototype._loadSourceElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&typeof window.Audio!="undefined"?this.data=new Audio:this.data=document.createElement(t);if(this.data===null){this.abort("Unsupported element: "+t);return}if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url)){var n=this.metadata.mimeType;for(var r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(n)?n[r]:n))}else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},e.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var n=this.xhr=new XMLHttpRequest;n.open("GET",this.url,!0),this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?n.responseType=e.XHR_RESPONSE_TYPE.TEXT:n.responseType=this.xhrType,n.addEventListener("error",this._boundXhrOnError,!1),n.addEventListener("abort",this._boundXhrOnAbort,!1),n.addEventListener("progress",this._boundOnProgress,!1),n.addEventListener("load",this._boundXhrOnLoad,!1),n.send()},e.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},e.prototype._createSource=function(t,n,r){r||(r=t+"/"+this._getExtension(n));var i=document.createElement("source");return i.src=n,i.type=r,i},e.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},e.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},e.prototype._xhrOnError=function(){var t=this.xhr;this.abort(w(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},e.prototype._xhrOnAbort=function(){this.abort(w(this.xhr)+" Request was aborted by the user.")},e.prototype._xdrOnTimeout=function(){this.abort(w(this.xhr)+" Request timed out.")},e.prototype._xhrOnLoad=function(){var n=this.xhr,r="",i=typeof n.status=="undefined"?p:n.status;if(n.responseType===""||n.responseType==="text"||typeof n.responseType=="undefined")r=n.responseText;i===h&&r.length>0?i=p:i===v&&(i=d);var s=i/100|0;if(s!==m){this.abort("["+n.status+"] "+n.statusText+": "+n.responseURL);return}if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=e.TYPE.JSON}catch(o){this.abort("Error trying to parse loaded json: "+o);return}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var u=new DOMParser;this.data=u.parseFromString(r,"text/xml")}else{var a=document.createElement("div");a.innerHTML=r,this.data=a}this.type=e.TYPE.XML}catch(o){this.abort("Error trying to parse loaded xml: "+o);return}else this.data=n.response||r;this.complete()},e.prototype._determineCrossOrigin=function(t,n){if(t.indexOf("data:")===0)return"";n=n||window.location,c||(c=document.createElement("a")),c.href=t,t=(0,s.default)(c.href,{strictMode:!0});var r=!t.port&&n.port===""||t.port===n.port,i=t.protocol?t.protocol+":":"";return t.host!==n.hostname||!r||i!==n.protocol?"anonymous":""},e.prototype._determineXhrType=function(){return e._xhrTypeMap[this.extension]||e.XHR_RESPONSE_TYPE.TEXT},e.prototype._determineLoadType=function(){return e._loadTypeMap[this.extension]||e.LOAD_TYPE.XHR},e.prototype._getExtension=function(){var t=this.url,n="";if(this.isDataUrl){var r=t.indexOf("/");n=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),s=t.indexOf("#"),o=Math.min(i>-1?i:t.length,s>-1?s:t.length);t=t.substring(0,o),n=t.substring(t.lastIndexOf(".")+1)}return n.toLowerCase()},e.prototype._getMimeFromXhrType=function(n){switch(n){case e.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case e.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case e.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case e.XHR_RESPONSE_TYPE.JSON:return"application/json";case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r(e,[{key:"isDataUrl",get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}();n.default=y,y.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},y.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},y.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},y.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},y._loadTypeMap={gif:y.LOAD_TYPE.IMAGE,png:y.LOAD_TYPE.IMAGE,bmp:y.LOAD_TYPE.IMAGE,jpg:y.LOAD_TYPE.IMAGE,jpeg:y.LOAD_TYPE.IMAGE,tif:y.LOAD_TYPE.IMAGE,tiff:y.LOAD_TYPE.IMAGE,webp:y.LOAD_TYPE.IMAGE,tga:y.LOAD_TYPE.IMAGE,svg:y.LOAD_TYPE.IMAGE,"svg+xml":y.LOAD_TYPE.IMAGE,mp3:y.LOAD_TYPE.AUDIO,ogg:y.LOAD_TYPE.AUDIO,wav:y.LOAD_TYPE.AUDIO,mp4:y.LOAD_TYPE.VIDEO,webm:y.LOAD_TYPE.VIDEO},y._xhrTypeMap={xhtml:y.XHR_RESPONSE_TYPE.DOCUMENT,html:y.XHR_RESPONSE_TYPE.DOCUMENT,htm:y.XHR_RESPONSE_TYPE.DOCUMENT,xml:y.XHR_RESPONSE_TYPE.DOCUMENT,tmx:y.XHR_RESPONSE_TYPE.DOCUMENT,svg:y.XHR_RESPONSE_TYPE.DOCUMENT,tsx:y.XHR_RESPONSE_TYPE.DOCUMENT,gif:y.XHR_RESPONSE_TYPE.BLOB,png:y.XHR_RESPONSE_TYPE.BLOB,bmp:y.XHR_RESPONSE_TYPE.BLOB,jpg:y.XHR_RESPONSE_TYPE.BLOB,jpeg:y.XHR_RESPONSE_TYPE.BLOB,tif:y.XHR_RESPONSE_TYPE.BLOB,tiff:y.XHR_RESPONSE_TYPE.BLOB,webp:y.XHR_RESPONSE_TYPE.BLOB,tga:y.XHR_RESPONSE_TYPE.BLOB,json:y.XHR_RESPONSE_TYPE.JSON,text:y.XHR_RESPONSE_TYPE.TEXT,txt:y.XHR_RESPONSE_TYPE.TEXT,ttf:y.XHR_RESPONSE_TYPE.BUFFER,otf:y.XHR_RESPONSE_TYPE.BUFFER},y.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":38,"parse-uri":39}],34:[function(e,t,n){"use strict";function r(){}function i(e,t,n,r){var i=0,s=e.length;(function o(u){if(u||i===s){n&&n(u);return}r?setTimeout(function(){t(e[i++],o)},1):t(e[i++],o)})()}function s(e){return function(){if(e===null)throw new Error("Callback was already called.");var n=e;e=null,n.apply(this,arguments)}}function o(e,t){function o(e,t,n){if(n!=null&&typeof n!="function")throw new Error("task callback must be a function");i.started=!0;if(e==null&&i.idle()){setTimeout(function(){return i.drain()},1);return}var s={data:e,callback:typeof n=="function"?n:r};t?i._tasks.unshift(s):i._tasks.push(s),setTimeout(function(){return i.process()},1)}function u(e){return function(){n-=1,e.callback.apply(e,arguments),arguments[0]!=null&&i.error(arguments[0],e.data),n<=i.concurrency-i.buffer&&i.unsaturated(),i.idle()&&i.drain(),i.process()}}if(t==null)t=1;else if(t===0)throw new Error("Concurrency must not be zero");var n=0,i={_tasks:[],concurrency:t,saturated:r,unsaturated:r,buffer:t/4,empty:r,drain:r,error:r,started:!1,paused:!1,push:function(t,n){o(t,!1,n)},kill:function(){n=0,i.drain=r,i.started=!1,i._tasks=[]},unshift:function(t,n){o(t,!0,n)},process:function(){while(!i.paused&&n<i.concurrency&&i._tasks.length){var r=i._tasks.shift();i._tasks.length===0&&i.empty(),n+=1,n===i.concurrency&&i.saturated(),e(r.data,s(u(r)))}},length:function(){return i._tasks.length},running:function(){return n},idle:function(){return i._tasks.length+n===0},pause:function(){if(i.paused===!0)return;i.paused=!0},resume:function(){if(i.paused===!1)return;i.paused=!1;for(var t=1;t<=i.concurrency;t++)i.process()}};return i}n.__esModule=!0,n.eachSeries=i,n.queue=o},{}],35:[function(e,t,n){"use strict";function i(e){var t="",n=0;while(n<e.length){var i=[0,0,0],s=[0,0,0,0];for(var o=0;o<i.length;++o)n<e.length?i[o]=e.charCodeAt(n++)&255:i[o]=0;s[0]=i[0]>>2,s[1]=(i[0]&3)<<4|i[1]>>4,s[2]=(i[1]&15)<<2|i[2]>>6,s[3]=i[2]&63;var u=n-(e.length-1);switch(u){case 2:s[3]=64,s[2]=64;break;case 1:s[3]=64;break;default:}for(var a=0;a<s.length;++a)t+=r.charAt(s[a])}return t}n.__esModule=!0,n.encodeBinary=i;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],36:[function(e,t,n){"use strict";var r=e("./Loader").default,i=e("./Resource").default,s=e("./async"),o=e("./b64");r.Resource=i,r.async=s,r.base64=o,t.exports=r,t.exports.default=r},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function l(){return function(t,n){if(!t.data){n();return}if(t.xhr&&t.xhrType===s.default.XHR_RESPONSE_TYPE.BLOB)if(!window.Blob||typeof t.data=="string"){var i=t.xhr.getResponseHeader("content-type");if(i&&i.indexOf("image")===0){t.data=new Image,t.data.src="data:"+i+";base64,"+u.default.encodeBinary(t.xhr.responseText),t.type=s.default.TYPE.IMAGE,t.data.onload=function(){t.data.onload=null,n()};return}}else if(t.data.type.indexOf("image")===0){var o=function(){var e=f.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=e,t.type=s.default.TYPE.IMAGE,t.data.onload=function(){f.revokeObjectURL(e),t.data.onload=null,n()},{v:void 0}}();if((typeof o=="undefined"?"undefined":r(o))==="object")return o.v}n()}}n.__esModule=!0;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.blobMiddlewareFactory=l;var i=e("../../Resource"),s=a(i),o=e("../../b64"),u=a(o),f=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t,n,r){n===undefined&&(n=!1),i(this,e),this._fn=t,this._once=n,this._thisArg=r,this._next=this._prev=this._owner=null}return r(e,[{key:"detach",value:function(){return this._owner===null?!1:(this._owner.detach(this),!0)}}]),e}(),u=function(){function e(){i(this,e),this._head=this._tail=undefined}return r(e,[{key:"handlers",value:function(){var t=arguments.length<=0||arguments[0]===undefined?!1:arguments[0],n=this._head;if(t)return!!n;var r=[];while(n)r.push(n),n=n._next;return r}},{key:"has",value:function(t){if(t instanceof s)return t._owner===this;throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.")}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;while(t)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var n=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new s(t,!1,n))}},{key:"once",value:function(t){var n=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new s(t,!0,n))}},{key:"detach",value:function(t){if(t instanceof s)return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this);throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.")}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;this._head=this._tail=null;while(t)t._owner=null,t=t._next;return this}}]),e}();u.MiniSignalBinding=s,n["default"]=u,t.exports=n["default"]},{}],39:[function(e,t,n){"use strict";t.exports=function(t,n){n=n||{};var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=r.parser[n.strictMode?"strict":"loose"].exec(t),s={},o=14;while(o--)s[r.key[o]]=i[o]||"";return s[r.q.name]={},s[r.key[12]].replace(r.q.parser,function(e,t,n){t&&(s[r.q.name][t]=n)}),s}},{}],40:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}function l(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../core"),i=l(r),s=e("ismobilejs"),o=f(s),u=e("./accessibleTarget"),a=f(u);i.utils.mixins.delayMixin(i.DisplayObject.prototype,a.default);var h=9,p=100,d=0,v=0,m=2,g=1,y=-1e3,b=-1e3,w=2,E=function(){function e(t){c(this,e),(o.default.tablet||o.default.phone)&&!navigator.isCocoonJS&&this.createTouchHook();var n=document.createElement("div");n.style.width=p+"px",n.style.height=p+"px",n.style.position="absolute",n.style.top=d+"px",n.style.left=v+"px",n.style.zIndex=m,this.div=n,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return e.prototype.createTouchHook=function(){var t=this,n=document.createElement("button");n.style.width=g+"px",n.style.height=g+"px",n.style.position="absolute",n.style.top=y+"px",n.style.left=b+"px",n.style.zIndex=w,n.style.backgroundColor="#FF0000",n.title="HOOK DIV",n.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(n)}),document.body.appendChild(n)},e.prototype.activate=function(){if(this.isActive)return;this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div)},e.prototype.deactivate=function(){if(!this.isActive||this.isMobileAccessabillity)return;this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div)},e.prototype.updateAccessibleObjects=function(t){if(!t.visible)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var n=t.children;for(var r=n.length-1;r>=0;r--)this.updateAccessibleObjects(n[r])},e.prototype.update=function(){if(!this.renderer.renderingToScreen)return;this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),n=t.width/this.renderer.width,r=t.height/this.renderer.height,s=this.div;s.style.left=t.left+"px",s.style.top=t.top+"px",s.style.width=this.renderer.width+"px",s.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var u=this.children[o];if(u.renderId!==this.renderId)u._accessibleActive=!1,i.utils.removeItems(this.children,o,1),this.div.removeChild(u._accessibleDiv),this.pool.push(u._accessibleDiv),u._accessibleDiv=null,o--,this.children.length===0&&this.deactivate();else{s=u._accessibleDiv;var a=u.hitArea,f=u.worldTransform;u.hitArea?(s.style.left=(f.tx+a.x*f.a)*n+"px",s.style.top=(f.ty+a.y*f.d)*r+"px",s.style.width=a.width*f.a*n+"px",s.style.height=a.height*f.d*r+"px"):(a=u.getBounds(),this.capHitArea(a),s.style.left=a.x*n+"px",s.style.top=a.y*r+"px",s.style.width=a.width*n+"px",s.style.height=a.height*r+"px")}}this.renderId++},e.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},e.prototype.addChild=function(t){var n=this.pool.pop();n||(n=document.createElement("button"),n.style.width=p+"px",n.style.height=p+"px",n.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",n.style.position="absolute",n.style.zIndex=m,n.style.borderStyle="none",n.addEventListener("click",this._onClick.bind(this)),n.addEventListener("focus",this._onFocus.bind(this)),n.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle?n.title=t.accessibleTitle:!t.accessibleTitle&&!t.accessibleHint&&(n.title="displayObject "+this.tabIndex),t.accessibleHint&&n.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=n,n.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},e.prototype._onClick=function(t){var n=this.renderer.plugins.interaction;n.dispatchEvent(t.target.displayObject,"click",n.eventData)},e.prototype._onFocus=function(t){var n=this.renderer.plugins.interaction;n.dispatchEvent(t.target.displayObject,"mouseover",n.eventData)},e.prototype._onFocusOut=function(t){var n=this.renderer.plugins.interaction;n.dispatchEvent(t.target.displayObject,"mouseout",n.eventData)},e.prototype._onKeyDown=function(t){if(t.keyCode!==h)return;this.activate()},e.prototype._onMouseMove=function(){this.deactivate()},e.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}();n.default=E,i.WebGLRenderer.registerPlugin("accessibility",E),i.CanvasRenderer.registerPlugin("accessibility",E)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(e,t,n){"use strict";n.__esModule=!0,n.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./accessibleTarget");Object.defineProperty(n,"accessibleTarget",{enumerable:!0,get:function(){return s(r).default}});var i=e("./AccessibilityManager");Object.defineProperty(n,"AccessibilityManager",{enumerable:!0,get:function(){return s(i).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(e,t,n){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./autoDetectRenderer"),s=e("./display/Container"),o=c(s),u=e("./ticker"),a=e("./settings"),f=c(a),l=e("./const"),p=function(){function e(t,n,r,s,a){h(this,e),typeof t=="number"&&(t=Object.assign({width:t,height:n||f.default.RENDER_OPTIONS.height,forceCanvas:!!s,sharedTicker:!!a},r)),this._options=t=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},t),this.renderer=(0,i.autoDetectRenderer)(t),this.stage=new o.default,this._ticker=null,this.ticker=t.sharedTicker?u.shared:new u.Ticker,t.autoStart&&this.start()}return e.prototype.render=function(){this.renderer.render(this.stage)},e.prototype.stop=function(){this._ticker.stop()},e.prototype.start=function(){this._ticker.start()},e.prototype.destroy=function(t){var n=this._ticker;this.ticker=null,n.destroy(),this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},r(e,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,l.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),e}();n.default=p},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":120}],44:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(e instanceof Array){if(e[0].substring(0,9)!=="precision"){var n=e.slice(0);return n.unshift("precision "+t+" float;"),n}}else if(e.substring(0,9)!=="precision")return"precision "+t+" float;\n"+e;return e}n.__esModule=!0;var r=e("pixi-gl-core"),i=e("./settings"),s=o(i),c=function(e){function t(n,r,i){return u(this,t),a(this,e.call(this,n,l(r,s.default.PRECISION_VERTEX),l(i,s.default.PRECISION_FRAGMENT)))}return f(t,e),t}(r.GLShader);n.default=c},{"./settings":101,"pixi-gl-core":12}],45:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}function l(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function c(e,t,n,r){var s=e&&e.forceCanvas;return r!==undefined&&(s=r),!s&&i.isWebGLSupported()?new a.default(e,t,n):new o.default(e,t,n)}n.__esModule=!0,n.autoDetectRenderer=c;var r=e("./utils"),i=l(r),s=e("./renderers/canvas/CanvasRenderer"),o=f(s),u=e("./renderers/webgl/WebGLRenderer"),a=f(u)},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":124}],46:[function(e,t,n){"use strict";n.__esModule=!0;var r=n.VERSION="4.5.6",i=n.PI_2=Math.PI*2,s=n.RAD_TO_DEG=180/Math.PI,o=n.DEG_TO_RAD=Math.PI/180,u=n.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},a=n.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},f=n.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},l=n.SCALE_MODES={LINEAR:0,NEAREST:1},c=n.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},h=n.GC_MODES={AUTO:0,MANUAL:1},p=n.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,d=n.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,v=n.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,m=n.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},g=n.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},y=n.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},b=n.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},w=n.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../math"),s=function(){function e(){i(this,e),this.minX=Infinity,this.minY=Infinity,this.maxX=-Infinity,this.maxY=-Infinity,this.rect=null}return e.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},e.prototype.clear=function(){this.updateID++,this.minX=Infinity,this.minY=Infinity,this.maxX=-Infinity,this.maxY=-Infinity},e.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?r.Rectangle.EMPTY:(t=t||new r.Rectangle(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},e.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},e.prototype.addQuad=function(t){var n=this.minX,r=this.minY,i=this.maxX,s=this.maxY,o=t[0],u=t[1];n=o<n?o:n,r=u<r?u:r,i=o>i?o:i,s=u>s?u:s,o=t[2],u=t[3],n=o<n?o:n,r=u<r?u:r,i=o>i?o:i,s=u>s?u:s,o=t[4],u=t[5],n=o<n?o:n,r=u<r?u:r,i=o>i?o:i,s=u>s?u:s,o=t[6],u=t[7],n=o<n?o:n,r=u<r?u:r,i=o>i?o:i,s=u>s?u:s,this.minX=n,this.minY=r,this.maxX=i,this.maxY=s},e.prototype.addFrame=function(t,n,r,i,s){var o=t.worldTransform,u=o.a,a=o.b,f=o.c,l=o.d,c=o.tx,h=o.ty,p=this.minX,d=this.minY,v=this.maxX,m=this.maxY,g=u*n+f*r+c,y=a*n+l*r+h;p=g<p?g:p,d=y<d?y:d,v=g>v?g:v,m=y>m?y:m,g=u*i+f*r+c,y=a*i+l*r+h,p=g<p?g:p,d=y<d?y:d,v=g>v?g:v,m=y>m?y:m,g=u*n+f*s+c,y=a*n+l*s+h,p=g<p?g:p,d=y<d?y:d,v=g>v?g:v,m=y>m?y:m,g=u*i+f*s+c,y=a*i+l*s+h,p=g<p?g:p,d=y<d?y:d,v=g>v?g:v,m=y>m?y:m,this.minX=p,this.minY=d,this.maxX=v,this.maxY=m},e.prototype.addVertices=function(t,n,r,i){var s=t.worldTransform,o=s.a,u=s.b,a=s.c,f=s.d,l=s.tx,c=s.ty,h=this.minX,p=this.minY,d=this.maxX,v=this.maxY;for(var m=r;m<i;m+=2){var g=n[m],y=n[m+1],b=o*g+a*y+l,w=f*y+u*g+c;h=b<h?b:h,p=w<p?w:p,d=b>d?b:d,v=w>v?w:v}this.minX=h,this.minY=p,this.maxX=d,this.maxY=v},e.prototype.addBounds=function(t){var n=this.minX,r=this.minY,i=this.maxX,s=this.maxY;this.minX=t.minX<n?t.minX:n,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>s?t.maxY:s},e.prototype.addBoundsMask=function(t,n){var r=t.minX>n.minX?t.minX:n.minX,i=t.minY>n.minY?t.minY:n.minY,s=t.maxX<n.maxX?t.maxX:n.maxX,o=t.maxY<n.maxY?t.maxY:n.maxY;if(r<=s&&i<=o){var u=this.minX,a=this.minY,f=this.maxX,l=this.maxY;this.minX=r<u?r:u,this.minY=i<a?i:a,this.maxX=s>f?s:f,this.maxY=o>l?o:l}},e.prototype.addBoundsArea=function(t,n){var r=t.minX>n.x?t.minX:n.x,i=t.minY>n.y?t.minY:n.y,s=t.maxX<n.x+n.width?t.maxX:n.x+n.width,o=t.maxY<n.y+n.height?t.maxY:n.y+n.height;if(r<=s&&i<=o){var u=this.minX,a=this.minY,f=this.maxX,l=this.maxY;this.minX=r<u?r:u,this.minY=i<a?i:a,this.maxX=s>f?s:f,this.maxY=o>l?o:l}},e}();n.default=s},{"../math":70}],48:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../utils"),s=e("./DisplayObject"),o=u(s),c=function(e){function t(){a(this,t);var n=f(this,e.call(this));return n.children=[],n}return l(t,e),t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(t){var n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.addChild(arguments[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},t.prototype.addChildAt=function(t,n){if(n<0||n>this.children.length)throw new Error(t+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(n,0,t),this._boundsID++,this.onChildrenChange(n),t.emit("added",this),t},t.prototype.swapChildren=function(t,n){if(t===n)return;var r=this.getChildIndex(t),i=this.getChildIndex(n);this.children[r]=n,this.children[i]=t,this.onChildrenChange(r<i?r:i)},t.prototype.getChildIndex=function(t){var n=this.children.indexOf(t);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},t.prototype.setChildIndex=function(t,n){if(n<0||n>=this.children.length)throw new Error("The supplied index is out of bounds");var r=this.getChildIndex(t);(0,i.removeItems)(this.children,r,1),this.children.splice(n,0,t),this.onChildrenChange(n)},t.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},t.prototype.removeChild=function(t){var n=arguments.length;if(n>1)for(var r=0;r<n;r++)this.removeChild(arguments[r]);else{var s=this.children.indexOf(t);if(s===-1)return null;t.parent=null,t.transform._parentID=-1,(0,i.removeItems)(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this)}return t},t.prototype.removeChildAt=function(t){var n=this.getChildAt(t);return n.parent=null,n.transform._parentID=-1,(0,i.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),n.emit("removed",this),n},t.prototype.removeChildren=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments[1],r=t,i=typeof n=="number"?n:this.children.length,s=i-r,o=void 0;if(s>0&&s<=i){o=this.children.splice(r,s);for(var u=0;u<o.length;++u)o[u].parent=null,o[u].transform&&(o[u].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<o.length;++a)o[a].emit("removed",this);return o}if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,n=this.children.length;t<n;++t){var r=this.children[t];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var n=this.children[t];if(!n.visible||!n.renderable)continue;n.calculateBounds(),n._mask?(n._mask.calculateBounds(),this._bounds.addBoundsMask(n._bounds,n._mask._bounds)):n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds)}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.renderWebGL=function(t){if(!this.visible||this.worldAlpha<=0||!this.renderable)return;if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var n=0,r=this.children.length;n<r;++n)this.children[n].renderWebGL(t)}},t.prototype.renderAdvancedWebGL=function(t){t.flush();var n=this._filters,r=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<n.length;i++)n[i].enabled&&this._enabledFilters.push(n[i]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}r&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var s=0,o=this.children.length;s<o;s++)this.children[s].renderWebGL(t);t.flush(),r&&t.maskManager.popMask(this,this._mask),n&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},t.prototype._renderWebGL=function(t){},t.prototype._renderCanvas=function(t){},t.prototype.renderCanvas=function(t){if(!this.visible||this.worldAlpha<=0||!this.renderable)return;this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var n=0,r=this.children.length;n<r;++n)this.children[n].renderCanvas(t);this._mask&&t.maskManager.popMask(t)},t.prototype.destroy=function(n){e.prototype.destroy.call(this);var r=typeof n=="boolean"?n:n&&n.children,i=this.removeChildren(0,this.children.length);if(r)for(var s=0;s<i.length;++s)i[s].destroy(n)},r(t,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var n=this.getLocalBounds().width;n!==0?this.scale.x=t/n:this.scale.x=1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var n=this.getLocalBounds().height;n!==0?this.scale.y=t/n:this.scale.y=1,this._height=t}}]),t}(o.default);n.default=c,c.prototype.containerUpdateTransform=c.prototype.updateTransform},{"../utils":124,"./DisplayObject":49}],49:[function(e,t,n){"use strict";function m(e){return e&&e.__esModule?e:{"default":e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function b(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("eventemitter3"),s=m(i),o=e("../const"),u=e("../settings"),a=m(u),f=e("./TransformStatic"),l=m(f),c=e("./Transform"),h=m(c),p=e("./Bounds"),d=m(p),v=e("../math"),w=function(e){function t(){g(this,t);var n=y(this,e.call(this)),r=a.default.TRANSFORM_MODE===o.TRANSFORM_MODE.STATIC?l.default:h.default;return n.tempDisplayObjectParent=null,n.transform=new r,n.alpha=1,n.visible=!0,n.renderable=!0,n.parent=null,n.worldAlpha=1,n.filterArea=null,n._filters=null,n._enabledFilters=null,n._bounds=new d.default,n._boundsID=0,n._lastBoundsID=-1,n._boundsRect=null,n._localBoundsRect=null,n._mask=null,n._destroyed=!1,n}return b(t,e),t.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.getBounds=function(t,n){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),n||(this._boundsRect||(this._boundsRect=new v.Rectangle),n=this._boundsRect),this._bounds.getRectangle(n)},t.prototype.getLocalBounds=function(t){var n=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new v.Rectangle),t=this._localBoundsRect);var i=this.getBounds(!1,t);return this.parent=r,this.transform=n,i},t.prototype.toGlobal=function(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,n)},t.prototype.toLocal=function(t,n,r,i){return n&&(t=n.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},t.prototype.renderWebGL=function(t){},t.prototype.renderCanvas=function(t){},t.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},t.prototype.setTransform=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1,s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0,o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0,u=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0,a=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0,f=arguments.length>8&&arguments[8]!==undefined?arguments[8]:0;return this.position.x=t,this.position.y=n,this.scale.x=r?r:1,this.scale.y=i?i:1,this.rotation=s,this.skew.x=o,this.skew.y=u,this.pivot.x=a,this.pivot.y=f,this},t.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r(t,[{key:"_tempDisplayObjectParent",get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new t),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),t}(s.default);n.default=w,w.prototype.displayObjectUpdateTransform=w.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../math"),s=e("./TransformBase"),o=u(s),c=function(e){function t(){a(this,t);var n=f(this,e.call(this));return n.position=new i.Point(0,0),n.scale=new i.Point(1,1),n.skew=new i.ObservablePoint(n.updateSkew,n,0,0),n.pivot=new i.Point(0,0),n._rotation=0,n._cx=1,n._sx=0,n._cy=0,n._sy=1,n}return l(t,e),t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},t.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},t.prototype.updateTransform=function(t){var n=this.localTransform;n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d);var r=t.worldTransform,i=this.worldTransform;i.a=n.a*r.a+n.b*r.c,i.b=n.a*r.b+n.b*r.d,i.c=n.c*r.a+n.d*r.c,i.d=n.c*r.b+n.d*r.d,i.tx=n.tx*r.a+n.ty*r.c+r.tx,i.ty=n.tx*r.b+n.ty*r.d+r.ty,this._worldID++},t.prototype.setFromMatrix=function(t){t.decompose(this)},r(t,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),t}(o.default);n.default=c},{"../math":70,"./TransformBase":51}],51:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../math"),s=function(){function e(){i(this,e),this.worldTransform=new r.Matrix,this.localTransform=new r.Matrix,this._worldID=0,this._parentID=0}return e.prototype.updateLocalTransform=function(){},e.prototype.updateTransform=function(t){var n=t.worldTransform,r=this.worldTransform,i=this.localTransform;r.a=i.a*n.a+i.b*n.c,r.b=i.a*n.b+i.b*n.d,r.c=i.c*n.a+i.d*n.c,r.d=i.c*n.b+i.d*n.d,r.tx=i.tx*n.a+i.ty*n.c+n.tx,r.ty=i.tx*n.b+i.ty*n.d+n.ty,this._worldID++},e}();n.default=s,s.prototype.updateWorldTransform=s.prototype.updateTransform,s.IDENTITY=new s},{"../math":70}],52:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../math"),s=e("./TransformBase"),o=u(s),c=function(e){function t(){a(this,t);var n=f(this,e.call(this));return n.position=new i.ObservablePoint(n.onChange,n,0,0),n.scale=new i.ObservablePoint(n.onChange,n,1,1),n.pivot=new i.ObservablePoint(n.onChange,n,0,0),n.skew=new i.ObservablePoint(n.updateSkew,n,0,0),n._rotation=0,n._cx=1,n._sx=0,n._cy=0,n._sy=1,n._localID=0,n._currentLocalID=0,n}return l(t,e),t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale._x,n.b=this._sx*this.scale._x,n.c=this._cy*this.scale._y,n.d=this._sy*this.scale._y,n.tx=this.position._x-(this.pivot._x*n.a+this.pivot._y*n.c),n.ty=this.position._y-(this.pivot._x*n.b+this.pivot._y*n.d),this._currentLocalID=this._localID,this._parentID=-1);if(this._parentID!==t._worldID){var r=t.worldTransform,i=this.worldTransform;i.a=n.a*r.a+n.b*r.c,i.b=n.a*r.b+n.b*r.d,i.c=n.c*r.a+n.d*r.c,i.d=n.c*r.b+n.d*r.d,i.tx=n.tx*r.a+n.ty*r.c+r.tx,i.ty=n.tx*r.b+n.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},r(t,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),t}(o.default);n.default=c},{"../math":70,"./TransformBase":51}],53:[function(e,t,n){"use strict";function S(e){return e&&e.__esModule?e:{"default":e}}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function N(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../display/Container"),i=S(r),s=e("../textures/RenderTexture"),o=S(s),u=e("../textures/Texture"),a=S(u),f=e("./GraphicsData"),l=S(f),c=e("../sprites/Sprite"),h=S(c),p=e("../math"),d=e("../utils"),v=e("../const"),m=e("../display/Bounds"),g=S(m),y=e("./utils/bezierCurveTo"),b=S(y),w=e("../renderers/canvas/CanvasRenderer"),E=S(w),C=void 0,k=new p.Matrix,L=new p.Point,A=new Float32Array(4),O=new Float32Array(4),M=function(e){function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;x(this,t);var r=T(this,e.call(this));return r.fillAlpha=1,r.lineWidth=0,r.nativeLines=n,r.lineColor=0,r.graphicsData=[],r.tint=16777215,r._prevTint=16777215,r.blendMode=v.BLEND_MODES.NORMAL,r.currentPath=null,r._webGL={},r.isMask=!1,r.boundsPadding=0,r._localBounds=new g.default,r.dirty=0,r.fastRectDirty=-1,r.clearDirty=0,r.boundsDirty=-1,r.cachedSpriteDirty=!1,r._spriteRect=null,r._fastRect=!1,r}return N(t,e),t.prototype.clone=function n(){var n=new t;n.renderable=this.renderable,n.fillAlpha=this.fillAlpha,n.lineWidth=this.lineWidth,n.lineColor=this.lineColor,n.tint=this.tint,n.blendMode=this.blendMode,n.isMask=this.isMask,n.boundsPadding=this.boundsPadding,n.dirty=0,n.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)n.graphicsData.push(this.graphicsData[e].clone());return n.currentPath=n.graphicsData[n.graphicsData.length-1],n.updateLocalBounds(),n},t.prototype.lineStyle=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;this.lineWidth=t,this.lineColor=n,this.lineAlpha=r;if(this.currentPath)if(this.currentPath.shape.points.length){var i=new p.Polygon(this.currentPath.shape.points.slice(-2));i.closed=!1,this.drawShape(i)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},t.prototype.moveTo=function(t,n){var r=new p.Polygon([t,n]);return r.closed=!1,this.drawShape(r),this},t.prototype.lineTo=function(t,n){return this.currentPath.shape.points.push(t,n),this.dirty++,this},t.prototype.quadraticCurveTo=function(t,n,r,i){this.currentPath?this.currentPath.shape.points.length===0&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=20,o=this.currentPath.shape.points,u=0,a=0;o.length===0&&this.moveTo(0,0);var f=o[o.length-2],l=o[o.length-1];for(var c=1;c<=s;++c){var h=c/s;u=f+(t-f)*h,a=l+(n-l)*h,o.push(u+(t+(r-t)*h-u)*h,a+(n+(i-n)*h-a)*h)}return this.dirty++,this},t.prototype.bezierCurveTo=function(t,n,r,i,s,o){this.currentPath?this.currentPath.shape.points.length===0&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var u=this.currentPath.shape.points,a=u[u.length-2],f=u[u.length-1];return u.length-=2,(0,b.default)(a,f,t,n,r,i,s,o,u),this.dirty++,this},t.prototype.arcTo=function(t,n,r,i,s){this.currentPath?this.currentPath.shape.points.length===0&&this.currentPath.shape.points.push(t,n):this.moveTo(t,n);var o=this.currentPath.shape.points,u=o[o.length-2],a=o[o.length-1],f=a-n,l=u-t,c=i-n,h=r-t,p=Math.abs(f*h-l*c);if(p<1e-8||s===0)(o[o.length-2]!==t||o[o.length-1]!==n)&&o.push(t,n);else{var d=f*f+l*l,v=c*c+h*h,m=f*c+l*h,g=s*Math.sqrt(d)/p,y=s*Math.sqrt(v)/p,b=g*m/d,w=y*m/v,E=g*h+y*l,S=g*c+y*f,x=l*(y+b),T=f*(y+b),N=h*(g+w),C=c*(g+w),k=Math.atan2(T-S,x-E),L=Math.atan2(C-S,N-E);this.arc(E+t,S+n,s,k,L,l*c>h*f)}return this.dirty++,this},t.prototype.arc=function(t,n,r,i,s){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!1;if(i===s)return this;!o&&s<=i?s+=Math.PI*2:o&&i<=s&&(i+=Math.PI*2);var u=s-i,a=Math.ceil(Math.abs(u)/(Math.PI*2))*40;if(u===0)return this;var f=t+Math.cos(i)*r,l=n+Math.sin(i)*r,c=this.currentPath?this.currentPath.shape.points:null;c?(c[c.length-2]!==f||c[c.length-1]!==l)&&c.push(f,l):(this.moveTo(f,l),c=this.currentPath.shape.points);var h=u/(a*2),p=h*2,d=Math.cos(h),v=Math.sin(h),m=a-1,g=m%1/m;for(var y=0;y<=m;++y){var b=y+g*y,w=h+i+p*b,E=Math.cos(w),S=-Math.sin(w);c.push((d*E+v*S)*r+t,(d*-S+v*E)*r+n)}return this.dirty++,this},t.prototype.beginFill=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=n,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},t.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},t.prototype.drawRect=function(t,n,r,i){return this.drawShape(new p.Rectangle(t,n,r,i)),this},t.prototype.drawRoundedRect=function(t,n,r,i,s){return this.drawShape(new p.RoundedRectangle(t,n,r,i,s)),this},t.prototype.drawCircle=function(t,n,r){return this.drawShape(new p.Circle(t,n,r)),this},t.prototype.drawEllipse=function(t,n,r,i){return this.drawShape(new p.Ellipse(t,n,r,i)),this},t.prototype.drawPolygon=function(t){var n=t,r=!0;n instanceof p.Polygon&&(r=n.closed,n=n.points);if(!Array.isArray(n)){n=new Array(arguments.length);for(var i=0;i<n.length;++i)n[i]=arguments[i]}var s=new p.Polygon(n);return s.closed=r,this.drawShape(s),this},t.prototype.clear=function(){if(this.lineWidth||this.filling||this.graphicsData.length>0)this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0;return this.currentPath=null,this._spriteRect=null,this},t.prototype.isFastRect=function(){return this.graphicsData.length===1&&this.graphicsData[0].shape.type===v.SHAPES.RECT&&!this.graphicsData[0].lineWidth},t.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},t.prototype._renderSpriteRect=function(t){var n=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new h.default(new a.default(a.default.WHITE)));var r=this._spriteRect;if(this.tint===16777215)r.tint=this.graphicsData[0].fillColor;else{var i=A,s=O;(0,d.hex2rgb)(this.graphicsData[0].fillColor,i),(0,d.hex2rgb)(this.tint,s),i[0]*=s[0],i[1]*=s[1],i[2]*=s[2],r.tint=(0,d.rgb2hex)(i)}r.alpha=this.graphicsData[0].fillAlpha,r.worldAlpha=this.worldAlpha*r.alpha,r.blendMode=this.blendMode,r._texture._frame.width=n.width,r._texture._frame.height=n.height,r.transform.worldTransform=this.transform.worldTransform,r.anchor.set(-n.x/n.width,-n.y/n.height),r._onAnchorUpdate(),r._renderWebGL(t)},t.prototype._renderCanvas=function(t){if(this.isMask===!0)return;t.plugins.graphics.render(this)},t.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,L);var n=this.graphicsData;for(var r=0;r<n.length;++r){var i=n[r];if(!i.fill)continue;if(i.shape&&i.shape.contains(L.x,L.y)){if(i.holes)for(var s=0;s<i.holes.length;s++){var o=i.holes[s];if(o.contains(L.x,L.y))return!1}return!0}}return!1},t.prototype.updateLocalBounds=function(){var t=Infinity,n=-Infinity,r=Infinity,i=-Infinity;if(this.graphicsData.length){var s=0,o=0,u=0,a=0,f=0;for(var l=0;l<this.graphicsData.length;l++){var c=this.graphicsData[l],h=c.type,p=c.lineWidth;s=c.shape;if(h===v.SHAPES.RECT||h===v.SHAPES.RREC)o=s.x-p/2,u=s.y-p/2,a=s.width+p,f=s.height+p,t=o<t?o:t,n=o+a>n?o+a:n,r=u<r?u:r,i=u+f>i?u+f:i;else if(h===v.SHAPES.CIRC)o=s.x,u=s.y,a=s.radius+p/2,f=s.radius+p/2,t=o-a<t?o-a:t,n=o+a>n?o+a:n,r=u-f<r?u-f:r,i=u+f>i?u+f:i;else if(h===v.SHAPES.ELIP)o=s.x,u=s.y,a=s.width+p/2,f=s.height+p/2,t=o-a<t?o-a:t,n=o+a>n?o+a:n,r=u-f<r?u-f:r,i=u+f>i?u+f:i;else{var d=s.points,m=0,g=0,y=0,b=0,w=0,E=0,S=0,x=0;for(var T=0;T+2<d.length;T+=2){o=d[T],u=d[T+1],m=d[T+2],g=d[T+3],y=Math.abs(m-o),b=Math.abs(g-u),f=p,a=Math.sqrt(y*y+b*b);if(a<1e-9)continue;w=(f/a*b+y)/2,E=(f/a*y+b)/2,S=(m+o)/2,x=(g+u)/2,t=S-w<t?S-w:t,n=S+w>n?S+w:n,r=x-E<r?x-E:r,i=x+E>i?x+E:i}}}}else t=0,n=0,r=0,i=0;var N=this.boundsPadding;this._localBounds.minX=t-N,this._localBounds.maxX=n+N,this._localBounds.minY=r-N,this._localBounds.maxY=i+N},t.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var n=new l.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t);return this.graphicsData.push(n),n.type===v.SHAPES.POLY&&(n.shape.closed=n.shape.closed||this.filling,this.currentPath=n),this.dirty++,n},t.prototype.generateCanvasTexture=function(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,r=this.getLocalBounds(),i=o.default.create(r.width,r.height,t,n);C||(C=new E.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(k),k.invert(),k.tx-=r.x,k.ty-=r.y,C.render(this,i,!0,k);var s=a.default.fromCanvas(i.baseTexture._canvasRenderTarget.canvas,t,"graphics");return s.baseTexture.resolution=n,s.baseTexture.update(),s},t.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},t.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},t.prototype.destroy=function(n){e.prototype.destroy.call(this,n);for(var r=0;r<this.graphicsData.length;++r)this.graphicsData[r].destroy();for(var i in this._webgl)for(var s=0;s<this._webgl[i].data.length;++s)this._webgl[i].data[s].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},t}(i.default);n.default=M,M._SPRITE_TEXTURE=null},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":124,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t,n,i,s,o,u,a,f){r(this,e),this.lineWidth=t,this.nativeLines=a,this.lineColor=n,this.lineAlpha=i,this._lineTint=n,this.fillColor=s,this.fillAlpha=o,this._fillTint=s,this.fill=u,this.holes=[],this.shape=f,this.type=f.type}return e.prototype.clone=function(){return new e(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},e.prototype.addHole=function(t){this.holes.push(t)},e.prototype.destroy=function(){this.shape=null,this.holes=null},e}();n.default=i},{}],55:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../renderers/canvas/CanvasRenderer"),i=o(r),s=e("../../const"),a=function(){function e(t){u(this,e),this.renderer=t}return e.prototype.render=function(t){var n=this.renderer,r=n.context,i=t.worldAlpha,o=t.transform.worldTransform,u=n.resolution;this._prevTint!==this.tint&&(this.dirty=!0),r.setTransform(o.a*u,o.b*u,o.c*u,o.d*u,o.tx*u,o.ty*u),t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),n.setBlendMode(t.blendMode);for(var a=0;a<t.graphicsData.length;a++){var f=t.graphicsData[a],l=f.shape,c=f._fillTint,h=f._lineTint;r.lineWidth=f.lineWidth;if(f.type===s.SHAPES.POLY){r.beginPath(),this.renderPolygon(l.points,l.closed,r);for(var p=0;p<f.holes.length;p++)this.renderPolygon(f.holes[p].points,!0,r);f.fill&&(r.globalAlpha=f.fillAlpha*i,r.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),r.fill()),f.lineWidth&&(r.globalAlpha=f.lineAlpha*i,r.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),r.stroke())}else if(f.type===s.SHAPES.RECT){if(f.fillColor||f.fillColor===0)r.globalAlpha=f.fillAlpha*i,r.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),r.fillRect(l.x,l.y,l.width,l.height);f.lineWidth&&(r.globalAlpha=f.lineAlpha*i,r.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),r.strokeRect(l.x,l.y,l.width,l.height))}else if(f.type===s.SHAPES.CIRC)r.beginPath(),r.arc(l.x,l.y,l.radius,0,2*Math.PI),r.closePath(),f.fill&&(r.globalAlpha=f.fillAlpha*i,r.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),r.fill()),f.lineWidth&&(r.globalAlpha=f.lineAlpha*i,r.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),r.stroke());else if(f.type===s.SHAPES.ELIP){var d=l.width*2,v=l.height*2,m=l.x-d/2,g=l.y-v/2;r.beginPath();var y=.5522848,b=d/2*y,w=v/2*y,E=m+d,S=g+v,x=m+d/2,T=g+v/2;r.moveTo(m,T),r.bezierCurveTo(m,T-w,x-b,g,x,g),r.bezierCurveTo(x+b,g,E,T-w,E,T),r.bezierCurveTo(E,T+w,x+b,S,x,S),r.bezierCurveTo(x-b,S,m,T+w,m,T),r.closePath(),f.fill&&(r.globalAlpha=f.fillAlpha*i,r.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),r.fill()),f.lineWidth&&(r.globalAlpha=f.lineAlpha*i,r.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),r.stroke())}else if(f.type===s.SHAPES.RREC){var N=l.x,C=l.y,k=l.width,L=l.height,A=l.radius,O=Math.min(k,L)/2|0;A=A>O?O:A,r.beginPath(),r.moveTo(N,C+A),r.lineTo(N,C+L-A),r.quadraticCurveTo(N,C+L,N+A,C+L),r.lineTo(N+k-A,C+L),r.quadraticCurveTo(N+k,C+L,N+k,C+L-A),r.lineTo(N+k,C+A),r.quadraticCurveTo(N+k,C,N+k-A,C),r.lineTo(N+A,C),r.quadraticCurveTo(N,C,N,C+A),r.closePath();if(f.fillColor||f.fillColor===0)r.globalAlpha=f.fillAlpha*i,r.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),r.fill();f.lineWidth&&(r.globalAlpha=f.lineAlpha*i,r.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),r.stroke())}}},e.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint;var n=(t.tint>>16&255)/255,r=(t.tint>>8&255)/255,i=(t.tint&255)/255;for(var s=0;s<t.graphicsData.length;++s){var o=t.graphicsData[s],u=o.fillColor|0,a=o.lineColor|0;o._fillTint=((u>>16&255)/255*n*255<<16)+((u>>8&255)/255*r*255<<8)+(u&255)/255*i*255,o._lineTint=((a>>16&255)/255*n*255<<16)+((a>>8&255)/255*r*255<<8)+(a&255)/255*i*255}},e.prototype.renderPolygon=function(t,n,r){r.moveTo(t[0],t[1]);for(var i=1;i<t.length/2;++i)r.lineTo(t[i*2],t[i*2+1]);n&&r.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();n.default=a,i.default.registerPlugin("graphics",a)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(e,t,n){"use strict";function r(e,t,n,r,i,s,o,u){var a=arguments.length>8&&arguments[8]!==undefined?arguments[8]:[],f=20,l=0,c=0,h=0,p=0,d=0;a.push(e,t);for(var v=1,m=0;v<=f;++v)m=v/f,l=1-m,c=l*l,h=c*l,p=m*m,d=p*m,a.push(h*e+3*c*m*n+3*l*p*i+d*o,h*t+3*c*m*r+3*l*p*s+d*u);return a}n.__esModule=!0,n.default=r},{}],57:[function(e,t,n){"use strict";function E(e){return e&&e.__esModule?e:{"default":e}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function T(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../utils"),i=e("../../const"),s=e("../../renderers/webgl/utils/ObjectRenderer"),o=E(s),u=e("../../renderers/webgl/WebGLRenderer"),a=E(u),f=e("./WebGLGraphicsData"),l=E(f),c=e("./shaders/PrimitiveShader"),h=E(c),p=e("./utils/buildPoly"),d=E(p),v=e("./utils/buildRectangle"),m=E(v),g=e("./utils/buildRoundedRectangle"),y=E(g),b=e("./utils/buildCircle"),w=E(b),N=function(e){function t(n){S(this,t);var r=x(this,e.call(this,n));return r.graphicsDataPool=[],r.primitiveShader=null,r.gl=n.gl,r.CONTEXT_UID=0,r}return T(t,e),t.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new h.default(this.gl)},t.prototype.destroy=function(){o.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},t.prototype.render=function(t){var n=this.renderer,i=n.gl,s=void 0,o=t._webGL[this.CONTEXT_UID];if(!o||t.dirty!==o.dirty)this.updateGraphics(t),o=t._webGL[this.CONTEXT_UID];var u=this.primitiveShader;n.bindShader(u),n.state.setBlendMode(t.blendMode);for(var a=0,f=o.data.length;a<f;a++){s=o.data[a];var l=s.shader;n.bindShader(l),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.tint=(0,r.hex2rgb)(t.tint),l.uniforms.alpha=t.worldAlpha,n.bindVao(s.vao),s.nativeLines?i.drawArrays(i.LINES,0,s.points.length/6):s.vao.draw(i.TRIANGLE_STRIP,s.indices.length)}},t.prototype.updateGraphics=function(t){var n=this.renderer.gl,r=t._webGL[this.CONTEXT_UID];r||(r=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:n,clearDirty:-1,dirty:-1}),r.dirty=t.dirty;if(t.clearDirty!==r.clearDirty){r.clearDirty=t.clearDirty;for(var s=0;s<r.data.length;s++)this.graphicsDataPool.push(r.data[s]);r.data.length=0,r.lastIndex=0}var o=void 0,u=void 0;for(var a=r.lastIndex;a<t.graphicsData.length;a++){var f=t.graphicsData[a];o=this.getWebGLData(r,0),f.nativeLines&&f.lineWidth&&(u=this.getWebGLData(r,0,!0),r.lastIndex++),f.type===i.SHAPES.POLY&&(0,d.default)(f,o,u),f.type===i.SHAPES.RECT?(0,m.default)(f,o,u):f.type===i.SHAPES.CIRC||f.type===i.SHAPES.ELIP?(0,w.default)(f,o,u):f.type===i.SHAPES.RREC&&(0,y.default)(f,o,u),r.lastIndex++}this.renderer.bindVao(null);for(var l=0;l<r.data.length;l++)o=r.data[l],o.dirty&&o.upload()},t.prototype.getWebGLData=function(t,n,r){var i=t.data[t.data.length-1];if(!i||i.nativeLines!==r||i.points.length>32e4)i=this.graphicsDataPool.pop()||new l.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),i.nativeLines=r,i.reset(n),t.data.push(i);return i.dirty=!0,i},t}(o.default);n.default=N,a.default.registerPlugin("graphics",N)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":124,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("pixi-gl-core"),i=s(r),u=function(){function e(t,n,r){o(this,e),this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=i.default.GLBuffer.createVertexBuffer(t),this.indexBuffer=i.default.GLBuffer.createIndexBuffer(t),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=n,this.vao=(new i.default.VertexArrayObject(t,r)).addIndex(this.indexBuffer).addAttribute(this.buffer,n.attributes.aVertexPosition,t.FLOAT,!1,24,0).addAttribute(this.buffer,n.attributes.aColor,t.FLOAT,!1,24,8)}return e.prototype.reset=function(){this.points.length=0,this.indices.length=0},e.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},e.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},e}();n.default=u},{"pixi-gl-core":12}],59:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../../Shader"),i=s(r),f=function(e){function t(n){return o(this,t),u(this,e.call(this,n,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return a(t,e),t}(i.default);n.default=f},{"../../../Shader":44}],60:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,n){var r=e.shape,u=r.x,a=r.y,f=void 0,l=void 0;e.type===s.SHAPES.CIRC?(f=r.radius,l=r.radius):(f=r.width,l=r.height);if(f===0||l===0)return;var c=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height)),h=Math.PI*2/c;if(e.fill){var p=(0,o.hex2rgb)(e.fillColor),d=e.fillAlpha,v=p[0]*d,m=p[1]*d,g=p[2]*d,y=t.points,b=t.indices,w=y.length/6;b.push(w);for(var E=0;E<c+1;E++)y.push(u,a,v,m,g,d),y.push(u+Math.sin(h*E)*f,a+Math.cos(h*E)*l,v,m,g,d),b.push(w++,w++);b.push(w-1)}if(e.lineWidth){var S=e.points;e.points=[];for(var x=0;x<c+1;x++)e.points.push(u+Math.sin(h*x)*f,a+Math.cos(h*x)*l);(0,i.default)(e,t,n),e.points=S}}n.__esModule=!0,n.default=a;var r=e("./buildLine"),i=u(r),s=e("../../../const"),o=e("../../../utils")},{"../../../const":46,"../../../utils":124,"./buildLine":61}],61:[function(e,t,n){"use strict";function s(e,t){var n=e.points;if(n.length===0)return;var s=new r.Point(n[0],n[1]),o=new r.Point(n[n.length-2],n[n.length-1]);if(s.x===o.x&&s.y===o.y){n=n.slice(),n.pop(),n.pop(),o=new r.Point(n[n.length-2],n[n.length-1]);var u=o.x+(s.x-o.x)*.5,a=o.y+(s.y-o.y)*.5;n.unshift(u,a),n.push(u,a)}var f=t.points,l=t.indices,c=n.length/2,h=n.length,p=f.length/6,d=e.lineWidth/2,v=(0,i.hex2rgb)(e.lineColor),m=e.lineAlpha,g=v[0]*m,y=v[1]*m,b=v[2]*m,w=n[0],E=n[1],S=n[2],x=n[3],T=0,N=0,C=-(E-x),k=w-S,L=0,A=0,O=0,M=0,_=Math.sqrt(C*C+k*k);C/=_,k/=_,C*=d,k*=d,f.push(w-C,E-k,g,y,b,m),f.push(w+C,E+k,g,y,b,m);for(var D=1;D<c-1;++D){w=n[(D-1)*2],E=n[(D-1)*2+1],S=n[D*2],x=n[D*2+1],T=n[(D+1)*2],N=n[(D+1)*2+1],C=-(E-x),k=w-S,_=Math.sqrt(C*C+k*k),C/=_,k/=_,C*=d,k*=d,L=-(x-N),A=S-T,_=Math.sqrt(L*L+A*A),L/=_,A/=_,L*=d,A*=d;var P=-k+E-(-k+x),H=-C+S-(-C+w),B=(-C+w)*(-k+x)-(-C+S)*(-k+E),j=-A+N-(-A+x),F=-L+S-(-L+T),I=(-L+T)*(-A+x)-(-L+S)*(-A+N),q=P*F-j*H;if(Math.abs(q)<.1){q+=10.1,f.push(S-C,x-k,g,y,b,m),f.push(S+C,x+k,g,y,b,m);continue}var R=(H*I-F*B)/q,U=(j*B-P*I)/q,z=(R-S)*(R-S)+(U-x)*(U-x);z>196*d*d?(O=C-L,M=k-A,_=Math.sqrt(O*O+M*M),O/=_,M/=_,O*=d,M*=d,f.push(S-O,x-M),f.push(g,y,b,m),f.push(S+O,x+M),f.push(g,y,b,m),f.push(S-O,x-M),f.push(g,y,b,m),h++):(f.push(R,U),f.push(g,y,b,m),f.push(S-(R-S),x-(U-x)),f.push(g,y,b,m))}w=n[(c-2)*2],E=n[(c-2)*2+1],S=n[(c-1)*2],x=n[(c-1)*2+1],C=-(E-x),k=w-S,_=Math.sqrt(C*C+k*k),C/=_,k/=_,C*=d,k*=d,f.push(S-C,x-k),f.push(g,y,b,m),f.push(S+C,x+k),f.push(g,y,b,m),l.push(p);for(var W=0;W<h;++W)l.push(p++);l.push(p-1)}function o(e,t){var n=0,r=e.points;if(r.length===0)return;var s=t.points,o=r.length/2,u=(0,i.hex2rgb)(e.lineColor),a=e.lineAlpha,f=u[0]*a,l=u[1]*a,c=u[2]*a;for(n=1;n<o;n++){var h=r[(n-1)*2],p=r[(n-1)*2+1],d=r[n*2],v=r[n*2+1];s.push(h,p),s.push(f,l,c,a),s.push(d,v),s.push(f,l,c,a)}}n.__esModule=!0,n.default=function(e,t,n){e.nativeLines?o(e,n):s(e,t)};var r=e("../../../math"),i=e("../../../utils")},{"../../../math":70,"../../../utils":124}],62:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e,t,n){e.points=e.shape.points.slice();var r=e.points;if(e.fill&&r.length>=6){var o=[],a=e.holes;for(var f=0;f<a.length;f++){var l=a[f];o.push(r.length/2),r=r.concat(l.points)}var c=t.points,h=t.indices,p=r.length/2,d=(0,s.hex2rgb)(e.fillColor),v=e.fillAlpha,m=d[0]*v,g=d[1]*v,y=d[2]*v,b=(0,u.default)(r,o,2);if(!b)return;var w=c.length/6;for(var E=0;E<b.length;E+=3)h.push(b[E]+w),h.push(b[E]+w),h.push(b[E+1]+w),h.push(b[E+2]+w),h.push(b[E+2]+w);for(var S=0;S<p;S++)c.push(r[S*2],r[S*2+1],m,g,y,v)}e.lineWidth>0&&(0,i.default)(e,t,n)}n.__esModule=!0,n.default=f;var r=e("./buildLine"),i=a(r),s=e("../../../utils"),o=e("earcut"),u=a(o)},{"../../../utils":124,"./buildLine":61,earcut:2}],63:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t,n){var r=e.shape,o=r.x,u=r.y,a=r.width,f=r.height;if(e.fill){var l=(0,s.hex2rgb)(e.fillColor),c=e.fillAlpha,h=l[0]*c,p=l[1]*c,d=l[2]*c,v=t.points,m=t.indices,g=v.length/6;v.push(o,u),v.push(h,p,d,c),v.push(o+a,u),v.push(h,p,d,c),v.push(o,u+f),v.push(h,p,d,c),v.push(o+a,u+f),v.push(h,p,d,c),m.push(g,g,g+1,g+2,g+3,g+3)}if(e.lineWidth){var y=e.points;e.points=[o,u,o+a,u,o+a,u+f,o,u+f,o,u],(0,i.default)(e,t,n),e.points=y}}n.__esModule=!0,n.default=u;var r=e("./buildLine"),i=o(r),s=e("../../../utils")},{"../../../utils":124,"./buildLine":61}],64:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e,t,n){var r=e.shape,s=r.x,a=r.y,f=r.width,l=r.height,h=r.radius,p=[];p.push(s,a+h),c(s,a+l-h,s,a+l,s+h,a+l,p),c(s+f-h,a+l,s+f,a+l,s+f,a+l-h,p),c(s+f,a+h,s+f,a,s+f-h,a,p),c(s+h,a,s,a,s,a+h+1e-10,p);if(e.fill){var d=(0,u.hex2rgb)(e.fillColor),v=e.fillAlpha,m=d[0]*v,g=d[1]*v,y=d[2]*v,b=t.points,w=t.indices,E=b.length/6,S=(0,i.default)(p,null,2);for(var x=0,T=S.length;x<T;x+=3)w.push(S[x]+E),w.push(S[x]+E),w.push(S[x+1]+E),w.push(S[x+2]+E),w.push(S[x+2]+E);for(var N=0,C=p.length;N<C;N++)b.push(p[N],p[++N],m,g,y,v)}if(e.lineWidth){var k=e.points;e.points=p,(0,o.default)(e,t,n),e.points=k}}function l(e,t,n){var r=t-e;return e+r*n}function c(e,t,n,r,i,s){var o=arguments.length>6&&arguments[6]!==undefined?arguments[6]:[],u=20,a=o,f=0,c=0,h=0,p=0,d=0,v=0;for(var m=0,g=0;m<=u;++m)g=m/u,f=l(e,n,g),c=l(t,r,g),h=l(n,i,g),p=l(r,s,g),d=l(f,h,g),v=l(c,p,g),a.push(d,v);return a}n.__esModule=!0,n.default=f;var r=e("earcut"),i=a(r),s=e("./buildLine"),o=a(s),u=e("../../../utils")},{"../../../utils":124,"./buildLine":61,earcut:2}],65:[function(e,t,n){"use strict";function Q(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function G(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.autoDetectRenderer=n.Application=n.Filter=n.SpriteMaskFilter=n.Quad=n.RenderTarget=n.ObjectRenderer=n.WebGLManager=n.Shader=n.CanvasRenderTarget=n.TextureUvs=n.VideoBaseTexture=n.BaseRenderTexture=n.RenderTexture=n.BaseTexture=n.Texture=n.Spritesheet=n.CanvasGraphicsRenderer=n.GraphicsRenderer=n.GraphicsData=n.Graphics=n.TextMetrics=n.TextStyle=n.Text=n.SpriteRenderer=n.CanvasTinter=n.CanvasSpriteRenderer=n.Sprite=n.TransformBase=n.TransformStatic=n.Transform=n.Container=n.DisplayObject=n.Bounds=n.glCore=n.WebGLRenderer=n.CanvasRenderer=n.ticker=n.utils=n.settings=undefined;var r=e("./const");Object.keys(r).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./math");Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var s=e("pixi-gl-core");Object.defineProperty(n,"glCore",{enumerable:!0,get:function(){return G(s).default}});var o=e("./display/Bounds");Object.defineProperty(n,"Bounds",{enumerable:!0,get:function(){return G(o).default}});var u=e("./display/DisplayObject");Object.defineProperty(n,"DisplayObject",{enumerable:!0,get:function(){return G(u).default}});var a=e("./display/Container");Object.defineProperty(n,"Container",{enumerable:!0,get:function(){return G(a).default}});var f=e("./display/Transform");Object.defineProperty(n,"Transform",{enumerable:!0,get:function(){return G(f).default}});var l=e("./display/TransformStatic");Object.defineProperty(n,"TransformStatic",{enumerable:!0,get:function(){return G(l).default}});var c=e("./display/TransformBase");Object.defineProperty(n,"TransformBase",{enumerable:!0,get:function(){return G(c).default}});var h=e("./sprites/Sprite");Object.defineProperty(n,"Sprite",{enumerable:!0,get:function(){return G(h).default}});var p=e("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(n,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return G(p).default}});var d=e("./sprites/canvas/CanvasTinter");Object.defineProperty(n,"CanvasTinter",{enumerable:!0,get:function(){return G(d).default}});var v=e("./sprites/webgl/SpriteRenderer");Object.defineProperty(n,"SpriteRenderer",{enumerable:!0,get:function(){return G(v).default}});var m=e("./text/Text");Object.defineProperty(n,"Text",{enumerable:!0,get:function(){return G(m).default}});var g=e("./text/TextStyle");Object.defineProperty(n,"TextStyle",{enumerable:!0,get:function(){return G(g).default}});var y=e("./text/TextMetrics");Object.defineProperty(n,"TextMetrics",{enumerable:!0,get:function(){return G(y).default}});var b=e("./graphics/Graphics");Object.defineProperty(n,"Graphics",{enumerable:!0,get:function(){return G(b).default}});var w=e("./graphics/GraphicsData");Object.defineProperty(n,"GraphicsData",{enumerable:!0,get:function(){return G(w).default}});var E=e("./graphics/webgl/GraphicsRenderer");Object.defineProperty(n,"GraphicsRenderer",{enumerable:!0,get:function(){return G(E).default}});var S=e("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(n,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return G(S).default}});var x=e("./textures/Spritesheet");Object.defineProperty(n,"Spritesheet",{enumerable:!0,get:function(){return G(x).default}});var T=e("./textures/Texture");Object.defineProperty(n,"Texture",{enumerable:!0,get:function(){return G(T).default}});var N=e("./textures/BaseTexture");Object.defineProperty(n,"BaseTexture",{enumerable:!0,get:function(){return G(N).default}});var C=e("./textures/RenderTexture");Object.defineProperty(n,"RenderTexture",{enumerable:!0,get:function(){return G(C).default}});var k=e("./textures/BaseRenderTexture");Object.defineProperty(n,"BaseRenderTexture",{enumerable:!0,get:function(){return G(k).default}});var L=e("./textures/VideoBaseTexture");Object.defineProperty(n,"VideoBaseTexture",{enumerable:!0,get:function(){return G(L).default}});var A=e("./textures/TextureUvs");Object.defineProperty(n,"TextureUvs",{enumerable:!0,get:function(){return G(A).default}});var O=e("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(n,"CanvasRenderTarget",{enumerable:!0,get:function(){return G(O).default}});var M=e("./Shader");Object.defineProperty(n,"Shader",{enumerable:!0,get:function(){return G(M).default}});var _=e("./renderers/webgl/managers/WebGLManager");Object.defineProperty(n,"WebGLManager",{enumerable:!0,get:function(){return G(_).default}});var D=e("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(n,"ObjectRenderer",{enumerable:!0,get:function(){return G(D).default}});var P=e("./renderers/webgl/utils/RenderTarget");Object.defineProperty(n,"RenderTarget",{enumerable:!0,get:function(){return G(P).default}});var H=e("./renderers/webgl/utils/Quad");Object.defineProperty(n,"Quad",{enumerable:!0,get:function(){return G(H).default}});var B=e("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(n,"SpriteMaskFilter",{enumerable:!0,get:function(){return G(B).default}});var j=e("./renderers/webgl/filters/Filter");Object.defineProperty(n,"Filter",{enumerable:!0,get:function(){return G(j).default}});var F=e("./Application");Object.defineProperty(n,"Application",{enumerable:!0,get:function(){return G(F).default}});var I=e("./autoDetectRenderer");Object.defineProperty(n,"autoDetectRenderer",{enumerable:!0,get:function(){return I.autoDetectRenderer}});var q=e("./utils"),R=Q(q),U=e("./ticker"),z=Q(U),W=e("./settings"),X=G(W),V=e("./renderers/canvas/CanvasRenderer"),$=G(V),J=e("./renderers/webgl/WebGLRenderer"),K=G(J);n.settings=X.default,n.utils=R,n.ticker=z,n.CanvasRenderer=$.default,n.WebGLRenderer=K.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureUvs":116,"./textures/VideoBaseTexture":117,"./ticker":120,"./utils":124,"pixi-gl-core":12}],66:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function h(e){return e<0?-1:e>0?1:0}function p(){for(var e=0;e<16;e++){var t=[];c.push(t);for(var n=0;n<16;n++){var r=h(o[e]*o[n]+a[e]*u[n]),s=h(u[e]*o[n]+f[e]*u[n]),p=h(o[e]*a[n]+a[e]*f[n]),d=h(u[e]*a[n]+f[e]*f[n]);for(var v=0;v<16;v++)if(o[v]===r&&u[v]===s&&a[v]===p&&f[v]===d){t.push(v);break}}}for(var m=0;m<16;m++){var g=new i.default;g.set(o[m],u[m],a[m],f[m],0,0),l.push(g)}}n.__esModule=!0;var r=e("./Matrix"),i=s(r),o=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],u=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],f=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],c=[];p();var d={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return o[t]},uY:function(t){return u[t]},vX:function(t){return a[t]},vY:function(t){return f[t]},inv:function(t){return t&8?t&15:-t&7},add:function(t,n){return c[t][n]},sub:function(t,n){return c[t][d.inv(n)]},rotate180:function(t){return t^4},isSwapWidthHeight:function(t){return(t&3)===2},byDirection:function(t,n){return Math.abs(t)*2<=Math.abs(n)?n>=0?d.S:d.N:Math.abs(n)*2<=Math.abs(t)?t>0?d.E:d.W:n>0?t>0?d.SE:d.SW:t>0?d.NE:d.NW},matrixAppendRotationInv:function(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0,s=l[d.inv(n)];s.tx=r,s.ty=i,t.append(s)}};n.default=d},{"./Matrix":67}],67:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./Point"),s=o(i),a=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1,s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0,o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;u(this,e),this.a=t,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o,this.array=null}return e.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},e.prototype.set=function(t,n,r,i,s,o){return this.a=t,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o,this},e.prototype.toArray=function(t,n){this.array||(this.array=new Float32Array(9));var r=n||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(t,n){n=n||new s.default;var r=t.x,i=t.y;return n.x=this.a*r+this.c*i+this.tx,n.y=this.b*r+this.d*i+this.ty,n},e.prototype.applyInverse=function(t,n){n=n||new s.default;var r=1/(this.a*this.d+this.c*-this.b),i=t.x,o=t.y;return n.x=this.d*r*i+ -this.c*r*o+(this.ty*this.c-this.tx*this.d)*r,n.y=this.a*r*o+ -this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,n},e.prototype.translate=function(t,n){return this.tx+=t,this.ty+=n,this},e.prototype.scale=function(t,n){return this.a*=t,this.d*=n,this.c*=t,this.b*=n,this.tx*=t,this.ty*=n,this},e.prototype.rotate=function(t){var n=Math.cos(t),r=Math.sin(t),i=this.a,s=this.c,o=this.tx;return this.a=i*n-this.b*r,this.b=i*r+this.b*n,this.c=s*n-this.d*r,this.d=s*r+this.d*n,this.tx=o*n-this.ty*r,this.ty=o*r+this.ty*n,this},e.prototype.append=function(t){var n=this.a,r=this.b,i=this.c,s=this.d;return this.a=t.a*n+t.b*i,this.b=t.a*r+t.b*s,this.c=t.c*n+t.d*i,this.d=t.c*r+t.d*s,this.tx=t.tx*n+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*s+this.ty,this},e.prototype.setTransform=function(t,n,r,i,s,o,u,a,f){var l=Math.sin(u),c=Math.cos(u),h=Math.cos(f),p=Math.sin(f),d=-Math.sin(a),v=Math.cos(a),m=c*s,g=l*s,y=-l*o,b=c*o;return this.a=h*m+p*y,this.b=h*g+p*b,this.c=d*m+v*y,this.d=d*g+v*b,this.tx=t+(r*m+i*y),this.ty=n+(r*g+i*b),this},e.prototype.prepend=function(t){var n=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this},e.prototype.decompose=function(t){var n=this.a,r=this.b,i=this.c,s=this.d,o=-Math.atan2(-i,s),u=Math.atan2(r,n),a=Math.abs(o+u);return a<1e-5?(t.rotation=u,n<0&&s>=0&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.skew.x=o,t.skew.y=u),t.scale.x=Math.sqrt(n*n+r*r),t.scale.y=Math.sqrt(i*i+s*s),t.position.x=this.tx,t.position.y=this.ty,t},e.prototype.invert=function(){var t=this.a,n=this.b,r=this.c,i=this.d,s=this.tx,o=t*i-n*r;return this.a=i/o,this.b=-n/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(t*this.ty-n*s)/o,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var n=new e;return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.tx=this.tx,n.ty=this.ty,n},e.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r(e,null,[{key:"IDENTITY",get:function(){return new e}},{key:"TEMP_MATRIX",get:function(){return new e}}]),e}();n.default=a},{"./Point":69}],68:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;i(this,e),this._x=r,this._y=s,this.cb=t,this.scope=n}return e.prototype.set=function(t,n){var r=t||0,i=n||(n!==0?r:0);if(this._x!==r||this._y!==i)this._x=r,this._y=i,this.cb.call(this.scope)},e.prototype.copy=function(t){if(this._x!==t.x||this._y!==t.y)this._x=t.x,this._y=t.y,this.cb.call(this.scope)},r(e,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),e}();n.default=s},{}],69:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;r(this,e),this.x=t,this.y=n}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copy=function(t){this.set(t.x,t.y)},e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},e.prototype.set=function(t,n){this.x=t||0,this.y=n||(n!==0?this.x:0)},e}();n.default=i},{}],70:[function(e,t,n){"use strict";function h(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./Point");Object.defineProperty(n,"Point",{enumerable:!0,get:function(){return h(r).default}});var i=e("./ObservablePoint");Object.defineProperty(n,"ObservablePoint",{enumerable:!0,get:function(){return h(i).default}});var s=e("./Matrix");Object.defineProperty(n,"Matrix",{enumerable:!0,get:function(){return h(s).default}});var o=e("./GroupD8");Object.defineProperty(n,"GroupD8",{enumerable:!0,get:function(){return h(o).default}});var u=e("./shapes/Circle");Object.defineProperty(n,"Circle",{enumerable:!0,get:function(){return h(u).default}});var a=e("./shapes/Ellipse");Object.defineProperty(n,"Ellipse",{enumerable:!0,get:function(){return h(a).default}});var f=e("./shapes/Polygon");Object.defineProperty(n,"Polygon",{enumerable:!0,get:function(){return h(f).default}});var l=e("./shapes/Rectangle");Object.defineProperty(n,"Rectangle",{enumerable:!0,get:function(){return h(l).default}});var c=e("./shapes/RoundedRectangle");Object.defineProperty(n,"RoundedRectangle",{enumerable:!0,get:function(){return h(c).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("./Rectangle"),i=o(r),s=e("../../const"),a=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;u(this,e),this.x=t,this.y=n,this.radius=r,this.type=s.SHAPES.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(t,n){if(this.radius<=0)return!1;var r=this.radius*this.radius,i=this.x-t,s=this.y-n;return i*=i,s*=s,i+s<=r},e.prototype.getBounds=function(){return new i.default(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},e}();n.default=a},{"../../const":46,"./Rectangle":74}],72:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("./Rectangle"),i=o(r),s=e("../../const"),a=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;u(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.type=s.SHAPES.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(t,n){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(n-this.y)/this.height;return r*=r,i*=i,r+i<=1},e.prototype.getBounds=function(){return new i.default(this.x-this.width,this.y-this.height,this.width,this.height)},e}();n.default=a},{"../../const":46,"./Rectangle":74}],73:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../Point"),i=o(r),s=e("../../const"),a=function(){function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];u(this,e),Array.isArray(n[0])&&(n=n[0]);if(n[0]instanceof i.default){var o=[];for(var a=0,f=n.length;a<f;a++)o.push(n[a].x,n[a].y);n=o}this.closed=!0,this.points=n,this.type=s.SHAPES.POLY}return e.prototype.clone=function(){return new e(this.points.slice())},e.prototype.close=function(){var t=this.points;(t[0]!==t[t.length-2]||t[1]!==t[t.length-1])&&t.push(t[0],t[1])},e.prototype.contains=function(t,n){var r=!1,i=this.points.length/2;for(var s=0,o=i-1;s<i;o=s++){var u=this.points[s*2],a=this.points[s*2+1],f=this.points[o*2],l=this.points[o*2+1],c=a>n!=l>n&&t<(f-u)*((n-a)/(l-a))+u;c&&(r=!r)}return r},e}();n.default=a},{"../../const":46,"../Point":69}],74:[function(e,t,n){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../const"),o=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;s(this,e),this.x=Number(t),this.y=Number(n),this.width=Number(r),this.height=Number(o),this.type=i.SHAPES.RECT}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},e.prototype.contains=function(t,n){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&n>=this.y&&n<this.y+this.height?!0:!1},e.prototype.pad=function(t,n){t=t||0,n=n||(n!==0?t:0),this.x-=t,this.y-=n,this.width+=t*2,this.height+=n*2},e.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},e.prototype.enlarge=function(t){var n=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);this.x=n,this.width=r-n,this.y=i,this.height=s-i},r(e,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new e(0,0,0,0)}}]),e}();n.default=o},{"../../const":46}],75:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../const"),s=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0,u=arguments.length>4&&arguments[4]!==undefined?arguments[4]:20;i(this,e),this.x=t,this.y=n,this.width=s,this.height=o,this.radius=u,this.type=r.SHAPES.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(t,n){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){if(n>=this.y+this.radius&&n<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),i=n-(this.y+this.radius),s=this.radius*this.radius;if(r*r+i*i<=s)return!0;r=t-(this.x+this.width-this.radius);if(r*r+i*i<=s)return!0;i=n-(this.y+this.height-this.radius);if(r*r+i*i<=s)return!0;r=t-(this.x+this.radius);if(r*r+i*i<=s)return!0}return!1},e}();n.default=s},{"../../const":46}],76:[function(e,t,n){"use strict";function v(e){return e&&e.__esModule?e:{"default":e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function y(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../utils"),s=e("../math"),o=e("../const"),u=e("../settings"),a=v(u),f=e("../display/Container"),l=v(f),c=e("../textures/RenderTexture"),h=v(c),p=e("eventemitter3"),d=v(p),b=new s.Matrix,w=function(e){function t(n,r,u,f){m(this,t);var c=g(this,e.call(this));return(0,i.sayHello)(n),typeof r=="number"&&(r=Object.assign({width:r,height:u||a.default.RENDER_OPTIONS.height},f)),r=Object.assign({},a.default.RENDER_OPTIONS,r),c.options=r,c.type=o.RENDERER_TYPE.UNKNOWN,c.screen=new s.Rectangle(0,0,r.width,r.height),c.view=r.view||document.createElement("canvas"),c.resolution=r.resolution||a.default.RESOLUTION,c.transparent=r.transparent,c.autoResize=r.autoResize||!1,c.blendModes=null,c.preserveDrawingBuffer=r.preserveDrawingBuffer,c.clearBeforeRender=r.clearBeforeRender,c.roundPixels=r.roundPixels,c._backgroundColor=0,c._backgroundColorRgba=[0,0,0,0],c._backgroundColorString="#000000",c.backgroundColor=r.backgroundColor||c._backgroundColor,c._tempDisplayObjectParent=new l.default,c._lastObjectRendered=c._tempDisplayObjectParent,c}return y(t,e),t.prototype.resize=function(t,n){this.screen.width=t,this.screen.height=n,this.view.width=t*this.resolution,this.view.height=n*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=n+"px")},t.prototype.generateTexture=function(t,n,r){var i=t.getLocalBounds(),s=h.default.create(i.width|0,i.height|0,n,r);return b.tx=-i.x,b.ty=-i.y,this.render(t,s,!1,b,!0),s},t.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=o.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},r(t,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,i.hex2string)(t),(0,i.hex2rgb)(t,this._backgroundColorRgba)}}]),t}(d.default);n.default=w},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":124,eventemitter3:3}],77:[function(e,t,n){"use strict";function v(e){return e&&e.__esModule?e:{"default":e}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function y(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../SystemRenderer"),i=v(r),s=e("./utils/CanvasMaskManager"),o=v(s),u=e("./utils/CanvasRenderTarget"),a=v(u),f=e("./utils/mapCanvasBlendModesToPixi"),l=v(f),c=e("../../utils"),h=e("../../const"),p=e("../../settings"),d=v(p),b=function(e){function t(n,r,i){m(this,t);var s=g(this,e.call(this,"Canvas",n,r,i));return s.type=h.RENDERER_TYPE.CANVAS,s.rootContext=s.view.getContext("2d",{alpha:s.transparent}),s.context=s.rootContext,s.refresh=!0,s.maskManager=new o.default(s),s.smoothProperty="imageSmoothingEnabled",s.rootContext.imageSmoothingEnabled||(s.rootContext.webkitImageSmoothingEnabled?s.smoothProperty="webkitImageSmoothingEnabled":s.rootContext.mozImageSmoothingEnabled?s.smoothProperty="mozImageSmoothingEnabled":s.rootContext.oImageSmoothingEnabled?s.smoothProperty="oImageSmoothingEnabled":s.rootContext.msImageSmoothingEnabled&&(s.smoothProperty="msImageSmoothingEnabled")),s.initPlugins(),s.blendModes=(0,l.default)(),s._activeBlendMode=null,s.renderingToScreen=!1,s.resize(s.options.width,s.options.height),s}return y(t,e),t.prototype.render=function(t,n,r,i,s){if(!this.view)return;this.renderingToScreen=!n,this.emit("prerender");var o=this.resolution;n?(n=n.baseTexture||n,n._canvasRenderTarget||(n._canvasRenderTarget=new a.default(n.width,n.height,n.resolution),n.source=n._canvasRenderTarget.canvas,n.valid=!0),this.context=n._canvasRenderTarget.context,this.resolution=n._canvasRenderTarget.resolution):this.context=this.rootContext;var u=this.context;n||(this._lastObjectRendered=t);if(!s){var f=t.parent,l=this._tempDisplayObjectParent.transform.worldTransform;i?(i.copy(l),this._tempDisplayObjectParent.transform._worldID=-1):l.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=f}u.setTransform(1,0,0,1,0,0),u.globalAlpha=1,this._activeBlendMode=h.BLEND_MODES.NORMAL,u.globalCompositeOperation=this.blendModes[h.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(u.fillStyle="black",u.clear()),(r!==undefined?r:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?u.clearRect(0,0,this.width,this.height):(u.fillStyle=this._backgroundColorString,u.fillRect(0,0,this.width,this.height)));var c=this.context;this.context=u,t.renderCanvas(this),this.context=c,this.resolution=o,this.emit("postrender")},t.prototype.clear=function(t){var n=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(n.fillStyle=t,n.fillRect(0,0,this.width,this.height)):n.clearRect(0,0,this.width,this.height)},t.prototype.setBlendMode=function(t){if(this._activeBlendMode===t)return;this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t]},t.prototype.destroy=function(n){this.destroyPlugins(),e.prototype.destroy.call(this,n),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},t.prototype.resize=function(n,r){e.prototype.resize.call(this,n,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=d.default.SCALE_MODE===h.SCALE_MODES.LINEAR)},t.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},t}(i.default);n.default=b,c.pluginTarget.mixin(b)},{"../../const":46,"../../settings":101,"../../utils":124,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../../const"),s=function(){function e(t){i(this,e),this.renderer=t}return e.prototype.pushMask=function(t){var n=this.renderer;n.context.save();var r=t.alpha,i=t.transform.worldTransform,s=n.resolution;n.context.setTransform(i.a*s,i.b*s,i.c*s,i.d*s,i.tx*s,i.ty*s),t._texture||(this.renderGraphicsShape(t),n.context.clip()),t.worldAlpha=r},e.prototype.renderGraphicsShape=function(t){var n=this.renderer.context,i=t.graphicsData.length;if(i===0)return;n.beginPath();for(var s=0;s<i;s++){var o=t.graphicsData[s],u=o.shape;if(o.type===r.SHAPES.POLY){var a=u.points;n.moveTo(a[0],a[1]);for(var f=1;f<a.length/2;f++)n.lineTo(a[f*2],a[f*2+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&n.closePath()}else if(o.type===r.SHAPES.RECT)n.rect(u.x,u.y,u.width,u.height),n.closePath();else if(o.type===r.SHAPES.CIRC)n.arc(u.x,u.y,u.radius,0,2*Math.PI),n.closePath();else if(o.type===r.SHAPES.ELIP){var l=u.width*2,c=u.height*2,h=u.x-l/2,p=u.y-c/2,d=.5522848,v=l/2*d,m=c/2*d,g=h+l,y=p+c,b=h+l/2,w=p+c/2;n.moveTo(h,w),n.bezierCurveTo(h,w-m,b-v,p,b,p),n.bezierCurveTo(b+v,p,g,w-m,g,w),n.bezierCurveTo(g,w+m,b+v,y,b,y),n.bezierCurveTo(b-v,y,h,w+m,h,w),n.closePath()}else if(o.type===r.SHAPES.RREC){var E=u.x,S=u.y,x=u.width,T=u.height,N=u.radius,C=Math.min(x,T)/2|0;N=N>C?C:N,n.moveTo(E,S+N),n.lineTo(E,S+T-N),n.quadraticCurveTo(E,S+T,E+N,S+T),n.lineTo(E+x-N,S+T),n.quadraticCurveTo(E+x,S+T,E+x,S+T-N),n.lineTo(E+x,S+N),n.quadraticCurveTo(E+x,S,E+x-N,S),n.lineTo(E+N,S),n.quadraticCurveTo(E,S,E,S+N),n.closePath()}}},e.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},e.prototype.destroy=function(){},e}();n.default=s},{"../../../const":46}],79:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../../settings"),s=o(i),a=function(){function e(t,n,r){u(this,e),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||s.default.RESOLUTION,this.resize(t,n)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(t,n){this.canvas.width=t*this.resolution,this.canvas.height=n*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},r(e,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),e}();n.default=a},{"../../../settings":101}],80:[function(e,t,n){"use strict";function r(e){var t=document.createElement("canvas");t.width=6,t.height=1;var n=t.getContext("2d");return n.fillStyle=e,n.fillRect(0,0,6,1),t}function i(){if(typeof document=="undefined")return!1;var e=r("#ff00ff"),t=r("#ffff00"),n=document.createElement("canvas");n.width=6,n.height=1;var i=n.getContext("2d");i.globalCompositeOperation="multiply",i.drawImage(e,0,0),i.drawImage(t,2,0);var s=i.getImageData(2,0,1,1);if(!s)return!1;var o=s.data;return o[0]===255&&o[1]===0&&o[2]===0}n.__esModule=!0,n.default=i},{}],81:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return(0,s.default)()?(e[r.BLEND_MODES.NORMAL]="source-over",e[r.BLEND_MODES.ADD]="lighter",e[r.BLEND_MODES.MULTIPLY]="multiply",e[r.BLEND_MODES.SCREEN]="screen",e[r.BLEND_MODES.OVERLAY]="overlay",e[r.BLEND_MODES.DARKEN]="darken",e[r.BLEND_MODES.LIGHTEN]="lighten",e[r.BLEND_MODES.COLOR_DODGE]="color-dodge",e[r.BLEND_MODES.COLOR_BURN]="color-burn",e[r.BLEND_MODES.HARD_LIGHT]="hard-light",e[r.BLEND_MODES.SOFT_LIGHT]="soft-light",e[r.BLEND_MODES.DIFFERENCE]="difference",e[r.BLEND_MODES.EXCLUSION]="exclusion",e[r.BLEND_MODES.HUE]="hue",e[r.BLEND_MODES.SATURATION]="saturate",e[r.BLEND_MODES.COLOR]="color",e[r.BLEND_MODES.LUMINOSITY]="luminosity"):(e[r.BLEND_MODES.NORMAL]="source-over",e[r.BLEND_MODES.ADD]="lighter",e[r.BLEND_MODES.MULTIPLY]="source-over",e[r.BLEND_MODES.SCREEN]="source-over",e[r.BLEND_MODES.OVERLAY]="source-over",e[r.BLEND_MODES.DARKEN]="source-over",e[r.BLEND_MODES.LIGHTEN]="source-over",e[r.BLEND_MODES.COLOR_DODGE]="source-over",e[r.BLEND_MODES.COLOR_BURN]="source-over",e[r.BLEND_MODES.HARD_LIGHT]="source-over",e[r.BLEND_MODES.SOFT_LIGHT]="source-over",e[r.BLEND_MODES.DIFFERENCE]="source-over",e[r.BLEND_MODES.EXCLUSION]="source-over",e[r.BLEND_MODES.HUE]="source-over",e[r.BLEND_MODES.SATURATION]="source-over",e[r.BLEND_MODES.COLOR]="source-over",e[r.BLEND_MODES.LUMINOSITY]="source-over"),e[r.BLEND_MODES.NORMAL_NPM]=e[r.BLEND_MODES.NORMAL],e[r.BLEND_MODES.ADD_NPM]=e[r.BLEND_MODES.ADD],e[r.BLEND_MODES.SCREEN_NPM]=e[r.BLEND_MODES.SCREEN],e}n.__esModule=!0,n.default=u;var r=e("../../../const"),i=e("./canUseNewCanvasBlendModes"),s=o(i)},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../const"),i=e("../../settings"),s=o(i),a=function(){function e(t){u(this,e),this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=s.default.GC_MAX_IDLE,this.checkCountMax=s.default.GC_MAX_CHECK_COUNT,this.mode=s.default.GC_MODE}return e.prototype.update=function(){this.count++;if(this.mode===r.GC_MODES.MANUAL)return;this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())},e.prototype.run=function(){var t=this.renderer.textureManager,n=t._managedTextures,r=!1;for(var i=0;i<n.length;i++){var s=n[i];!s._glRenderTargets&&this.count-s.touched>this.maxIdle&&(t.destroyTexture(s,!0),n[i]=null,r=!0)}if(r){var o=0;for(var u=0;u<n.length;u++)n[u]!==null&&(n[o++]=n[u]);n.length=o}},e.prototype.unload=function(t){var n=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&n.destroyTexture(t._texture,!0);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}();n.default=a},{"../../const":46,"../../settings":101}],83:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("pixi-gl-core"),i=e("../../const"),s=e("./utils/RenderTarget"),o=a(s),u=e("../../utils"),l=function(){function e(t){f(this,e),this.renderer=t,this.gl=t.gl,this._managedTextures=[]}return e.prototype.bindTexture=function(){},e.prototype.getTexture=function(){},e.prototype.updateTexture=function(t,n){var s=this.gl,u=!!t._glRenderTargets;if(!t.hasLoaded)return null;var a=this.renderer.boundTextures;if(n===undefined){n=0;for(var f=0;f<a.length;++f)if(a[f]===t){n=f;break}}a[n]=t,s.activeTexture(s.TEXTURE0+n);var l=t._glTextures[this.renderer.CONTEXT_UID];if(!l){if(u){var c=new o.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);c.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=c,l=c.texture}else l=new r.GLTexture(this.gl,null,null,null,null),l.bind(n),l.premultiplyAlpha=!0,l.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=l,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&l.enableMipmap(),t.wrapMode===i.WRAP_MODES.CLAMP?l.enableWrapClamp():t.wrapMode===i.WRAP_MODES.REPEAT?l.enableWrapRepeat():l.enableWrapMirrorRepeat()):l.enableWrapClamp(),t.scaleMode===i.SCALE_MODES.NEAREST?l.enableNearestScaling():l.enableLinearScaling()}else u?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):l.upload(t.source);return l},e.prototype.destroyTexture=function(t,n){t=t.baseTexture||t;if(!t.hasLoaded)return;var r=this.renderer.CONTEXT_UID,i=t._glTextures,s=t._glRenderTargets;if(i[r]){this.renderer.unbindTexture(t),i[r].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete i[r];if(!n){var o=this._managedTextures.indexOf(t);o!==-1&&(0,u.removeItems)(this._managedTextures,o,1)}}s&&s[r]&&(s[r].destroy(),delete s[r])},e.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var n=this._managedTextures[t];n._glTextures[this.renderer.CONTEXT_UID]&&delete n._glTextures[this.renderer.CONTEXT_UID]}},e.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var n=this._managedTextures[t];this.destroyTexture(n,!0),n.off("update",this.updateTexture,this),n.off("dispose",this.destroyTexture,this)}this._managedTextures=null},e}();n.default=l},{"../../const":46,"../../utils":124,"./utils/RenderTarget":96,"pixi-gl-core":12}],84:[function(e,t,n){"use strict";function M(e){return e&&e.__esModule?e:{"default":e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function P(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../SystemRenderer"),i=M(r),s=e("./managers/MaskManager"),o=M(s),u=e("./managers/StencilManager"),a=M(u),f=e("./managers/FilterManager"),l=M(f),c=e("./utils/RenderTarget"),h=M(c),p=e("./utils/ObjectRenderer"),d=M(p),v=e("./TextureManager"),m=M(v),g=e("../../textures/BaseTexture"),y=M(g),b=e("./TextureGarbageCollector"),w=M(b),E=e("./WebGLState"),S=M(E),x=e("./utils/mapWebGLDrawModesToPixi"),T=M(x),N=e("./utils/validateContext"),C=M(N),k=e("../../utils"),L=e("pixi-gl-core"),A=M(L),O=e("../../const"),H=0,B=function(e){function t(n,r,i){_(this,t);var s=D(this,e.call(this,"WebGL",n,r,i));return s.legacy=s.options.legacy,s.legacy&&(A.default.VertexArrayObject.FORCE_NATIVE=!0),s.type=O.RENDERER_TYPE.WEBGL,s.handleContextLost=s.handleContextLost.bind(s),s.handleContextRestored=s.handleContextRestored.bind(s),s.view.addEventListener("webglcontextlost",s.handleContextLost,!1),s.view.addEventListener("webglcontextrestored",s.handleContextRestored,!1),s._contextOptions={alpha:s.transparent,antialias:s.options.antialias,premultipliedAlpha:s.transparent&&s.transparent!=="notMultiplied",stencil:!0,preserveDrawingBuffer:s.options.preserveDrawingBuffer,powerPreference:s.options.powerPreference},s._backgroundColorRgba[3]=s.transparent?0:1,s.maskManager=new o.default(s),s.stencilManager=new a.default(s),s.emptyRenderer=new d.default(s),s.currentRenderer=s.emptyRenderer,s.textureManager=null,s.filterManager=null,s.initPlugins(),s.options.context&&(0,C.default)(s.options.context),s.gl=s.options.context||A.default.createContext(s.view,s._contextOptions),s.CONTEXT_UID=H++,s.state=new S.default(s.gl),s.renderingToScreen=!0,s.boundTextures=null,s._activeShader=null,s._activeVao=null,s._activeRenderTarget=null,s._initContext(),s.drawModes=(0,T.default)(s.gl),s._nextTextureLocation=0,s.setBlendMode(0),s}return P(t,e),t.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var n=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(n),this.emptyTextures=new Array(n),this.textureManager=new m.default(this),this.filterManager=new l.default(this),this.textureGC=new w.default(this),this.state.resetToDefault(),this.rootRenderTarget=new h.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var r=new A.default.GLTexture.fromData(t,null,1,1),i={_glTextures:{}};i._glTextures[this.CONTEXT_UID]={};for(var s=0;s<n;s++){var o=new y.default;o._glTextures[this.CONTEXT_UID]=r,this.boundTextures[s]=i,this.emptyTextures[s]=o,this.bindTexture(null,s)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},t.prototype.render=function(t,n,r,i,s){this.renderingToScreen=!n,this.emit("prerender");if(!this.gl||this.gl.isContextLost())return;this._nextTextureLocation=0,n||(this._lastObjectRendered=t);if(!s){var o=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=o}this.bindRenderTexture(n,i),this.currentRenderer.start(),(r!==undefined?r:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")},t.prototype.setObjectRenderer=function(t){if(this.currentRenderer===t)return;this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start()},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.resize=function(t,n){i.default.prototype.resize.call(this,t,n),this.rootRenderTarget.resize(t,n),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},t.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},t.prototype.clear=function(t){this._activeRenderTarget.clear(t)},t.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},t.prototype.clearRenderTexture=function(t,n){var r=t.baseTexture,i=r._glRenderTargets[this.CONTEXT_UID];return i&&i.clear(n),this},t.prototype.bindRenderTexture=function(t,n){var r=void 0;if(t){var i=t.baseTexture;i._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(i,0),this.unbindTexture(i),r=i._glRenderTargets[this.CONTEXT_UID],r.setFrame(t.frame)}else r=this.rootRenderTarget;return r.transform=n,this.bindRenderTarget(r),this},t.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},t.prototype.bindShader=function(t,n){return this._activeShader!==t&&(this._activeShader=t,t.bind(),n!==!1&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},t.prototype.bindTexture=function(t,n,r){t=t||this.emptyTextures[n],t=t.baseTexture||t,t.touched=this.textureGC.count;if(!r){for(var i=0;i<this.boundTextures.length;i++)if(this.boundTextures[i]===t)return i;n===undefined&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,n=this.boundTextures.length-this._nextTextureLocation-1)}else n=n||0;var s=this.gl,o=t._glTextures[this.CONTEXT_UID];return o?(this.boundTextures[n]=t,s.activeTexture(s.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,o.texture)):this.textureManager.updateTexture(t,n),n},t.prototype.unbindTexture=function(t){var n=this.gl;t=t.baseTexture||t;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]===t&&(this.boundTextures[r]=this.emptyTextures[r],n.activeTexture(n.TEXTURE0+r),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[r]._glTextures[this.CONTEXT_UID].texture));return this},t.prototype.createVao=function(){return new A.default.VertexArrayObject(this.gl,this.state.attribState)},t.prototype.bindVao=function(t){return this._activeVao===t?this:(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t,this)},t.prototype.reset=function(){return this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this.rootRenderTarget.activate(),this.state.resetToDefault(),this},t.prototype.handleContextLost=function(t){t.preventDefault()},t.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},t.prototype.destroy=function(n){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),e.prototype.destroy.call(this,n),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},t}(i.default);n.default=B,k.pluginTarget.mixin(B)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":124,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":12}],85:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("./utils/mapWebGLBlendModesToPixi"),i=s(r),u=0,a=1,f=2,l=3,c=4,h=function(){function e(t){o(this,e),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=t,this.maxAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,i.default)(t),this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")}return e.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var n=0;n<this.activeState.length;n++)t[n]=this.activeState[n]},e.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},e.prototype.setState=function(t){this.setBlend(t[u]),this.setDepthTest(t[a]),this.setFrontFace(t[f]),this.setCullFace(t[l]),this.setBlendMode(t[c])},e.prototype.setBlend=function(t){t=t?1:0;if(this.activeState[u]===t)return;this.activeState[u]=t,this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setBlendMode=function(t){if(t===this.activeState[c])return;this.activeState[c]=t;var n=this.blendModes[t];n.length===2?this.gl.blendFunc(n[0],n[1]):this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3])},e.prototype.setDepthTest=function(t){t=t?1:0;if(this.activeState[a]===t)return;this.activeState[a]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){t=t?1:0;if(this.activeState[l]===t)return;this.activeState[l]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){t=t?1:0;if(this.activeState[f]===t)return;this.activeState[f]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var n=0;n<this.attribState.attribState.length;n++)this.attribState.attribState[n]=0;for(var r=1;r<this.maxAttribs;r++)this.gl.disableVertexAttribArray(r)},e.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},e}();n.default=h},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./extractUniformsFromSrc"),s=l(i),o=e("../../../utils"),u=e("../../../const"),a=e("../../../settings"),f=l(a),h={},p=function(){function e(t,n,r){c(this,e),this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=n||e.defaultFragmentSrc,this._blendMode=u.BLEND_MODES.NORMAL,this.uniformData=r||(0,s.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var i in this.uniformData)this.uniforms[i]=this.uniformData[i].value,this.uniformData[i].type&&(this.uniformData[i].type=this.uniformData[i].type.toLowerCase());this.glShaders={},h[this.vertexSrc+this.fragmentSrc]||(h[this.vertexSrc+this.fragmentSrc]=(0,o.uid)()),this.glShaderKey=h[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=f.default.RESOLUTION,this.enabled=!0,this.autoFit=!0}return e.prototype.apply=function(t,n,r,i,s){t.applyFilter(this,n,r,i)},r(e,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),e}();n.default=p},{"../../../const":46,"../../../settings":101,"../../../utils":124,"./extractUniformsFromSrc":87}],87:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function u(e,t,n){var r=a(e,n),i=a(t,n);return Object.assign(r,i)}function a(e){var t=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),n={},r=void 0,i=e.replace(/\s+/g," ").split(/\s*;\s*/);for(var s=0;s<i.length;s++){var u=i[s].trim();if(u.indexOf("uniform")>-1){var a=u.split(" "),f=a[1],l=a[2],c=1;l.indexOf("[")>-1&&(r=l.split(/\[|]/),l=r[0],c*=Number(r[1])),l.match(t)||(n[l]={value:o(f,c),name:l,type:f})}}return n}n.__esModule=!0,n.default=u;var r=e("pixi-gl-core"),i=s(r),o=i.default.shader.defaultValue},{"pixi-gl-core":12}],88:[function(e,t,n){"use strict";function i(e,t,n){var r=e.identity();return r.translate(t.x/n.width,t.y/n.height),r.scale(n.width,n.height),r}function s(e,t,n){var r=e.identity();r.translate(t.x/n.width,t.y/n.height);var i=n.width/t.width,s=n.height/t.height;return r.scale(i,s),r}function o(e,t,n,i){var s=i._texture.baseTexture,o=e.set(n.width,0,0,n.height,t.x,t.y),u=i.worldTransform.copy(r.Matrix.TEMP_MATRIX);return u.invert(),o.prepend(u),o.scale(1/s.width,1/s.height),o.translate(i.anchor.x,i.anchor.y),o}n.__esModule=!0,n.calculateScreenSpaceMatrix=i,n.calculateNormalizedScreenSpaceMatrix=s,n.calculateSpriteMatrix=o;var r=e("../../../math")},{"../../../math":70}],89:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../Filter"),i=u(r),s=e("../../../../math"),o=e("path"),c=function(e){function t(n){a(this,t);var r=new s.Matrix,i=f(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return n.renderable=!1,i.maskSprite=n,i.maskMatrix=r,i}return l(t,e),t.prototype.apply=function(t,n,r){var i=this.maskSprite;this.uniforms.mask=i._texture,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i),this.uniforms.alpha=i.worldAlpha,t.applyFilter(this,n,r)},t}(i.default);n.default=c},{"../../../../math":70,"../Filter":86,path:23}],90:[function(e,t,n){"use strict";function m(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function g(e){return e&&e.__esModule?e:{"default":e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function b(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("./WebGLManager"),i=g(r),s=e("../utils/RenderTarget"),o=g(s),u=e("../utils/Quad"),a=g(u),f=e("../../../math"),l=e("../../../Shader"),c=g(l),h=e("../filters/filterTransforms"),p=m(h),d=e("bit-twiddle"),v=g(d),E=function x(){w(this,x),this.renderTarget=null,this.sourceFrame=new f.Rectangle,this.destinationFrame=new f.Rectangle,this.filters=[],this.target=null,this.resolution=1},S=function(e){function t(n){w(this,t);var r=y(this,e.call(this,n));return r.gl=r.renderer.gl,r.quad=new a.default(r.gl,n.state.attribState),r.shaderCache={},r.pool={},r.filterData=null,r.managedFilters=[],r}return b(t,e),t.prototype.pushFilter=function(t,n){var r=this.renderer,i=this.filterData;if(!i){i=this.renderer._activeRenderTarget.filterStack;var s=new E;s.sourceFrame=s.destinationFrame=this.renderer._activeRenderTarget.size,s.renderTarget=r._activeRenderTarget,this.renderer._activeRenderTarget.filterData=i={index:0,stack:[s]},this.filterData=i}var o=i.stack[++i.index];o||(o=i.stack[i.index]=new E);var u=n[0].resolution,a=n[0].padding|0,f=t.filterArea||t.getBounds(!0),l=o.sourceFrame,c=o.destinationFrame;l.x=(f.x*u|0)/u,l.y=(f.y*u|0)/u,l.width=(f.width*u|0)/u,l.height=(f.height*u|0)/u,i.stack[0].renderTarget.transform||n[0].autoFit&&l.fit(i.stack[0].destinationFrame),l.pad(a),c.width=l.width,c.height=l.height;var h=this.getPotRenderTarget(r.gl,l.width,l.height,u);o.target=t,o.filters=n,o.resolution=u,o.renderTarget=h,h.setFrame(c,l),r.bindRenderTarget(h),h.clear()},t.prototype.popFilter=function(){var t=this.filterData,n=t.stack[t.index-1],r=t.stack[t.index];this.quad.map(r.renderTarget.size,r.sourceFrame).upload();var i=r.filters;if(i.length===1)i[0].apply(this,r.renderTarget,n.renderTarget,!1,r),this.freePotRenderTarget(r.renderTarget);else{var s=r.renderTarget,o=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,r.resolution);o.setFrame(r.destinationFrame,r.sourceFrame),o.clear();var u=0;for(u=0;u<i.length-1;++u){i[u].apply(this,s,o,!0,r);var a=s;s=o,o=a}i[u].apply(this,s,n.renderTarget,!1,r),this.freePotRenderTarget(s),this.freePotRenderTarget(o)}t.index--,t.index===0&&(this.filterData=null)},t.prototype.applyFilter=function(t,n,r,i){var s=this.renderer,o=s.gl,u=t.glShaders[s.CONTEXT_UID];u||(t.glShaderKey?(u=this.shaderCache[t.glShaderKey],u||(u=new c.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[s.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=u)):u=t.glShaders[s.CONTEXT_UID]=new c.default(this.gl,t.vertexSrc,t.fragmentSrc),this.managedFilters.push(t),s.bindVao(null),this.quad.initVao(u)),s.bindVao(this.quad.vao),s.bindRenderTarget(r),i&&(o.disable(o.SCISSOR_TEST),s.clear(),o.enable(o.SCISSOR_TEST)),r===s.maskManager.scissorRenderTarget&&s.maskManager.pushScissorMask(null,s.maskManager.scissorData),s.bindShader(u);var a=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=a,this.syncUniforms(u,t),s.state.setBlendMode(t.blendMode),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),o.bindTexture(o.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)},t.prototype.syncUniforms=function(t,n){var r=n.uniformData,i=n.uniforms,s=1,o=void 0;if(t.uniforms.filterArea){o=this.filterData.stack[this.filterData.index];var u=t.uniforms.filterArea;u[0]=o.renderTarget.size.width,u[1]=o.renderTarget.size.height,u[2]=o.sourceFrame.x,u[3]=o.sourceFrame.y,t.uniforms.filterArea=u}if(t.uniforms.filterClamp){o=o||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(o.sourceFrame.width-1)/o.renderTarget.size.width,a[3]=(o.sourceFrame.height-1)/o.renderTarget.size.height,t.uniforms.filterClamp=a}for(var f in r){var l=r[f].type;if(l==="sampler2d"&&i[f]!==0){if(i[f].baseTexture)t.uniforms[f]=this.renderer.bindTexture(i[f].baseTexture,s);else{t.uniforms[f]=s;var c=this.renderer.gl;this.renderer.boundTextures[s]=this.renderer.emptyTextures[s],c.activeTexture(c.TEXTURE0+s),i[f].texture.bind()}s++}else if(l==="mat3")i[f].a!==undefined?t.uniforms[f]=i[f].toArray(!0):t.uniforms[f]=i[f];else if(l==="vec2")if(i[f].x!==undefined){var h=t.uniforms[f]||new Float32Array(2);h[0]=i[f].x,h[1]=i[f].y,t.uniforms[f]=h}else t.uniforms[f]=i[f];else l==="float"?t.uniforms.data[f].value!==r[f]&&(t.uniforms[f]=i[f]):t.uniforms[f]=i[f]}},t.prototype.getRenderTarget=function(t,n){var r=this.filterData.stack[this.filterData.index],i=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,n||r.resolution);return i.setFrame(r.destinationFrame,r.sourceFrame),i},t.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},t.prototype.calculateScreenSpaceMatrix=function(t){var n=this.filterData.stack[this.filterData.index];return p.calculateScreenSpaceMatrix(t,n.sourceFrame,n.renderTarget.size)},t.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var n=this.filterData.stack[this.filterData.index];return p.calculateNormalizedScreenSpaceMatrix(t,n.sourceFrame,n.renderTarget.size,n.destinationFrame)},t.prototype.calculateSpriteMatrix=function(t,n){var r=this.filterData.stack[this.filterData.index];return p.calculateSpriteMatrix(t,r.sourceFrame,r.renderTarget.size,n)},t.prototype.destroy=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.renderer,r=this.managedFilters;for(var i=0;i<r.length;i++)t||r[i].glShaders[n.CONTEXT_UID].destroy(),delete r[i].glShaders[n.CONTEXT_UID];this.shaderCache={},t?this.pool={}:this.emptyPool()},t.prototype.getPotRenderTarget=function(t,n,r,i){n=v.default.nextPow2(n*i),r=v.default.nextPow2(r*i);var s=(n&65535)<<16|r&65535;this.pool[s]||(this.pool[s]=[]);var u=this.pool[s].pop();if(!u){var a=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),u=new o.default(t,n,r,null,1),t.bindTexture(t.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)}return u.resolution=i,u.defaultFrame.width=u.size.width=n/i,u.defaultFrame.height=u.size.height=r/i,u},t.prototype.emptyPool=function(){for(var t in this.pool){var n=this.pool[t];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.pool={}},t.prototype.freePotRenderTarget=function(t){var n=t.size.width*t.resolution,r=t.size.height*t.resolution,i=(n&65535)<<16|r&65535;this.pool[i].push(t)},t}(i.default);n.default=S},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./WebGLManager"),i=u(r),s=e("../filters/spriteMask/SpriteMaskFilter"),o=u(s),c=function(e){function t(n){a(this,t);var r=f(this,e.call(this,n));return r.scissor=!1,r.scissorData=null,r.scissorRenderTarget=null,r.enableScissor=!0,r.alphaMaskPool=[],r.alphaMaskIndex=0,r}return l(t,e),t.prototype.pushMask=function(t,n){if(n.texture)this.pushSpriteMask(t,n);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&n.isFastRect()){var r=n.worldTransform,i=Math.atan2(r.b,r.a);i=Math.round(i*(180/Math.PI)),i%90?this.pushStencilMask(n):this.pushScissorMask(t,n)}else this.pushStencilMask(n)},t.prototype.popMask=function(t,n){n.texture?this.popSpriteMask(t,n):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,n):this.popStencilMask(t,n)},t.prototype.pushSpriteMask=function(t,n){var r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new o.default(n)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=n,t.filterArea=n.getBounds(!0),this.renderer.filterManager.pushFilter(t,r),this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},t.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},t.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},t.prototype.pushScissorMask=function(t,n){n.renderable=!0;var r=this.renderer._activeRenderTarget,i=n.getBounds();i.fit(r.size),n.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var s=this.renderer.resolution;this.renderer.gl.scissor(i.x*s,(r.root?r.size.height-i.y-i.height:i.y)*s,i.width*s,i.height*s),this.scissorRenderTarget=r,this.scissorData=n,this.scissor=!0},t.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},t}(i.default);n.default=c},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./WebGLManager"),i=s(r),f=function(e){function t(n){o(this,t);var r=u(this,e.call(this,n));return r.stencilMaskStack=null,r}return a(t,e),t.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var n=this.renderer.gl;t.length===0?n.disable(n.STENCIL_TEST):n.enable(n.STENCIL_TEST)},t.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var n=this.renderer.gl,r=this.stencilMaskStack.length;r===0&&n.enable(n.STENCIL_TEST),this.stencilMaskStack.push(t),n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,r,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},t.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,n=this.stencilMaskStack.pop();this.stencilMaskStack.length===0?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(n),this._useCurrent())},t.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},t.prototype.destroy=function(){i.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},t}(i.default);n.default=f},{"./WebGLManager":93}],93:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t){r(this,e),this.renderer=t,this.renderer.on("context",this.onContextChange,this)}return e.prototype.onContextChange=function(){},e.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},e}();n.default=i},{}],94:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../managers/WebGLManager"),i=s(r),f=function(e){function t(){return o(this,t),u(this,e.apply(this,arguments))}return a(t,e),t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){},t.prototype.render=function(t){},t}(i.default);n.default=f},{"../managers/WebGLManager":93}],95:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("pixi-gl-core"),i=u(r),s=e("../../../utils/createIndicesForQuads"),o=u(s),f=function(){function e(t,n){a(this,e),this.gl=t,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var r=0;r<4;r++)this.interleaved[r*4]=this.vertices[r*2],this.interleaved[r*4+1]=this.vertices[r*2+1],this.interleaved[r*4+2]=this.uvs[r*2],this.interleaved[r*4+3]=this.uvs[r*2+1];this.indices=(0,o.default)(1),this.vertexBuffer=i.default.GLBuffer.createVertexBuffer(t,this.interleaved,t.STATIC_DRAW),this.indexBuffer=i.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.vao=new i.default.VertexArrayObject(t,n)}return e.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},e.prototype.map=function(t,n){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+n.width/t.width,this.uvs[3]=i,this.uvs[4]=r+n.width/t.width,this.uvs[5]=i+n.height/t.height,this.uvs[6]=r,this.uvs[7]=i+n.height/t.height,r=n.x,i=n.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+n.width,this.vertices[3]=i,this.vertices[4]=r+n.width,this.vertices[5]=i+n.height,this.vertices[6]=r,this.vertices[7]=i+n.height,this},e.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[t*4]=this.vertices[t*2],this.interleaved[t*4+1]=this.vertices[t*2+1],this.interleaved[t*4+2]=this.uvs[t*2],this.interleaved[t*4+3]=this.uvs[t*2+1];return this.vertexBuffer.upload(this.interleaved),this},e.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},e}();n.default=f},{"../../../utils/createIndicesForQuads":122,"pixi-gl-core":12}],96:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../../math"),i=e("../../../const"),s=e("../../../settings"),o=a(s),u=e("pixi-gl-core"),l=function(){function e(t,n,s,a,l,c){f(this,e),this.gl=t,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new r.Rectangle(0,0,1,1),this.resolution=l||o.default.RESOLUTION,this.projectionMatrix=new r.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new r.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=a!==undefined?a:o.default.SCALE_MODE,this.root=c,this.root?(this.frameBuffer=new u.GLFramebuffer(t,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=u.GLFramebuffer.createRGBA(t,100,100),this.scaleMode===i.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(n,s)}return e.prototype.clear=function(t){var n=t||this.clearColor;this.frameBuffer.clear(n[0],n[1],n[2],n[3])},e.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},e.prototype.setFrame=function(t,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=n||this.sourceFrame||this.destinationFrame},e.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},e.prototype.calculateProjection=function(t,n){var r=this.projectionMatrix;n=n||t,r.identity(),this.root?(r.a=1/t.width*2,r.d=-1/t.height*2,r.tx=-1-n.x*r.a,r.ty=1-n.y*r.d):(r.a=1/t.width*2,r.d=1/t.height*2,r.tx=-1-n.x*r.a,r.ty=-1-n.y*r.d)},e.prototype.resize=function(t,n){t|=0,n|=0;if(this.size.width===t&&this.size.height===n)return;this.size.width=t,this.size.height=n,this.defaultFrame.width=t,this.defaultFrame.height=n,this.frameBuffer.resize(t*this.resolution,n*this.resolution);var r=this.frame||this.size;this.calculateProjection(r)},e.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},e}();n.default=l},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":12}],97:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){var n=!t;if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(n){var r=document.createElement("canvas");r.width=1,r.height=1,t=i.default.createContext(r)}var s=t.createShader(t.FRAGMENT_SHADER);for(;;){var u=o.replace(/%forloop%/gi,a(e));t.shaderSource(s,u),t.compileShader(s);if(!!t.getShaderParameter(s,t.COMPILE_STATUS))break;e=e/2|0}return n&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),e}function a(e){var t="";for(var n=0;n<e;++n)n>0&&(t+="\nelse "),n<e-1&&(t+="if(test == "+n+".0){}");return t}n.__esModule=!0,n.default=u;var r=e("pixi-gl-core"),i=s(r),o=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":12}],98:[function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return t[r.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.ADD]=[e.ONE,e.DST_ALPHA],t[r.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR],t[r.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[r.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.DST_ALPHA,e.ONE,e.DST_ALPHA],t[r.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_COLOR],t}n.__esModule=!0,n.default=i;var r=e("../../../const")},{"../../../const":46}],99:[function(e,t,n){"use strict";function i(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return t[r.DRAW_MODES.POINTS]=e.POINTS,t[r.DRAW_MODES.LINES]=e.LINES,t[r.DRAW_MODES.LINE_LOOP]=e.LINE_LOOP,t[r.DRAW_MODES.LINE_STRIP]=e.LINE_STRIP,t[r.DRAW_MODES.TRIANGLES]=e.TRIANGLES,t[r.DRAW_MODES.TRIANGLE_STRIP]=e.TRIANGLE_STRIP,t[r.DRAW_MODES.TRIANGLE_FAN]=e.TRIANGLE_FAN,t}n.__esModule=!0,n.default=i;var r=e("../../../const")},{"../../../const":46}],100:[function(e,t,n){"use strict";function r(e){var t=e.getContextAttributes();t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}n.__esModule=!0,n.default=r},{}],101:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./utils/maxRecommendedTextures"),i=u(r),s=e("./utils/canUploadSameBuffer"),o=u(s);n.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,i.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,o.default)()}},{"./utils/canUploadSameBuffer":121,"./utils/maxRecommendedTextures":126}],102:[function(e,t,n){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../math"),s=e("../utils"),o=e("../const"),u=e("../textures/Texture"),a=c(u),f=e("../display/Container"),l=c(f),v=new i.Point,m=function(e){function t(n){h(this,t);var r=p(this,e.call(this));return r._anchor=new i.ObservablePoint(r._onAnchorUpdate,r),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=o.BLEND_MODES.NORMAL,r.shader=null,r.cachedTint=16777215,r.texture=n||a.default.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.pluginName="sprite",r}return d(t,e),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,s.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,s.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){if(this._transformID===this.transform._worldID&&this._textureID===this._texture._updateID)return;this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,n=this.transform.worldTransform,r=n.a,i=n.b,s=n.c,o=n.d,u=n.tx,a=n.ty,f=this.vertexData,l=t.trim,c=t.orig,h=this._anchor,p=0,d=0,v=0,m=0;l?(d=l.x-h._x*c.width,p=d+l.width,m=l.y-h._y*c.height,v=m+l.height):(d=-h._x*c.width,p=d+c.width,m=-h._y*c.height,v=m+c.height),f[0]=r*d+s*m+u,f[1]=o*m+i*d+a,f[2]=r*p+s*m+u,f[3]=o*m+i*p+a,f[4]=r*p+s*v+u,f[5]=o*v+i*p+a,f[6]=r*d+s*v+u,f[7]=o*v+i*d+a},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,n=this.vertexTrimmedData,r=t.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,u=s.b,a=s.c,f=s.d,l=s.tx,c=s.ty,h=-i._x*r.width,p=h+r.width,d=-i._y*r.height,v=d+r.height;n[0]=o*h+a*d+l,n[1]=f*d+u*h+c,n[2]=o*p+a*d+l,n[3]=f*d+u*p+c,n[4]=o*p+a*v+l,n[5]=f*v+u*p+c,n[6]=o*h+a*v+l,n[7]=f*v+u*h+c},t.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var t=this._texture.trim,n=this._texture.orig;!t||t.width===n.width&&t.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(n){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),n||(this._localBoundsRect||(this._localBoundsRect=new i.Rectangle),n=this._localBoundsRect),this._bounds.getRectangle(n)):e.prototype.getLocalBounds.call(this,n)},t.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,v);var n=this._texture.orig.width,r=this._texture.orig.height,i=-n*this.anchor.x,s=0;if(v.x>=i&&v.x<i+n){s=-r*this.anchor.y;if(v.y>=s&&v.y<s+r)return!0}return!1},t.prototype.destroy=function(n){e.prototype.destroy.call(this,n),this._anchor=null;var r=typeof n=="boolean"?n:n&&n.texture;if(r){var i=typeof n=="boolean"?n:n&&n.baseTexture;this._texture.destroy(!!i)}this._texture=null,this.shader=null},t.from=function(n){return new t(a.default.from(n))},t.fromFrame=function(n){var r=s.TextureCache[n];if(!r)throw new Error('The frameId "'+n+'" does not exist in the texture cache');return new t(r)},t.fromImage=function(n,r,i){return new t(a.default.fromImage(n,r,i))},r(t,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var n=(0,s.sign)(this.scale.x)||1;this.scale.x=n*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var n=(0,s.sign)(this.scale.y)||1;this.scale.y=n*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){if(this._texture===t)return;this._texture=t,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this))}}]),t}(l.default);n.default=m},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":124}],103:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../renderers/canvas/CanvasRenderer"),i=f(r),s=e("../../const"),o=e("../../math"),u=e("./CanvasTinter"),a=f(u),c=new o.Matrix,h=function(){function e(t){l(this,e),this.renderer=t}return e.prototype.render=function(t){var n=t._texture,r=this.renderer,i=n._frame.width,u=n._frame.height,f=t.transform.worldTransform,l=0,h=0;if(n.orig.width<=0||n.orig.height<=0||!n.baseTexture.source)return;r.setBlendMode(t.blendMode);if(n.valid){r.context.globalAlpha=t.worldAlpha;var p=n.baseTexture.scaleMode===s.SCALE_MODES.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==p&&(r.context[r.smoothProperty]=p),n.trim?(l=n.trim.width/2+n.trim.x-t.anchor.x*n.orig.width,h=n.trim.height/2+n.trim.y-t.anchor.y*n.orig.height):(l=(.5-t.anchor.x)*n.orig.width,h=(.5-t.anchor.y)*n.orig.height),n.rotate&&(f.copy(c),f=c,o.GroupD8.matrixAppendRotationInv(f,n.rotate,l,h),l=0,h=0),l-=i/2,h-=u/2,r.roundPixels?(r.context.setTransform(f.a,f.b,f.c,f.d,f.tx*r.resolution|0,f.ty*r.resolution|0),l|=0,h|=0):r.context.setTransform(f.a,f.b,f.c,f.d,f.tx*r.resolution,f.ty*r.resolution);var d=n.baseTexture.resolution;if(t.tint!==16777215){if(t.cachedTint!==t.tint||t.tintedTexture.tintId!==t._texture._updateID)t.cachedTint=t.tint,t.tintedTexture=a.default.getTintedTexture(t,t.tint);r.context.drawImage(t.tintedTexture,0,0,i*d,u*d,l*r.resolution,h*r.resolution,i*r.resolution,u*r.resolution)}else r.context.drawImage(n.baseTexture.source,n._frame.x*d,n._frame.y*d,i*d,u*d,l*r.resolution,h*r.resolution,i*r.resolution,u*r.resolution)}},e.prototype.destroy=function(){this.renderer=null},e}();n.default=h,i.default.registerPlugin("sprite",h)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("../../utils"),i=e("../../renderers/canvas/utils/canUseNewCanvasBlendModes"),s=o(i),u={getTintedTexture:function(t,n){var r=t._texture;n=u.roundColor(n);var i="#"+("00000"+(n|0).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var s=r.tintCache[i],o=void 0;if(s){if(s.tintId===r._updateID)return r.tintCache[i];o=r.tintCache[i]}else o=u.canvas||document.createElement("canvas");u.tintMethod(r,n,o),o.tintId=r._updateID;if(u.convertTintToImage){var a=new Image;a.src=o.toDataURL(),r.tintCache[i]=a}else r.tintCache[i]=o,u.canvas=null;return o},tintWithMultiply:function(t,n,r){var i=r.getContext("2d"),s=t._frame.clone(),o=t.baseTexture.resolution;s.x*=o,s.y*=o,s.width*=o,s.height*=o,r.width=Math.ceil(s.width),r.height=Math.ceil(s.height),i.save(),i.fillStyle="#"+("00000"+(n|0).toString(16)).substr(-6),i.fillRect(0,0,s.width,s.height),i.globalCompositeOperation="multiply",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height),i.restore()},tintWithOverlay:function(t,n,r){var i=r.getContext("2d"),s=t._frame.clone(),o=t.baseTexture.resolution;s.x*=o,s.y*=o,s.width*=o,s.height*=o,r.width=Math.ceil(s.width),r.height=Math.ceil(s.height),i.save(),i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(n|0).toString(16)).substr(-6),i.fillRect(0,0,s.width,s.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height),i.restore()},tintWithPerPixel:function(t,n,i){var s=i.getContext("2d"),o=t._frame.clone(),u=t.baseTexture.resolution;o.x*=u,o.y*=u,o.width*=u,o.height*=u,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),s.save(),s.globalCompositeOperation="copy",s.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),s.restore();var a=(0,r.hex2rgb)(n),f=a[0],l=a[1],c=a[2],h=s.getImageData(0,0,o.width,o.height),p=h.data;for(var d=0;d<p.length;d+=4)p[d+0]*=f,p[d+1]*=l,p[d+2]*=c;s.putImageData(h,0,0)},roundColor:function(t){var n=u.cacheStepsPerColorChannel,i=(0,r.hex2rgb)(t);return i[0]=Math.min(255,i[0]/n*n),i[1]=Math.min(255,i[1]/n*n),i[2]=Math.min(255,i[2]/n*n),(0,r.rgb2hex)(i)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,s.default)(),tintMethod:0};u.tintMethod=u.canUseMultiply?u.tintWithMultiply:u.tintWithPerPixel,n.default=u},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":124}],105:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t){r(this,e),this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return e.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},e}();n.default=i},{}],106:[function(e,t,n){"use strict";function S(e){return e&&e.__esModule?e:{"default":e}}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function N(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../renderers/webgl/utils/ObjectRenderer"),i=S(r),s=e("../../renderers/webgl/WebGLRenderer"),o=S(s),u=e("../../utils/createIndicesForQuads"),a=S(u),f=e("./generateMultiTextureShader"),l=S(f),c=e("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),h=S(c),p=e("./BatchBuffer"),d=S(p),v=e("../../settings"),m=S(v),g=e("../../utils"),y=e("pixi-gl-core"),b=S(y),w=e("bit-twiddle"),E=S(w),C=0,k=0,L=function(e){function t(n){x(this,t);var r=T(this,e.call(this,n));r.vertSize=5,r.vertByteSize=r.vertSize*4,r.size=m.default.SPRITE_BATCH_SIZE,r.buffers=[];for(var i=1;i<=E.default.nextPow2(r.size);i*=2)r.buffers.push(new d.default(i*4*r.vertByteSize));r.indices=(0,a.default)(r.size),r.shader=null,r.currentIndex=0,r.groups=[];for(var s=0;s<r.size;s++)r.groups[s]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return r.sprites=[],r.vertexBuffers=[],r.vaos=[],r.vaoMax=2,r.vertexCount=0,r.renderer.on("prerender",r.onPrerender,r),r}return N(t,e),t.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),m.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,h.default)(this.MAX_TEXTURES,t)),this.shader=(0,l.default)(t,this.MAX_TEXTURES),this.indexBuffer=b.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);var n=this.shader.attributes;for(var r=0;r<this.vaoMax;r++){var i=this.vertexBuffers[r]=b.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),s=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(i,n.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(i,n.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(i,n.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);n.aTextureId&&s.addAttribute(i,n.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[r]=s}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},t.prototype.onPrerender=function(){this.vertexCount=0},t.prototype.render=function(t){this.currentIndex>=this.size&&this.flush();if(!t._texture._uvs)return;this.sprites[this.currentIndex++]=t},t.prototype.flush=function(){if(this.currentIndex===0)return;var t=this.renderer.gl,n=this.MAX_TEXTURES,r=E.default.nextPow2(this.currentIndex),i=E.default.log2(r),s=this.buffers[i],o=this.sprites,u=this.groups,a=s.float32View,f=s.uint32View,l=this.boundTextures,c=this.renderer.boundTextures,h=this.renderer.textureGC.count,p=0,d=void 0,v=void 0,y=1,w=0,S=u[0],x=void 0,T=void 0,N=g.premultiplyBlendMode[o[0]._texture.baseTexture.premultipliedAlpha?1:0][o[0].blendMode];S.textureCount=0,S.start=0,S.blend=N,C++;var L=void 0;for(L=0;L<n;++L)l[L]=c[L],l[L]._virtalBoundId=L;for(L=0;L<this.currentIndex;++L){var A=o[L];d=A._texture.baseTexture;var O=g.premultiplyBlendMode[Number(d.premultipliedAlpha)][A.blendMode];N!==O&&(N=O,v=null,w=n,C++);if(v!==d){v=d;if(d._enabled!==C){w===n&&(C++,S.size=L-S.start,w=0,S=u[y++],S.blend=N,S.textureCount=0,S.start=L),d.touched=h;if(d._virtalBoundId===-1)for(var M=0;M<n;++M){var _=(M+k)%n,D=l[_];if(D._enabled!==C){k++,D._virtalBoundId=-1,d._virtalBoundId=_,l[_]=d;break}}d._enabled=C,S.textureCount++,S.ids[w]=d._virtalBoundId,S.textures[w++]=d}}x=A.vertexData,T=A._texture._uvs.uvsUint32;if(this.renderer.roundPixels){var P=this.renderer.resolution;a[p]=(x[0]*P|0)/P,a[p+1]=(x[1]*P|0)/P,a[p+5]=(x[2]*P|0)/P,a[p+6]=(x[3]*P|0)/P,a[p+10]=(x[4]*P|0)/P,a[p+11]=(x[5]*P|0)/P,a[p+15]=(x[6]*P|0)/P,a[p+16]=(x[7]*P|0)/P}else a[p]=x[0],a[p+1]=x[1],a[p+5]=x[2],a[p+6]=x[3],a[p+10]=x[4],a[p+11]=x[5],a[p+15]=x[6],a[p+16]=x[7];f[p+2]=T[0],f[p+7]=T[1],f[p+12]=T[2],f[p+17]=T[3];var H=Math.min(A.worldAlpha,1),B=H<1&&d.premultipliedAlpha?(0,g.premultiplyTint)(A._tintRGB,H):A._tintRGB+(H*255<<24);f[p+3]=f[p+8]=f[p+13]=f[p+18]=B,a[p+4]=a[p+9]=a[p+14]=a[p+19]=d._virtalBoundId,p+=20}S.size=L-S.start;if(!m.default.CAN_UPLOAD_SAME_BUFFER){if(this.vaoMax<=this.vertexCount){this.vaoMax++;var j=this.shader.attributes,F=this.vertexBuffers[this.vertexCount]=b.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),I=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(F,j.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(F,j.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(F,j.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);j.aTextureId&&I.addAttribute(F,j.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=I}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(s.vertices,0,!1),this.vertexCount++}else this.vertexBuffers[this.vertexCount].upload(s.vertices,0,!0);for(L=0;L<n;++L)c[L]._virtalBoundId=-1;for(L=0;L<y;++L){var q=u[L],R=q.textureCount;for(var U=0;U<R;U++)v=q.textures[U],c[q.ids[U]]!==v&&this.renderer.bindTexture(v,q.ids[U],!0),v._virtalBoundId=-1;this.renderer.state.setBlendMode(q.blend),t.drawElements(t.TRIANGLES,q.size*6,t.UNSIGNED_SHORT,q.start*6*2)}this.currentIndex=0},t.prototype.start=function(){this.renderer.bindShader(this.shader),m.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var n=0;n<this.vaoMax;n++)this.vertexBuffers[n]&&this.vertexBuffers[n].destroy(),this.vaos[n]&&this.vaos[n].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var r=0;r<this.buffers.length;++r)this.buffers[r].destroy()},t}(i.default);n.default=L,o.default.registerPlugin("sprite",L)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":124,"../../utils/createIndicesForQuads":122,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":12}],107:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",r=u;r=r.replace(/%count%/gi,t),r=r.replace(/%forloop%/gi,f(t));var s=new i.default(e,n,r),o=[];for(var a=0;a<t;a++)o[a]=a;return s.bind(),s.uniforms.uSamplers=o,s}function f(e){var t="";t+="\n",t+="\n";for(var n=0;n<e;n++)n>0&&(t+="\nelse "),n<e-1&&(t+="if(textureId == "+n+".0)"),t+="\n{",t+="\n	color = texture2D(uSamplers["+n+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n",t}n.__esModule=!0,n.default=a;var r=e("../../Shader"),i=o(r),s=e("path"),u=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n")},{"../../Shader":44,path:23}],108:[function(e,t,n){"use strict";function b(e){return e&&e.__esModule?e:{"default":e}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function S(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../sprites/Sprite"),s=b(i),o=e("../textures/Texture"),u=b(o),a=e("../math"),f=e("../utils"),l=e("../const"),c=e("../settings"),h=b(c),p=e("./TextStyle"),d=b(p),v=e("./TextMetrics"),m=b(v),g=e("../utils/trimCanvas"),y=b(g),x={texture:!0,children:!1,baseTexture:!0},T=function(e){function t(n,r,i){w(this,t),i=i||document.createElement("canvas"),i.width=3,i.height=3;var s=u.default.fromCanvas(i,h.default.SCALE_MODE,"text");s.orig=new a.Rectangle,s.trim=new a.Rectangle;var o=E(this,e.call(this,s));return u.default.addToCache(o._texture,o._texture.baseTexture.textureCacheIds[0]),o.canvas=i,o.context=o.canvas.getContext("2d"),o.resolution=h.default.RESOLUTION,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=n,o.style=r,o.localStyleID=-1,o}return S(t,e),t.prototype.updateText=function(t){var n=this._style;this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID);if(!this.dirty&&t)return;this._font=this._style.toFontString();var r=this.context,i=m.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,u=i.lines,a=i.lineHeight,f=i.lineWidths,l=i.maxLineWidth,c=i.fontProperties;this.canvas.width=Math.ceil((s+n.padding*2)*this.resolution),this.canvas.height=Math.ceil((o+n.padding*2)*this.resolution),r.scale(this.resolution,this.resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.strokeStyle=n.stroke,r.lineWidth=n.strokeThickness,r.textBaseline=n.textBaseline,r.lineJoin=n.lineJoin,r.miterLimit=n.miterLimit;var h=void 0,p=void 0;if(n.dropShadow){r.fillStyle=n.dropShadowColor,r.globalAlpha=n.dropShadowAlpha,r.shadowBlur=n.dropShadowBlur,n.dropShadowBlur>0&&(r.shadowColor=n.dropShadowColor);var d=Math.cos(n.dropShadowAngle)*n.dropShadowDistance,v=Math.sin(n.dropShadowAngle)*n.dropShadowDistance;for(var g=0;g<u.length;g++)h=n.strokeThickness/2,p=n.strokeThickness/2+g*a+c.ascent,n.align==="right"?h+=l-f[g]:n.align==="center"&&(h+=(l-f[g])/2),n.fill&&(this.drawLetterSpacing(u[g],h+d+n.padding,p+v+n.padding),n.stroke&&n.strokeThickness&&(r.strokeStyle=n.dropShadowColor,this.drawLetterSpacing(u[g],h+d+n.padding,p+v+n.padding,!0),r.strokeStyle=n.stroke))}r.shadowBlur=0,r.globalAlpha=1,r.fillStyle=this._generateFillStyle(n,u);for(var y=0;y<u.length;y++)h=n.strokeThickness/2,p=n.strokeThickness/2+y*a+c.ascent,n.align==="right"?h+=l-f[y]:n.align==="center"&&(h+=(l-f[y])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[y],h+n.padding,p+n.padding,!0),n.fill&&this.drawLetterSpacing(u[y],h+n.padding,p+n.padding);this.updateTexture()},t.prototype.drawLetterSpacing=function(t,n,r){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,s=this._style,o=s.letterSpacing;if(o===0){i?this.context.strokeText(t,n,r):this.context.fillText(t,n,r);return}var u=String.prototype.split.call(t,""),a=n,f=0,l="";while(f<t.length)l=u[f++],i?this.context.strokeText(l,a,r):this.context.fillText(l,a,r),a+=this.context.measureText(l).width+o},t.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var n=(0,y.default)(t);t.width=n.width,t.height=n.height,this.context.putImageData(n.data,0,0)}var r=this._texture,i=this._style,s=i.trim?0:i.padding,o=r.baseTexture;o.hasLoaded=!0,o.resolution=this.resolution,o.realWidth=t.width,o.realHeight=t.height,o.width=t.width/this.resolution,o.height=t.height/this.resolution,r.trim.width=r._frame.width=t.width/this.resolution,r.trim.height=r._frame.height=t.height/this.resolution,r.trim.x=-s,r.trim.y=-s,r.orig.width=r._frame.width-s*2,r.orig.height=r._frame.height-s*2,this._onTextureUpdate(),o.emit("update",o),this.dirty=!1},t.prototype.renderWebGL=function(n){this.resolution!==n.resolution&&(this.resolution=n.resolution,this.dirty=!0),this.updateText(!0),e.prototype.renderWebGL.call(this,n)},t.prototype._renderCanvas=function(n){this.resolution!==n.resolution&&(this.resolution=n.resolution,this.dirty=!0),this.updateText(!0),e.prototype._renderCanvas.call(this,n)},t.prototype.getLocalBounds=function(n){return this.updateText(!0),e.prototype.getLocalBounds.call(this,n)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._onStyleChange=function(){this.dirty=!0},t.prototype._generateFillStyle=function(t,n){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var r=void 0,i=void 0,s=void 0,o=void 0,u=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,f=t.fill.slice(),c=t.fillGradientStops.slice();if(!c.length){var h=f.length+1;for(var p=1;p<h;++p)c.push(p/h)}f.unshift(t.fill[0]),c.unshift(0),f.push(t.fill[t.fill.length-1]),c.push(1);if(t.fillGradientType===l.TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(u/2,0,u/2,a),i=(f.length+1)*n.length,s=0;for(var d=0;d<n.length;d++){s+=1;for(var v=0;v<f.length;v++)typeof c[v]=="number"?o=c[v]/n.length+d/n.length:o=s/i,r.addColorStop(o,f[v]),s++}}else{r=this.context.createLinearGradient(0,a/2,u,a/2),i=f.length+1,s=1;for(var m=0;m<f.length;m++)typeof c[m]=="number"?o=c[m]:o=s/i,r.addColorStop(o,f[m]),s++}return r},t.prototype.destroy=function(n){typeof n=="boolean"&&(n={children:n}),n=Object.assign({},x,n),e.prototype.destroy.call(this,n),this.context=null,this.canvas=null,this._style=null},r(t,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var n=(0,f.sign)(this.scale.x)||1;this.scale.x=n*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var n=(0,f.sign)(this.scale.y)||1;this.scale.y=n*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){t=t||{},t instanceof d.default?this._style=t:this._style=new d.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(t===""||t===null||t===undefined?" ":t);if(this._text===t)return;this._text=t,this.dirty=!0}}]),t}(s.default);n.default=T},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":124,"../utils/trimCanvas":129,"./TextMetrics":109,"./TextStyle":110}],109:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t,n,i,s,o,u,a,f,l){r(this,e),this.text=t,this.style=n,this.width=i,this.height=s,this.lines=o,this.lineWidths=u,this.lineHeight=a,this.maxLineWidth=f,this.fontProperties=l}return e.measureText=function(n,r,i){var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:e._canvas;i=i||r.wordWrap;var o=r.toFontString(),u=e.measureFont(o),a=s.getContext("2d");a.font=o;var f=i?e.wordWrap(n,r,s):n,l=f.split(/(?:\r\n|\r|\n)/),c=new Array(l.length),h=0;for(var p=0;p<l.length;p++){var d=a.measureText(l[p]).width+(l[p].length-1)*r.letterSpacing;c[p]=d,h=Math.max(h,d)}var v=h+r.strokeThickness;r.dropShadow&&(v+=r.dropShadowDistance);var m=r.lineHeight||u.fontSize+r.strokeThickness,g=Math.max(m,u.fontSize+r.strokeThickness)+(l.length-1)*(m+r.leading);return r.dropShadow&&(g+=r.dropShadowDistance),new e(n,r,v,g,l,c,m+r.leading,h,u)},e.wordWrap=function(n,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:e._canvas,s=i.getContext("2d"),o="",u=n.split("\n"),a=r.wordWrapWidth,f={};for(var l=0;l<u.length;l++){var c=a,h=u[l].split(" ");for(var p=0;p<h.length;p++){var d=s.measureText(h[p]).width;if(r.breakWords&&d>a){var v=h[p].split("");for(var m=0;m<v.length;m++){var g=v[m],y=f[g];y===undefined&&(y=s.measureText(g).width,f[g]=y),y>c?(o+="\n"+g,c=a-y):(m===0&&(o+=" "),o+=g,c-=y)}}else{var b=d+s.measureText(" ").width;p===0||b>c?(p>0&&(o+="\n"),o+=h[p],c=a-d):(c-=b,o+=" "+h[p])}}l<u.length-1&&(o+="\n")}return o},e.measureFont=function(n){if(e._fonts[n])return e._fonts[n];var r={},i=e._canvas,s=e._context;s.font=n;var o=Math.ceil(s.measureText("|MÃâ°q").width),u=Math.ceil(s.measureText("M").width),a=2*u;u=u*1.4|0,i.width=o,i.height=a,s.fillStyle="#f00",s.fillRect(0,0,o,a),s.font=n,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText("|MÃâ°q",0,u);var f=s.getImageData(0,0,o,a).data,l=f.length,c=o*4,h=0,p=0,d=!1;for(h=0;h<u;++h){for(var v=0;v<c;v+=4)if(f[p+v]!==255){d=!0;break}if(!!d)break;p+=c}r.ascent=u-h,p=l-c,d=!1;for(h=a;h>u;--h){for(var m=0;m<c;m+=4)if(f[p+m]!==255){d=!0;break}if(!!d)break;p-=c}return r.descent=h-u,r.fontSize=r.ascent+r.descent,e._fonts[n]=r,r},e}();n.default=i;var s=document.createElement("canvas");s.width=s.height=10,i._canvas=s,i._context=s.getContext("2d"),i._fonts={}},{}],110:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e){return typeof e=="number"?(0,s.hex2string)(e):(typeof e=="string"&&e.indexOf("0x")===0&&(e=e.replace("0x","#")),e)}function l(e){if(!Array.isArray(e))return f(e);for(var t=0;t<e.length;++t)e[t]=f(e[t]);return e}function c(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../const"),s=e("../utils"),u={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:i.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,wordWrap:!1,wordWrapWidth:100,leading:0},a=function(){function e(t){o(this,e),this.styleID=0,Object.assign(this,u,t)}return e.prototype.clone=function(){var n={};for(var r in u)n[r]=this[r];return new e(n)},e.prototype.reset=function(){Object.assign(this,u)},e.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,n=this.fontFamily;Array.isArray(this.fontFamily)||(n=this.fontFamily.split(","));for(var r=n.length-1;r>=0;r--){var i=n[r].trim();/([\"\'])[^\'\"]+\1/.test(i)||(i='"'+i+'"'),n[r]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+n.join(",")},r(e,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var n=l(t);this._dropShadowColor!==n&&(this._dropShadowColor=n,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var n=l(t);this._fill!==n&&(this._fill=n,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){c(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var n=l(t);this._stroke!==n&&(this._stroke=n,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),e}();n.default=a},{"../const":46,"../utils":124}],111:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./BaseTexture"),i=u(r),s=e("../settings"),o=u(s),c=function(e){function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100,i=arguments[2],s=arguments[3];a(this,t);var u=f(this,e.call(this,null,i));return u.resolution=s||o.default.RESOLUTION,u.width=n,u.height=r,u.realWidth=u.width*u.resolution,u.realHeight=u.height*u.resolution,u.scaleMode=i!==undefined?i:o.default.SCALE_MODE,u.hasLoaded=!0,u._glRenderTargets={},u._canvasRenderTarget=null,u.valid=!1,u}return l(t,e),t.prototype.resize=function(t,n){if(t===this.width&&n===this.height)return;this.valid=t>0&&n>0,this.width=t,this.height=n,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution;if(!this.valid)return;this.emit("update",this)},t.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.renderer=null},t}(i.default);n.default=c},{"../settings":101,"./BaseTexture":112}],112:[function(e,t,n){"use strict";function h(e){return e&&e.__esModule?e:{"default":e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function v(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../utils"),i=e("../settings"),s=h(i),o=e("eventemitter3"),u=h(o),a=e("../utils/determineCrossOrigin"),f=h(a),l=e("bit-twiddle"),c=h(l),m=function(e){function t(n,i,o){p(this,t);var u=d(this,e.call(this));return u.uid=(0,r.uid)(),u.touched=0,u.resolution=o||s.default.RESOLUTION,u.width=100,u.height=100,u.realWidth=100,u.realHeight=100,u.scaleMode=i!==undefined?i:s.default.SCALE_MODE,u.hasLoaded=!1,u.isLoading=!1,u.source=null,u.origSource=null,u.imageType=null,u.sourceScale=1,u.premultipliedAlpha=!0,u.imageUrl=null,u.isPowerOfTwo=!1,u.mipmap=s.default.MIPMAP_TEXTURES,u.wrapMode=s.default.WRAP_MODE,u._glTextures={},u._enabled=0,u._virtalBoundId=-1,u._destroyed=!1,u.textureCacheIds=[],n&&u.loadSource(n),u}return v(t,e),t.prototype.update=function(){this.imageType!=="svg"&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},t.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=c.default.isPow2(this.realWidth)&&c.default.isPow2(this.realHeight)},t.prototype.loadSource=function(t){var n=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,n&&this.source&&(this.source.onload=null,this.source.onerror=null);var r=!this.source;this.source=t;if((t.src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),this.imageType==="svg"?this._loadSvgSource():this._sourceLoaded(),r&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var i=this;t.onload=function(){i._updateImageType(),t.onload=null,t.onerror=null;if(!i.isLoading)return;i.isLoading=!1,i._sourceLoaded();if(i.imageType==="svg"){i._loadSvgSource();return}i.emit("loaded",i)},t.onerror=function(){t.onload=null,t.onerror=null;if(!i.isLoading)return;i.isLoading=!1,i.emit("error",i)};if(t.complete&&t.src){t.onload=null,t.onerror=null;if(i.imageType==="svg"){i._loadSvgSource();return}this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),n&&this.emit("loaded",this)):n&&this.emit("error",this)}}},t.prototype._updateImageType=function(){if(!this.imageUrl)return;var t=(0,r.decomposeDataUri)(this.imageUrl),n=void 0;if(t&&t.mediaType==="image"){var i=t.subType.split("+")[0];n=(0,r.getUrlFileExtension)("."+i);if(!n)throw new Error("Invalid image type in data URI.")}else n=(0,r.getUrlFileExtension)(this.imageUrl),n||(n="png");this.imageType=n},t.prototype._loadSvgSource=function(){if(this.imageType!=="svg")return;var t=(0,r.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()},t.prototype._loadSvgSourceUsingDataUri=function(t){var n=void 0;if(t.encoding==="base64"){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");n=atob(t.data)}else n=t.data;this._loadSvgSourceUsingString(n)},t.prototype._loadSvgSourceUsingXhr=function(){var t=this,n=new XMLHttpRequest;n.onload=function(){if(n.readyState!==n.DONE||n.status!==200)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(n.response)},n.onerror=function(){return t.emit("error",t)},n.open("GET",this.imageUrl,!0),n.send()},t.prototype._loadSvgSourceUsingString=function(n){var i=(0,r.getSvgSize)(n),s=i.width,o=i.height;if(!s||!o)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(s*this.sourceScale),this.realHeight=Math.round(o*this.sourceScale),this._updateDimensions();var u=document.createElement("canvas");u.width=this.realWidth,u.height=this.realHeight,u._pixiId="canvas_"+(0,r.uid)(),u.getContext("2d").drawImage(this.source,0,0,s,o,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=u,t.addToCache(this,u._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},t.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},t.prototype.destroy=function(){this.imageUrl&&(delete r.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},t.fromImage=function(n,i,s,o){var u=r.BaseTextureCache[n];if(!u){var a=new Image;i===undefined&&n.indexOf("data:")!==0?a.crossOrigin=(0,f.default)(n):i&&(a.crossOrigin=typeof i=="string"?i:"anonymous"),u=new t(a,s),u.imageUrl=n,o&&(u.sourceScale=o),u.resolution=(0,r.getResolutionOfUrl)(n),a.src=n,t.addToCache(u,n)}return u},t.fromCanvas=function(n,i){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"canvas";n._pixiId||(n._pixiId=s+"_"+(0,r.uid)());var o=r.BaseTextureCache[n._pixiId];return o||(o=new t(n,i),t.addToCache(o,n._pixiId)),o},t.from=function(n,i,s){if(typeof n=="string")return t.fromImage(n,undefined,i,s);if(n instanceof HTMLImageElement){var o=n.src,u=r.BaseTextureCache[o];return u||(u=new t(n,i),u.imageUrl=o,s&&(u.sourceScale=s),u.resolution=(0,r.getResolutionOfUrl)(o),t.addToCache(u,o)),u}return n instanceof HTMLCanvasElement?t.fromCanvas(n,i):n},t.addToCache=function(t,n){n&&(t.textureCacheIds.indexOf(n)===-1&&t.textureCacheIds.push(n),r.BaseTextureCache[n]&&console.warn("BaseTexture added to the cache with an id ["+n+"] that already had an entry"),r.BaseTextureCache[n]=t)},t.removeFromCache=function(t){if(typeof t=="string"){var n=r.BaseTextureCache[t];if(n){var i=n.textureCacheIds.indexOf(t);return i>-1&&n.textureCacheIds.splice(i,1),delete r.BaseTextureCache[t],n}}else if(t&&t.textureCacheIds){for(var s=0;s<t.textureCacheIds.length;++s)delete r.BaseTextureCache[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null},t}(u.default);n.default=m},{"../settings":101,"../utils":124,"../utils/determineCrossOrigin":123,"bit-twiddle":1,eventemitter3:3}],113:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./BaseRenderTexture"),i=u(r),s=e("./Texture"),o=u(s),c=function(e){function t(n,r){a(this,t);var s=null;if(!(n instanceof i.default)){var o=arguments[1],u=arguments[2],l=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+u+") instead of the ctor directly."),s=arguments[0],r=null,n=new i.default(o,u,l,c)}var h=f(this,e.call(this,n,r));return h.legacyRenderer=s,h.valid=!0,h._updateUvs(),h}return l(t,e),t.prototype.resize=function(t,n,r){this.valid=t>0&&n>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=n,r||this.baseTexture.resize(t,n),this._updateUvs()},t.create=function(n,r,s,o){return new t(new i.default(n,r,s,o))},t}(o.default);n.default=c},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../"),s=e("../utils"),u=function(){function e(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;o(this,e),this.baseTexture=t,this.textures={},this.data=n,this.resolution=this._updateResolution(r||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r(e,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),e.prototype._updateResolution=function(t){var n=this.data.meta.scale,r=(0,s.getResolutionOfUrl)(t,null);return r===null&&(r=n!==undefined?parseFloat(n):1),r!==1&&(this.baseTexture.resolution=r,this.baseTexture.update()),r},e.prototype.parse=function(n){this._batchIndex=0,this._callback=n,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},e.prototype._processFrames=function(n){var r=n,s=e.BATCH_SIZE,o=this.baseTexture.sourceScale;while(r-n<s&&r<this._frameKeys.length){var u=this._frameKeys[r],a=this._frames[u].frame;if(a){var f=null,l=null,c=new i.Rectangle(0,0,Math.floor(this._frames[u].sourceSize.w*o)/this.resolution,Math.floor(this._frames[u].sourceSize.h*o)/this.resolution);this._frames[u].rotated?f=new i.Rectangle(Math.floor(a.x*o)/this.resolution,Math.floor(a.y*o)/this.resolution,Math.floor(a.h*o)/this.resolution,Math.floor(a.w*o)/this.resolution):f=new i.Rectangle(Math.floor(a.x*o)/this.resolution,Math.floor(a.y*o)/this.resolution,Math.floor(a.w*o)/this.resolution,Math.floor(a.h*o)/this.resolution),this._frames[u].trimmed&&(l=new i.Rectangle(Math.floor(this._frames[u].spriteSourceSize.x*o)/this.resolution,Math.floor(this._frames[u].spriteSourceSize.y*o)/this.resolution,Math.floor(a.w*o)/this.resolution,Math.floor(a.h*o)/this.resolution)),this.textures[u]=new i.Texture(this.baseTexture,f,c,l,this._frames[u].rotated?2:0),i.Texture.addToCache(this.textures[u],u)}r++}},e.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},e.prototype._nextBatch=function(){var n=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(function(){n._batchIndex*e.BATCH_SIZE<n._frameKeys.length?n._nextBatch():n._parseComplete()},0)},e.prototype.destroy=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;for(var n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},e}();n.default=u},{"../":65,"../utils":124}],115:[function(e,t,n){"use strict";function m(e){return e&&e.__esModule?e:{"default":e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function b(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(){var e=document.createElement("canvas");e.width=10,e.height=10;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,10,10),new w(new s.default(e))}function S(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./BaseTexture"),s=m(i),o=e("./VideoBaseTexture"),u=m(o),a=e("./TextureUvs"),f=m(a),l=e("eventemitter3"),c=m(l),h=e("../math"),p=e("../utils"),d=e("../settings"),v=m(d),w=function(e){function t(n,r,i,s,o){g(this,t);var u=y(this,e.call(this));u.noFrame=!1,r||(u.noFrame=!0,r=new h.Rectangle(0,0,1,1)),n instanceof t&&(n=n.baseTexture),u.baseTexture=n,u._frame=r,u.trim=s,u.valid=!1,u.requiresUpdate=!1,u._uvs=null,u.orig=i||r,u._rotate=Number(o||0);if(o===!0)u._rotate=2;else if(u._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return n.hasLoaded?(u.noFrame&&(r=new h.Rectangle(0,0,n.width,n.height),n.on("update",u.onBaseTextureUpdated,u)),u.frame=r):n.once("loaded",u.onBaseTextureLoaded,u),u._updateID=0,u.transform=null,u.textureCacheIds=[],u}return b(t,e),t.prototype.update=function(){this.baseTexture.update()},t.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new h.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},t.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},t.prototype.destroy=function(n){this.baseTexture&&(n&&(p.TextureCache[this.baseTexture.imageUrl]&&t.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},t.prototype._updateUvs=function(){this._uvs||(this._uvs=new f.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.fromImage=function(n,r,i,o){var u=p.TextureCache[n];return u||(u=new t(s.default.fromImage(n,r,i,o)),t.addToCache(u,n)),u},t.fromFrame=function(t){var n=p.TextureCache[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return n},t.fromCanvas=function(n,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"canvas";return new t(s.default.fromCanvas(n,r,i))},t.fromVideo=function(n,r){return typeof n=="string"?t.fromVideoUrl(n,r):new t(u.default.fromVideo(n,r))},t.fromVideoUrl=function(n,r){return new t(u.default.fromUrl(n,r))},t.from=function(n){if(typeof n=="string"){var r=p.TextureCache[n];if(!r){var i=n.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)!==null;return i?t.fromVideoUrl(n):t.fromImage(n)}return r}return n instanceof HTMLImageElement?new t(s.default.from(n)):n instanceof HTMLCanvasElement?t.fromCanvas(n,v.default.SCALE_MODE,"HTMLCanvasElement"):n instanceof HTMLVideoElement?t.fromVideo(n):n instanceof s.default?new t(n):n},t.fromLoader=function(n,r,i){var o=new s.default(n,undefined,(0,p.getResolutionOfUrl)(r)),u=new t(o);return o.imageUrl=r,i||(i=r),s.default.addToCache(u.baseTexture,i),t.addToCache(u,i),i!==r&&(s.default.addToCache(u.baseTexture,r),t.addToCache(u,r)),u},t.addToCache=function(t,n){n&&(t.textureCacheIds.indexOf(n)===-1&&t.textureCacheIds.push(n),p.TextureCache[n]&&console.warn("Texture added to the cache with an id ["+n+"] that already had an entry"),p.TextureCache[n]=t)},t.removeFromCache=function(t){if(typeof t=="string"){var n=p.TextureCache[t];if(n){var r=n.textureCacheIds.indexOf(t);return r>-1&&n.textureCacheIds.splice(r,1),delete p.TextureCache[t],n}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)p.TextureCache[t.textureCacheIds[i]]===t&&delete p.TextureCache[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},r(t,[{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var n=t.x,r=t.y,i=t.width,s=t.height,o=n+i>this.baseTexture.width,u=r+s>this.baseTexture.height;if(o||u){var a=o&&u?"and":"or",f="X: "+n+" + "+i+" = "+(n+i)+" > "+this.baseTexture.width,l="Y: "+r+" + "+s+" = "+(r+s)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(f+" "+a+" "+l))}this.valid=i&&s&&this.baseTexture.hasLoaded,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),t}(c.default);n.default=w,w.EMPTY=new w(new s.default),S(w.EMPTY),S(w.EMPTY.baseTexture),w.WHITE=E(),S(w.WHITE),S(w.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":124,"./BaseTexture":112,"./TextureUvs":116,"./VideoBaseTexture":117,eventemitter3:3}],116:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../math/GroupD8"),i=s(r),u=function(){function e(){o(this,e),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return e.prototype.set=function(t,n,r){var s=n.width,o=n.height;if(r){var u=t.width/2/s,a=t.height/2/o,f=t.x/s+u,l=t.y/o+a;r=i.default.add(r,i.default.NW),this.x0=f+u*i.default.uX(r),this.y0=l+a*i.default.uY(r),r=i.default.add(r,2),this.x1=f+u*i.default.uX(r),this.y1=l+a*i.default.uY(r),r=i.default.add(r,2),this.x2=f+u*i.default.uX(r),this.y2=l+a*i.default.uY(r),r=i.default.add(r,2),this.x3=f+u*i.default.uX(r),this.y3=l+a*i.default.uY(r)}else this.x0=t.x/s,this.y0=t.y/o,this.x1=(t.x+t.width)/s,this.y1=t.y/o,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/o,this.x3=t.x/s,this.y3=(t.y+t.height)/o;this.uvsUint32[0]=(this.y0*65535&65535)<<16|this.x0*65535&65535,this.uvsUint32[1]=(this.y1*65535&65535)<<16|this.x1*65535&65535,this.uvsUint32[2]=(this.y2*65535&65535)<<16|this.x2*65535&65535,this.uvsUint32[3]=(this.y3*65535&65535)<<16|this.x3*65535&65535},e}();n.default=u},{"../math/GroupD8":66}],117:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function h(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function d(e,t){t||(t="video/"+e.substr(e.lastIndexOf(".")+1));var n=document.createElement("source");return n.src=e,n.type=t,n}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./BaseTexture"),s=f(i),o=e("../utils"),u=e("../ticker"),a=e("../const"),p=function(e){function t(n,r){l(this,t);if(!n)throw new Error("No video source element specified.");(n.readyState===n.HAVE_ENOUGH_DATA||n.readyState===n.HAVE_FUTURE_DATA)&&n.width&&n.height&&(n.complete=!0);var i=c(this,e.call(this,n,r));return i.width=n.videoWidth,i.height=n.videoHeight,i._autoUpdate=!0,i._isAutoUpdating=!1,i.autoPlay=!0,i.update=i.update.bind(i),i._onCanPlay=i._onCanPlay.bind(i),n.addEventListener("play",i._onPlayStart.bind(i)),n.addEventListener("pause",i._onPlayStop.bind(i)),i.hasLoaded=!1,i.__loaded=!1,i._isSourceReady()?i._onCanPlay():(n.addEventListener("canplay",i._onCanPlay),n.addEventListener("canplaythrough",i._onCanPlay)),i}return h(t,e),t.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&t.paused===!1&&t.ended===!1&&t.readyState>2},t.prototype._isSourceReady=function(){return this.source.readyState===3||this.source.readyState===4},t.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(u.shared.add(this.update,this,a.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},t.prototype._onPlayStop=function(){this._isAutoUpdating&&(u.shared.remove(this.update,this),this._isAutoUpdating=!1)},t.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},t.prototype.destroy=function(){this._isAutoUpdating&&u.shared.remove(this.update,this),this.source&&this.source._pixiId&&(s.default.removeFromCache(this.source._pixiId),delete this.source._pixiId),e.prototype.destroy.call(this)},t.fromVideo=function(n,r){n._pixiId||(n._pixiId="video_"+(0,o.uid)());var i=o.BaseTextureCache[n._pixiId];return i||(i=new t(n,r),s.default.addToCache(i,n._pixiId)),i},t.fromUrl=function(n,r){var i=document.createElement("video");i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","");if(Array.isArray(n))for(var s=0;s<n.length;++s)i.appendChild(d(n[s].src||n[s],n[s].mime));else i.appendChild(d(n.src||n,n.mime));return i.load(),t.fromVideo(i,r)},r(t,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(u.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(u.shared.add(this.update,this,a.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),t}(s.default);n.default=p,p.fromUrls=p.fromUrl},{"../const":46,"../ticker":120,"../utils":124,"./BaseTexture":112}],118:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../settings"),s=f(i),o=e("../const"),u=e("./TickerListener"),a=f(u),c=function(){function e(){var t=this;l(this,e),this._head=new a.default(null,null,Infinity),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/s.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:o.UPDATE_PRIORITY.NORMAL;return this._addListener(new a.default(t,n,r))},e.prototype.addOnce=function(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:o.UPDATE_PRIORITY.NORMAL;return this._addListener(new a.default(t,n,r,!0))},e.prototype._addListener=function(t){var n=this._head.next,r=this._head;if(!n)t.connect(r);else{while(n){if(t.priority>n.priority){t.connect(r);break}r=n,n=n.next}t.previous||t.connect(r)}return this._startIfPossible(),this},e.prototype.remove=function(t,n){var r=this._head.next;while(r)r.match(t,n)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this},e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){this.stop();var t=this._head.next;while(t)t=t.destroy(!0);this._head.destroy(),this._head=null},e.prototype.update=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:performance.now(),n=void 0;if(t>this.lastTime){n=this.elapsedMS=t-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),this.deltaTime=n*s.default.TARGET_FPMS*this.speed;var r=this._head,i=r.next;while(i)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},r(e,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var n=Math.min(Math.max(0,t)/1e3,s.default.TARGET_FPMS);this._maxElapsedMS=1/n}}]),e}();n.default=c},{"../const":46,"../settings":101,"./TickerListener":119}],119:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;r(this,e),this.fn=t,this.context=n,this.priority=i,this.once=s,this.next=null,this.previous=null,this._destroyed=!1}return e.prototype.match=function(t,n){return n=n||null,this.fn===t&&this.context===n},e.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var n=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),n},e.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},e.prototype.destroy=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var n=this.previous;return this.next=t?null:n,this.previous=null,n},e}();n.default=i},{}],120:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.Ticker=n.shared=undefined;var r=e("./Ticker"),i=s(r),o=new i.default;o.autoStart=!0,o.destroy=function(){},n.shared=o,n.Ticker=i.default},{"./Ticker":118}],121:[function(e,t,n){"use strict";function r(){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);return!e}n.__esModule=!0,n.default=r},{}],122:[function(e,t,n){"use strict";function r(e){var t=e*6,n=new Uint16Array(t);for(var r=0,i=0;r<t;r+=6,i+=4)n[r+0]=i+0,n[r+1]=i+1,n[r+2]=i+2,n[r+3]=i+0,n[r+4]=i+2,n[r+5]=i+3;return n}n.__esModule=!0,n.default=r},{}],123:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function u(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.location;if(e.indexOf("data:")===0)return"";t=t||window.location,o||(o=document.createElement("a")),o.href=e,e=i.default.parse(o.href);var n=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!n||e.protocol!==t.protocol?"anonymous":""}n.__esModule=!0,n.default=u;var r=e("url"),i=s(r),o=void 0},{url:29}],124:[function(e,t,n){"use strict";function y(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function b(e){return e&&e.__esModule?e:{"default":e}}function S(){return++w}function x(e,t){return t=t||[],t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}function T(e){return e=e.toString(16),e="000000".substr(0,6-e.length)+e,"#"+e}function N(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}function C(e,t){var n=s.default.RETINA_PREFIX.exec(e);return n?parseFloat(n[1]):t!==undefined?t:1}function k(e){var t=r.DATA_URI.exec(e);return t?{mediaType:t[1]?t[1].toLowerCase():undefined,subType:t[2]?t[2].toLowerCase():undefined,encoding:t[3]?t[3].toLowerCase():undefined,data:t[4]}:undefined}function L(e){var t=r.URL_FILE_EXTENSION.exec(e);return t?t[1].toLowerCase():undefined}function A(e){var t=r.SVG_SIZE.exec(e),n={};return t&&(n[t[1]]=Math.round(parseFloat(t[3])),n[t[5]]=Math.round(parseFloat(t[7]))),n}function O(){E=!0}function M(e){if(E)return;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=["\n %c %c %c PixiJS "+r.VERSION+" - â° "+e+" â°  %c  %c  http://www.pixijs.com/  %c %c â¥%câ¥%câ¥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,t)}else window.console&&window.console.log("PixiJS "+r.VERSION+" - "+e+" - http://www.pixijs.com/");E=!0}function _(){var e={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),r=!!n&&!!n.getContextAttributes().stencil;if(n){var i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}return n=null,r}catch(s){return!1}}function D(e){return e===0?0:e<0?-1:1}function B(){var e=void 0;for(e in P)P[e].destroy();for(e in H)H[e].destroy()}function j(){var e=void 0;for(e in P)delete P[e];for(e in H)delete H[e]}function I(e,t){return F[t?1:0][e]}function q(e,t){if(t===1)return(t*255<<24)+e;if(t===0)return 0;var n=e>>16&255,r=e>>8&255,i=e&255;return n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0,(t*255<<24)+(n<<16)+(r<<8)+i}function R(e,t,n,r){return n=n||new Float32Array(4),r||r===undefined?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t):(n[0]=e[0],n[1]=e[1],n[2]=e[2]),n[3]=t,n}function U(e,t,n,r){n=n||new Float32Array(4),n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(e&255)/255;if(r||r===undefined)n[0]*=t,n[1]*=t,n[2]*=t;return n[3]=t,n}n.__esModule=!0,n.premultiplyBlendMode=n.BaseTextureCache=n.TextureCache=n.mixins=n.pluginTarget=n.EventEmitter=n.removeItems=n.isMobile=undefined,n.uid=S,n.hex2rgb=x,n.hex2string=T,n.rgb2hex=N,n.getResolutionOfUrl=C,n.decomposeDataUri=k,n.getUrlFileExtension=L,n.getSvgSize=A,n.skipHello=O,n.sayHello=M,n.isWebGLSupported=_,n.sign=D,n.destroyTextureCache=B,n.clearTextureCache=j,n.correctBlendMode=I,n.premultiplyTint=q,n.premultiplyRgba=R,n.premultiplyTintToRgba=U;var r=e("../const"),i=e("../settings"),s=b(i),o=e("eventemitter3"),u=b(o),a=e("./pluginTarget"),f=b(a),l=e("./mixin"),c=y(l),h=e("ismobilejs"),p=y(h),d=e("remove-array-items"),v=b(d),m=e("./mapPremultipliedBlendModes"),g=b(m),w=0,E=!1;n.isMobile=p,n.removeItems=v.default,n.EventEmitter=u.default,n.pluginTarget=f.default,n.mixins=c;var P=n.TextureCache=Object.create(null),H=n.BaseTextureCache=Object.create(null),F=n.premultiplyBlendMode=(0,g.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":125,"./mixin":127,"./pluginTarget":128,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],125:[function(e,t,n){"use strict";function i(){var e=[],t=[];for(var n=0;n<32;n++)e[n]=n,t[n]=n;e[r.BLEND_MODES.NORMAL_NPM]=r.BLEND_MODES.NORMAL,e[r.BLEND_MODES.ADD_NPM]=r.BLEND_MODES.ADD,e[r.BLEND_MODES.SCREEN_NPM]=r.BLEND_MODES.SCREEN,t[r.BLEND_MODES.NORMAL]=r.BLEND_MODES.NORMAL_NPM,t[r.BLEND_MODES.ADD]=r.BLEND_MODES.ADD_NPM,t[r.BLEND_MODES.SCREEN]=r.BLEND_MODES.SCREEN_NPM;var i=[];return i.push(t),i.push(e),i}n.__esModule=!0,n.default=i;var r=e("../const")},{"../const":46}],126:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e){return i.default.tablet||i.default.phone?4:e}n.__esModule=!0,n.default=o;var r=e("ismobilejs"),i=s(r)},{ismobilejs:4}],127:[function(e,t,n){"use strict";function r(e,t){if(!e||!t)return;var n=Object.keys(t);for(var r=0;r<n.length;++r){var i=n[r];Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}}function s(e,t){i.push(e,t)}function o(){for(var e=0;e<i.length;e+=2)r(i[e],i[e+1]);i.length=0}n.__esModule=!0,n.mixin=r,n.delayMixin=s,n.performMixins=o;var i=[]},{}],128:[function(e,t,n){"use strict";function r(e){e.__plugins={},e.registerPlugin=function(n,r){e.__plugins[n]=r},e.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var n in e.__plugins)this.plugins[n]=new e.__plugins[n](this)},e.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}n.__esModule=!0,n.default={mixin:function(t){r(t)}}},{}],129:[function(e,t,n){"use strict";function r(e){var t=e.width,n=e.height,r=e.getContext("2d"),i=r.getImageData(0,0,t,n),s=i.data,o=s.length,u={top:null,left:null,right:null,bottom:null},a=void 0,f=void 0,l=void 0;for(a=0;a<o;a+=4)s[a+3]!==0&&(f=a/4%t,l=~~(a/4/t),u.top===null&&(u.top=l),u.left===null?u.left=f:f<u.left&&(u.left=f),u.right===null?u.right=f+1:u.right<f&&(u.right=f+1),u.bottom===null?u.bottom=l:u.bottom<l&&(u.bottom=l));t=u.right-u.left,n=u.bottom-u.top+1;var c=r.getImageData(u.left,u.top,t,n);return{height:n,width:t,data:c}}n.__esModule=!0,n.default=r},{}],130:[function(e,t,n){"use strict";function r(e){var t=(new Error).stack;typeof t=="undefined"?console.warn("Deprecation Warning: ",e):(t=t.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e),console.warn(t),console.groupEnd()):(console.warn("Deprecation Warning: ",e),console.warn(t)))}function i(e){var t=e.mesh,n=e.particles,i=e.extras,s=e.filters,o=e.prepare,u=e.loaders,a=e.interaction;Object.defineProperties(e,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return r("You do not need to use a PIXI Stage any more, you can simply render any container."),e.Container}},DisplayObjectContainer:{get:function(){return r("DisplayObjectContainer has been shortened to Container, please use Container from now on."),e.Container}},Strip:{get:function(){return r("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),t.Mesh}},Rope:{get:function(){return r("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),t.Rope}},ParticleContainer:{get:function(){return r("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),n.ParticleContainer}},MovieClip:{get:function(){return r("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),i.AnimatedSprite}},TilingSprite:{get:function(){return r("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),i.TilingSprite}},BitmapText:{get:function(){return r("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),i.BitmapText}},blendModes:{get:function(){return r("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),e.BLEND_MODES}},scaleModes:{get:function(){return r("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),e.SCALE_MODES}},BaseTextureCache:{get:function(){return r("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),e.utils.BaseTextureCache}},TextureCache:{get:function(){return r("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),e.utils.TextureCache}},math:{get:function(){return r("The math namespace is deprecated, please access members already accessible on PIXI."),e}},AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),e.Filter}},TransformManual:{get:function(){return r("TransformManual has been renamed to TransformBase, please update your pixi-spine"),e.TransformBase}},TARGET_FPMS:{get:function(){return r("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),e.settings.TARGET_FPMS},set:function(n){r("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),e.settings.TARGET_FPMS=n}},FILTER_RESOLUTION:{get:function(){return r("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),e.settings.FILTER_RESOLUTION},set:function(n){r("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),e.settings.FILTER_RESOLUTION=n}},RESOLUTION:{get:function(){return r("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),e.settings.RESOLUTION},set:function(n){r("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),e.settings.RESOLUTION=n}},MIPMAP_TEXTURES:{get:function(){return r("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),e.settings.MIPMAP_TEXTURES},set:function(n){r("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),e.settings.MIPMAP_TEXTURES=n}},SPRITE_BATCH_SIZE:{get:function(){return r("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),e.settings.SPRITE_BATCH_SIZE},set:function(n){r("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),e.settings.SPRITE_BATCH_SIZE=n}},SPRITE_MAX_TEXTURES:{get:function(){return r("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),e.settings.SPRITE_MAX_TEXTURES},set:function(n){r("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),e.settings.SPRITE_MAX_TEXTURES=n}},RETINA_PREFIX:{get:function(){return r("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),e.settings.RETINA_PREFIX},set:function(n){r("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),e.settings.RETINA_PREFIX=n}},DEFAULT_RENDER_OPTIONS:{get:function(){return r("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),e.settings.RENDER_OPTIONS}}});var f=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],l=function(n){var i=f[n];Object.defineProperty(e[i.parent],"DEFAULT",{get:function(){return r("PIXI."+i.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+i.target)),e.settings[i.target]},set:function(n){r("PIXI."+i.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+i.target)),e.settings[i.target]=n}})};for(var c=0;c<f.length;c++)l(c);Object.defineProperties(e.settings,{PRECISION:{get:function(){return r("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),e.settings.PRECISION_FRAGMENT},set:function(n){r("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),e.settings.PRECISION_FRAGMENT=n}}}),i.AnimatedSprite&&Object.defineProperties(i,{MovieClip:{get:function(){return r("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),i.AnimatedSprite}}}),e.DisplayObject.prototype.generateTexture=function(t,n,i){return r("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,n,i)},e.Graphics.prototype.generateTexture=function(t,n){return r("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,n)},e.RenderTexture.prototype.render=function(t,n,i,s){this.legacyRenderer.render(t,this,i,n,!s),r("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},e.RenderTexture.prototype.getImage=function(t){return r("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},e.RenderTexture.prototype.getBase64=function(t){return r("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},e.RenderTexture.prototype.getCanvas=function(t){return r("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},e.RenderTexture.prototype.getPixels=function(t){return r("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},e.Sprite.prototype.setTexture=function(t){this.texture=t,r("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},i.BitmapText&&(i.BitmapText.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),e.Text.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},e.Text.calculateFontProperties=function(n){return r("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),e.TextMetrics.measureFont(n)},Object.defineProperties(e.Text,{fontPropertiesCache:{get:function(){return r("Text.fontPropertiesCache is deprecated"),e.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return r("Text.fontPropertiesCanvas is deprecated"),e.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return r("Text.fontPropertiesContext is deprecated"),e.TextMetrics._context}}}),e.Text.prototype.setStyle=function(t){this.style=t,r("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},e.Text.prototype.determineFontProperties=function(n){return r("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),e.TextMetrics.measureFont(n)},e.Text.getFontStyle=function(n){return r("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),n=n||{},n instanceof e.TextStyle||(n=new e.TextStyle(n)),n.toFontString()},Object.defineProperties(e.TextStyle.prototype,{font:{get:function(){r("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t=typeof this._fontSize=="number"?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){r("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),t.indexOf("italic")>1?this._fontStyle="italic":t.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",t.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var n=t.split(" "),i=-1;this._fontSize=26;for(var s=0;s<n.length;++s)if(n[s].match(/(px|pt|em|%)/)){i=s,this._fontSize=n[s];break}this._fontWeight="normal";for(var o=0;o<i;++o)if(n[o].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=n[o];break}if(i>-1&&i<n.length-1){this._fontFamily="";for(var u=i+1;u<n.length;++u)this._fontFamily+=n[u]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),e.Texture.prototype.setFrame=function(t){this.frame=t,r("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},e.Texture.addTextureToCache=function(n,i){e.Texture.addToCache(n,i),r("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},e.Texture.removeTextureFromCache=function(n){return r("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),e.BaseTexture.removeFromCache(n),e.Texture.removeFromCache(n)},Object.defineProperties(s,{AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),e.AbstractFilter}},SpriteMaskFilter:{get:function(){return r("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),e.SpriteMaskFilter}}}),e.utils.uuid=function(){return r("utils.uuid() is deprecated, please use utils.uid() from now on."),e.utils.uid()},e.utils.canUseNewCanvasBlendModes=function(){return r("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),e.CanvasTinter.canUseMultiply};var h=!0;Object.defineProperty(e.utils,"_saidHello",{set:function(t){t&&(r("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),h=t},get:function(){return h}}),o.BasePrepare&&(o.BasePrepare.prototype.register=function(t,n){return r("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),n&&this.registerUploadHook(n),this}),o.canvas&&Object.defineProperty(o.canvas,"UPLOADS_PER_FRAME",{set:function(){r("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return r("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),o.webgl&&Object.defineProperty(o.webgl,"UPLOADS_PER_FRAME",{set:function(){r("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return r("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}});if(u.Loader){var p=u.Resource,d=u.Loader;Object.defineProperties(p.prototype,{isJson:{get:function(){return r("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===p.TYPE.JSON}},isXml:{get:function(){return r("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===p.TYPE.XML}},isImage:{get:function(){return r("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===p.TYPE.IMAGE}},isAudio:{get:function(){return r("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===p.TYPE.AUDIO}},isVideo:{get:function(){return r("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===p.TYPE.VIDEO}}}),Object.defineProperties(d.prototype,{before:{get:function(){return r("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return r("The after() method is deprecated, please use use()."),this.use}}})}a.interactiveTarget&&Object.defineProperty(a.interactiveTarget,"defaultCursor",{set:function(t){r("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return r("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),a.InteractionManager&&(Object.defineProperty(a.InteractionManager,"defaultCursorStyle",{set:function(t){r("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return r("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(a.InteractionManager,"currentCursorStyle",{set:function(t){r("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return r("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}n.__esModule=!0,n.default=i},{}],131:[function(e,t,n){"use strict";function s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../core"),i=s(r),u=new i.Rectangle,a=function(){function e(t){o(this,e),this.renderer=t,t.extract=this}return e.prototype.image=function t(e){var t=new Image;return t.src=this.base64(e),t},e.prototype.base64=function(t){return this.canvas(t).toDataURL()},e.prototype.canvas=function(t){var n=this.renderer,r=void 0,s=void 0,o=void 0,a=void 0;t&&(t instanceof i.RenderTexture?a=t:a=n.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,s=a.baseTexture._canvasRenderTarget.resolution,o=a.frame):(r=n.rootContext,o=u,o.width=this.renderer.width,o.height=this.renderer.height);var f=o.width*s,l=o.height*s,c=new i.CanvasRenderTarget(f,l),h=r.getImageData(o.x*s,o.y*s,f,l);return c.context.putImageData(h,0,0),c.canvas},e.prototype.pixels=function(t){var n=this.renderer,r=void 0,s=void 0,o=void 0,a=void 0;return t&&(t instanceof i.RenderTexture?a=t:a=n.generateTexture(t)),a?(r=a.baseTexture._canvasRenderTarget.context,s=a.baseTexture._canvasRenderTarget.resolution,o=a.frame):(r=n.rootContext,o=u,o.width=n.width,o.height=n.height),r.getImageData(0,0,o.width*s,o.height*s).data},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();n.default=a,i.CanvasRenderer.registerPlugin("extract",a)},{"../../core":65}],132:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./webgl/WebGLExtract");Object.defineProperty(n,"webgl",{enumerable:!0,get:function(){return s(r).default}});var i=e("./canvas/CanvasExtract");Object.defineProperty(n,"canvas",{enumerable:!0,get:function(){return s(i).default}})},{"./canvas/CanvasExtract":131,"./webgl/WebGLExtract":133}],133:[function(e,t,n){"use strict";function s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../core"),i=s(r),u=new i.Rectangle,a=4,f=function(){function e(t){o(this,e),this.renderer=t,t.extract=this}return e.prototype.image=function t(e){var t=new Image;return t.src=this.base64(e),t},e.prototype.base64=function(t){return this.canvas(t).toDataURL()},e.prototype.canvas=function(t){var n=this.renderer,r=void 0,s=void 0,o=void 0,f=!1,l=void 0;t&&(t instanceof i.RenderTexture?l=t:l=this.renderer.generateTexture(t)),l?(r=l.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],s=r.resolution,o=l.frame,f=!1):(r=this.renderer.rootRenderTarget,s=r.resolution,f=!0,o=u,o.width=r.size.width,o.height=r.size.height);var c=o.width*s,h=o.height*s,p=new i.CanvasRenderTarget(c,h);if(r){n.bindRenderTarget(r);var d=new Uint8Array(a*c*h),v=n.gl;v.readPixels(o.x*s,o.y*s,c,h,v.RGBA,v.UNSIGNED_BYTE,d);var m=p.context.getImageData(0,0,c,h);m.data.set(d),p.context.putImageData(m,0,0),f&&(p.context.scale(1,-1),p.context.drawImage(p.canvas,0,-h))}return p.canvas},e.prototype.pixels=function(t){var n=this.renderer,r=void 0,s=void 0,o=void 0,f=void 0;t&&(t instanceof i.RenderTexture?f=t:f=this.renderer.generateTexture(t)),f?(r=f.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],s=r.resolution,o=f.frame):(r=this.renderer.rootRenderTarget,s=r.resolution,o=u,o.width=r.size.width,o.height=r.size.height);var l=o.width*s,c=o.height*s,h=new Uint8Array(a*l*c);if(r){n.bindRenderTarget(r);var p=n.gl;p.readPixels(o.x*s,o.y*s,l,c,p.RGBA,p.UNSIGNED_BYTE,h)}return h},e.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},e}();n.default=f,i.WebGLRenderer.registerPlugin("extract",f)},{"../../core":65}],134:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=o(i),l=function(e){function t(n,r){u(this,t);var i=a(this,e.call(this,n[0]instanceof s.Texture?n[0]:n[0].texture));return i._textures=null,i._durations=null,i.textures=n,i._autoUpdate=r!==!1,i.animationSpeed=1,i.loop=!0,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i.playing=!1,i}return f(t,e),t.prototype.stop=function(){if(!this.playing)return;this.playing=!1,this._autoUpdate&&s.ticker.shared.remove(this.update,this)},t.prototype.play=function(){if(this.playing)return;this.playing=!0,this._autoUpdate&&s.ticker.shared.add(this.update,this,s.UPDATE_PRIORITY.HIGH)},t.prototype.gotoAndStop=function(t){this.stop();var n=this.currentFrame;this._currentTime=t,n!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(t){var n=this.currentFrame;this._currentTime=t,n!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(t){var n=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){var i=this._currentTime%1*this._durations[this.currentFrame];i+=n/60*1e3;while(i<0)this._currentTime--,i+=this._durations[this.currentFrame];var s=Math.sign(this.animationSpeed*t);this._currentTime=Math.floor(this._currentTime);while(i>=this._durations[this.currentFrame])i-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},t.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},t.prototype.destroy=function(n){this.stop(),e.prototype.destroy.call(this,n)},t.fromFrames=function(n){var r=[];for(var i=0;i<n.length;++i)r.push(s.Texture.fromFrame(n[i]));return new t(r)},t.fromImages=function(n){var r=[];for(var i=0;i<n.length;++i)r.push(s.Texture.fromImage(n[i]));return new t(r)},r(t,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof s.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<t.length;n++)this._textures.push(t[n].texture),this._durations.push(t[n].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),t}(s.Sprite);n.default=l},{"../core":65}],135:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=c(i),o=e("../core/math/ObservablePoint"),u=l(o),a=e("../core/settings"),f=l(a),v=function(e){function t(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};h(this,t);var i=p(this,e.call(this));return i._textWidth=0,i._textHeight=0,i._glyphs=[],i._font={tint:r.tint!==undefined?r.tint:16777215,align:r.align||"left",name:null,size:0},i.font=r.font,i._text=n,i._maxWidth=0,i._maxLineHeight=0,i._anchor=new u.default(function(){i.dirty=!0},i,0,0),i.dirty=!1,i.updateText(),i}return d(t,e),t.prototype.updateText=function(){var n=t.fonts[this._font.name],r=this._font.size/n.size,i=new s.Point,o=[],u=[],a=null,f=0,l=0,c=0,h=-1,p=0,d=0,v=0;for(var m=0;m<this.text.length;m++){var g=this.text.charCodeAt(m);/(\s)/.test(this.text.charAt(m))&&(h=m,p=f);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(m))){u.push(f),l=Math.max(l,f),c++,i.x=0,i.y+=n.lineHeight,a=null;continue}if(h!==-1&&this._maxWidth>0&&i.x*r>this._maxWidth){s.utils.removeItems(o,h-d,m-h),m=h,h=-1,++d,u.push(p),l=Math.max(l,p),c++,i.x=0,i.y+=n.lineHeight,a=null;continue}var y=n.chars[g];if(!y)continue;a&&y.kerning[a]&&(i.x+=y.kerning[a]),o.push({texture:y.texture,line:c,charCode:g,position:new s.Point(i.x+y.xOffset,i.y+y.yOffset)}),f=i.x+(y.texture.width+y.xOffset),i.x+=y.xAdvance,v=Math.max(v,y.yOffset+y.texture.height),a=g}u.push(f),l=Math.max(l,f);var b=[];for(var w=0;w<=c;w++){var E=0;this._font.align==="right"?E=l-u[w]:this._font.align==="center"&&(E=(l-u[w])/2),b.push(E)}var S=o.length,x=this.tint;for(var T=0;T<S;T++){var N=this._glyphs[T];N?N.texture=o[T].texture:(N=new s.Sprite(o[T].texture),this._glyphs.push(N)),N.position.x=(o[T].position.x+b[o[T].line])*r,N.position.y=o[T].position.y*r,N.scale.x=N.scale.y=r,N.tint=x,N.parent||this.addChild(N)}for(var C=S;C<this._glyphs.length;++C)this.removeChild(this._glyphs[C]);this._textWidth=l*r,this._textHeight=(i.y+n.lineHeight)*r;if(this.anchor.x!==0||this.anchor.y!==0)for(var k=0;k<S;k++)this._glyphs[k].x-=this._textWidth*this.anchor.x,this._glyphs[k].y-=this._textHeight*this.anchor.y;this._maxLineHeight=v*r},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},t.registerFont=function(n,r){var i={},o=n.getElementsByTagName("info")[0],u=n.getElementsByTagName("common")[0],a=r.baseTexture.resolution||f.default.RESOLUTION;i.font=o.getAttribute("face"),i.size=parseInt(o.getAttribute("size"),10),i.lineHeight=parseInt(u.getAttribute("lineHeight"),10)/a,i.chars={};var l=n.getElementsByTagName("char");for(var c=0;c<l.length;c++){var h=l[c],p=parseInt(h.getAttribute("id"),10),d=new s.Rectangle(parseInt(h.getAttribute("x"),10)/a+r.frame.x/a,parseInt(h.getAttribute("y"),10)/a+r.frame.y/a,parseInt(h.getAttribute("width"),10)/a,parseInt(h.getAttribute("height"),10)/a);i.chars[p]={xOffset:parseInt(h.getAttribute("xoffset"),10)/a,yOffset:parseInt(h.getAttribute("yoffset"),10)/a,xAdvance:parseInt(h.getAttribute("xadvance"),10)/a,kerning:{},texture:new s.Texture(r.baseTexture,d)}}var v=n.getElementsByTagName("kerning");for(var m=0;m<v.length;m++){var g=v[m],y=parseInt(g.getAttribute("first"),10)/a,b=parseInt(g.getAttribute("second"),10)/a,w=parseInt(g.getAttribute("amount"),10)/a;i.chars[b]&&(i.chars[b].kerning[y]=w)}return t.fonts[i.font]=i,i},r(t,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint=typeof t=="number"&&t>=0?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){typeof t=="number"?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(n){if(!n)return;typeof n=="string"?(n=n.split(" "),this._font.name=n.length===1?n[0]:n.slice(1).join(" "),this._font.size=n.length>=2?parseInt(n[0],10):t.fonts[this._font.name].size):(this._font.name=n.name,this._font.size=typeof n.size=="number"?n.size:parseInt(n.size,10)),this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ";if(this._text===t)return;this._text=t,this.dirty=!0}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){if(this._maxWidth===t)return;this._maxWidth=t,this.dirty=!0}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),t}(s.Container);n.default=v,v.fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101}],136:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core/math/Matrix"),s=o(i),a=new s.default,f=function(){function e(t,n){u(this,e),this._texture=t,this.mapCoord=new s.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=typeof n=="undefined"?.5:n}return e.prototype.multiplyUvs=function(t,n){n===undefined&&(n=t);var r=this.mapCoord;for(var i=0;i<t.length;i+=2){var s=t[i],o=t[i+1];n[i]=s*r.a+o*r.c+r.tx,n[i+1]=s*r.b+o*r.d+r.ty}return n},e.prototype.update=function(t){var n=this._texture;if(!n||!n.valid)return!1;if(!t&&this._lastTextureID===n._updateID)return!1;this._lastTextureID=n._updateID;var r=n._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=n.orig,s=n.trim;s&&(a.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(a));var o=n.baseTexture,u=this.uClampFrame,f=this.clampMargin/o.resolution,l=this.clampOffset;return u[0]=(n._frame.x+f+l)/o.width,u[1]=(n._frame.y+f+l)/o.height,u[2]=(n._frame.x+n._frame.width-f+l)/o.width,u[3]=(n._frame.y+n._frame.height-f+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,!0},r(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),e}();n.default=f},{"../core/math/Matrix":67}],137:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=c(i),o=e("../core/sprites/canvas/CanvasTinter"),u=l(o),a=e("./TextureTransform"),f=l(a),v=new s.Point,m=function(e){function t(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;h(this,t);var o=p(this,e.call(this,n));return o.tileTransform=new s.TransformStatic,o._width=r,o._height=i,o._canvasPattern=null,o.uvTransform=n.transform||new f.default(n),o.pluginName="tilingSprite",o.uvRespectAnchor=!1,o}return d(t,e),t.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},t.prototype._renderWebGL=function(t){var n=this._texture;if(!n||!n.valid)return;this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(t){var n=this._texture;if(!n.baseTexture.hasLoaded)return;var r=t.context,i=this.worldTransform,o=t.resolution,a=n.baseTexture,f=a.resolution,l=this.tilePosition.x/this.tileScale.x%n._frame.width*f,c=this.tilePosition.y/this.tileScale.y%n._frame.height*f;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var h=new s.CanvasRenderTarget(n._frame.width,n._frame.height,f);this.tint!==16777215?(this.tintedTexture=u.default.getTintedTexture(this,this.tint),h.context.drawImage(this.tintedTexture,0,0)):h.context.drawImage(a.source,-n._frame.x*f,-n._frame.y*f),this.cachedTint=this.tint,this._canvasPattern=h.context.createPattern(h.canvas,"repeat")}r.globalAlpha=this.worldAlpha,r.setTransform(i.a*o,i.b*o,i.c*o,i.d*o,i.tx*o,i.ty*o),t.setBlendMode(this.blendMode),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/f,this.tileScale.y/f);var p=this.anchor.x*-this._width,d=this.anchor.y*-this._height;this.uvRespectAnchor?(r.translate(l,c),r.fillRect(-l+p,-c+d,this._width/this.tileScale.x*f,this._height/this.tileScale.y*f)):(r.translate(l+p,c+d),r.fillRect(-l,-c,this._width/this.tileScale.x*f,this._height/this.tileScale.y*f))},t.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,n=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,n,r,i)},t.prototype.getLocalBounds=function(n){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),n||(this._localBoundsRect||(this._localBoundsRect=new s.Rectangle),n=this._localBoundsRect),this._bounds.getRectangle(n)):e.prototype.getLocalBounds.call(this,n)},t.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,v);var n=this._width,r=this._height,i=-n*this.anchor._x;if(v.x>=i&&v.x<i+n){var s=-r*this.anchor._y;if(v.y>=s&&v.y<s+r)return!0}return!1},t.prototype.destroy=function(n){e.prototype.destroy.call(this,n),this.tileTransform=null,this.uvTransform=null},t.from=function(n,r,i){return new t(s.Texture.from(n),r,i)},t.fromFrame=function(n,r,i){var o=s.utils.TextureCache[n];if(!o)throw new Error('The frameId "'+n+'" does not exist in the texture cache '+this);return new t(o,r,i)},t.fromImage=function(n,r,i,o,u){return new t(s.Texture.fromImage(n,o,u),r,i)},r(t,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),t}(s.Sprite);n.default=m},{"../core":65,"../core/sprites/canvas/CanvasTinter":104,"./TextureTransform":136}],138:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=e("../core"),i=c(r),s=e("../core/textures/Texture"),o=l(s),u=e("../core/textures/BaseTexture"),a=l(u),f=e("../core/utils"),p=i.DisplayObject,d=new i.Matrix;p.prototype._cacheAsBitmap=!1,p.prototype._cacheData=!1;var v=function m(){h(this,m),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(p.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap===t)return;this._cacheAsBitmap=t;var n=void 0;t?(this._cacheData||(this._cacheData=new v),n=this._cacheData,n.originalRenderWebGL=this.renderWebGL,n.originalRenderCanvas=this.renderCanvas,n.originalUpdateTransform=this.updateTransform,n.originalCalculateBounds=this._calculateBounds,n.originalGetLocalBounds=this.getLocalBounds,n.originalDestroy=this.destroy,n.originalContainsPoint=this.containsPoint,n.originalMask=this._mask,n.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(n=this._cacheData,n.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=n.originalRenderWebGL,this.renderCanvas=n.originalRenderCanvas,this._calculateBounds=n.originalCalculateBounds,this.getLocalBounds=n.originalGetLocalBounds,this.destroy=n.originalDestroy,this.updateTransform=n.originalUpdateTransform,this.containsPoint=n.originalContainsPoint,this._mask=n.originalMask,this.filterArea=n.originalFilterArea)}}}),p.prototype._renderCachedWebGL=function(t){if(!this.visible||this.worldAlpha<=0||!this.renderable)return;this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t)},p.prototype._initCachedDisplayObject=function(t){if(this._cacheData&&this._cacheData.sprite)return;var n=this.alpha;this.alpha=1,t.currentRenderer.flush();var r=this.getLocalBounds().clone();if(this._filters){var s=this._filters[0].padding;r.pad(s)}var u=t._activeRenderTarget,l=t.filterManager.filterStack,c=i.RenderTexture.create(r.width|0,r.height|0),h="cacheAsBitmap_"+(0,f.uid)();this._cacheData.textureCacheId=h,a.default.addToCache(c.baseTexture,h),o.default.addToCache(c,h);var p=d;p.tx=-r.x,p.ty=-r.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,c,!0,p,!0),t.bindRenderTarget(u),t.filterManager.filterStack=l,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var v=new i.Sprite(c);v.transform.worldTransform=this.transform.worldTransform,v.anchor.x=-(r.x/r.width),v.anchor.y=-(r.y/r.height),v.alpha=n,v._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=v,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=v.containsPoint.bind(v)},p.prototype._renderCachedCanvas=function(t){if(!this.visible||this.worldAlpha<=0||!this.renderable)return;this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t)},p.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData&&this._cacheData.sprite)return;var n=this.getLocalBounds(),r=this.alpha;this.alpha=1;var s=t.context,u=i.RenderTexture.create(n.width|0,n.height|0),l="cacheAsBitmap_"+(0,f.uid)();this._cacheData.textureCacheId=l,a.default.addToCache(u.baseTexture,l),o.default.addToCache(u,l);var c=d;this.transform.localTransform.copy(c),c.invert(),c.tx-=n.x,c.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,u,!0,c,!1),t.context=s,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var h=new i.Sprite(u);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(n.x/n.width),h.anchor.y=-(n.y/n.height),h._bounds=this._bounds,h.alpha=r,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=h,this.containsPoint=h.containsPoint.bind(h)},p.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},p.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},p.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,a.default.removeFromCache(this._cacheData.textureCacheId),o.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},p.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":124}],139:[function(e,t,n){"use strict";function s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var r=e("../core"),i=s(r);i.DisplayObject.prototype.name=null,i.Container.prototype.getChildByName=function(t){for(var n=0;n<this.children.length;n++)if(this.children[n].name===t)return this.children[n];return null}},{"../core":65}],140:[function(e,t,n){"use strict";function s(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var r=e("../core"),i=s(r);i.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new i.Point,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return this.parent?this.parent.toGlobal(this.position,t,n):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.BitmapText=n.TilingSpriteRenderer=n.TilingSprite=n.TextureTransform=n.AnimatedSprite=undefined;var r=e("./AnimatedSprite");Object.defineProperty(n,"AnimatedSprite",{enumerable:!0,get:function(){return a(r).default}});var i=e("./TextureTransform");Object.defineProperty(n,"TextureTransform",{enumerable:!0,get:function(){return a(i).default}});var s=e("./TilingSprite");Object.defineProperty(n,"TilingSprite",{enumerable:!0,get:function(){return a(s).default}});var o=e("./webgl/TilingSpriteRenderer");Object.defineProperty(n,"TilingSpriteRenderer",{enumerable:!0,get:function(){return a(o).default}});var u=e("./BitmapText");Object.defineProperty(n,"BitmapText",{enumerable:!0,get:function(){return a(u).default}}),e("./cacheAsBitmap"),e("./getChildByName"),e("./getGlobalPosition")},{"./AnimatedSprite":134,"./BitmapText":135,"./TextureTransform":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core"),i=u(r),s=e("../../core/const"),o=e("path"),c=new i.Matrix,h=function(e){function t(n){a(this,t);var r=f(this,e.call(this,n));return r.shader=null,r.simpleShader=null,r.quad=null,r}return l(t,e),t.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new i.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new i.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new i.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},t.prototype.render=function(t){var n=this.renderer,r=this.quad;n.bindVao(r.vao);var o=r.vertices;o[0]=o[6]=t._width*-t.anchor.x,o[1]=o[3]=t._height*-t.anchor.y,o[2]=o[4]=t._width*(1-t.anchor.x),o[5]=o[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&(o=r.uvs,o[0]=o[6]=-t.anchor.x,o[1]=o[3]=-t.anchor.y,o[2]=o[4]=1-t.anchor.x,o[5]=o[7]=1-t.anchor.y),r.upload();var u=t._texture,a=u.baseTexture,f=t.tileTransform.localTransform,l=t.uvTransform,h=a.isPowerOfTwo&&u.frame.width===a.width&&u.frame.height===a.height;h&&(a._glTextures[n.CONTEXT_UID]?h=a.wrapMode!==s.WRAP_MODES.CLAMP:a.wrapMode===s.WRAP_MODES.CLAMP&&(a.wrapMode=s.WRAP_MODES.REPEAT));var p=h?this.simpleShader:this.shader;n.bindShader(p);var d=u.width,v=u.height,m=t._width,g=t._height;c.set(f.a*d/m,f.b*d/g,f.c*v/m,f.d*v/g,f.tx/m,f.ty/g),c.invert(),h?c.prepend(l.mapCoord):(p.uniforms.uMapCoord=l.mapCoord.toArray(!0),p.uniforms.uClampFrame=l.uClampFrame,p.uniforms.uClampOffset=l.uClampOffset),p.uniforms.uTransform=c.toArray(!0),p.uniforms.uColor=i.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,p.uniforms.uColor,a.premultipliedAlpha),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=n.bindTexture(u),n.setBlendMode(i.utils.correctBlendMode(t.blendMode,a.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},t}(i.ObjectRenderer);n.default=h,i.WebGLRenderer.registerPlugin("tilingSprite",h)},{"../../core":65,"../../core/const":46,path:23}],143:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=c(i),o=e("./BlurXFilter"),u=l(o),a=e("./BlurYFilter"),f=l(a),v=function(e){function t(n,r,i,o){h(this,t);var a=p(this,e.call(this));return a.blurXFilter=new u.default(n,r,i,o),a.blurYFilter=new f.default(n,r,i,o),a.padding=0,a.resolution=i||s.settings.RESOLUTION,a.quality=r||4,a.blur=n||8,a}return d(t,e),t.prototype.apply=function(t,n,r){var i=t.getRenderTarget(!0);this.blurXFilter.apply(t,n,i,!0),this.blurYFilter.apply(t,i,r,!1),t.returnRenderTarget(i)},r(t,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),t}(s.Filter);n.default=v},{"../../core":65,"./BlurXFilter":144,"./BlurYFilter":145}],144:[function(e,t,n){"use strict";function h(e){return e&&e.__esModule?e:{"default":e}}function p(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function m(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=p(i),o=e("./generateBlurVertSource"),u=h(o),a=e("./generateBlurFragSource"),f=h(a),l=e("./getMaxBlurKernelSize"),c=h(l),g=function(e){function t(n,r,i,o){d(this,t),o=o||5;var a=(0,u.default)(o,!0),l=(0,f.default)(o),c=v(this,e.call(this,a,l));return c.resolution=i||s.settings.RESOLUTION,c._quality=0,c.quality=r||4,c.strength=n||8,c.firstRun=!0,c}return m(t,e),t.prototype.apply=function(t,n,r,i){if(this.firstRun){var s=t.renderer.gl,o=(0,c.default)(s);this.vertexSrc=(0,u.default)(o,!0),this.fragmentSrc=(0,f.default)(o),this.firstRun=!1}this.uniforms.strength=1/r.size.width*(r.size.width/n.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes;if(this.passes===1)t.applyFilter(this,n,r,i);else{var a=t.getRenderTarget(!0),l=n,h=a;for(var p=0;p<this.passes-1;p++){t.applyFilter(this,l,h,!0);var d=h;h=l,l=d}t.applyFilter(this,l,r,i),t.returnRenderTarget(a)}},r(t,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=Math.abs(t)*2,this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),t}(s.Filter);n.default=g},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],145:[function(e,t,n){"use strict";function h(e){return e&&e.__esModule?e:{"default":e}}function p(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function m(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=p(i),o=e("./generateBlurVertSource"),u=h(o),a=e("./generateBlurFragSource"),f=h(a),l=e("./getMaxBlurKernelSize"),c=h(l),g=function(e){function t(n,r,i,o){d(this,t),o=o||5;var a=(0,u.default)(o,!1),l=(0,f.default)(o),c=v(this,e.call(this,a,l));return c.resolution=i||s.settings.RESOLUTION,c._quality=0,c.quality=r||4,c.strength=n||8,c.firstRun=!0,c}return m(t,e),t.prototype.apply=function(t,n,r,i){if(this.firstRun){var s=t.renderer.gl,o=(0,c.default)(s);this.vertexSrc=(0,u.default)(o,!1),this.fragmentSrc=(0,f.default)(o),this.firstRun=!1}this.uniforms.strength=1/r.size.height*(r.size.height/n.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes;if(this.passes===1)t.applyFilter(this,n,r,i);else{var a=t.getRenderTarget(!0),l=n,h=a;for(var p=0;p<this.passes-1;p++){t.applyFilter(this,l,h,!0);var d=h;h=l,l=d}t.applyFilter(this,l,r,i),t.returnRenderTarget(a)}},r(t,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=Math.abs(t)*2,this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),t}(s.Filter);n.default=g},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],146:[function(e,t,n){"use strict";function s(e){var t=r[e],n=t.length,s=i,o="",u="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",a=void 0;for(var f=0;f<e;f++){var l=u.replace("%index%",f);a=f,f>=n&&(a=e-f-1),l=l.replace("%value%",t[a]),o+=l,o+="\n"}return s=s.replace("%blur%",o),s=s.replace("%size%",e),s}n.__esModule=!0,n.default=s;var r={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},i=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],147:[function(e,t,n){"use strict";function i(e,t){var n=Math.ceil(e/2),i=r,s="",o=void 0;t?o="vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var u=0;u<e;u++){var a=o.replace("%index%",u);a=a.replace("%sampleIndex%",u-(n-1)+".0"),s+=a,s+="\n"}return i=i.replace("%blur%",s),i=i.replace("%size%",e),i}n.__esModule=!0,n.default=i;var r=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],148:[function(e,t,n){"use strict";function r(e){var t=e.getParameter(e.MAX_VARYING_VECTORS),n=15;while(n>t)n-=2;return n}n.__esModule=!0,n.default=r},{}],149:[function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=u(i),o=e("path"),c=function(e){function t(){a(this,t);var n=f(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return n.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],n.alpha=1,n}return l(t,e),t.prototype._loadMatrix=function(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,r=t;n&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(t,n,r){return t[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],t[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],t[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],t[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],t[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],t[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],t[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],t[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],t[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],t[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],t[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],t[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],t[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],t[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],t[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],t[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],t[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],t[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],t[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],t[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],t},t.prototype._colorMatrix=function(t){var n=new Float32Array(t);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},t.prototype.brightness=function(t,n){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.greyscale=function(t,n){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.blackAndWhite=function(t){var n=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.hue=function(t,n){t=(t||0)/180*Math.PI;var r=Math.cos(t),i=Math.sin(t),s=Math.sqrt,o=1/3,u=s(o),a=r+(1-r)*o,f=o*(1-r)-u*i,l=o*(1-r)+u*i,c=o*(1-r)+u*i,h=r+o*(1-r),p=o*(1-r)-u*i,d=o*(1-r)-u*i,v=o*(1-r)+u*i,m=r+o*(1-r),g=[a,f,l,0,0,c,h,p,0,0,d,v,m,0,0,0,0,0,1,0];this._loadMatrix(g,n)},t.prototype.contrast=function(t,n){var r=(t||0)+1,i=-0.5*(r-1),s=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.saturate=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0,n=arguments[1],r=t*2/3+1,i=(r-1)*-0.5,s=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(s,n)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(t){var n=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.sepia=function(t){var n=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.technicolor=function(t){var n=[1.9125277891456083,-0.8545344976951645,-0.09155508482755585,0,11.793603434377337,-0.3087833385928097,1.7658908555458428,-0.10601743074722245,0,-70.35205161461398,-0.231103377548616,-0.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.polaroid=function(t){var n=[1.438,-0.062,-0.062,0,0,-0.122,1.378,-0.122,0,0,-0.016,-0.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.toBGR=function(t){var n=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.kodachrome=function(t){var n=[1.1285582396593525,-0.3967382283601348,-0.03992559172921793,0,63.72958762196502,-0.16404339962244616,1.0835251566291304,-0.05498805115633132,0,24.732407896706203,-0.16786010706155763,-0.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.browni=function(t){var n=[.5997023498159715,.34553243048391263,-0.2708298674538042,0,47.43192855600873,-0.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-0.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.vintage=function(t){var n=[.6279345635605994,.3202183420819367,-0.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-0.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.colorTone=function(t,n,r,i,s){t=t||.2,n=n||.15,r=r||16770432,i=i||3375104;var o=(r>>16&255)/255,u=(r>>8&255)/255,a=(r&255)/255,f=(i>>16&255)/255,l=(i>>8&255)/255,c=(i&255)/255,h=[.3,.59,.11,0,0,o,u,a,t,0,f,l,c,n,0,o-f,u-l,a-c,0,0];this._loadMatrix(h,s)},t.prototype.night=function(t,n){t=t||.1;var r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.predator=function(t,n){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,n)},t.prototype.lsd=function(t){var n=[2,-0.4,.5,0,0,-0.5,2,-0.4,0,0,-0.4,-0.5,3,0,0,0,0,0,1,0];this._loadMatrix(n,t)},t.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},r(t,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),t}(s.Filter);n.default=c,c.prototype.grayscale=c.prototype.greyscale},{"../../core":65,path:23}],150:[function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=u(i),o=e("path"),c=function(e){function t(n,r){a(this,t);var i=new s.Matrix;n.renderable=!1;var o=f(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));o.maskSprite=n,o.maskMatrix=i,o.uniforms.mapSampler=n._texture,o.uniforms.filterMatrix=i,o.uniforms.scale={x:1,y:1};if(r===null||r===undefined)r=20;return o.scale=new s.Point(r,r),o}return l(t,e),t.prototype.apply=function(t,n,r){var i=1/r.destinationFrame.width*(r.size.width/n.size.width);this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*i,this.uniforms.scale.y=this.scale.y*i,t.applyFilter(this,n,r)},r(t,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),t}(s.Filter);n.default=c},{"../../core":65,path:23}],151:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core"),i=o(r),s=e("path"),l=function(e){function t(){return u(this,t),a(this,e.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return f(t,e),t}(i.Filter);n.default=l},{"../../core":65,path:23}],152:[function(e,t,n){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./fxaa/FXAAFilter");Object.defineProperty(n,"FXAAFilter",{enumerable:!0,get:function(){return c(r).default}});var i=e("./noise/NoiseFilter");Object.defineProperty(n,"NoiseFilter",{enumerable:!0,get:function(){return c(i).default}});var s=e("./displacement/DisplacementFilter");Object.defineProperty(n,"DisplacementFilter",{enumerable:!0,get:function(){return c(s).default}});var o=e("./blur/BlurFilter");Object.defineProperty(n,"BlurFilter",{enumerable:!0,get:function(){return c(o).default}});var u=e("./blur/BlurXFilter");Object.defineProperty(n,"BlurXFilter",{enumerable:!0,get:function(){return c(u).default}});var a=e("./blur/BlurYFilter");Object.defineProperty(n,"BlurYFilter",{enumerable:!0,get:function(){return c(a).default}});var f=e("./colormatrix/ColorMatrixFilter");Object.defineProperty(n,"ColorMatrixFilter",{enumerable:!0,get:function(){return c(f).default}});var l=e("./void/VoidFilter");Object.defineProperty(n,"VoidFilter",{enumerable:!0,get:function(){return c(l).default}})},{"./blur/BlurFilter":143,"./blur/BlurXFilter":144,"./blur/BlurYFilter":145,"./colormatrix/ColorMatrixFilter":149,"./displacement/DisplacementFilter":150,"./fxaa/FXAAFilter":151,"./noise/NoiseFilter":153,"./void/VoidFilter":154}],153:[function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../../core"),s=u(i),o=e("path"),c=function(e){function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:.5,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Math.random();a(this,t);var i=f(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return i.noise=n,i.seed=r,i}return l(t,e),r(t,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),t}(s.Filter);n.default=c},{"../../core":65,path:23}],154:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core"),i=o(r),s=e("path"),l=function(e){function t(){u(this,t);var n=a(this,e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"));return n.glShaderKey="void",n}return f(t,e),t}(i.Filter);n.default=l},{"../../core":65,path:23}],155:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=o(i),a=function(){function e(){u(this,e),this.global=new s.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return e.prototype.getLocalPosition=function(t,n,r){return t.worldTransform.applyInverse(r||this.global,n)},e.prototype._copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=t.buttons,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},e.prototype._reset=function(){this.isPrimary=!1},r(e,[{key:"pointerId",get:function(){return this.identifier}}]),e}();n.default=a},{"../core":65}],156:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(){r(this,e),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return e.prototype.stopPropagation=function(){this.stopped=!0},e.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},e}();n.default=i},{}],157:[function(e,t,n){"use strict";function m(e){return e&&e.__esModule?e:{"default":e}}function g(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function w(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../core"),s=g(i),o=e("./InteractionData"),u=m(o),a=e("./InteractionEvent"),f=m(a),l=e("./InteractionTrackingData"),c=m(l),h=e("eventemitter3"),p=m(h),d=e("./interactiveTarget"),v=m(d);s.utils.mixins.delayMixin(s.DisplayObject.prototype,v.default);var E="MOUSE",S={target:null,data:{global:null}},x=function(e){function t(n,r){y(this,t);var i=b(this,e.call(this));return r=r||{},i.renderer=n,i.autoPreventDefault=r.autoPreventDefault!==undefined?r.autoPreventDefault:!0,i.interactionFrequency=r.interactionFrequency||10,i.mouse=new u.default,i.mouse.identifier=E,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[E]=i.mouse,i.interactionDataPool=[],i.eventData=new f.default,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.mouseOverRenderer=!1,i.supportsTouchEvents="ontouchstart"in window,i.supportsPointerEvents=!!window.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={"default":"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i._tempPoint=new s.Point,i.resolution=1,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return w(t,e),t.prototype.hitTest=function(t,n){return S.target=null,S.data.global=t,n||(n=this.renderer._lastObjectRendered),this.processInteractive(S,n,null,!0),S.target},t.prototype.setTargetElement=function(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=n,this.addEvents()},t.prototype.addEvents=function(){if(!this.interactionDOMElement)return;s.ticker.shared.add(this.update,this,s.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0},t.prototype.removeEvents=function(){if(!this.interactionDOMElement)return;s.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1},t.prototype.update=function(t){this._deltaTime+=t;if(this._deltaTime<this.interactionFrequency)return;this._deltaTime=0;if(!this.interactionDOMElement)return;if(this.didMove){this.didMove=!1;return}this.cursor=null;for(var n in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(n)){var r=this.activeInteractionData[n];if(r.originalEvent&&r.pointerType!=="touch"){var i=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)},t.prototype.setCursorMode=function(t){t=t||"default";if(this.currentCursorMode===t)return;this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n=="undefined"?"undefined":r(n)){case"string":this.interactionDOMElement.style.cursor=n;break;case"function":n(t);break;case"object":Object.assign(this.interactionDOMElement.style,n)}else typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)},t.prototype.dispatchEvent=function(t,n,r){r.stopped||(r.currentTarget=t,r.type=n,t.emit(n,r),t[n]&&t[n](r))},t.prototype.mapPositionToPoint=function(t,n,r){var i=void 0;this.interactionDOMElement.parentElement?i=this.interactionDOMElement.getBoundingClientRect():i={x:0,y:0,width:0,height:0};var s=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(n-i.left)*(this.interactionDOMElement.width/i.width)*s,t.y=(r-i.top)*(this.interactionDOMElement.height/i.height)*s},t.prototype.processInteractive=function(t,n,r,i,s){if(!n||!n.visible)return!1;var o=t.data.global;s=n.interactive||s;var u=!1,a=s;n.hitArea?a=!1:i&&n._mask&&(n._mask.containsPoint(o)||(i=!1));if(n.interactiveChildren&&n.children){var f=n.children;for(var l=f.length-1;l>=0;l--){var c=f[l],h=this.processInteractive(t,c,r,i,a);if(h){if(!c.parent)continue;a=!1,h&&(t.target&&(i=!1),u=!0)}}}return s&&(i&&!t.target&&(n.hitArea?(n.worldTransform.applyInverse(o,this._tempPoint),n.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(u=!0)):n.containsPoint&&n.containsPoint(o)&&(u=!0)),n.interactive&&(u&&!t.target&&(t.target=n),r&&r(t,n,!!u))),u},t.prototype.onPointerDown=function(t){if(this.supportsTouchEvents&&t.pointerType==="touch")return;var n=this.normalizeToPointerData(t);this.autoPreventDefault&&n[0].isNormalized&&t.preventDefault();var r=n.length;for(var i=0;i<r;i++){var s=n[i],o=this.getInteractionDataForPointerId(s),u=this.configureInteractionEventForDOMEvent(this.eventData,s,o);u.data.originalEvent=t,this.processInteractive(u,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",u);if(s.pointerType==="touch")this.emit("touchstart",u);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;this.emit(a?"rightdown":"mousedown",this.eventData)}}},t.prototype.processPointerDown=function(t,n,r){var i=t.data,s=t.data.identifier;if(r){n.trackedPointers[s]||(n.trackedPointers[s]=new c.default(s)),this.dispatchEvent(n,"pointerdown",t);if(i.pointerType==="touch")this.dispatchEvent(n,"touchstart",t);else if(i.pointerType==="mouse"||i.pointerType==="pen"){var o=i.button===2;o?n.trackedPointers[s].rightDown=!0:n.trackedPointers[s].leftDown=!0,this.dispatchEvent(n,o?"rightdown":"mousedown",t)}}},t.prototype.onPointerComplete=function(t,n,r){var i=this.normalizeToPointerData(t),s=i.length,o=t.target!==this.interactionDOMElement?"outside":"";for(var u=0;u<s;u++){var a=i[u],f=this.getInteractionDataForPointerId(a),l=this.configureInteractionEventForDOMEvent(this.eventData,a,f);l.data.originalEvent=t,this.processInteractive(l,this.renderer._lastObjectRendered,r,n||!o),this.emit(n?"pointercancel":"pointerup"+o,l);if(a.pointerType==="mouse"||a.pointerType==="pen"){var c=a.button===2;this.emit(c?"rightup"+o:"mouseup"+o,l)}else a.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+o,l),this.releaseInteractionDataForPointerId(a.pointerId,f))}},t.prototype.onPointerCancel=function(t){if(this.supportsTouchEvents&&t.pointerType==="touch")return;this.onPointerComplete(t,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(t,n){var r=t.data,i=t.data.identifier;n.trackedPointers[i]!==undefined&&(delete n.trackedPointers[i],this.dispatchEvent(n,"pointercancel",t),r.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",t))},t.prototype.onPointerUp=function(t){if(this.supportsTouchEvents&&t.pointerType==="touch")return;this.onPointerComplete(t,!1,this.processPointerUp)},t.prototype.processPointerUp=function(t,n,r){var i=t.data,s=t.data.identifier,o=n.trackedPointers[s],u=i.pointerType==="touch",a=i.pointerType==="mouse"||i.pointerType==="pen";if(a){var f=i.button===2,l=c.default.FLAGS,h=f?l.RIGHT_DOWN:l.LEFT_DOWN,p=o!==undefined&&o.flags&h;r?(this.dispatchEvent(n,f?"rightup":"mouseup",t),p&&this.dispatchEvent(n,f?"rightclick":"click",t)):p&&this.dispatchEvent(n,f?"rightupoutside":"mouseupoutside",t),o&&(f?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(n,"pointerup",t),u&&this.dispatchEvent(n,"touchend",t),o&&(this.dispatchEvent(n,"pointertap",t),u&&(this.dispatchEvent(n,"tap",t),o.over=!1))):o&&(this.dispatchEvent(n,"pointerupoutside",t),u&&this.dispatchEvent(n,"touchendoutside",t)),o&&o.none&&delete n.trackedPointers[s]},t.prototype.onPointerMove=function(t){if(this.supportsTouchEvents&&t.pointerType==="touch")return;var n=this.normalizeToPointerData(t);n[0].pointerType==="mouse"&&(this.didMove=!0,this.cursor=null);var r=n.length;for(var i=0;i<r;i++){var s=n[i],o=this.getInteractionDataForPointerId(s),u=this.configureInteractionEventForDOMEvent(this.eventData,s,o);u.data.originalEvent=t;var a=s.pointerType==="touch"?this.moveWhenInside:!0;this.processInteractive(u,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",u),s.pointerType==="touch"&&this.emit("touchmove",u),(s.pointerType==="mouse"||s.pointerType==="pen")&&this.emit("mousemove",u)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)},t.prototype.processPointerMove=function(t,n,r){var i=t.data,s=i.pointerType==="touch",o=i.pointerType==="mouse"||i.pointerType==="pen";o&&this.processPointerOverOut(t,n,r);if(!this.moveWhenInside||r)this.dispatchEvent(n,"pointermove",t),s&&this.dispatchEvent(n,"touchmove",t),o&&this.dispatchEvent(n,"mousemove",t)},t.prototype.onPointerOut=function(t){if(this.supportsTouchEvents&&t.pointerType==="touch")return;var n=this.normalizeToPointerData(t),r=n[0];r.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,i);s.data.originalEvent=r,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",s),r.pointerType==="mouse"||r.pointerType==="pen"?this.emit("mouseout",s):this.releaseInteractionDataForPointerId(i.identifier)},t.prototype.processPointerOverOut=function(t,n,r){var i=t.data,s=t.data.identifier,o=i.pointerType==="mouse"||i.pointerType==="pen",u=n.trackedPointers[s];r&&!u&&(u=n.trackedPointers[s]=new c.default(s));if(u===undefined)return;r&&this.mouseOverRenderer?(u.over||(u.over=!0,this.dispatchEvent(n,"pointerover",t),o&&this.dispatchEvent(n,"mouseover",t)),o&&this.cursor===null&&(this.cursor=n.cursor)):u.over&&(u.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),o&&this.dispatchEvent(n,"mouseout",t),u.none&&delete n.trackedPointers[s])},t.prototype.onPointerOver=function(t){var n=this.normalizeToPointerData(t),r=n[0],i=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,i);s.data.originalEvent=r,r.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",s),(r.pointerType==="mouse"||r.pointerType==="pen")&&this.emit("mouseover",s)},t.prototype.getInteractionDataForPointerId=function(t){var n=t.pointerId,r=void 0;return n===E||t.pointerType==="mouse"?r=this.mouse:this.activeInteractionData[n]?r=this.activeInteractionData[n]:(r=this.interactionDataPool.pop()||new u.default,r.identifier=n,this.activeInteractionData[n]=r),r._copyEvent(t),r},t.prototype.releaseInteractionDataForPointerId=function(t){var n=this.activeInteractionData[t];n&&(delete this.activeInteractionData[t],n._reset(),this.interactionDataPool.push(n))},t.prototype.configureInteractionEventForDOMEvent=function(t,n,r){return t.data=r,this.mapPositionToPoint(r.global,n.clientX,n.clientY),navigator.isCocoonJS&&n.pointerType==="touch"&&(r.global.x=r.global.x/this.resolution,r.global.y=r.global.y/this.resolution),n.pointerType==="touch"&&(n.globalX=r.global.x,n.globalY=r.global.y),r.originalEvent=n,t._reset(),t},t.prototype.normalizeToPointerData=function(t){var n=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,i=t.changedTouches.length;r<i;r++){var s=t.changedTouches[r];typeof s.button=="undefined"&&(s.button=t.touches.length?1:0),typeof s.buttons=="undefined"&&(s.buttons=t.touches.length?1:0),typeof s.isPrimary=="undefined"&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof s.width=="undefined"&&(s.width=s.radiusX||1),typeof s.height=="undefined"&&(s.height=s.radiusY||1),typeof s.tiltX=="undefined"&&(s.tiltX=0),typeof s.tiltY=="undefined"&&(s.tiltY=0),typeof s.pointerType=="undefined"&&(s.pointerType="touch"),typeof s.pointerId=="undefined"&&(s.pointerId=s.identifier||0),typeof s.pressure=="undefined"&&(s.pressure=s.force||.5),s.twist=0,s.tangentialPressure=0,typeof s.layerX=="undefined"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY=="undefined"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,n.push(s)}else!(t instanceof MouseEvent)||!!this.supportsPointerEvents&&t instanceof window.PointerEvent?n.push(t):(typeof t.isPrimary=="undefined"&&(t.isPrimary=!0),typeof t.width=="undefined"&&(t.width=1),typeof t.height=="undefined"&&(t.height=1),typeof t.tiltX=="undefined"&&(t.tiltX=0),typeof t.tiltY=="undefined"&&(t.tiltY=0),typeof t.pointerType=="undefined"&&(t.pointerType="mouse"),typeof t.pointerId=="undefined"&&(t.pointerId=E),typeof t.pressure=="undefined"&&(t.pressure=.5),t.twist=0,t.tangentialPressure=0,t.isNormalized=!0,n.push(t));return n},t.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},t}(p.default);n.default=x,s.WebGLRenderer.registerPlugin("interaction",x),s.CanvasRenderer.registerPlugin("interaction",x)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t){i(this,e),this._pointerId=t,this._flags=e.FLAGS.NONE}return e.prototype._doSet=function(t,n){n?this._flags=this._flags|t:this._flags=this._flags&~t},r(e,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return(this._flags&this.constructor.FLAGS.OVER)!==0},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return(this._flags&this.constructor.FLAGS.RIGHT_DOWN)!==0},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return(this._flags&this.constructor.FLAGS.LEFT_DOWN)!==0},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),e}();n.default=s,s.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./InteractionData");Object.defineProperty(n,"InteractionData",{enumerable:!0,get:function(){return a(r).default}});var i=e("./InteractionManager");Object.defineProperty(n,"InteractionManager",{enumerable:!0,get:function(){return a(i).default}});var s=e("./interactiveTarget");Object.defineProperty(n,"interactiveTarget",{enumerable:!0,get:function(){return a(s).default}});var o=e("./InteractionTrackingData");Object.defineProperty(n,"InteractionTrackingData",{enumerable:!0,get:function(){return a(o).default}});var u=e("./InteractionEvent");Object.defineProperty(n,"InteractionEvent",{enumerable:!0,get:function(){return a(u).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(e,t,n){"use strict";n.__esModule=!0,n.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(e){e?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===undefined&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:undefined}},{}],161:[function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){e.bitmapFont=u.BitmapText.registerFont(e.data,t)}n.__esModule=!0,n.parse=f,n.default=function(){return function(t,n){if(!t.data||t.type!==o.Resource.TYPE.XML){n();return}if(t.data.getElementsByTagName("page").length===0||t.data.getElementsByTagName("info").length===0||t.data.getElementsByTagName("info")[0].getAttribute("face")===null){n();return}var r=t.isDataUrl?"":i.dirname(t.url);t.isDataUrl&&(r==="."&&(r=""),this.baseUrl&&r&&this.baseUrl.charAt(this.baseUrl.length-1)==="/"&&(r+="/")),r=r.replace(this.baseUrl,""),r&&r.charAt(r.length-1)!=="/"&&(r+="/");var u=r+t.data.getElementsByTagName("page")[0].getAttribute("file");if(s.utils.TextureCache[u])f(t,s.utils.TextureCache[u]),n();else{var a={crossOrigin:t.crossOrigin,loadType:o.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t};this.add(t.name+"_image",u,a,function(e){f(t,e.texture),n()})}}};var r=e("path"),i=a(r),s=e("../core"),o=e("resource-loader"),u=e("../extras")},{"../core":65,"../extras":141,path:23,"resource-loader":36}],162:[function(e,t,n){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.shared=n.Resource=n.textureParser=n.getResourcePath=n.spritesheetParser=n.parseBitmapFontData=n.bitmapFontParser=n.Loader=undefined;var r=e("./bitmapFontParser");Object.defineProperty(n,"bitmapFontParser",{enumerable:!0,get:function(){return c(r).default}}),Object.defineProperty(n,"parseBitmapFontData",{enumerable:!0,get:function(){return r.parse}});var i=e("./spritesheetParser");Object.defineProperty(n,"spritesheetParser",{enumerable:!0,get:function(){return c(i).default}}),Object.defineProperty(n,"getResourcePath",{enumerable:!0,get:function(){return i.getResourcePath}});var s=e("./textureParser");Object.defineProperty(n,"textureParser",{enumerable:!0,get:function(){return c(s).default}});var o=e("resource-loader");Object.defineProperty(n,"Resource",{enumerable:!0,get:function(){return o.Resource}});var u=e("../core/Application"),a=c(u),f=e("./loader"),l=c(f);n.Loader=l.default;var h=new l.default;h.destroy=function(){},n.shared=h;var p=a.default.prototype;p._loader=null,Object.defineProperty(p,"loader",{get:function(){if(!this._loader){var t=this._options.sharedLoader;this._loader=t?h:new l.default}return this._loader}}),p._parentDestroy=p.destroy,p.destroy=function(t){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(e,t,n){"use strict";function d(e){return e&&e.__esModule?e:{"default":e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function g(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("resource-loader"),i=d(r),s=e("resource-loader/lib/middlewares/parsing/blob"),o=e("eventemitter3"),u=d(o),a=e("./textureParser"),f=d(a),l=e("./spritesheetParser"),c=d(l),h=e("./bitmapFontParser"),p=d(h),y=function(e){function t(n,r){v(this,t);var i=m(this,e.call(this,n,r));u.default.call(i);for(var s=0;s<t._pixiMiddleware.length;++s)i.use(t._pixiMiddleware[s]());return i.onStart.add(function(e){return i.emit("start",e)}),i.onProgress.add(function(e,t){return i.emit("progress",e,t)}),i.onError.add(function(e,t,n){return i.emit("error",e,t,n)}),i.onLoad.add(function(e,t){return i.emit("load",e,t)}),i.onComplete.add(function(e,t){return i.emit("complete",e,t)}),i}return g(t,e),t.addPixiMiddleware=function(n){t._pixiMiddleware.push(n)},t.prototype.destroy=function(){this.removeAllListeners(),this.reset()},t}(i.default);n.default=y;for(var b in u.default.prototype)y.prototype[b]=u.default.prototype[b];y._pixiMiddleware=[s.blobMiddlewareFactory,f.default,c.default,p.default];var w=i.default.Resource;w.setExtensionXhrType("fnt",w.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){return e.isDataUrl?e.data.meta.image:s.default.resolve(e.url.replace(t,""),e.data.meta.image)}n.__esModule=!0,n.default=function(){return function(t,n){var i=t.name+"_image";if(!t.data||t.type!==r.Resource.TYPE.JSON||!t.data.frames||this.resources[i]){n();return}var s={crossOrigin:t.crossOrigin,loadType:r.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t},u=a(t,this.baseUrl);this.add(i,u,s,function(r){var i=new o.Spritesheet(r.texture.baseTexture,t.data,t.url);i.parse(function(){t.spritesheet=i,t.textures=i.textures,n()})})}},n.getResourcePath=a;var r=e("resource-loader"),i=e("url"),s=u(i),o=e("../core")},{"../core":65,"resource-loader":36,url:29}],165:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.default=function(){return function(t,n){t.data&&t.type===r.Resource.TYPE.IMAGE&&(t.texture=s.default.fromLoader(t.data,t.url,t.name)),n()}};var r=e("resource-loader"),i=e("../core/textures/Texture"),s=o(i)},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function f(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function h(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=f(i),o=e("../extras/TextureTransform"),u=a(o),p=new s.Point,d=new s.Polygon,v=function(e){function t(n,r,i,o,a){l(this,t);var f=c(this,e.call(this));return f._texture=n,f.uvs=i||new Float32Array([0,0,1,0,1,1,0,1]),f.vertices=r||new Float32Array([0,0,100,0,100,100,0,100]),f.indices=o||new Uint16Array([0,1,3,2]),f.dirty=0,f.indexDirty=0,f.blendMode=s.BLEND_MODES.NORMAL,f.canvasPadding=0,f.drawMode=a||t.DRAW_MODES.TRIANGLE_MESH,f.shader=null,f.tintRgb=new Float32Array([1,1,1]),f._glDatas={},f._uvTransform=new u.default(n),f.uploadUvTransform=!1,f.pluginName="mesh",f}return h(t,e),t.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},t.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},t.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},t.prototype.refresh=function(t){this._uvTransform.update(t)&&this._refresh()},t.prototype._refresh=function(){},t.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},t.prototype.containsPoint=function(n){if(!this.getBounds().contains(n.x,n.y))return!1;this.worldTransform.applyInverse(n,p);var r=this.vertices,i=d.points,s=this.indices,o=this.indices.length,u=this.drawMode===t.DRAW_MODES.TRIANGLES?3:1;for(var a=0;a+2<o;a+=u){var f=s[a]*2,l=s[a+1]*2,c=s[a+2]*2;i[0]=r[f],i[1]=r[f+1],i[2]=r[l],i[3]=r[l+1],i[4]=r[c],i[5]=r[c+1];if(d.contains(p.x,p.y))return!0}return!1},r(t,[{key:"texture",get:function(){return this._texture},set:function(t){if(this._texture===t)return;this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this))}},{key:"tint",get:function(){return s.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=s.utils.hex2rgb(t,this.tintRgb)}}]),t}(s.Container);n.default=v,v.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../extras/TextureTransform":136}],167:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function f(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./Plane"),s=o(i),l=10,c=function(e){function t(n,r,i,s,o){u(this,t);var f=a(this,e.call(this,n,4,4));return f._origWidth=n.orig.width,f._origHeight=n.orig.height,f._width=f._origWidth,f._height=f._origHeight,f.leftWidth=typeof r!="undefined"?r:l,f.rightWidth=typeof s!="undefined"?s:l,f.topHeight=typeof i!="undefined"?i:l,f.bottomHeight=typeof o!="undefined"?o:l,f.refresh(!0),f}return f(t,e),t.prototype.updateHorizontalVertices=function(){var t=this.vertices;t[9]=t[11]=t[13]=t[15]=this._topHeight,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight,t[25]=t[27]=t[29]=t[31]=this._height},t.prototype.updateVerticalVertices=function(){var t=this.vertices;t[2]=t[10]=t[18]=t[26]=this._leftWidth,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth,t[6]=t[14]=t[22]=t[30]=this._width},t.prototype._renderCanvas=function(t){var n=t.context;n.globalAlpha=this.worldAlpha;var r=this.worldTransform,i=t.resolution;t.roundPixels?n.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i|0,r.ty*i|0):n.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i);var s=this._texture.baseTexture,o=s.source,u=s.width,a=s.height;this.drawSegment(n,o,u,a,0,1,10,11),this.drawSegment(n,o,u,a,2,3,12,13),this.drawSegment(n,o,u,a,4,5,14,15),this.drawSegment(n,o,u,a,8,9,18,19),this.drawSegment(n,o,u,a,10,11,20,21),this.drawSegment(n,o,u,a,12,13,22,23),this.drawSegment(n,o,u,a,16,17,26,27),this.drawSegment(n,o,u,a,18,19,28,29),this.drawSegment(n,o,u,a,20,21,30,31)},t.prototype.drawSegment=function(t,n,r,i,s,o,u,a){var f=this.uvs,l=this.vertices,c=(f[u]-f[s])*r,h=(f[a]-f[o])*i,p=l[u]-l[s],d=l[a]-l[o];c<1&&(c=1),h<1&&(h=1),p<1&&(p=1),d<1&&(d=1),t.drawImage(n,f[s]*r,f[o]*i,c,h,l[s],l[o],p,d)},t.prototype._refresh=function(){e.prototype._refresh.call(this);var n=this.uvs,r=this._texture;this._origWidth=r.orig.width,this._origHeight=r.orig.height;var i=1/this._origWidth,s=1/this._origHeight;n[0]=n[8]=n[16]=n[24]=0,n[1]=n[3]=n[5]=n[7]=0,n[6]=n[14]=n[22]=n[30]=1,n[25]=n[27]=n[29]=n[31]=1,n[2]=n[10]=n[18]=n[26]=i*this._leftWidth,n[4]=n[12]=n[20]=n[28]=1-i*this._rightWidth,n[9]=n[11]=n[13]=n[15]=s*this._topHeight,n[17]=n[19]=n[21]=n[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},r(t,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),t}(s.default);n.default=c},{"./Plane":168}],168:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./Mesh"),i=s(r),f=function(e){function t(n,r,s){o(this,t);var a=u(this,e.call(this,n));return a._ready=!0,a.verticesX=r||10,a.verticesY=s||10,a.drawMode=i.default.DRAW_MODES.TRIANGLES,a.refresh(),a}return a(t,e),t.prototype._refresh=function(){var t=this._texture,n=this.verticesX*this.verticesY,r=[],i=[],s=[],o=[],u=this.verticesX-1,a=this.verticesY-1,f=t.width/u,l=t.height/a;for(var c=0;c<n;c++){var h=c%this.verticesX,p=c/this.verticesX|0;r.push(h*f,p*l),s.push(h/u,p/a)}var d=u*a;for(var v=0;v<d;v++){var m=v%u,g=v/u|0,y=g*this.verticesX+m,b=g*this.verticesX+m+1,w=(g+1)*this.verticesX+m,E=(g+1)*this.verticesX+m+1;o.push(y,b,w),o.push(b,E,w)}this.vertices=new Float32Array(r),this.uvs=new Float32Array(s),this.colors=new Float32Array(i),this.indices=new Uint16Array(o),this.indexDirty++,this.multiplyUvs()},t.prototype._onTextureUpdate=function(){i.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},t}(i.default);n.default=f},{"./Mesh":166}],169:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("./Mesh"),i=s(r),f=function(e){function t(n,r){o(this,t);var i=u(this,e.call(this,n));return i.points=r,i.vertices=new Float32Array(r.length*4),i.uvs=new Float32Array(r.length*4),i.colors=new Float32Array(r.length*2),i.indices=new Uint16Array(r.length*2),i.autoUpdate=!0,i.refresh(),i}return a(t,e),t.prototype._refresh=function(){var t=this.points;if(t.length<1||!this._texture._uvs)return;this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(t.length*4),this.uvs=new Float32Array(t.length*4),this.colors=new Float32Array(t.length*2),this.indices=new Uint16Array(t.length*2));var n=this.uvs,r=this.indices,i=this.colors;n[0]=0,n[1]=0,n[2]=0,n[3]=1,i[0]=1,i[1]=1,r[0]=0,r[1]=1;var s=t.length;for(var o=1;o<s;o++){var u=o*4,a=o/(s-1);n[u]=a,n[u+1]=0,n[u+2]=a,n[u+3]=1,u=o*2,i[u]=1,i[u+1]=1,u=o*2,r[u]=u,r[u+1]=u+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()},t.prototype.refreshVertices=function(){var t=this.points;if(t.length<1)return;var n=t[0],r=void 0,i=0,s=0,o=this.vertices,u=t.length;for(var a=0;a<u;a++){var f=t[a],l=a*4;a<t.length-1?r=t[a+1]:r=f,s=-(r.x-n.x),i=r.y-n.y;var c=(1-a/(u-1))*10;c>1&&(c=1);var h=Math.sqrt(i*i+s*s),p=this._texture.height/2;i/=h,s/=h,i*=p,s*=p,o[l]=f.x+i,o[l+1]=f.y+s,o[l+2]=f.x-i,o[l+3]=f.y-s,n=f}},t.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},t}(i.default);n.default=f},{"./Mesh":166}],170:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("../../core"),i=a(r),s=e("../Mesh"),o=u(s),l=function(){function e(t){f(this,e),this.renderer=t}return e.prototype.render=function(t){var n=this.renderer,r=n.context,i=t.worldTransform,s=n.resolution;n.roundPixels?r.setTransform(i.a*s,i.b*s,i.c*s,i.d*s,i.tx*s|0,i.ty*s|0):r.setTransform(i.a*s,i.b*s,i.c*s,i.d*s,i.tx*s,i.ty*s),n.setBlendMode(t.blendMode),t.drawMode===o.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},e.prototype._renderTriangleMesh=function(t){var n=t.vertices.length/2;for(var r=0;r<n-2;r++){var i=r*2;this._renderDrawTriangle(t,i,i+2,i+4)}},e.prototype._renderTriangles=function(t){var n=t.indices,r=n.length;for(var i=0;i<r;i+=3){var s=n[i]*2,o=n[i+1]*2,u=n[i+2]*2;this._renderDrawTriangle(t,s,o,u)}},e.prototype._renderDrawTriangle=function(t,n,r,i){var s=this.renderer.context,o=t.uvs,u=t.vertices,a=t._texture;if(!a.valid)return;var f=a.baseTexture,l=f.source,c=f.width,h=f.height,p=void 0,d=void 0,v=void 0,m=void 0,g=void 0,y=void 0;if(t.uploadUvTransform){var b=t._uvTransform.mapCoord;p=(o[n]*b.a+o[n+1]*b.c+b.tx)*f.width,d=(o[r]*b.a+o[r+1]*b.c+b.tx)*f.width,v=(o[i]*b.a+o[i+1]*b.c+b.tx)*f.width,m=(o[n]*b.b+o[n+1]*b.d+b.ty)*f.height,g=(o[r]*b.b+o[r+1]*b.d+b.ty)*f.height,y=(o[i]*b.b+o[i+1]*b.d+b.ty)*f.height}else p=o[n]*f.width,d=o[r]*f.width,v=o[i]*f.width,m=o[n+1]*f.height,g=o[r+1]*f.height,y=o[i+1]*f.height;var w=u[n],E=u[r],S=u[i],x=u[n+1],T=u[r+1],N=u[i+1];if(t.canvasPadding>0){var C=t.canvasPadding/t.worldTransform.a,k=t.canvasPadding/t.worldTransform.d,L=(w+E+S)/3,A=(x+T+N)/3,O=w-L,M=x-A,_=Math.sqrt(O*O+M*M);w=L+O/_*(_+C),x=A+M/_*(_+k),O=E-L,M=T-A,_=Math.sqrt(O*O+M*M),E=L+O/_*(_+C),T=A+M/_*(_+k),O=S-L,M=N-A,_=Math.sqrt(O*O+M*M),S=L+O/_*(_+C),N=A+M/_*(_+k)}s.save(),s.beginPath(),s.moveTo(w,x),s.lineTo(E,T),s.lineTo(S,N),s.closePath(),s.clip();var D=p*g+m*v+d*y-g*v-m*d-p*y,P=w*g+m*S+E*y-g*S-m*E-w*y,H=p*E+w*v+d*S-E*v-w*d-p*S,B=p*g*S+m*E*v+w*d*y-w*g*v-m*d*S-p*E*y,j=x*g+m*N+T*y-g*N-m*T-x*y,F=p*T+x*v+d*N-T*v-x*d-p*N,I=p*g*N+m*T*v+x*d*y-x*g*v-m*d*N-p*T*y;s.transform(P/D,j/D,H/D,F/D,B/D,I/D),s.drawImage(l,0,0,c*f.resolution,h*f.resolution,0,0,c,h),s.restore(),this.renderer.invalidateBlendMode()},e.prototype.renderMeshFlat=function(t){var n=this.renderer.context,r=t.vertices,i=r.length/2;n.beginPath();for(var s=1;s<i-2;++s){var o=s*2,u=r[o],a=r[o+1],f=r[o+2],l=r[o+3],c=r[o+4],h=r[o+5];n.moveTo(u,a),n.lineTo(f,l),n.lineTo(c,h)}n.fillStyle="#FF0000",n.fill(),n.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();n.default=l,i.CanvasRenderer.registerPlugin("mesh",l)},{"../../core":65,"../Mesh":166}],171:[function(e,t,n){"use strict";function f(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./Mesh");Object.defineProperty(n,"Mesh",{enumerable:!0,get:function(){return f(r).default}});var i=e("./webgl/MeshRenderer");Object.defineProperty(n,"MeshRenderer",{enumerable:!0,get:function(){return f(i).default}});var s=e("./canvas/CanvasMeshRenderer");Object.defineProperty(n,"CanvasMeshRenderer",{enumerable:!0,get:function(){return f(s).default}});var o=e("./Plane");Object.defineProperty(n,"Plane",{enumerable:!0,get:function(){return f(o).default}});var u=e("./NineSlicePlane");Object.defineProperty(n,"NineSlicePlane",{enumerable:!0,get:function(){return f(u).default}});var a=e("./Rope");Object.defineProperty(n,"Rope",{enumerable:!0,get:function(){return f(a).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core"),i=c(r),s=e("pixi-gl-core"),o=l(s),u=e("../Mesh"),a=l(u),f=e("path"),v=i.Matrix.IDENTITY,m=function(e){function t(n){h(this,t);var r=p(this,e.call(this,n));return r.shader=null,r}return d(t,e),t.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new i.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},t.prototype.render=function(t){var n=this.renderer,r=n.gl,s=t._texture;if(!s.valid)return;var u=t._glDatas[n.CONTEXT_UID];u||(n.bindVao(null),u={shader:this.shader,vertexBuffer:o.default.GLBuffer.createVertexBuffer(r,t.vertices,r.STREAM_DRAW),uvBuffer:o.default.GLBuffer.createVertexBuffer(r,t.uvs,r.STREAM_DRAW),indexBuffer:o.default.GLBuffer.createIndexBuffer(r,t.indices,r.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty},u.vao=(new o.default.VertexArrayObject(r)).addIndex(u.indexBuffer).addAttribute(u.vertexBuffer,u.shader.attributes.aVertexPosition,r.FLOAT,!1,8,0).addAttribute(u.uvBuffer,u.shader.attributes.aTextureCoord,r.FLOAT,!1,8,0),t._glDatas[n.CONTEXT_UID]=u),n.bindVao(u.vao),t.dirty!==u.dirty&&(u.dirty=t.dirty,u.uvBuffer.upload(t.uvs)),t.indexDirty!==u.indexDirty&&(u.indexDirty=t.indexDirty,u.indexBuffer.upload(t.indices)),u.vertexBuffer.upload(t.vertices),n.bindShader(u.shader),u.shader.uniforms.uSampler=n.bindTexture(s),n.state.setBlendMode(i.utils.correctBlendMode(t.blendMode,s.baseTexture.premultipliedAlpha)),u.shader.uniforms.uTransform&&(t.uploadUvTransform?u.shader.uniforms.uTransform=t._uvTransform.mapCoord.toArray(!0):u.shader.uniforms.uTransform=v.toArray(!0)),u.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),u.shader.uniforms.uColor=i.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,u.shader.uniforms.uColor,s.baseTexture.premultipliedAlpha);var f=t.drawMode===a.default.DRAW_MODES.TRIANGLE_MESH?r.TRIANGLE_STRIP:r.TRIANGLES;u.vao.draw(f,t.indices.length,0)},t}(i.ObjectRenderer);n.default=m,i.WebGLRenderer.registerPlugin("mesh",m)},{"../../core":65,"../Mesh":166,path:23,"pixi-gl-core":12}],173:[function(e,t,n){"use strict";function u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function l(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../core"),s=u(i),o=e("../core/utils"),c=function(e){function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1500,r=arguments[1],i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:16384,o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;a(this,t);var u=f(this,e.call(this)),l=16384;return i>l&&(i=l),i>n&&(i=n),u._properties=[!1,!0,!1,!1,!1],u._maxSize=n,u._batchSize=i,u._glBuffers={},u._bufferToUpdate=0,u.interactiveChildren=!1,u.blendMode=s.BLEND_MODES.NORMAL,u.autoResize=o,u.roundPixels=!0,u.baseTexture=null,u.setProperties(r),u._tint=0,u.tintRgb=new Float32Array(4),u.tint=16777215,u}return l(t,e),t.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t||"tint"in t?!!t.alpha||!!t.tint:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},t.prototype.renderWebGL=function(t){var n=this;if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable)return;this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this)},t.prototype.onChildrenChange=function(t){var n=Math.floor(t/this._batchSize);n<this._bufferToUpdate&&(this._bufferToUpdate=n)},t.prototype.renderCanvas=function(t){if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable)return;var n=t.context,r=this.worldTransform,i=!0,s=0,o=0,u=0,a=0;t.setBlendMode(this.blendMode),n.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var f=0;f<this.children.length;++f){var l=this.children[f];if(!l.visible)continue;var c=l._texture.frame;n.globalAlpha=this.worldAlpha*l.alpha;if(l.rotation%(Math.PI*2)===0)i&&(n.setTransform(r.a,r.b,r.c,r.d,r.tx*t.resolution,r.ty*t.resolution),i=!1),s=l.anchor.x*-c.width*l.scale.x+l.position.x+.5,o=l.anchor.y*-c.height*l.scale.y+l.position.y+.5,u=c.width*l.scale.x,a=c.height*l.scale.y;else{i||(i=!0),l.displayObjectUpdateTransform();var h=l.worldTransform;t.roundPixels?n.setTransform(h.a,h.b,h.c,h.d,h.tx*t.resolution|0,h.ty*t.resolution|0):n.setTransform(h.a,h.b,h.c,h.d,h.tx*t.resolution,h.ty*t.resolution),s=l.anchor.x*-c.width+.5,o=l.anchor.y*-c.height+.5,u=c.width,a=c.height}var p=l._texture.baseTexture.resolution;n.drawImage(l._texture.baseTexture.source,c.x*p,c.y*p,c.width*p,c.height*p,s*t.resolution,o*t.resolution,u*t.resolution,a*t.resolution)}},t.prototype.destroy=function(n){e.prototype.destroy.call(this,n);if(this._buffers)for(var r=0;r<this._buffers.length;++r)this._buffers[r].destroy();this._properties=null,this._buffers=null},r(t,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,o.hex2rgb)(t,this.tintRgb)}}]),t}(s.Container);n.default=c},{"../core":65,"../core/utils":124}],174:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./ParticleContainer");Object.defineProperty(n,"ParticleContainer",{enumerable:!0,get:function(){return s(r).default}});var i=e("./webgl/ParticleRenderer");Object.defineProperty(n,"ParticleRenderer",{enumerable:!0,get:function(){return s(i).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var r=e("pixi-gl-core"),i=u(r),s=e("../../core/utils/createIndicesForQuads"),o=u(s),f=function(){function e(t,n,r,i){a(this,e),this.gl=t,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<n.length;++s){var o=n[s];o={attribute:o.attribute,size:o.size,uploadFunction:o.uploadFunction,unsignedByte:o.unsignedByte,offset:o.offset},r[s]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.initBuffers()}return e.prototype.initBuffers=function(){var t=this.gl,n=0;this.indices=(0,o.default)(this.size),this.indexBuffer=i.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var s=this.dynamicProperties[r];s.offset=n,n+=s.size,this.dynamicStride+=s.size}var u=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(u),this.dynamicDataUint32=new Uint32Array(u),this.dynamicBuffer=i.default.GLBuffer.createVertexBuffer(t,u,t.STREAM_DRAW);var a=0;this.staticStride=0;for(var f=0;f<this.staticProperties.length;++f){var l=this.staticProperties[f];l.offset=a,a+=l.size,this.staticStride+=l.size}var c=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(c),this.staticDataUint32=new Uint32Array(c),this.staticBuffer=i.default.GLBuffer.createVertexBuffer(t,c,t.STATIC_DRAW),this.vao=(new i.default.VertexArrayObject(t)).addIndex(this.indexBuffer);for(var h=0;h<this.dynamicProperties.length;++h){var p=this.dynamicProperties[h];p.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,p.attribute,t.UNSIGNED_BYTE,!0,this.dynamicStride*4,p.offset*4):this.vao.addAttribute(this.dynamicBuffer,p.attribute,t.FLOAT,!1,this.dynamicStride*4,p.offset*4)}for(var d=0;d<this.staticProperties.length;++d){var v=this.staticProperties[d];v.unsignedByte?this.vao.addAttribute(this.staticBuffer,v.attribute,t.UNSIGNED_BYTE,!0,this.staticStride*4,v.offset*4):this.vao.addAttribute(this.staticBuffer,v.attribute,t.FLOAT,!1,this.staticStride*4,v.offset*4)}},e.prototype.uploadDynamic=function(t,n,r){for(var i=0;i<this.dynamicProperties.length;i++){var s=this.dynamicProperties[i];s.uploadFunction(t,n,r,s.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer.upload()},e.prototype.uploadStatic=function(t,n,r){for(var i=0;i<this.staticProperties.length;i++){var s=this.staticProperties[i];s.uploadFunction(t,n,r,s.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer.upload()},e.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()},e}();n.default=f},{"../../core/utils/createIndicesForQuads":122,"pixi-gl-core":12}],176:[function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function d(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core"),i=c(r),s=e("./ParticleShader"),o=l(s),u=e("./ParticleBuffer"),a=l(u),f=e("../../core/utils"),v=function(e){function t(n){h(this,t);var r=p(this,e.call(this,n));return r.shader=null,r.indexBuffer=null,r.properties=null,r.tempMatrix=new i.Matrix,r.CONTEXT_UID=0,r}return d(t,e),t.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new o.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},t.prototype.start=function(){this.renderer.bindShader(this.shader)},t.prototype.render=function(t){var n=t.children,r=t._maxSize,s=t._batchSize,o=this.renderer,u=n.length;if(u===0)return;u>r&&(u=r);var a=t._glBuffers[o.CONTEXT_UID];a||(a=t._glBuffers[o.CONTEXT_UID]=this.generateBuffers(t));var f=n[0]._texture.baseTexture;this.renderer.setBlendMode(i.utils.correctBlendMode(t.blendMode,f.premultipliedAlpha));var l=o.gl,c=t.worldTransform.copy(this.tempMatrix);c.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=c.toArray(!0),this.shader.uniforms.uColor=i.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f.premultipliedAlpha),this.shader.uniforms.uSampler=o.bindTexture(f);for(var h=0,p=0;h<u;h+=s,p+=1){var d=u-h;d>s&&(d=s);if(p>=a.length){if(!t.autoResize)break;a.push(this._generateOneMoreBuffer(t))}var v=a[p];v.uploadDynamic(n,h,d),t._bufferToUpdate===p&&(v.uploadStatic(n,h,d),t._bufferToUpdate=p+1),o.bindVao(v.vao),v.vao.draw(l.TRIANGLES,d*6)}},t.prototype.generateBuffers=function(t){var n=this.renderer.gl,r=[],i=t._maxSize,s=t._batchSize,o=t._properties;for(var u=0;u<i;u+=s)r.push(new a.default(n,this.properties,o,s));return r},t.prototype._generateOneMoreBuffer=function(t){var n=this.renderer.gl,r=t._batchSize,i=t._properties;return new a.default(n,this.properties,i,r)},t.prototype.uploadVertices=function(t,n,r,i,s,o){var u=0,a=0,f=0,l=0;for(var c=0;c<r;++c){var h=t[n+c],p=h._texture,d=h.scale.x,v=h.scale.y,m=p.trim,g=p.orig;m?(a=m.x-h.anchor.x*g.width,u=a+m.width,l=m.y-h.anchor.y*g.height,f=l+m.height):(u=g.width*(1-h.anchor.x),a=g.width*-h.anchor.x,f=g.height*(1-h.anchor.y),l=g.height*-h.anchor.y),i[o]=a*d,i[o+1]=l*v,i[o+s]=u*d,i[o+s+1]=l*v,i[o+s*2]=u*d,i[o+s*2+1]=f*v,i[o+s*3]=a*d,i[o+s*3+1]=f*v,o+=s*4}},t.prototype.uploadPosition=function(t,n,r,i,s,o){for(var u=0;u<r;u++){var a=t[n+u].position;i[o]=a.x,i[o+1]=a.y,i[o+s]=a.x,i[o+s+1]=a.y,i[o+s*2]=a.x,i[o+s*2+1]=a.y,i[o+s*3]=a.x,i[o+s*3+1]=a.y,o+=s*4}},t.prototype.uploadRotation=function(t,n,r,i,s,o){for(var u=0;u<r;u++){var a=t[n+u].rotation;i[o]=a,i[o+s]=a,i[o+s*2]=a,i[o+s*3]=a,o+=s*4}},t.prototype.uploadUvs=function(t,n,r,i,s,o){for(var u=0;u<r;++u){var a=t[n+u]._texture._uvs;a?(i[o]=a.x0,i[o+1]=a.y0,i[o+s]=a.x1,i[o+s+1]=a.y1,i[o+s*2]=a.x2,i[o+s*2+1]=a.y2,i[o+s*3]=a.x3,i[o+s*3+1]=a.y3,o+=s*4):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+s*2]=0,i[o+s*2+1]=0,i[o+s*3]=0,i[o+s*3+1]=0,o+=s*4)}},t.prototype.uploadTint=function(t,n,r,i,s,o){for(var u=0;u<r;++u){var a=t[n+u],l=a._texture.baseTexture.premultipliedAlpha,c=a.alpha,h=c<1&&l?(0,f.premultiplyTint)(a._tintRGB,c):a._tintRGB+(c*255<<24);i[o]=h,i[o+s]=h,i[o+s*2]=h,i[o+s*3]=h,o+=s*4}},t.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),e.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},t}(i.ObjectRenderer);n.default=v,i.WebGLRenderer.registerPlugin("particle",v)},{"../../core":65,"../../core/utils":124,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function a(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.__esModule=!0;var r=e("../../core/Shader"),i=s(r),f=function(e){function t(n){return o(this,t),u(this,e.call(this,n,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n")))}return a(t,e),t}(i.default);n.default=f},{"../../core/Shader":44}],178:[function(e,t,n){"use strict";Math.sign||(Math.sign=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1})},{}],179:[function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("object-assign"),i=s(r);Object.assign||(Object.assign=i.default)},{"object-assign":5}],180:[function(e,t,n){"use strict";e("./Object.assign"),e("./requestAnimationFrame"),e("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Object.assign":179,"./requestAnimationFrame":181}],181:[function(e,t,n){(function(e){"use strict";var t=16;if(!Date.now||!Date.prototype.getTime)Date.now=function(){return(new Date).getTime()};if(!e.performance||!e.performance.now){var n=Date.now();e.performance||(e.performance={}),e.performance.now=function(){return Date.now()-n}}var r=Date.now(),i=["ms","moz","webkit","o"];for(var s=0;s<i.length&&!e.requestAnimationFrame;++s){var o=i[s];e.requestAnimationFrame=e[o+"RequestAnimationFrame"],e.cancelAnimationFrame=e[o+"CancelAnimationFrame"]||e[o+"CancelRequestAnimationFrame"]}e.requestAnimationFrame||(e.requestAnimationFrame=function(e){if(typeof e!="function")throw new TypeError(e+"is not a function");var n=Date.now(),i=t+r-n;return i<0&&(i=0),r=n,setTimeout(function(){r=Date.now(),e(performance.now())},i)}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){return clearTimeout(e)})}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],182:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){var n=!1;if(e&&e._textures&&e._textures.length)for(var r=0;r<e._textures.length;r++)if(e._textures[r]instanceof i.Texture){var s=e._textures[r].baseTexture;t.indexOf(s)===-1&&(t.push(s),n=!0)}return n}function p(e,t){return e instanceof i.BaseTexture?(t.indexOf(e)===-1&&t.push(e),!0):!1}function d(e,t){if(e._texture&&e._texture instanceof i.Texture){var n=e._texture.baseTexture;return t.indexOf(n)===-1&&t.push(n),!0}return!1}function v(e,t){return t instanceof i.Text?(t.updateText(!0),!0):!1}function m(e,t){if(t instanceof i.TextStyle){var n=t.toFontString();return i.TextMetrics.measureFont(n),!0}return!1}function g(e,t){if(e instanceof i.Text){t.indexOf(e.style)===-1&&t.push(e.style),t.indexOf(e)===-1&&t.push(e);var n=e._texture.baseTexture;return t.indexOf(n)===-1&&t.push(n),!0}return!1}function y(e,t){return e instanceof i.TextStyle?(t.indexOf(e)===-1&&t.push(e),!0):!1}n.__esModule=!0;var r=e("../core"),i=a(r),s=e("./limiters/CountLimiter"),o=u(s),l=i.ticker.shared;i.settings.UPLOADS_PER_FRAME=4;var c=function(){function e(t){var n=this;f(this,e),this.limiter=new o.default(i.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){if(!n.queue)return;n.prepareItems()},this.registerFindHook(g),this.registerFindHook(y),this.registerFindHook(h),this.registerFindHook(p),this.registerFindHook(d),this.registerUploadHook(v),this.registerUploadHook(m)}return e.prototype.upload=function(t,n){typeof t=="function"&&(n=t,t=null),t&&this.add(t),this.queue.length?(n&&this.completes.push(n),this.ticking||(this.ticking=!0,l.addOnce(this.tick,this,i.UPDATE_PRIORITY.UTILITY))):n&&n()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){this.limiter.beginFrame();while(this.queue.length&&this.limiter.allowedToUpload()){var t=this.queue[0],n=!1;if(t&&!t._destroyed)for(var r=0,s=this.uploadHooks.length;r<s;r++)if(this.uploadHooks[r](this.uploadHookHelper,t)){this.queue.shift(),n=!0;break}n||this.queue.shift()}if(!this.queue.length){this.ticking=!1;var o=this.completes.slice(0);this.completes.length=0;for(var u=0,a=o.length;u<a;u++)o[u]()}else l.addOnce(this.tick,this,i.UPDATE_PRIORITY.UTILITY)},e.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},e.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},e.prototype.add=function(t){for(var n=0,r=this.addHooks.length;n<r;n++)if(this.addHooks[n](t,this.queue))break;if(t instanceof i.Container)for(var s=t.children.length-1;s>=0;s--)this.add(t.children[s]);return this},e.prototype.destroy=function(){this.ticking&&l.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();n.default=c},{"../core":65,"./limiters/CountLimiter":185}],183:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function c(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function d(e,t){if(t instanceof i.BaseTexture){var n=t.source,r=n.width===0?e.canvas.width:Math.min(e.canvas.width,n.width),s=n.height===0?e.canvas.height:Math.min(e.canvas.height,n.height);return e.ctx.drawImage(n,0,0,r,s,0,0,e.canvas.width,e.canvas.height),!0}return!1}n.__esModule=!0;var r=e("../../core"),i=a(r),s=e("../BasePrepare"),o=u(s),h=16,p=function(e){function t(n){f(this,t);var r=l(this,e.call(this,n));return r.uploadHookHelper=r,r.canvas=document.createElement("canvas"),r.canvas.width=h,r.canvas.height=h,r.ctx=r.canvas.getContext("2d"),r.registerUploadHook(d),r}return c(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(o.default);n.default=p,i.CanvasRenderer.registerPlugin("prepare",p)},{"../../core":65,"../BasePrepare":182}],184:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0;var r=e("./webgl/WebGLPrepare");Object.defineProperty(n,"webgl",{enumerable:!0,get:function(){return a(r).default}});var i=e("./canvas/CanvasPrepare");Object.defineProperty(n,"canvas",{enumerable:!0,get:function(){return a(i).default}});var s=e("./BasePrepare");Object.defineProperty(n,"BasePrepare",{enumerable:!0,get:function(){return a(s).default}});var o=e("./limiters/CountLimiter");Object.defineProperty(n,"CountLimiter",{enumerable:!0,get:function(){return a(o).default}});var u=e("./limiters/TimeLimiter");Object.defineProperty(n,"TimeLimiter",{enumerable:!0,get:function(){return a(u).default}})},{"./BasePrepare":182,"./canvas/CanvasPrepare":183,"./limiters/CountLimiter":185,"./limiters/TimeLimiter":186,"./webgl/WebGLPrepare":187}],185:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t){r(this,e),this.maxItemsPerFrame=t,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return this.itemsLeft-->0},e}();n.default=i},{}],186:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.__esModule=!0;var i=function(){function e(t){r(this,e),this.maxMilliseconds=t,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}();n.default=i},{}],187:[function(e,t,n){"use strict";function u(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||typeof t!="object"&&typeof t!="function"?e:t}function c(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e,t){return t instanceof i.BaseTexture?(t._glTextures[e.CONTEXT_UID]||e.textureManager.updateTexture(t),!0):!1}function d(e,t){return t instanceof i.Graphics?((t.dirty||t.clearDirty||!t._webGL[e.plugins.graphics.CONTEXT_UID])&&e.plugins.graphics.updateGraphics(t),!0):!1}function v(e,t){return e instanceof i.Graphics?(t.push(e),!0):!1}n.__esModule=!0;var r=e("../../core"),i=a(r),s=e("../BasePrepare"),o=u(s),h=function(e){function t(n){f(this,t);var r=l(this,e.call(this,n));return r.uploadHookHelper=r.renderer,r.registerFindHook(v),r.registerUploadHook(p),r.registerUploadHook(d),r}return c(t,e),t}(o.default);n.default=h,i.WebGLRenderer.registerPlugin("prepare",h)},{"../../core":65,"../BasePrepare":182}],188:[function(e,t,n){(function(t){"use strict";function N(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function C(e){return e&&e.__esModule?e:{"default":e}}n.__esModule=!0,n.loader=n.prepare=n.particles=n.mesh=n.loaders=n.interaction=n.filters=n.extras=n.extract=n.accessibility=undefined;var r=e("./polyfill");Object.keys(r).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var i=e("./core");Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var s=e("./deprecation"),o=C(s),u=e("./accessibility"),a=N(u),f=e("./extract"),l=N(f),c=e("./extras"),h=N(c),p=e("./filters"),d=N(p),v=e("./interaction"),m=N(v),g=e("./loaders"),y=N(g),b=e("./mesh"),w=N(b),E=e("./particles"),S=N(E),x=e("./prepare"),T=N(x);i.utils.mixins.performMixins();var k=y.shared||null;n.accessibility=a,n.extract=l,n.extras=h,n.filters=d,n.interaction=m,n.loaders=y,n.mesh=w,n.particles=S,n.prepare=T,n.loader=k,typeof o.default=="function"&&(0,o.default)(n),t.PIXI=n}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./accessibility":42,"./core":65,"./deprecation":130,"./extract":132,"./extras":141,"./filters":152,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":180,"./prepare":184}]},{},[188])(188)}),function(e){if(typeof exports=="object"&&typeof module!="undefined")module.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.pixiParticles=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=e("./ParticleUtils"),i=e("./Particle"),s=PIXI.Texture,o=function(e){i.call(this,e),this.textures=null,this.duration=0,this.framerate=0,this.elapsed=0,this.loop=!1},u=i.prototype,a=o.prototype=Object.create(u);a.init=function(){this.Particle_init(),this.elapsed=0,this.framerate<0&&(this.duration=this.maxLife,this.framerate=this.textures.length/this.duration)},a.applyArt=function(e){this.textures=e.textures,this.framerate=e.framerate,this.duration=e.duration,this.loop=e.loop},a.update=function(e){if(this.Particle_update(e)>=0){this.elapsed+=e,this.elapsed>this.duration&&(this.loop?this.elapsed=this.elapsed%this.duration:this.elapsed=this.duration-1e-6);var t=this.elapsed*this.framerate+1e-7|0;this.texture=this.textures[t]||r.EMPTY_TEXTURE}},a.Particle_destroy=i.prototype.destroy,a.destroy=function(){this.Particle_destroy(),this.textures=null},o.parseArt=function(e){var t,n,r=[],i,o,u,a;for(t=0;t<e.length;++t){n=e[t],e[t]=r={},r.textures=a=[],o=n.textures;for(i=0;i<o.length;++i){u=o[i];if(typeof u=="string")a.push(s.fromImage(u));else if(u instanceof s)a.push(u);else{var f=u.count||1;typeof u.texture=="string"?u=s.fromImage(u.texture):u=u.texture;for(;f>0;--f)a.push(u)}}n.framerate=="matchLife"?(r.framerate=-1,r.duration=0,r.loop=!1):(r.loop=!!n.loop,r.framerate=n.framerate>0?n.framerate:60,r.duration=a.length/r.framerate)}return e},t.exports=o},{"./Particle":3,"./ParticleUtils":4}],2:[function(e,t,n){"use strict";var r=e("./ParticleUtils"),i=e("./Particle"),s=PIXI.particles.ParticleContainer||PIXI.ParticleContainer,o=PIXI.ticker.shared,u=function(e,t,n){this._particleConstructor=i,this.particleImages=null,this.startAlpha=1,this.endAlpha=1,this.startSpeed=0,this.endSpeed=0,this.minimumSpeedMultiplier=1,this.acceleration=null,this.maxSpeed=NaN,this.startScale=1,this.endScale=1,this.minimumScaleMultiplier=1,this.startColor=null,this.endColor=null,this.minLifetime=0,this.maxLifetime=0,this.minStartRotation=0,this.maxStartRotation=0,this.noRotation=!1,this.minRotationSpeed=0,this.maxRotationSpeed=0,this.particleBlendMode=0,this.customEase=null,this.extraData=null,this._frequency=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=null,this.spawnType=null,this._spawnFunc=null,this.spawnRect=null,this.spawnCircle=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this._parentIsPC=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._origArt=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this.parent=e,t&&n&&this.init(t,n),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos},a=u.prototype={},f=new PIXI.Point;Object.defineProperty(a,"frequency",{get:function(){return this._frequency},set:function(e){typeof e=="number"&&e>0?this._frequency=e:this._frequency=1}}),Object.defineProperty(a,"particleConstructor",{get:function(){return this._particleConstructor},set:function(e){if(e!=this._particleConstructor){this._particleConstructor=e,this.cleanup();for(var t=this._poolFirst;t;t=t.next)t.destroy();this._poolFirst=null,this._origConfig&&this._origArt&&this.init(this._origArt,this._origConfig)}}}),Object.defineProperty(a,"parent",{get:function(){return this._parent},set:function(e){if(this._parentIsPC)for(var t=this._poolFirst;t;t=t.next)t.parent&&t.parent.removeChild(t);this.cleanup(),this._parent=e,this._parentIsPC=s&&e&&e instanceof s}}),a.init=function(e,t){if(!e||!t)return;this.cleanup(),this._origConfig=t,this._origArt=e,e=Array.isArray(e)?e.slice():[e];var n=this._particleConstructor;this.particleImages=n.parseArt?n.parseArt(e):e,t.alpha?(this.startAlpha=t.alpha.start,this.endAlpha=t.alpha.end):this.startAlpha=this.endAlpha=1,t.speed?(this.startSpeed=t.speed.start,this.endSpeed=t.speed.end,this.minimumSpeedMultiplier=t.speed.minimumSpeedMultiplier||1):(this.minimumSpeedMultiplier=1,this.startSpeed=this.endSpeed=0);var i=t.acceleration;i&&(i.x||i.y)?(this.endSpeed=this.startSpeed,this.acceleration=new PIXI.Point(i.x,i.y),this.maxSpeed=t.maxSpeed||NaN):this.acceleration=new PIXI.Point,t.scale?(this.startScale=t.scale.start,this.endScale=t.scale.end,this.minimumScaleMultiplier=t.scale.minimumScaleMultiplier||1):this.startScale=this.endScale=this.minimumScaleMultiplier=1,t.color&&(this.startColor=r.hexToRGB(t.color.start),t.color.start!=t.color.end?this.endColor=r.hexToRGB(t.color.end):this.endColor=null),t.startRotation?(this.minStartRotation=t.startRotation.min,this.maxStartRotation=t.startRotation.max):this.minStartRotation=this.maxStartRotation=0,t.noRotation&&(this.minStartRotation||this.maxStartRotation)?this.noRotation=!!t.noRotation:this.noRotation=!1,t.rotationSpeed?(this.minRotationSpeed=t.rotationSpeed.min,this.maxRotationSpeed=t.rotationSpeed.max):this.minRotationSpeed=this.maxRotationSpeed=0,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,this.particleBlendMode=r.getBlendMode(t.blendMode),t.ease?this.customEase=typeof t.ease=="function"?t.ease:r.generateEase(t.ease):this.customEase=null,n.parseData?this.extraData=n.parseData(t.extraData):this.extraData=t.extraData||null,this.spawnRect=this.spawnCircle=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0;var s;switch(t.spawnType){case"rect":this.spawnType="rect",this._spawnFunc=this._spawnRect;var o=t.spawnRect;this.spawnRect=new PIXI.Rectangle(o.x,o.y,o.w,o.h);break;case"circle":this.spawnType="circle",this._spawnFunc=this._spawnCircle,s=t.spawnCircle,this.spawnCircle=new PIXI.Circle(s.x,s.y,s.r);break;case"ring":this.spawnType="ring",this._spawnFunc=this._spawnRing,s=t.spawnCircle,this.spawnCircle=new PIXI.Circle(s.x,s.y,s.r),this.spawnCircle.minRadius=s.minR;break;case"burst":this.spawnType="burst",this._spawnFunc=this._spawnBurst,this.particlesPerWave=t.particlesPerWave,this.particleSpacing=t.particleSpacing,this.angleStart=t.angleStart?t.angleStart:0;break;case"point":this.spawnType="point",this._spawnFunc=this._spawnPoint;break;default:this.spawnType="point",this._spawnFunc=this._spawnPoint}this.frequency=t.frequency,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos=new PIXI.Point,this.spawnPos=new PIXI.Point(t.pos.x,t.pos.y),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=t.emit===undefined?!0:!!t.emit,this.autoUpdate=t.autoUpdate===undefined?!1:!!t.autoUpdate},a.recycle=function(e){e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next),e==this._activeParticlesLast&&(this._activeParticlesLast=e.prev),e==this._activeParticlesFirst&&(this._activeParticlesFirst=e.next),e.prev=null,e.next=this._poolFirst,this._poolFirst=e,this._parentIsPC?(e.alpha=0,e.visible=!1):e.parent&&e.parent.removeChild(e),--this.particleCount},a.rotate=function(e){if(this.rotation==e)return;var t=e-this.rotation;this.rotation=e,r.rotatePoint(t,this.spawnPos),this._posChanged=!0},a.updateSpawnPos=function(e,t){this._posChanged=!0,this.spawnPos.x=e,this.spawnPos.y=t},a.updateOwnerPos=function(e,t){this._posChanged=!0,this.ownerPos.x=e,this.ownerPos.y=t},a.resetPositionTracking=function(){this._prevPosIsValid=!1},Object.defineProperty(a,"emit",{get:function(){return this._emit},set:function(e){this._emit=!!e,this._emitterLife=this.emitterLifetime}}),Object.defineProperty(a,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){this._autoUpdate&&!e?o.remove(this.update,this):!this._autoUpdate&&e&&o.add(this.update,this),this._autoUpdate=!!e}}),a.playOnceAndDestroy=function(){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0},a.update=function(e){this._autoUpdate&&(e=e/PIXI.settings.TARGET_FPMS/1e3);if(!this._parent)return;var t,n,r;for(n=this._activeParticlesFirst;n;n=r)r=n.next,n.update(e);var i,s;this._prevPosIsValid&&(i=this._prevEmitterPos.x,s=this._prevEmitterPos.y);var o=this.ownerPos.x+this.spawnPos.x,u=this.ownerPos.y+this.spawnPos.y;if(this._emit){this._spawnTimer-=e;while(this._spawnTimer<=0){if(this._emitterLife>0){this._emitterLife-=this._frequency;if(this._emitterLife<=0){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}var a;this.minLifetime==this.maxLifetime?a=this.minLifetime:a=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime;if(-this._spawnTimer<a){var f,l;if(this._prevPosIsValid&&this._posChanged){var c=1+this._spawnTimer/e;f=(o-i)*c+i,l=(u-s)*c+s}else f=o,l=u;t=0;for(var h=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount);t<h;++t){var p,d;this._poolFirst?(p=this._poolFirst,this._poolFirst=this._poolFirst.next,p.next=null):p=new this.particleConstructor(this),this.particleImages.length>1?p.applyArt(this.particleImages[Math.floor(Math.random()*this.particleImages.length)]):p.applyArt(this.particleImages[0]),p.startAlpha=this.startAlpha,p.endAlpha=this.endAlpha,this.minimumSpeedMultiplier!=1?(d=Math.random()*(1-this.minimumSpeedMultiplier)+this.minimumSpeedMultiplier,p.startSpeed=this.startSpeed*d,p.endSpeed=this.endSpeed*d):(p.startSpeed=this.startSpeed,p.endSpeed=this.endSpeed),p.acceleration.x=this.acceleration.x,p.acceleration.y=this.acceleration.y,p.maxSpeed=this.maxSpeed,this.minimumScaleMultiplier!=1?(d=Math.random()*(1-this.minimumScaleMultiplier)+this.minimumScaleMultiplier,p.startScale=this.startScale*d,p.endScale=this.endScale*d):(p.startScale=this.startScale,p.endScale=this.endScale),p.startColor=this.startColor,p.endColor=this.endColor,this.minRotationSpeed==this.maxRotationSpeed?p.rotationSpeed=this.minRotationSpeed:p.rotationSpeed=Math.random()*(this.maxRotationSpeed-this.minRotationSpeed)+this.minRotationSpeed,p.noRotation=this.noRotation,p.maxLife=a,p.blendMode=this.particleBlendMode,p.ease=this.customEase,p.extraData=this.extraData,this._spawnFunc(p,f,l,t),p.init(),p.update(-this._spawnTimer);if(!this._parentIsPC||!p.parent)this.addAtBack?this._parent.addChildAt(p,0):this._parent.addChild(p);else{var v=this._parent.children;if(v[0]==p)v.shift();else if(v[v.length-1]==p)v.pop();else{var m=v.indexOf(p);v.splice(m,1)}this.addAtBack?v.unshift(p):v.push(p)}this._activeParticlesLast?(this._activeParticlesLast.next=p,p.prev=this._activeParticlesLast,this._activeParticlesLast=p):this._activeParticlesLast=this._activeParticlesFirst=p,++this.particleCount}}this._spawnTimer+=this._frequency}}this._posChanged&&(this._prevEmitterPos.x=o,this._prevEmitterPos.y=u,this._prevPosIsValid=!0,this._posChanged=!1),this._destroyWhenComplete&&!this._emit&&!this._activeParticlesFirst&&this.destroy()},a._spawnPoint=function(e,t,n){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,e.position.x=t,e.position.y=n},a._spawnRect=function(e,t,n){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,f.x=Math.random()*this.spawnRect.width+this.spawnRect.x,f.y=Math.random()*this.spawnRect.height+this.spawnRect.y,this.rotation!==0&&r.rotatePoint(this.rotation,f),e.position.x=t+f.x,e.position.y=n+f.y},a._spawnCircle=function(e,t,n){this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,f.x=Math.random()*this.spawnCircle.radius,f.y=0,r.rotatePoint(Math.random()*360,f),f.x+=this.spawnCircle.x,f.y+=this.spawnCircle.y,this.rotation!==0&&r.rotatePoint(this.rotation,f),e.position.x=t+f.x,e.position.y=n+f.y},a._spawnRing=function(e,t,n){var i=this.spawnCircle;this.minStartRotation==this.maxStartRotation?e.rotation=this.minStartRotation+this.rotation:e.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,i.minRadius==i.radius?f.x=Math.random()*(i.radius-i.minRadius)+i.minRadius:f.x=i.radius,f.y=0;var s=Math.random()*360;e.rotation+=s,r.rotatePoint(s,f),f.x+=this.spawnCircle.x,f.y+=this.spawnCircle.y,this.rotation!==0&&r.rotatePoint(this.rotation,f),e.position.x=t+f.x,e.position.y=n+f.y},a._spawnBurst=function(e,t,n,r){this.particleSpacing===0?e.rotation=Math.random()*360:e.rotation=this.angleStart+this.particleSpacing*r+this.rotation,e.position.x=t,e.position.y=n},a.cleanup=function(){var e,t;for(e=this._activeParticlesFirst;e;e=t)t=e.next,this.recycle(e),e.parent&&e.parent.removeChild(e);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0},a.destroy=function(){this.autoUpdate=!1,this.cleanup();var e;for(var t=this._poolFirst;t;t=e)e=t.next,t.destroy();this._poolFirst=this._parent=this.particleImages=this.spawnPos=this.ownerPos=this.startColor=this.endColor=this.customEase=null},t.exports=u},{"./Particle":3,"./ParticleUtils":4}],3:[function(e,t,n){var r=e("./ParticleUtils"),i=PIXI.Sprite,s=function(e){i.call(this),this.emitter=e,this.anchor.x=this.anchor.y=.5,this.velocity=new PIXI.Point,this.maxLife=0,this.age=0,this.ease=null,this.extraData=null,this.startAlpha=0,this.endAlpha=0,this.startSpeed=0,this.endSpeed=0,this.acceleration=new PIXI.Point,this.maxSpeed=NaN,this.startScale=0,this.endScale=0,this.startColor=null,this._sR=0,this._sG=0,this._sB=0,this.endColor=null,this._eR=0,this._eG=0,this._eB=0,this._doAlpha=!1,this._doScale=!1,this._doSpeed=!1,this._doAcceleration=!1,this._doColor=!1,this._doNormalMovement=!1,this._oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.Particle_init=this.Particle_init,this.update=this.update,this.Particle_update=this.Particle_update,this.applyArt=this.applyArt,this.kill=this.kill},o=s.prototype=Object.create(i.prototype);o.init=o.Particle_init=function(){this.age=0,this.velocity.x=this.startSpeed,this.velocity.y=0,r.rotatePoint(this.rotation,this.velocity),this.noRotation?this.rotation=0:this.rotation*=r.DEG_TO_RADS,this.rotationSpeed*=r.DEG_TO_RADS,this.alpha=this.startAlpha,this.scale.x=this.scale.y=this.startScale,this.startColor&&(this._sR=this.startColor[0],this._sG=this.startColor[1],this._sB=this.startColor[2],this.endColor&&(this._eR=this.endColor[0],this._eG=this.endColor[1],this._eB=this.endColor[2])),this._doAlpha=this.startAlpha!=this.endAlpha,this._doSpeed=this.startSpeed!=this.endSpeed,this._doScale=this.startScale!=this.endScale,this._doColor=!!this.endColor,this._doAcceleration=this.acceleration.x!==0||this.acceleration.y!==0,this._doNormalMovement=this._doSpeed||this.startSpeed!==0||this._doAcceleration,this._oneOverLife=1/this.maxLife,this.tint=r.combineRGBComponents(this._sR,this._sG,this._sB),this.visible=!0},o.applyArt=function(e){this.texture=e||r.EMPTY_TEXTURE},o.update=o.Particle_update=function(e){this.age+=e;if(this.age>=this.maxLife)return this.kill(),-1;var t=this.age*this._oneOverLife;this.ease&&(this.ease.length==4?t=this.ease(t,0,1,1):t=this.ease(t)),this._doAlpha&&(this.alpha=(this.endAlpha-this.startAlpha)*t+this.startAlpha);if(this._doScale){var n=(this.endScale-this.startScale)*t+this.startScale;this.scale.x=this.scale.y=n}if(this._doNormalMovement){if(this._doSpeed){var i=(this.endSpeed-this.startSpeed)*t+this.startSpeed;r.normalize(this.velocity),r.scaleBy(this.velocity,i)}else if(this._doAcceleration){this.velocity.x+=this.acceleration.x*e,this.velocity.y+=this.acceleration.y*e;if(this.maxSpeed){var s=r.length(this.velocity);s>this.maxSpeed&&r.scaleBy(this.velocity,this.maxSpeed/s)}}this.position.x+=this.velocity.x*e,this.position.y+=this.velocity.y*e}if(this._doColor){var o=(this._eR-this._sR)*t+this._sR,u=(this._eG-this._sG)*t+this._sG,a=(this._eB-this._sB)*t+this._sB;this.tint=r.combineRGBComponents(o,u,a)}return this.rotationSpeed!==0?this.rotation+=this.rotationSpeed*e:this.acceleration&&!this.noRotation&&(this.rotation=Math.atan2(this.velocity.y,this.velocity.x)),t},o.kill=function(){this.emitter.recycle(this)},o.Sprite_Destroy=i.prototype.destroy,o.destroy=function(){this.parent&&this.parent.removeChild(this),this.Sprite_Destroy&&this.Sprite_Destroy(),this.emitter=this.velocity=this.startColor=this.endColor=this.ease=this.next=this.prev=null},s.parseArt=function(e){var t;for(t=e.length;t>=0;--t)typeof e[t]=="string"&&(e[t]=PIXI.Texture.fromImage(e[t]));if(r.verbose)for(t=e.length-1;t>0;--t)if(e[t].baseTexture!=e[t-1].baseTexture){window.console&&console.warn("PixiParticles: using particle textures from different images may hinder performance in WebGL");break}return e},s.parseData=function(e){return e},t.exports=s},{"./ParticleUtils":4}],4:[function(e,t,n){"use strict";var r=PIXI.BLEND_MODES||PIXI.blendModes,i=PIXI.Texture,s={};s.verbose=!1;var o=s.DEG_TO_RADS=Math.PI/180,u=s.EMPTY_TEXTURE=i.EMPTY;u.on=u.destroy=u.once=u.emit=function(){},s.rotatePoint=function(e,t){if(!e)return;e*=o;var n=Math.sin(e),r=Math.cos(e),i=t.x*r-t.y*n,s=t.x*n+t.y*r;t.x=i,t.y=s},s.combineRGBComponents=function(e,t,n){return e<<16|t<<8|n},s.normalize=function(e){var t=1/s.length(e);e.x*=t,e.y*=t},s.scaleBy=function(e,t){e.x*=t,e.y*=t},s.length=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},s.hexToRGB=function(e,t){t?t.length=0:t=[],e.charAt(0)=="#"?e=e.substr(1):e.indexOf("0x")===0&&(e=e.substr(2));var n;return e.length==8&&(n=e.substr(0,2),e=e.substr(2)),t.push(parseInt(e.substr(0,2),16)),t.push(parseInt(e.substr(2,2),16)),t.push(parseInt(e.substr(4,2),16)),n&&t.push(parseInt(n,16)),t},s.generateEase=function(e){var t=e.length,n=1/t,r=function(r){var i,s,o=t*r|0;return i=(r-o*n)*t,s=e[o]||e[t-1],s.s+i*(2*(1-i)*(s.cp-s.s)+i*(s.e-s.s))};return r},s.getBlendMode=function(e){if(!e)return r.NORMAL;e=e.toUpperCase();while(e.indexOf(" ")>=0)e=e.replace(" ","_");return r[e]||r.NORMAL},t.exports=s},{}],5:[function(require,module,exports){"use strict";var ParticleUtils=require("./ParticleUtils"),Particle=require("./Particle"),PathParticle=function(e){Particle.call(this,e),this.path=null,this.initialRotation=0,this.initialPosition=new PIXI.Point,this.movement=0},s=Particle.prototype,p=PathParticle.prototype=Object.create(s),helperPoint=new PIXI.Point;p.init=function(){this.initialRotation=this.rotation,this.Particle_init(),this.path=this.extraData.path,this._doNormalMovement=!this.path,this.movement=0,this.initialPosition.x=this.position.x,this.initialPosition.y=this.position.y};var MATH_FUNCS=["pow","sqrt","abs","floor","round","ceil","E","PI","sin","cos","tan","asin","acos","atan","atan2","log"],WHITELISTER="[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]";for(var index=MATH_FUNCS.length-1;index>=0;--index)WHITELISTER+="|"+MATH_FUNCS[index];WHITELISTER=new RegExp(WHITELISTER,"g");var parsePath=function(pathString){var rtn,matches=pathString.match(WHITELISTER);for(var i=matches.length-1;i>=0;--i)MATH_FUNCS.indexOf(matches[i])>=0&&(matches[i]="Math."+matches[i]);return pathString=matches.join(""),eval("rtn = function(x){ return "+pathString+"; };"),rtn};p.update=function(e){var t=this.Particle_update(e);if(t>=0&&this.path){var n=(this.endSpeed-this.startSpeed)*t+this.startSpeed;this.movement+=n*e,helperPoint.x=this.movement,helperPoint.y=this.path(this.movement),ParticleUtils.rotatePoint(this.initialRotation,helperPoint),this.position.x=this.initialPosition.x+helperPoint.x,this.position.y=this.initialPosition.y+helperPoint.y}},p.Particle_destroy=Particle.prototype.destroy,p.destroy=function(){this.Particle_destroy(),this.path=this.initialPosition=null},PathParticle.parseArt=function(e){return Particle.parseArt(e)},PathParticle.parseData=function(e){var t={};if(e&&e.path)try{t.path=parsePath(e.path)}catch(n){ParticleUtils.verbose&&console.error("PathParticle: error in parsing path expression"),t.path=null}else ParticleUtils.verbose&&console.error("PathParticle requires a path string in extraData!"),t.path=null;return t},module.exports=PathParticle},{"./Particle":3,"./ParticleUtils":4}],6:[function(e,t,n){},{}],7:[function(e,t,n){n.ParticleUtils=e("./ParticleUtils.js"),n.Particle=e("./Particle.js"),n.Emitter=e("./Emitter.js"),n.PathParticle=e("./PathParticle.js"),n.AnimatedParticle=e("./AnimatedParticle.js"),e("./deprecation.js")},{"./AnimatedParticle.js":1,"./Emitter.js":2,"./Particle.js":3,"./ParticleUtils.js":4,"./PathParticle.js":5,"./deprecation.js":6}],8:[function(e,t,n){"use strict";var r=typeof window!="undefined"?window:GLOBAL;r.PIXI.particles||(r.PIXI.particles={});if(typeof t!="undefined"&&t.exports)typeof PIXI=="undefined"&&e("pixi.js"),t.exports=r.PIXI.particles||i;else if(typeof PIXI=="undefined")throw"pixi-particles requires pixi.js to be loaded first";var i=e("./particles");for(var s in i)r.PIXI.particles[s]=i[s]},{"./particles":7,"pixi.js":undefined}]},{},[8])(8)}),function(){var e={linear:function(e,t,n,r){return n*e/r+t},quadIn:function(e,t,n,r){return e/=r,n*e*e+t},quadOut:function(e,t,n,r){return e/=r,-n*e*(e-2)+t},quadInOut:function(e,t,n,r){return e/=r/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)},cubeIn:function(e,t,n,r){return e/=r,n*e*e*e+t},cubeOut:function(e,t,n,r){return e/=r,e--,n*(e*e*e+1)+t},cubeInOut:function(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e+t:(e-=2,n/2*(e*e*e+2)+t)},quartIn:function(e,t,n,r){return e/=r,n*e*e*e*e+t},quartOut:function(e,t,n,r){return e/=r,e--,-n*(e*e*e*e-1)+t},quartInOut:function(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e*e+t:(e-=2,-n/2*(e*e*e*e-2)+t)},quintIn:function(e,t,n,r){return e/=r,n*e*e*e*e*e+t},quintOut:function(e,t,n,r){return e/=r,e--,n*(e*e*e*e*e+1)+t},quintInOut:function(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e*e*e+t:(e-=2,n/2*(e*e*e*e*e+2)+t)},sineIn:function(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t},sineOut:function(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t},sineInOut:function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t},expoIn:function(e,t,n,r){return n*Math.pow(2,10*(e/r-1))+t},expoOut:function(e,t,n,r){return n*(-Math.pow(2,-10*e/r)+1)+t},expoInOut:function(e,t,n,r){return e/=r/2,e<1?n/2*Math.pow(2,10*(e-1))+t:(e--,n/2*(-Math.pow(2,-10*e)+2)+t)},circIn:function(e,t,n,r){return e/=r,-n*(Math.sqrt(1-e*e)-1)+t},circOut:function(e,t,n,r){return e/=r,e--,n*Math.sqrt(1-e*e)+t},circInOut:function(e,t,n,r){return e/=r/2,e<1?-n/2*(Math.sqrt(1-e*e)-1)+t:(e-=2,n/2*(Math.sqrt(1-e*e)+1)+t)}},t={round:function(e){return Math.round(e*100)/100}};window.Tween=function(e,t,n,r,i){return this.startTime=Date.now(),this.startValue=e,this.distance=t,this.duration=n,this.animationType=r,this.loop=i,this},window.Tween.prototype.getValue=function(){if(!this.expired())var n=e[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration);else if(!this.loop)var n=this.startValue+this.distance;else if(this.loop==="repeat"){this.startTime=Date.now();var n=e[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration)}else{this.startValue=this.startValue+this.distance,this.distance=-this.distance,this.startTime=Date.now();var n=e[this.animationType](Date.now()-this.startTime,this.startValue,this.distance,this.duration)}return t.round(n)},window.Tween.prototype.getStartTime=function(){return Date.now()-this.startTime-this.duration+Date.now()},window.Tween.prototype.expired=function(){return this.startTime+this.duration<Date.now()},window.Tween.prototype.set=function(e,t,n,r,i){return this.startValue=e||this.startValue,this.distance=t||this.distance,this.duration=n||this.duration,this.animationType=r||this.animationType,this.loop=i||this.loop,this},window.Tween.prototype.reset=function(){return this.startTime=Date.now(),this}}(),tagpro.particleDefinitions={tagproSparks:{alpha:{start:.75,end:0},scale:{start:0,end:.25,minimumScaleMultiplier:1},color:{start:"#83FF7A",end:"#00BB00"},speed:{start:30,end:30},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:0},lifetime:{min:.1,max:.9},blendMode:"normal",frequency:.01,emitterLifetime:-1,maxParticles:50,pos:{x:20,y:20},addAtBack:!0,spawnType:"point",spawnCircle:{x:0,y:0,r:0}},explosion:{alpha:{start:.74,end:0},scale:{start:5,end:1,minimumScaleMultiplier:.1},color:{start:"#ffdfa0",end:"#100f0c"},speed:{start:1e3,end:0},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:200},lifetime:{min:.25,max:.5},blendMode:"normal",ease:[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],frequency:.001,emitterLifetime:.1,maxParticles:50,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"},playerEmitter:{alpha:{start:.85,end:0},scale:{start:.01,end:.2,minimumScaleMultiplier:1},color:{start:"#fff191",end:"#ff622c"},speed:{start:20,end:20},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:50,max:50},lifetime:{min:.1,max:.75},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:50,pos:{x:20,y:20},addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:10}},death:{alpha:{start:.15,end:0},scale:{start:1.5,end:0},speed:{start:300,end:100},startRotation:{min:0,max:0},rotationSpeed:{min:0,max:0},lifetime:{min:.4,max:.4},frequency:.08,emitterLifetime:.17,maxParticles:50,pos:{x:0,y:0},addAtBack:!1,spawnType:"burst",particlesPerWave:16,particleSpacing:22.5,angleStart:0},rollingBomb:{alpha:{start:.45,end:0},scale:{start:.1,end:1.5,minimumScaleMultiplier:1},color:{start:"#85888d",end:"#100f0c"},speed:{start:1,end:50},acceleration:{x:0,y:0},startRotation:{min:0,max:360},rotationSpeed:{min:0,max:0},lifetime:{min:.5,max:2},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:10,pos:{x:0,y:0},addAtBack:!1,spawnType:"circle",spawnCircle:{x:20,y:20,r:30}},gravityWell:{alpha:{start:0,end:1},scale:{start:.5,end:.15,minimumScaleMultiplier:1},color:{start:"#000000",end:"#000000"},speed:{start:1,end:500},acceleration:{x:0,y:0},startRotation:{min:180,max:180},rotationSpeed:{min:90,max:180},lifetime:{min:.9,max:1},blendMode:"normal",frequency:.025,emitterLifetime:-1,maxParticles:40,pos:{x:0,y:0},addAtBack:!1,spawnType:"ring",spawnCircle:{x:0,y:0,r:240,minR:240}},arcReactor:{alpha:{start:.25,end:0},scale:{start:.5,end:.25,minimumScaleMultiplier:1},color:{start:"#57d0d6",end:"#57d0d6"},speed:{start:0,end:0,minimumSpeedMultiplier:1},acceleration:{x:0,y:0},maxSpeed:0,startRotation:{min:0,max:0},noRotation:!0,rotationSpeed:{min:0,max:0},lifetime:{min:.1,max:.1},blendMode:"normal",frequency:.001,emitterLifetime:-1,maxParticles:500,pos:{x:0,y:0},addAtBack:!1,spawnType:"point"}},function(){typeof window.performance=="undefined"&&(window.performance={});if(!window.performance.now){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}(),console.image=function(e,t){function r(e,t){return{string:"+",style:"font-size: 1px; padding: "+Math.floor(t/2)+"px "+Math.floor(e/2)+"px; line-height: "+t+"px;"}}t=t||1;var n=new Image;n.onload=function(){var n=r(this.width*t,this.height*t);console.log("%c"+n.string,n.style+"background: url("+e+"); background-size: "+this.width*t+"px "+this.height*t+"px; color: transparent;")},n.src=e},tagpro.ready(createRenderer),PIXI.SpriteClip=function(e){PIXI.extras.AnimatedSprite.call(this,e),this.fps=4,this.lastUpdate=performance.now()},PIXI.SpriteClip.prototype=Object.create(PIXI.extras.AnimatedSprite.prototype),PIXI.SpriteClip.prototype.constructor=PIXI.SpriteClip,PIXI.SpriteClip.prototype.update=function(){var e=this.currentFrame,t=performance.now(),n=Math.min(t-this.lastUpdate,100);this.lastUpdate=t,this._currentTime+=this.fps*n/1e3,this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):e!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<e?this.onLoop():this.animationSpeed<0&&this.currentFrame>e&&this.onLoop()),this.updateTexture())};var Box2D={};(function(e,t){function n(){}!Object.defineProperty&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(e,t,n){n.get instanceof Function&&e.__defineGetter__(t,n.get),n.set instanceof Function&&e.__defineSetter__(t,n.set)}),e.inherit=function(e,t){var r=e;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=r},e.generateCallback=function(t,n){return function(){n.apply(t,arguments)}},e.NVector=function(n){n===t&&(n=0);var r=new Array(n||0);for(var i=0;i<n;++i)r[i]=0;return r},e.is=function(n,r){return n===null?!1:r instanceof Function&&n instanceof r?!0:n.constructor.__implements!=t&&n.constructor.__implements[r]?!0:!1},e.parseUInt=function(e){return Math.abs(parseInt(e))}})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;typeof Box2D=="undefined"&&(Box2D={}),typeof Box2D.Collision=="undefined"&&(Box2D.Collision={}),typeof Box2D.Collision.Shapes=="undefined"&&(Box2D.Collision.Shapes={}),typeof Box2D.Common=="undefined"&&(Box2D.Common={}),typeof Box2D.Common.Math=="undefined"&&(Box2D.Common.Math={}),typeof Box2D.Dynamics=="undefined"&&(Box2D.Dynamics={}),typeof Box2D.Dynamics.Contacts=="undefined"&&(Box2D.Dynamics.Contacts={}),typeof Box2D.Dynamics.Controllers=="undefined"&&(Box2D.Dynamics.Controllers={}),typeof Box2D.Dynamics.Joints=="undefined"&&(Box2D.Dynamics.Joints={}),function(){function e(){e.b2AABB.apply(this,arguments)}function t(){t.b2Bound.apply(this,arguments)}function n(){n.b2BoundValues.apply(this,arguments),this.constructor===n&&this.b2BoundValues.apply(this,arguments)}function r(){r.b2Collision.apply(this,arguments)}function i(){i.b2ContactID.apply(this,arguments),this.constructor===i&&this.b2ContactID.apply(this,arguments)}function s(){s.b2ContactPoint.apply(this,arguments)}function o(){o.b2Distance.apply(this,arguments)}function u(){u.b2DistanceInput.apply(this,arguments)}function a(){a.b2DistanceOutput.apply(this,arguments)}function f(){f.b2DistanceProxy.apply(this,arguments)}function l(){l.b2DynamicTree.apply(this,arguments),this.constructor===l&&this.b2DynamicTree.apply(this,arguments)}function c(){c.b2DynamicTreeBroadPhase.apply(this,arguments)}function h(){h.b2DynamicTreeNode.apply(this,arguments)}function p(){p.b2DynamicTreePair.apply(this,arguments)}function d(){d.b2Manifold.apply(this,arguments),this.constructor===d&&this.b2Manifold.apply(this,arguments)}function v(){v.b2ManifoldPoint.apply(this,arguments),this.constructor===v&&this.b2ManifoldPoint.apply(this,arguments)}function m(){m.b2Point.apply(this,arguments)}function g(){g.b2RayCastInput.apply(this,arguments),this.constructor===g&&this.b2RayCastInput.apply(this,arguments)}function y(){y.b2RayCastOutput.apply(this,arguments)}function b(){b.b2Segment.apply(this,arguments)}function w(){w.b2SeparationFunction.apply(this,arguments)}function E(){E.b2Simplex.apply(this,arguments),this.constructor===E&&this.b2Simplex.apply(this,arguments)}function S(){S.b2SimplexCache.apply(this,arguments)}function x(){x.b2SimplexVertex.apply(this,arguments)}function T(){T.b2TimeOfImpact.apply(this,arguments)}function N(){N.b2TOIInput.apply(this,arguments)}function C(){C.b2WorldManifold.apply(this,arguments),this.constructor===C&&this.b2WorldManifold.apply(this,arguments)}function k(){k.ClipVertex.apply(this,arguments)}function L(){L.Features.apply(this,arguments)}function A(){A.b2CircleShape.apply(this,arguments),this.constructor===A&&this.b2CircleShape.apply(this,arguments)}function O(){O.b2EdgeChainDef.apply(this,arguments),this.constructor===O&&this.b2EdgeChainDef.apply(this,arguments)}function M(){M.b2EdgeShape.apply(this,arguments),this.constructor===M&&this.b2EdgeShape.apply(this,arguments)}function _(){_.b2MassData.apply(this,arguments)}function D(){D.b2PolygonShape.apply(this,arguments),this.constructor===D&&this.b2PolygonShape.apply(this,arguments)}function P(){P.b2Shape.apply(this,arguments),this.constructor===P&&this.b2Shape.apply(this,arguments)}function H(){H.b2Color.apply(this,arguments),this.constructor===H&&this.b2Color.apply(this,arguments)}function B(){B.b2Settings.apply(this,arguments)}function j(){j.b2Mat22.apply(this,arguments),this.constructor===j&&this.b2Mat22.apply(this,arguments)}function F(){F.b2Mat33.apply(this,arguments),this.constructor===F&&this.b2Mat33.apply(this,arguments)}function I(){I.b2Math.apply(this,arguments)}function q(){q.b2Sweep.apply(this,arguments)}function R(){R.b2Transform.apply(this,arguments),this.constructor===R&&this.b2Transform.apply(this,arguments)}function U(){U.b2Vec2.apply(this,arguments),this.constructor===U&&this.b2Vec2.apply(this,arguments)}function z(){z.b2Vec3.apply(this,arguments),this.constructor===z&&this.b2Vec3.apply(this,arguments)}function W(){W.b2Body.apply(this,arguments),this.constructor===W&&this.b2Body.apply(this,arguments)}function X(){X.b2BodyDef.apply(this,arguments),this.constructor===X&&this.b2BodyDef.apply(this,arguments)}function V(){V.b2ContactFilter.apply(this,arguments)}function $(){$.b2ContactImpulse.apply(this,arguments)}function J(){J.b2ContactListener.apply(this,arguments)}function K(){K.b2ContactManager.apply(this,arguments),this.constructor===K&&this.b2ContactManager.apply(this,arguments)}function Q(){Q.b2DebugDraw.apply(this,arguments),this.constructor===Q&&this.b2DebugDraw.apply(this,arguments)}function G(){G.b2DestructionListener.apply(this,arguments)}function Y(){Y.b2FilterData.apply(this,arguments)}function Z(){Z.b2Fixture.apply(this,arguments),this.constructor===Z&&this.b2Fixture.apply(this,arguments)}function et(){et.b2FixtureDef.apply(this,arguments),this.constructor===et&&this.b2FixtureDef.apply(this,arguments)}function tt(){tt.b2Island.apply(this,arguments),this.constructor===tt&&this.b2Island.apply(this,arguments)}function nt(){nt.b2TimeStep.apply(this,arguments)}function rt(){rt.b2World.apply(this,arguments),this.constructor===rt&&this.b2World.apply(this,arguments)}function it(){it.b2CircleContact.apply(this,arguments)}function st(){st.b2Contact.apply(this,arguments),this.constructor===st&&this.b2Contact.apply(this,arguments)}function ot(){ot.b2ContactConstraint.apply(this,arguments),this.constructor===ot&&this.b2ContactConstraint.apply(this,arguments)}function ut(){ut.b2ContactConstraintPoint.apply(this,arguments)}function at(){at.b2ContactEdge.apply(this,arguments)}function ft(){ft.b2ContactFactory.apply(this,arguments),this.constructor===ft&&this.b2ContactFactory.apply(this,arguments)}function lt(){lt.b2ContactRegister.apply(this,arguments)}function ct(){ct.b2ContactResult.apply(this,arguments)}function ht(){ht.b2ContactSolver.apply(this,arguments),this.constructor===ht&&this.b2ContactSolver.apply(this,arguments)}function pt(){pt.b2EdgeAndCircleContact.apply(this,arguments)}function dt(){dt.b2NullContact.apply(this,arguments),this.constructor===dt&&this.b2NullContact.apply(this,arguments)}function vt(){vt.b2PolyAndCircleContact.apply(this,arguments)}function mt(){mt.b2PolyAndEdgeContact.apply(this,arguments)}function gt(){gt.b2PolygonContact.apply(this,arguments)}function yt(){yt.b2PositionSolverManifold.apply(this,arguments),this.constructor===yt&&this.b2PositionSolverManifold.apply(this,arguments)}function bt(){bt.b2BuoyancyController.apply(this,arguments)}function wt(){wt.b2ConstantAccelController.apply(this,arguments)}function Et(){Et.b2ConstantForceController.apply(this,arguments)}function St(){St.b2Controller.apply(this,arguments)}function xt(){xt.b2ControllerEdge.apply(this,arguments)}function Tt(){Tt.b2GravityController.apply(this,arguments)}function Nt(){Nt.b2TensorDampingController.apply(this,arguments)}function Ct(){Ct.b2DistanceJoint.apply(this,arguments),this.constructor===Ct&&this.b2DistanceJoint.apply(this,arguments)}function kt(){kt.b2DistanceJointDef.apply(this,arguments),this.constructor===kt&&this.b2DistanceJointDef.apply(this,arguments)}function Lt(){Lt.b2FrictionJoint.apply(this,arguments),this.constructor===Lt&&this.b2FrictionJoint.apply(this,arguments)}function At(){At.b2FrictionJointDef.apply(this,arguments),this.constructor===At&&this.b2FrictionJointDef.apply(this,arguments)}function Ot(){Ot.b2GearJoint.apply(this,arguments),this.constructor===Ot&&this.b2GearJoint.apply(this,arguments)}function Mt(){Mt.b2GearJointDef.apply(this,arguments),this.constructor===Mt&&this.b2GearJointDef.apply(this,arguments)}function _t(){_t.b2Jacobian.apply(this,arguments)}function Dt(){Dt.b2Joint.apply(this,arguments),this.constructor===Dt&&this.b2Joint.apply(this,arguments)}function Pt(){Pt.b2JointDef.apply(this,arguments),this.constructor===Pt&&this.b2JointDef.apply(this,arguments)}function Ht(){Ht.b2JointEdge.apply(this,arguments)}function Bt(){Bt.b2LineJoint.apply(this,arguments),this.constructor===Bt&&this.b2LineJoint.apply(this,arguments)}function jt(){jt.b2LineJointDef.apply(this,arguments),this.constructor===jt&&this.b2LineJointDef.apply(this,arguments)}function Ft(){Ft.b2MouseJoint.apply(this,arguments),this.constructor===Ft&&this.b2MouseJoint.apply(this,arguments)}function It(){It.b2MouseJointDef.apply(this,arguments),this.constructor===It&&this.b2MouseJointDef.apply(this,arguments)}function qt(){qt.b2PrismaticJoint.apply(this,arguments),this.constructor===qt&&this.b2PrismaticJoint.apply(this,arguments)}function Rt(){Rt.b2PrismaticJointDef.apply(this,arguments),this.constructor===Rt&&this.b2PrismaticJointDef.apply(this,arguments)}function Ut(){Ut.b2PulleyJoint.apply(this,arguments),this.constructor===Ut&&this.b2PulleyJoint.apply(this,arguments)}function zt(){zt.b2PulleyJointDef.apply(this,arguments),this.constructor===zt&&this.b2PulleyJointDef.apply(this,arguments)}function Wt(){Wt.b2RevoluteJoint.apply(this,arguments),this.constructor===Wt&&this.b2RevoluteJoint.apply(this,arguments)}function Xt(){Xt.b2RevoluteJointDef.apply(this,arguments),this.constructor===Xt&&this.b2RevoluteJointDef.apply(this,arguments)}function Vt(){Vt.b2WeldJoint.apply(this,arguments),this.constructor===Vt&&this.b2WeldJoint.apply(this,arguments)}function $t(){$t.b2WeldJointDef.apply(this,arguments),this.constructor===$t&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=e,Box2D.Collision.b2Bound=t,Box2D.Collision.b2BoundValues=n,Box2D.Collision.b2Collision=r,Box2D.Collision.b2ContactID=i,Box2D.Collision.b2ContactPoint=s,Box2D.Collision.b2Distance=o,Box2D.Collision.b2DistanceInput=u,Box2D.Collision.b2DistanceOutput=a,Box2D.Collision.b2DistanceProxy=f,Box2D.Collision.b2DynamicTree=l,Box2D.Collision.b2DynamicTreeBroadPhase=c,Box2D.Collision.b2DynamicTreeNode=h,Box2D.Collision.b2DynamicTreePair=p,Box2D.Collision.b2Manifold=d,Box2D.Collision.b2ManifoldPoint=v,Box2D.Collision.b2Point=m,Box2D.Collision.b2RayCastInput=g,Box2D.Collision.b2RayCastOutput=y,Box2D.Collision.b2Segment=b,Box2D.Collision.b2SeparationFunction=w,Box2D.Collision.b2Simplex=E,Box2D.Collision.b2SimplexCache=S,Box2D.Collision.b2SimplexVertex=x,Box2D.Collision.b2TimeOfImpact=T,Box2D.Collision.b2TOIInput=N,Box2D.Collision.b2WorldManifold=C,Box2D.Collision.ClipVertex=k,Box2D.Collision.Features=L,Box2D.Collision.Shapes.b2CircleShape=A,Box2D.Collision.Shapes.b2EdgeChainDef=O,Box2D.Collision.Shapes.b2EdgeShape=M,Box2D.Collision.Shapes.b2MassData=_,Box2D.Collision.Shapes.b2PolygonShape=D,Box2D.Collision.Shapes.b2Shape=P,Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=H,Box2D.Common.b2Settings=B,Box2D.Common.Math.b2Mat22=j,Box2D.Common.Math.b2Mat33=F,Box2D.Common.Math.b2Math=I,Box2D.Common.Math.b2Sweep=q,Box2D.Common.Math.b2Transform=R,Box2D.Common.Math.b2Vec2=U,Box2D.Common.Math.b2Vec3=z,Box2D.Dynamics.b2Body=W,Box2D.Dynamics.b2BodyDef=X,Box2D.Dynamics.b2ContactFilter=V,Box2D.Dynamics.b2ContactImpulse=$,Box2D.Dynamics.b2ContactListener=J,Box2D.Dynamics.b2ContactManager=K,Box2D.Dynamics.b2DebugDraw=Q,Box2D.Dynamics.b2DestructionListener=G,Box2D.Dynamics.b2FilterData=Y,Box2D.Dynamics.b2Fixture=Z,Box2D.Dynamics.b2FixtureDef=et,Box2D.Dynamics.b2Island=tt,Box2D.Dynamics.b2TimeStep=nt,Box2D.Dynamics.b2World=rt,Box2D.Dynamics.Contacts.b2CircleContact=it,Box2D.Dynamics.Contacts.b2Contact=st,Box2D.Dynamics.Contacts.b2ContactConstraint=ot,Box2D.Dynamics.Contacts.b2ContactConstraintPoint=ut,Box2D.Dynamics.Contacts.b2ContactEdge=at,Box2D.Dynamics.Contacts.b2ContactFactory=ft,Box2D.Dynamics.Contacts.b2ContactRegister=lt,Box2D.Dynamics.Contacts.b2ContactResult=ct,Box2D.Dynamics.Contacts.b2ContactSolver=ht,Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=pt,Box2D.Dynamics.Contacts.b2NullContact=dt,Box2D.Dynamics.Contacts.b2PolyAndCircleContact=vt,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=mt,Box2D.Dynamics.Contacts.b2PolygonContact=gt,Box2D.Dynamics.Contacts.b2PositionSolverManifold=yt,Box2D.Dynamics.Controllers.b2BuoyancyController=bt,Box2D.Dynamics.Controllers.b2ConstantAccelController=wt,Box2D.Dynamics.Controllers.b2ConstantForceController=Et,Box2D.Dynamics.Controllers.b2Controller=St,Box2D.Dynamics.Controllers.b2ControllerEdge=xt,Box2D.Dynamics.Controllers.b2GravityController=Tt,Box2D.Dynamics.Controllers.b2TensorDampingController=Nt,Box2D.Dynamics.Joints.b2DistanceJoint=Ct,Box2D.Dynamics.Joints.b2DistanceJointDef=kt,Box2D.Dynamics.Joints.b2FrictionJoint=Lt,Box2D.Dynamics.Joints.b2FrictionJointDef=At,Box2D.Dynamics.Joints.b2GearJoint=Ot,Box2D.Dynamics.Joints.b2GearJointDef=Mt,Box2D.Dynamics.Joints.b2Jacobian=_t,Box2D.Dynamics.Joints.b2Joint=Dt,Box2D.Dynamics.Joints.b2JointDef=Pt,Box2D.Dynamics.Joints.b2JointEdge=Ht,Box2D.Dynamics.Joints.b2LineJoint=Bt,Box2D.Dynamics.Joints.b2LineJointDef=jt,Box2D.Dynamics.Joints.b2MouseJoint=Ft,Box2D.Dynamics.Joints.b2MouseJointDef=It,Box2D.Dynamics.Joints.b2PrismaticJoint=qt,Box2D.Dynamics.Joints.b2PrismaticJointDef=Rt,Box2D.Dynamics.Joints.b2PulleyJoint=Ut,Box2D.Dynamics.Joints.b2PulleyJointDef=zt,Box2D.Dynamics.Joints.b2RevoluteJoint=Wt,Box2D.Dynamics.Joints.b2RevoluteJointDef=Xt,Box2D.Dynamics.Joints.b2WeldJoint=Vt,Box2D.Dynamics.Joints.b2WeldJointDef=$t}(),Box2D.postDefs=[],function(){var e=Box2D.Collision.Shapes.b2CircleShape,t=Box2D.Collision.Shapes.b2EdgeChainDef,n=Box2D.Collision.Shapes.b2EdgeShape,r=Box2D.Collision.Shapes.b2MassData,i=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,o=Box2D.Common.b2Color,u=Box2D.Common.b2internal,a=Box2D.Common.b2Settings,f=Box2D.Common.Math.b2Mat22,l=Box2D.Common.Math.b2Mat33,c=Box2D.Common.Math.b2Math,h=Box2D.Common.Math.b2Sweep,p=Box2D.Common.Math.b2Transform,d=Box2D.Common.Math.b2Vec2,v=Box2D.Common.Math.b2Vec3,m=Box2D.Collision.b2AABB,g=Box2D.Collision.b2Bound,y=Box2D.Collision.b2BoundValues,b=Box2D.Collision.b2Collision,w=Box2D.Collision.b2ContactID,E=Box2D.Collision.b2ContactPoint,S=Box2D.Collision.b2Distance,x=Box2D.Collision.b2DistanceInput,T=Box2D.Collision.b2DistanceOutput,N=Box2D.Collision.b2DistanceProxy,C=Box2D.Collision.b2DynamicTree,k=Box2D.Collision.b2DynamicTreeBroadPhase,L=Box2D.Collision.b2DynamicTreeNode,A=Box2D.Collision.b2DynamicTreePair,O=Box2D.Collision.b2Manifold,M=Box2D.Collision.b2ManifoldPoint,_=Box2D.Collision.b2Point,D=Box2D.Collision.b2RayCastInput,P=Box2D.Collision.b2RayCastOutput,H=Box2D.Collision.b2Segment,B=Box2D.Collision.b2SeparationFunction,j=Box2D.Collision.b2Simplex,F=Box2D.Collision.b2SimplexCache,I=Box2D.Collision.b2SimplexVertex,q=Box2D.Collision.b2TimeOfImpact,R=Box2D.Collision.b2TOIInput,U=Box2D.Collision.b2WorldManifold,z=Box2D.Collision.ClipVertex,W=Box2D.Collision.Features,X=Box2D.Collision.IBroadPhase;m.b2AABB=function(){this.lowerBound=new d,this.upperBound=new d},m.prototype.IsValid=function(){var e=this.upperBound.x-this.lowerBound.x,t=this.upperBound.y-this.lowerBound.y,n=e>=0&&t>=0;return n=n&&this.lowerBound.IsValid()&&this.upperBound.IsValid(),n},m.prototype.GetCenter=function(){return new d((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},m.prototype.GetExtents=function(){return new d((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},m.prototype.Contains=function(e){var t=!0;return t=t&&this.lowerBound.x<=e.lowerBound.x,t=t&&this.lowerBound.y<=e.lowerBound.y,t=t&&e.upperBound.x<=this.upperBound.x,t=t&&e.upperBound.y<=this.upperBound.y,t},m.prototype.RayCast=function(e,t){var n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=t.p1.x,s=t.p1.y,o=t.p2.x-t.p1.x,u=t.p2.y-t.p1.y,a=Math.abs(o),f=Math.abs(u),l=e.normal,c=0,h=0,p=0,d=0,v=0;if(a<Number.MIN_VALUE){if(i<this.lowerBound.x||this.upperBound.x<i)return!1}else{c=1/o,h=(this.lowerBound.x-i)*c,p=(this.upperBound.x-i)*c,v=-1,h>p&&(d=h,h=p,p=d,v=1),h>n&&(l.x=v,l.y=0,n=h),r=Math.min(r,p);if(n>r)return!1}if(f<Number.MIN_VALUE){if(s<this.lowerBound.y||this.upperBound.y<s)return!1}else{c=1/u,h=(this.lowerBound.y-s)*c,p=(this.upperBound.y-s)*c,v=-1,h>p&&(d=h,h=p,p=d,v=1),h>n&&(l.y=v,l.x=0,n=h),r=Math.min(r,p);if(n>r)return!1}return e.fraction=n,!0},m.prototype.TestOverlap=function(e){var t=e.lowerBound.x-this.upperBound.x,n=e.lowerBound.y-this.upperBound.y,r=this.lowerBound.x-e.upperBound.x,i=this.lowerBound.y-e.upperBound.y;return t>0||n>0?!1:r>0||i>0?!1:!0},m.Combine=function(e,t){var n=new m;return n.Combine(e,t),n},m.prototype.Combine=function(e,t){this.lowerBound.x=Math.min(e.lowerBound.x,t.lowerBound.x),this.lowerBound.y=Math.min(e.lowerBound.y,t.lowerBound.y),this.upperBound.x=Math.max(e.upperBound.x,t.upperBound.x),this.upperBound.y=Math.max(e.upperBound.y,t.upperBound.y)},g.b2Bound=function(){},g.prototype.IsLower=function(){return(this.value&1)==0},g.prototype.IsUpper=function(){return(this.value&1)==1},g.prototype.Swap=function(e){var t=this.value,n=this.proxy,r=this.stabbingCount;this.value=e.value,this.proxy=e.proxy,this.stabbingCount=e.stabbingCount,e.value=t,e.proxy=n,e.stabbingCount=r},y.b2BoundValues=function(){},y.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},b.b2Collision=function(){},b.ClipSegmentToLine=function(e,t,n,r){r===undefined&&(r=0);var i,s=0;i=t[0];var o=i.v;i=t[1];var u=i.v,a=n.x*o.x+n.y*o.y-r,f=n.x*u.x+n.y*u.y-r;a<=0&&e[s++].Set(t[0]),f<=0&&e[s++].Set(t[1]);if(a*f<0){var l=a/(a-f);i=e[s];var c=i.v;c.x=o.x+l*(u.x-o.x),c.y=o.y+l*(u.y-o.y),i=e[s];var h;a>0?(h=t[0],i.id=h.id):(h=t[1],i.id=h.id),++s}return s},b.EdgeSeparation=function(e,t,n,r,i){n===undefined&&(n=0);var s=parseInt(e.m_vertexCount),o=e.m_vertices,u=e.m_normals,a=parseInt(r.m_vertexCount),f=r.m_vertices,l,c;l=t.R,c=u[n];var h=l.col1.x*c.x+l.col2.x*c.y,p=l.col1.y*c.x+l.col2.y*c.y;l=i.R;var d=l.col1.x*h+l.col1.y*p,v=l.col2.x*h+l.col2.y*p,m=0,g=Number.MAX_VALUE;for(var y=0;y<a;++y){c=f[y];var b=c.x*d+c.y*v;b<g&&(g=b,m=y)}c=o[n],l=t.R;var w=t.position.x+(l.col1.x*c.x+l.col2.x*c.y),E=t.position.y+(l.col1.y*c.x+l.col2.y*c.y);c=f[m],l=i.R;var S=i.position.x+(l.col1.x*c.x+l.col2.x*c.y),x=i.position.y+(l.col1.y*c.x+l.col2.y*c.y);S-=w,x-=E;var T=S*h+x*p;return T},b.FindMaxSeparation=function(e,t,n,r,i){var s=parseInt(t.m_vertexCount),o=t.m_normals,u,a;a=i.R,u=r.m_centroid;var f=i.position.x+(a.col1.x*u.x+a.col2.x*u.y),l=i.position.y+(a.col1.y*u.x+a.col2.y*u.y);a=n.R,u=t.m_centroid,f-=n.position.x+(a.col1.x*u.x+a.col2.x*u.y),l-=n.position.y+(a.col1.y*u.x+a.col2.y*u.y);var c=f*n.R.col1.x+l*n.R.col1.y,h=f*n.R.col2.x+l*n.R.col2.y,p=0,d=-Number.MAX_VALUE;for(var v=0;v<s;++v){u=o[v];var m=u.x*c+u.y*h;m>d&&(d=m,p=v)}var g=b.EdgeSeparation(t,n,p,r,i),y=parseInt(p-1>=0?p-1:s-1),w=b.EdgeSeparation(t,n,y,r,i),E=parseInt(p+1<s?p+1:0),S=b.EdgeSeparation(t,n,E,r,i),x=0,T=0,N=0;if(w>g&&w>S)N=-1,x=y,T=w;else{if(!(S>g))return e[0]=p,g;N=1,x=E,T=S}for(;;){N==-1?p=x-1>=0?x-1:s-1:p=x+1<s?x+1:0,g=b.EdgeSeparation(t,n,p,r,i);if(!(g>T))break;x=p,T=g}return e[0]=x,T},b.FindIncidentEdge=function(e,t,n,r,i,s){r===undefined&&(r=0);var o=parseInt(t.m_vertexCount),u=t.m_normals,a=parseInt(i.m_vertexCount),f=i.m_vertices,l=i.m_normals,c,h;c=n.R,h=u[r];var p=c.col1.x*h.x+c.col2.x*h.y,d=c.col1.y*h.x+c.col2.y*h.y;c=s.R;var v=c.col1.x*p+c.col1.y*d;d=c.col2.x*p+c.col2.y*d,p=v;var m=0,g=Number.MAX_VALUE;for(var y=0;y<a;++y){h=l[y];var b=p*h.x+d*h.y;b<g&&(g=b,m=y)}var w,E=parseInt(m),S=parseInt(E+1<a?E+1:0);w=e[0],h=f[E],c=s.R,w.v.x=s.position.x+(c.col1.x*h.x+c.col2.x*h.y),w.v.y=s.position.y+(c.col1.y*h.x+c.col2.y*h.y),w.id.features.referenceEdge=r,w.id.features.incidentEdge=E,w.id.features.incidentVertex=0,w=e[1],h=f[S],c=s.R,w.v.x=s.position.x+(c.col1.x*h.x+c.col2.x*h.y),w.v.y=s.position.y+(c.col1.y*h.x+c.col2.y*h.y),w.id.features.referenceEdge=r,w.id.features.incidentEdge=S,w.id.features.incidentVertex=1},b.MakeClipPointVector=function(){var e=new Vector(2);return e[0]=new z,e[1]=new z,e},b.CollidePolygons=function(e,t,n,r,i){var s;e.m_pointCount=0;var o=t.m_radius+r.m_radius,u=0;b.s_edgeAO[0]=u;var f=b.FindMaxSeparation(b.s_edgeAO,t,n,r,i);u=b.s_edgeAO[0];if(f>o)return;var l=0;b.s_edgeBO[0]=l;var c=b.FindMaxSeparation(b.s_edgeBO,r,i,t,n);l=b.s_edgeBO[0];if(c>o)return;var h,p,d,v,m=0,g=0,y=.98,w=.001,E;c>y*f+w?(h=r,p=t,d=i,v=n,m=l,e.m_type=O.e_faceB,g=1):(h=t,p=r,d=n,v=i,m=u,e.m_type=O.e_faceA,g=0);var S=b.s_incidentEdge;b.FindIncidentEdge(S,h,d,m,p,v);var x=parseInt(h.m_vertexCount),T=h.m_vertices,N=T[m],C;m+1<x?C=T[parseInt(m+1)]:C=T[0];var k=b.s_localTangent;k.Set(C.x-N.x,C.y-N.y),k.Normalize();var L=b.s_localNormal;L.x=k.y,L.y=-k.x;var A=b.s_planePoint;A.Set(.5*(N.x+C.x),.5*(N.y+C.y));var M=b.s_tangent;E=d.R,M.x=E.col1.x*k.x+E.col2.x*k.y,M.y=E.col1.y*k.x+E.col2.y*k.y;var _=b.s_tangent2;_.x=-M.x,_.y=-M.y;var D=b.s_normal;D.x=M.y,D.y=-M.x;var P=b.s_v11,H=b.s_v12;P.x=d.position.x+(E.col1.x*N.x+E.col2.x*N.y),P.y=d.position.y+(E.col1.y*N.x+E.col2.y*N.y),H.x=d.position.x+(E.col1.x*C.x+E.col2.x*C.y),H.y=d.position.y+(E.col1.y*C.x+E.col2.y*C.y);var B=D.x*P.x+D.y*P.y,j=-M.x*P.x-M.y*P.y+o,F=M.x*H.x+M.y*H.y+o,I=b.s_clipPoints1,q=b.s_clipPoints2,R=0;R=b.ClipSegmentToLine(I,S,_,j);if(R<2)return;R=b.ClipSegmentToLine(q,I,M,F);if(R<2)return;e.m_localPlaneNormal.SetV(L),e.m_localPoint.SetV(A);var U=0;for(var z=0;z<a.b2_maxManifoldPoints;++z){s=q[z];var W=D.x*s.v.x+D.y*s.v.y-B;if(W<=o){var X=e.m_points[U];E=v.R;var V=s.v.x-v.position.x,$=s.v.y-v.position.y;X.m_localPoint.x=V*E.col1.x+$*E.col1.y,X.m_localPoint.y=V*E.col2.x+$*E.col2.y,X.m_id.Set(s.id),X.m_id.features.flip=g,++U}}e.m_pointCount=U},b.CollideCircles=function(e,t,n,r,i){e.m_pointCount=0;var s,o;s=n.R,o=t.m_p;var u=n.position.x+(s.col1.x*o.x+s.col2.x*o.y),a=n.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=r.m_p;var f=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),l=i.position.y+(s.col1.y*o.x+s.col2.y*o.y),c=f-u,h=l-a,p=c*c+h*h,d=t.m_radius+r.m_radius;if(p>d*d)return;e.m_type=O.e_circles,e.m_localPoint.SetV(t.m_p),e.m_localPlaneNormal.SetZero(),e.m_pointCount=1,e.m_points[0].m_localPoint.SetV(r.m_p),e.m_points[0].m_id.key=0},b.CollidePolygonAndCircle=function(e,t,n,r,i){e.m_pointCount=0;var s,o=0,u=0,a=0,f=0,l,c;c=i.R,l=r.m_p;var h=i.position.x+(c.col1.x*l.x+c.col2.x*l.y),p=i.position.y+(c.col1.y*l.x+c.col2.y*l.y);o=h-n.position.x,u=p-n.position.y,c=n.R;var d=o*c.col1.x+u*c.col1.y,v=o*c.col2.x+u*c.col2.y,m=0,g=0,y=-Number.MAX_VALUE,b=t.m_radius+r.m_radius,w=parseInt(t.m_vertexCount),E=t.m_vertices,S=t.m_normals;for(var x=0;x<w;++x){l=E[x],o=d-l.x,u=v-l.y,l=S[x];var T=l.x*o+l.y*u;if(T>b)return;T>y&&(y=T,g=x)}var N=parseInt(g),C=parseInt(N+1<w?N+1:0),k=E[N],L=E[C];if(y<Number.MIN_VALUE){e.m_pointCount=1,e.m_type=O.e_faceA,e.m_localPlaneNormal.SetV(S[g]),e.m_localPoint.x=.5*(k.x+L.x),e.m_localPoint.y=.5*(k.y+L.y),e.m_points[0].m_localPoint.SetV(r.m_p),e.m_points[0].m_id.key=0;return}var A=(d-k.x)*(L.x-k.x)+(v-k.y)*(L.y-k.y),M=(d-L.x)*(k.x-L.x)+(v-L.y)*(k.y-L.y);if(A<=0){if((d-k.x)*(d-k.x)+(v-k.y)*(v-k.y)>b*b)return;e.m_pointCount=1,e.m_type=O.e_faceA,e.m_localPlaneNormal.x=d-k.x,e.m_localPlaneNormal.y=v-k.y,e.m_localPlaneNormal.Normalize(),e.m_localPoint.SetV(k),e.m_points[0].m_localPoint.SetV(r.m_p),e.m_points[0].m_id.key=0}else if(M<=0){if((d-L.x)*(d-L.x)+(v-L.y)*(v-L.y)>b*b)return;e.m_pointCount=1,e.m_type=O.e_faceA,e.m_localPlaneNormal.x=d-L.x,e.m_localPlaneNormal.y=v-L.y,e.m_localPlaneNormal.Normalize(),e.m_localPoint.SetV(L),e.m_points[0].m_localPoint.SetV(r.m_p),e.m_points[0].m_id.key=0}else{var _=.5*(k.x+L.x),D=.5*(k.y+L.y);y=(d-_)*S[N].x+(v-D)*S[N].y;if(y>b)return;e.m_pointCount=1,e.m_type=O.e_faceA,e.m_localPlaneNormal.x=S[N].x,e.m_localPlaneNormal.y=S[N].y,e.m_localPlaneNormal.Normalize(),e.m_localPoint.Set(_,D),e.m_points[0].m_localPoint.SetV(r.m_p),e.m_points[0].m_id.key=0}},b.TestOverlap=function(e,t){var n=t.lowerBound,r=e.upperBound,i=n.x-r.x,s=n.y-r.y;n=e.lowerBound,r=t.upperBound;var o=n.x-r.x,u=n.y-r.y;return i>0||s>0?!1:o>0||u>0?!1:!0},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=b.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=b.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=b.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new d,Box2D.Collision.b2Collision.s_localNormal=new d,Box2D.Collision.b2Collision.s_planePoint=new d,Box2D.Collision.b2Collision.s_normal=new d,Box2D.Collision.b2Collision.s_tangent=new d,Box2D.Collision.b2Collision.s_tangent2=new d,Box2D.Collision.b2Collision.s_v11=new d,Box2D.Collision.b2Collision.s_v12=new d,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new d,Box2D.Collision.b2Collision.b2_nullFeature=255}),w.b2ContactID=function(){this.features=new W},w.prototype.b2ContactID=function(){this.features._m_id=this},w.prototype.Set=function(e){this.key=e._key},w.prototype.Copy=function(){var e=new w;return e.key=this.key,e},Object.defineProperty(w.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(w.prototype,"key",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._key=e,this.features._referenceEdge=this._key&255,this.features._incidentEdge=(this._key&65280)>>8&255,this.features._incidentVertex=(this._key&16711680)>>16&255,this.features._flip=(this._key&4278190080)>>24&255}}),E.b2ContactPoint=function(){this.position=new d,this.velocity=new d,this.normal=new d,this.id=new w},S.b2Distance=function(){},S.Distance=function(e,t,n){++S.b2_gjkCalls;var r=n.proxyA,i=n.proxyB,s=n.transformA,o=n.transformB,u=S.s_simplex;u.ReadCache(t,r,s,i,o);var f=u.m_vertices,l=20,h=S.s_saveA,p=S.s_saveB,v=0,m=u.GetClosestPoint(),g=m.LengthSquared(),y=g,b=0,w,E=0;while(E<l){v=u.m_count;for(b=0;b<v;b++)h[b]=f[b].indexA,p[b]=f[b].indexB;switch(u.m_count){case 1:break;case 2:u.Solve2();break;case 3:u.Solve3();break;default:a.b2Assert(!1)}if(u.m_count==3)break;w=u.GetClosestPoint(),y=w.LengthSquared(),y>g,g=y;var x=u.GetSearchDirection();if(x.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var T=f[u.m_count];T.indexA=r.GetSupport(c.MulTMV(s.R,x.GetNegative())),T.wA=c.MulX(s,r.GetVertex(T.indexA)),T.indexB=i.GetSupport(c.MulTMV(o.R,x)),T.wB=c.MulX(o,i.GetVertex(T.indexB)),T.w=c.SubtractVV(T.wB,T.wA),++E,++S.b2_gjkIters;var N=!1;for(b=0;b<v;b++)if(T.indexA==h[b]&&T.indexB==p[b]){N=!0;break}if(N)break;++u.m_count}S.b2_gjkMaxIters=c.Max(S.b2_gjkMaxIters,E),u.GetWitnessPoints(e.pointA,e.pointB),e.distance=c.SubtractVV(e.pointA,e.pointB).Length(),e.iterations=E,u.WriteCache(t);if(n.useRadii){var C=r.m_radius,k=i.m_radius;if(e.distance>C+k&&e.distance>Number.MIN_VALUE){e.distance-=C+k;var L=c.SubtractVV(e.pointB,e.pointA);L.Normalize(),e.pointA.x+=C*L.x,e.pointA.y+=C*L.y,e.pointB.x-=k*L.x,e.pointB.y-=k*L.y}else w=new d,w.x=.5*(e.pointA.x+e.pointB.x),w.y=.5*(e.pointA.y+e.pointB.y),e.pointA.x=e.pointB.x=w.x,e.pointA.y=e.pointB.y=w.y,e.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new j,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),x.b2DistanceInput=function(){},T.b2DistanceOutput=function(){this.pointA=new d,this.pointB=new d},N.b2DistanceProxy=function(){},N.prototype.Set=function(t){switch(t.GetType()){case s.e_circleShape:var n=t instanceof e?t:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=n.m_p,this.m_count=1,this.m_radius=n.m_radius;break;case s.e_polygonShape:var r=t instanceof i?t:null;this.m_vertices=r.m_vertices,this.m_count=r.m_vertexCount,this.m_radius=r.m_radius;break;default:a.b2Assert(!1)}},N.prototype.GetSupport=function(e){var t=0,n=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y;for(var r=1;r<this.m_count;++r){var i=this.m_vertices[r].x*e.x+this.m_vertices[r].y*e.y;i>n&&(t=r,n=i)}return t},N.prototype.GetSupportVertex=function(e){var t=0,n=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y;for(var r=1;r<this.m_count;++r){var i=this.m_vertices[r].x*e.x+this.m_vertices[r].y*e.y;i>n&&(t=r,n=i)}return this.m_vertices[t]},N.prototype.GetVertexCount=function(){return this.m_count},N.prototype.GetVertex=function(e){return e===undefined&&(e=0),a.b2Assert(0<=e&&e<this.m_count),this.m_vertices[e]},C.b2DynamicTree=function(){},C.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},C.prototype.CreateProxy=function(e,t){var n=this.AllocateNode(),r=a.b2_aabbExtension,i=a.b2_aabbExtension;return n.aabb.lowerBound.x=e.lowerBound.x-r,n.aabb.lowerBound.y=e.lowerBound.y-i,n.aabb.upperBound.x=e.upperBound.x+r,n.aabb.upperBound.y=e.upperBound.y+i,n.userData=t,this.InsertLeaf(n),n},C.prototype.DestroyProxy=function(e){this.RemoveLeaf(e),this.FreeNode(e)},C.prototype.MoveProxy=function(e,t,n){a.b2Assert(e.IsLeaf());if(e.aabb.Contains(t))return!1;this.RemoveLeaf(e);var r=a.b2_aabbExtension+a.b2_aabbMultiplier*(n.x>0?n.x:-n.x),i=a.b2_aabbExtension+a.b2_aabbMultiplier*(n.y>0?n.y:-n.y);return e.aabb.lowerBound.x=t.lowerBound.x-r,e.aabb.lowerBound.y=t.lowerBound.y-i,e.aabb.upperBound.x=t.upperBound.x+r,e.aabb.upperBound.y=t.upperBound.y+i,this.InsertLeaf(e),!0},C.prototype.Rebalance=function(e){e===undefined&&(e=0);if(this.m_root==null)return;for(var t=0;t<e;t++){var n=this.m_root,r=0;while(n.IsLeaf()==0)n=this.m_path>>r&1?n.child2:n.child1,r=r+1&31;++this.m_path,this.RemoveLeaf(n),this.InsertLeaf(n)}},C.prototype.GetFatAABB=function(e){return e.aabb},C.prototype.GetUserData=function(e){return e.userData},C.prototype.Query=function(e,t){if(this.m_root==null)return;var n=new Vector,r=0;n[r++]=this.m_root;while(r>0){var i=n[--r];if(i.aabb.TestOverlap(t))if(i.IsLeaf()){var s=e(i);if(!s)return}else n[r++]=i.child1,n[r++]=i.child2}},C.prototype.RayCast=function(e,t){if(this.m_root==null)return;var n=t.p1,r=t.p2,i=c.SubtractVV(n,r);i.Normalize();var s=c.CrossFV(1,i),o=c.AbsV(s),u=t.maxFraction,a=new m,f=0,l=0;f=n.x+u*(r.x-n.x),l=n.y+u*(r.y-n.y),a.lowerBound.x=Math.min(n.x,f),a.lowerBound.y=Math.min(n.y,l),a.upperBound.x=Math.max(n.x,f),a.upperBound.y=Math.max(n.y,l);var h=new Vector,p=0;h[p++]=this.m_root;while(p>0){var d=h[--p];if(d.aabb.TestOverlap(a)==0)continue;var v=d.aabb.GetCenter(),g=d.aabb.GetExtents(),y=Math.abs(s.x*(n.x-v.x)+s.y*(n.y-v.y))-o.x*g.x-o.y*g.y;if(y>0)continue;if(d.IsLeaf()){var b=new D;b.p1=t.p1,b.p2=t.p2,b.maxFraction=t.maxFraction,u=e(b,d);if(u==0)return;u>0&&(f=n.x+u*(r.x-n.x),l=n.y+u*(r.y-n.y),a.lowerBound.x=Math.min(n.x,f),a.lowerBound.y=Math.min(n.y,l),a.upperBound.x=Math.max(n.x,f),a.upperBound.y=Math.max(n.y,l))}else h[p++]=d.child1,h[p++]=d.child2}},C.prototype.AllocateNode=function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e}return new L},C.prototype.FreeNode=function(e){e.parent=this.m_freeList,this.m_freeList=e},C.prototype.InsertLeaf=function(e){++this.m_insertionCount;if(this.m_root==null){this.m_root=e,this.m_root.parent=null;return}var t=e.aabb.GetCenter(),n=this.m_root;if(n.IsLeaf()==0)do{var r=n.child1,i=n.child2,s=Math.abs((r.aabb.lowerBound.x+r.aabb.upperBound.x)/2-t.x)+Math.abs((r.aabb.lowerBound.y+r.aabb.upperBound.y)/2-t.y),o=Math.abs((i.aabb.lowerBound.x+i.aabb.upperBound.x)/2-t.x)+Math.abs((i.aabb.lowerBound.y+i.aabb.upperBound.y)/2-t.y);s<o?n=r:n=i}while(n.IsLeaf()==0);var u=n.parent,a=this.AllocateNode();a.parent=u,a.userData=null,a.aabb.Combine(e.aabb,n.aabb);if(u){n.parent.child1==n?u.child1=a:u.child2=a,a.child1=n,a.child2=e,n.parent=a,e.parent=a;do{if(u.aabb.Contains(a.aabb))break;u.aabb.Combine(u.child1.aabb,u.child2.aabb),a=u,u=u.parent}while(u)}else a.child1=n,a.child2=e,n.parent=a,e.parent=a,this.m_root=a},C.prototype.RemoveLeaf=function(e){if(e==this.m_root){this.m_root=null;return}var t=e.parent,n=t.parent,r;t.child1==e?r=t.child2:r=t.child1;if(n){n.child1==t?n.child1=r:n.child2=r,r.parent=n,this.FreeNode(t);while(n){var i=n.aabb;n.aabb=m.Combine(n.child1.aabb,n.child2.aabb);if(i.Contains(n.aabb))break;n=n.parent}}else this.m_root=r,r.parent=null,this.FreeNode(t)},k.b2DynamicTreeBroadPhase=function(){this.m_tree=new C,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},k.prototype.CreateProxy=function(e,t){var n=this.m_tree.CreateProxy(e,t);return++this.m_proxyCount,this.BufferMove(n),n},k.prototype.DestroyProxy=function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)},k.prototype.MoveProxy=function(e,t,n){var r=this.m_tree.MoveProxy(e,t,n);r&&this.BufferMove(e)},k.prototype.TestOverlap=function(e,t){var n=this.m_tree.GetFatAABB(e),r=this.m_tree.GetFatAABB(t);return n.TestOverlap(r)},k.prototype.GetUserData=function(e){return this.m_tree.GetUserData(e)},k.prototype.GetFatAABB=function(e){return this.m_tree.GetFatAABB(e)},k.prototype.GetProxyCount=function(){return this.m_proxyCount},k.prototype.UpdatePairs=function(e){var t=this;t.m_pairCount=0;var n=0,r;for(n=0;n<t.m_moveBuffer.length;++n){r=t.m_moveBuffer[n];function i(e){if(e==r)return!0;t.m_pairCount==t.m_pairBuffer.length&&(t.m_pairBuffer[t.m_pairCount]=new A);var n=t.m_pairBuffer[t.m_pairCount];return n.proxyA=e<r?e:r,n.proxyB=e>=r?e:r,++t.m_pairCount,!0}var s=t.m_tree.GetFatAABB(r);t.m_tree.Query(i,s)}t.m_moveBuffer.length=0;for(var n=0;n<t.m_pairCount;){var o=t.m_pairBuffer[n],u=t.m_tree.GetUserData(o.proxyA),a=t.m_tree.GetUserData(o.proxyB);e(u,a),++n;while(n<t.m_pairCount){var f=t.m_pairBuffer[n];if(f.proxyA!=o.proxyA||f.proxyB!=o.proxyB)break;++n}}},k.prototype.Query=function(e,t){this.m_tree.Query(e,t)},k.prototype.RayCast=function(e,t){this.m_tree.RayCast(e,t)},k.prototype.Validate=function(){},k.prototype.Rebalance=function(e){e===undefined&&(e=0),this.m_tree.Rebalance(e)},k.prototype.BufferMove=function(e){this.m_moveBuffer[this.m_moveBuffer.length]=e},k.prototype.UnBufferMove=function(e){var t=parseInt(this.m_moveBuffer.indexOf(e));this.m_moveBuffer.splice(t,1)},k.prototype.ComparePairs=function(e,t){return 0},k.__implements={},k.__implements[X]=!0,L.b2DynamicTreeNode=function(){this.aabb=new m},L.prototype.IsLeaf=function(){return this.child1==null},A.b2DynamicTreePair=function(){},O.b2Manifold=function(){this.m_pointCount=0},O.prototype.b2Manifold=function(){this.m_points=new Vector(a.b2_maxManifoldPoints);for(var e=0;e<a.b2_maxManifoldPoints;e++)this.m_points[e]=new M;this.m_localPlaneNormal=new d,this.m_localPoint=new d},O.prototype.Reset=function(){for(var e=0;e<a.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof M?this.m_points[e]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},O.prototype.Set=function(e){this.m_pointCount=e.m_pointCount;for(var t=0;t<a.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof M?this.m_points[t]:null).Set(e.m_points[t]);this.m_localPlaneNormal.SetV(e.m_localPlaneNormal),this.m_localPoint.SetV(e.m_localPoint),this.m_type=e.m_type},O.prototype.Copy=function(){var e=new O;return e.Set(this),e},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),M.b2ManifoldPoint=function(){this.m_localPoint=new d,this.m_id=new w},M.prototype.b2ManifoldPoint=function(){this.Reset()},M.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},M.prototype.Set=function(e){this.m_localPoint.SetV(e.m_localPoint),this.m_normalImpulse=e.m_normalImpulse,this.m_tangentImpulse=e.m_tangentImpulse,this.m_id.Set(e.m_id)},_.b2Point=function(){this.p=new d},_.prototype.Support=function(e,t,n){return t===undefined&&(t=0),n===undefined&&(n=0),this.p},_.prototype.GetFirstVertex=function(e){return this.p},D.b2RayCastInput=function(){this.p1=new d,this.p2=new d},D.prototype.b2RayCastInput=function(e,t,n){e===undefined&&(e=null),t===undefined&&(t=null),n===undefined&&(n=1),e&&this.p1.SetV(e),t&&this.p2.SetV(t),this.maxFraction=n},P.b2RayCastOutput=function(){this.normal=new d},H.b2Segment=function(){this.p1=new d,this.p2=new d},H.prototype.TestSegment=function(e,t,n,r){r===undefined&&(r=0);var i=n.p1,s=n.p2.x-i.x,o=n.p2.y-i.y,u=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,f=a,l=-u,c=100*Number.MIN_VALUE,h=-(s*f+o*l);if(h>c){var p=i.x-this.p1.x,d=i.y-this.p1.y,v=p*f+d*l;if(0<=v&&v<=r*h){var m=-s*d+o*p;if(-c*h<=m&&m<=h*(1+c)){v/=h;var g=Math.sqrt(f*f+l*l);return f/=g,l/=g,e[0]=v,t.Set(f,l),!0}}}return!1},H.prototype.Extend=function(e){this.ExtendForward(e),this.ExtendBackward(e)},H.prototype.ExtendForward=function(e){var t=this.p2.x-this.p1.x,n=this.p2.y-this.p1.y,r=Math.min(t>0?(e.upperBound.x-this.p1.x)/t:t<0?(e.lowerBound.x-this.p1.x)/t:Number.POSITIVE_INFINITY,n>0?(e.upperBound.y-this.p1.y)/n:n<0?(e.lowerBound.y-this.p1.y)/n:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+t*r,this.p2.y=this.p1.y+n*r},H.prototype.ExtendBackward=function(e){var t=-this.p2.x+this.p1.x,n=-this.p2.y+this.p1.y,r=Math.min(t>0?(e.upperBound.x-this.p2.x)/t:t<0?(e.lowerBound.x-this.p2.x)/t:Number.POSITIVE_INFINITY,n>0?(e.upperBound.y-this.p2.y)/n:n<0?(e.lowerBound.y-this.p2.y)/n:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+t*r,this.p1.y=this.p2.y+n*r},B.b2SeparationFunction=function(){this.m_localPoint=new d,this.m_axis=new d},B.prototype.Initialize=function(e,t,n,r,i){this.m_proxyA=t,this.m_proxyB=r;var s=parseInt(e.count);a.b2Assert(0<s&&s<3);var o,u,f,l,h,p,v=0,m=0,g=0,y=0,b=0,w=0,E,S,x=0,T=0;if(s==1)this.m_type=B.e_points,o=this.m_proxyA.GetVertex(e.indexA[0]),l=this.m_proxyB.GetVertex(e.indexB[0]),S=o,E=n.R,v=n.position.x+(E.col1.x*S.x+E.col2.x*S.y),m=n.position.y+(E.col1.y*S.x+E.col2.y*S.y),S=l,E=i.R,g=i.position.x+(E.col1.x*S.x+E.col2.x*S.y),y=i.position.y+(E.col1.y*S.x+E.col2.y*S.y),this.m_axis.x=g-v,this.m_axis.y=y-m,this.m_axis.Normalize();else if(e.indexB[0]==e.indexB[1])this.m_type=B.e_faceA,u=this.m_proxyA.GetVertex(e.indexA[0]),f=this.m_proxyA.GetVertex(e.indexA[1]),l=this.m_proxyB.GetVertex(e.indexB[0]),this.m_localPoint.x=.5*(u.x+f.x),this.m_localPoint.y=.5*(u.y+f.y),this.m_axis=c.CrossVF(c.SubtractVV(f,u),1),this.m_axis.Normalize(),S=this.m_axis,E=n.R,b=E.col1.x*S.x+E.col2.x*S.y,w=E.col1.y*S.x+E.col2.y*S.y,S=this.m_localPoint,E=n.R,v=n.position.x+(E.col1.x*S.x+E.col2.x*S.y),m=n.position.y+(E.col1.y*S.x+E.col2.y*S.y),S=l,E=i.R,g=i.position.x+(E.col1.x*S.x+E.col2.x*S.y),y=i.position.y+(E.col1.y*S.x+E.col2.y*S.y),x=(g-v)*b+(y-m)*w,x<0&&this.m_axis.NegativeSelf();else if(e.indexA[0]==e.indexA[0])this.m_type=B.e_faceB,h=this.m_proxyB.GetVertex(e.indexB[0]),p=this.m_proxyB.GetVertex(e.indexB[1]),o=this.m_proxyA.GetVertex(e.indexA[0]),this.m_localPoint.x=.5*(h.x+p.x),this.m_localPoint.y=.5*(h.y+p.y),this.m_axis=c.CrossVF(c.SubtractVV(p,h),1),this.m_axis.Normalize(),S=this.m_axis,E=i.R,b=E.col1.x*S.x+E.col2.x*S.y,w=E.col1.y*S.x+E.col2.y*S.y,S=this.m_localPoint,E=i.R,g=i.position.x+(E.col1.x*S.x+E.col2.x*S.y),y=i.position.y+(E.col1.y*S.x+E.col2.y*S.y),S=o,E=n.R,v=n.position.x+(E.col1.x*S.x+E.col2.x*S.y),m=n.position.y+(E.col1.y*S.x+E.col2.y*S.y),x=(v-g)*b+(m-y)*w,x<0&&this.m_axis.NegativeSelf();else{u=this.m_proxyA.GetVertex(e.indexA[0]),f=this.m_proxyA.GetVertex(e.indexA[1]),h=this.m_proxyB.GetVertex(e.indexB[0]),p=this.m_proxyB.GetVertex(e.indexB[1]);var N=c.MulX(n,o),C=c.MulMV(n.R,c.SubtractVV(f,u)),k=c.MulX(i,l),L=c.MulMV(i.R,c.SubtractVV(p,h)),A=C.x*C.x+C.y*C.y,O=L.x*L.x+L.y*L.y,M=c.SubtractVV(L,C),_=C.x*M.x+C.y*M.y,D=L.x*M.x+L.y*M.y,P=C.x*L.x+C.y*L.y,H=A*O-P*P;x=0,H!=0&&(x=c.Clamp((P*D-_*O)/H,0,1));var j=(P*x+D)/O;j<0&&(j=0,x=c.Clamp((P-_)/A,0,1)),o=new d,o.x=u.x+x*(f.x-u.x),o.y=u.y+x*(f.y-u.y),l=new d,l.x=h.x+x*(p.x-h.x),l.y=h.y+x*(p.y-h.y),x==0||x==1?(this.m_type=B.e_faceB,this.m_axis=c.CrossVF(c.SubtractVV(p,h),1),this.m_axis.Normalize(),this.m_localPoint=l,S=this.m_axis,E=i.R,b=E.col1.x*S.x+E.col2.x*S.y,w=E.col1.y*S.x+E.col2.y*S.y,S=this.m_localPoint,E=i.R,g=i.position.x+(E.col1.x*S.x+E.col2.x*S.y),y=i.position.y+(E.col1.y*S.x+E.col2.y*S.y),S=o,E=n.R,v=n.position.x+(E.col1.x*S.x+E.col2.x*S.y),m=n.position.y+(E.col1.y*S.x+E.col2.y*S.y),T=(v-g)*b+(m-y)*w,x<0&&this.m_axis.NegativeSelf()):(this.m_type=B.e_faceA,this.m_axis=c.CrossVF(c.SubtractVV(f,u),1),this.m_localPoint=o,S=this.m_axis,E=n.R,b=E.col1.x*S.x+E.col2.x*S.y,w=E.col1.y*S.x+E.col2.y*S.y,S=this.m_localPoint,E=n.R,v=n.position.x+(E.col1.x*S.x+E.col2.x*S.y),m=n.position.y+(E.col1.y*S.x+E.col2.y*S.y),S=l,E=i.R,g=i.position.x+(E.col1.x*S.x+E.col2.x*S.y),y=i.position.y+(E.col1.y*S.x+E.col2.y*S.y),T=(g-v)*b+(y-m)*w,x<0&&this.m_axis.NegativeSelf())}},B.prototype.Evaluate=function(e,t){var n,r,i,s,o,u,f=0,l;switch(this.m_type){case B.e_points:return n=c.MulTMV(e.R,this.m_axis),r=c.MulTMV(t.R,this.m_axis.GetNegative()),i=this.m_proxyA.GetSupportVertex(n),s=this.m_proxyB.GetSupportVertex(r),o=c.MulX(e,i),u=c.MulX(t,s),f=(u.x-o.x)*this.m_axis.x+(u.y-o.y)*this.m_axis.y,f;case B.e_faceA:return l=c.MulMV(e.R,this.m_axis),o=c.MulX(e,this.m_localPoint),r=c.MulTMV(t.R,l.GetNegative()),s=this.m_proxyB.GetSupportVertex(r),u=c.MulX(t,s),f=(u.x-o.x)*l.x+(u.y-o.y)*l.y,f;case B.e_faceB:return l=c.MulMV(t.R,this.m_axis),u=c.MulX(t,this.m_localPoint),n=c.MulTMV(e.R,l.GetNegative()),i=this.m_proxyA.GetSupportVertex(n),o=c.MulX(e,i),f=(o.x-u.x)*l.x+(o.y-u.y)*l.y,f;default:return a.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),j.b2Simplex=function(){this.m_v1=new I,this.m_v2=new I,this.m_v3=new I,this.m_vertices=new Vector(3)},j.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},j.prototype.ReadCache=function(e,t,n,r,i){a.b2Assert(0<=e.count&&e.count<=3);var s,o;this.m_count=e.count;var u=this.m_vertices;for(var f=0;f<this.m_count;f++){var l=u[f];l.indexA=e.indexA[f],l.indexB=e.indexB[f],s=t.GetVertex(l.indexA),o=r.GetVertex(l.indexB),l.wA=c.MulX(n,s),l.wB=c.MulX(i,o),l.w=c.SubtractVV(l.wB,l.wA),l.a=0}if(this.m_count>1){var h=e.metric,p=this.GetMetric();if(p<.5*h||2*h<p||p<Number.MIN_VALUE)this.m_count=0}this.m_count==0&&(l=u[0],l.indexA=0,l.indexB=0,s=t.GetVertex(0),o=r.GetVertex(0),l.wA=c.MulX(n,s),l.wB=c.MulX(i,o),l.w=c.SubtractVV(l.wB,l.wA),this.m_count=1)},j.prototype.WriteCache=function(e){e.metric=this.GetMetric(),e.count=Box2D.parseUInt(this.m_count);var t=this.m_vertices;for(var n=0;n<this.m_count;n++)e.indexA[n]=Box2D.parseUInt(t[n].indexA),e.indexB[n]=Box2D.parseUInt(t[n].indexB)},j.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var e=c.SubtractVV(this.m_v2.w,this.m_v1.w),t=c.CrossVV(e,this.m_v1.w.GetNegative());return t>0?c.CrossFV(1,e):c.CrossVF(e,1);default:return a.b2Assert(!1),new d}},j.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return a.b2Assert(!1),new d;case 1:return this.m_v1.w;case 2:return new d(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return a.b2Assert(!1),new d}},j.prototype.GetWitnessPoints=function(e,t){switch(this.m_count){case 0:a.b2Assert(!1);break;case 1:e.SetV(this.m_v1.wA),t.SetV(this.m_v1.wB);break;case 2:e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,t.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,t.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:t.x=e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,t.y=e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:a.b2Assert(!1)}},j.prototype.GetMetric=function(){switch(this.m_count){case 0:return a.b2Assert(!1),0;case 1:return 0;case 2:return c.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return c.CrossVV(c.SubtractVV(this.m_v2.w,this.m_v1.w),c.SubtractVV(this.m_v3.w,this.m_v1.w));default:return a.b2Assert(!1),0}},j.prototype.Solve2=function(){var e=this.m_v1.w,t=this.m_v2.w,n=c.SubtractVV(t,e),r=-(e.x*n.x+e.y*n.y);if(r<=0){this.m_v1.a=1,this.m_count=1;return}var i=t.x*n.x+t.y*n.y;if(i<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.Set(this.m_v2);return}var s=1/(i+r);this.m_v1.a=i*s,this.m_v2.a=r*s,this.m_count=2},j.prototype.Solve3=function(){var e=this.m_v1.w,t=this.m_v2.w,n=this.m_v3.w,r=c.SubtractVV(t,e),i=c.Dot(e,r),s=c.Dot(t,r),o=s,u=-i,a=c.SubtractVV(n,e),f=c.Dot(e,a),l=c.Dot(n,a),h=l,p=-f,d=c.SubtractVV(n,t),v=c.Dot(t,d),m=c.Dot(n,d),g=m,y=-v,b=c.CrossVV(r,a),w=b*c.CrossVV(t,n),E=b*c.CrossVV(n,e),S=b*c.CrossVV(e,t);if(u<=0&&p<=0){this.m_v1.a=1,this.m_count=1;return}if(o>0&&u>0&&S<=0){var x=1/(o+u);this.m_v1.a=o*x,this.m_v2.a=u*x,this.m_count=2;return}if(h>0&&p>0&&E<=0){var T=1/(h+p);this.m_v1.a=h*T,this.m_v3.a=p*T,this.m_count=2,this.m_v2.Set(this.m_v3);return}if(o<=0&&y<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.Set(this.m_v2);return}if(h<=0&&g<=0){this.m_v3.a=1,this.m_count=1,this.m_v1.Set(this.m_v3);return}if(g>0&&y>0&&w<=0){var N=1/(g+y);this.m_v2.a=g*N,this.m_v3.a=y*N,this.m_count=2,this.m_v1.Set(this.m_v3);return}var C=1/(w+E+S);this.m_v1.a=w*C,this.m_v2.a=E*C,this.m_v3.a=S*C,this.m_count=3},F.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},I.b2SimplexVertex=function(){},I.prototype.Set=function(e){this.wA.SetV(e.wA),this.wB.SetV(e.wB),this.w.SetV(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB},q.b2TimeOfImpact=function(){},q.TimeOfImpact=function(e){++q.b2_toiCalls;var t=e.proxyA,n=e.proxyB,r=e.sweepA,i=e.sweepB;a.b2Assert(r.t0==i.t0),a.b2Assert(1-r.t0>Number.MIN_VALUE);var s=t.m_radius+n.m_radius,o=e.tolerance,u=0,f=1e3,l=0,h=0;q.s_cache.count=0,q.s_distanceInput.useRadii=!1;for(;;){r.GetTransform(q.s_xfA,u),i.GetTransform(q.s_xfB,u),q.s_distanceInput.proxyA=t,q.s_distanceInput.proxyB=n,q.s_distanceInput.transformA=q.s_xfA,q.s_distanceInput.transformB=q.s_xfB,S.Distance(q.s_distanceOutput,q.s_cache,q.s_distanceInput);if(q.s_distanceOutput.distance<=0){u=1;break}q.s_fcn.Initialize(q.s_cache,t,q.s_xfA,n,q.s_xfB);var p=q.s_fcn.Evaluate(q.s_xfA,q.s_xfB);if(p<=0){u=1;break}l==0&&(p>s?h=c.Max(s-o,.75*s):h=c.Max(p-o,.02*s));if(p-h<.5*o){if(l==0){u=1;break}break}var d=u,v=u,m=1,g=p;r.GetTransform(q.s_xfA,m),i.GetTransform(q.s_xfB,m);var y=q.s_fcn.Evaluate(q.s_xfA,q.s_xfB);if(y>=h){u=1;break}var b=0;for(;;){var w=0;b&1?w=v+(h-g)*(m-v)/(y-g):w=.5*(v+m),r.GetTransform(q.s_xfA,w),i.GetTransform(q.s_xfB,w);var E=q.s_fcn.Evaluate(q.s_xfA,q.s_xfB);if(c.Abs(E-h)<.025*o){d=w;break}E>h?(v=w,g=E):(m=w,y=E),++b,++q.b2_toiRootIters;if(b==50)break}q.b2_toiMaxRootIters=c.Max(q.b2_toiMaxRootIters,b);if(d<(1+100*Number.MIN_VALUE)*u)break;u=d,l++,++q.b2_toiIters;if(l==f)break}return q.b2_toiMaxIters=c.Max(q.b2_toiMaxIters,l),u},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new F,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new x,Box2D.Collision.b2TimeOfImpact.s_xfA=new p,Box2D.Collision.b2TimeOfImpact.s_xfB=new p,Box2D.Collision.b2TimeOfImpact.s_fcn=new B,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new T}),R.b2TOIInput=function(){this.proxyA=new N,this.proxyB=new N,this.sweepA=new h,this.sweepB=new h},U.b2WorldManifold=function(){this.m_normal=new d},U.prototype.b2WorldManifold=function(){this.m_points=new Vector(a.b2_maxManifoldPoints);for(var e=0;e<a.b2_maxManifoldPoints;e++)this.m_points[e]=new d},U.prototype.Initialize=function(e,t,n,r,i){n===undefined&&(n=0),i===undefined&&(i=0);if(e.m_pointCount==0)return;var s=0,o,u,a=0,f=0,l=0,c=0,h=0,p=0;switch(e.m_type){case O.e_circles:u=t.R,o=e.m_localPoint;var d=t.position.x+u.col1.x*o.x+u.col2.x*o.y,v=t.position.y+u.col1.y*o.x+u.col2.y*o.y;u=r.R,o=e.m_points[0].m_localPoint;var m=r.position.x+u.col1.x*o.x+u.col2.x*o.y,g=r.position.y+u.col1.y*o.x+u.col2.y*o.y,y=m-d,b=g-v,w=y*y+b*b;if(w>Number.MIN_VALUE*Number.MIN_VALUE){var E=Math.sqrt(w);this.m_normal.x=y/E,this.m_normal.y=b/E}else this.m_normal.x=1,this.m_normal.y=0;var S=d+n*this.m_normal.x,x=v+n*this.m_normal.y,T=m-i*this.m_normal.x,N=g-i*this.m_normal.y;this.m_points[0].x=.5*(S+T),this.m_points[0].y=.5*(x+N);break;case O.e_faceA:u=t.R,o=e.m_localPlaneNormal,a=u.col1.x*o.x+u.col2.x*o.y,f=u.col1.y*o.x+u.col2.y*o.y,u=t.R,o=e.m_localPoint,l=t.position.x+u.col1.x*o.x+u.col2.x*o.y,c=t.position.y+u.col1.y*o.x+u.col2.y*o.y,this.m_normal.x=a,this.m_normal.y=f;for(s=0;s<e.m_pointCount;s++)u=r.R,o=e.m_points[s].m_localPoint,h=r.position.x+u.col1.x*o.x+u.col2.x*o.y,p=r.position.y+u.col1.y*o.x+u.col2.y*o.y,this.m_points[s].x=h+.5*(n-(h-l)*a-(p-c)*f-i)*a,this.m_points[s].y=p+.5*(n-(h-l)*a-(p-c)*f-i)*f;break;case O.e_faceB:u=r.R,o=e.m_localPlaneNormal,a=u.col1.x*o.x+u.col2.x*o.y,f=u.col1.y*o.x+u.col2.y*o.y,u=r.R,o=e.m_localPoint,l=r.position.x+u.col1.x*o.x+u.col2.x*o.y,c=r.position.y+u.col1.y*o.x+u.col2.y*o.y,this.m_normal.x=-a,this.m_normal.y=-f;for(s=0;s<e.m_pointCount;s++)u=t.R,o=e.m_points[s].m_localPoint,h=t.position.x+u.col1.x*o.x+u.col2.x*o.y,p=t.position.y+u.col1.y*o.x+u.col2.y*o.y,this.m_points[s].x=h+.5*(i-(h-l)*a-(p-c)*f-n)*a,this.m_points[s].y=p+.5*(i-(h-l)*a-(p-c)*f-n)*f}},z.ClipVertex=function(){this.v=new d,this.id=new w},z.prototype.Set=function(e){this.v.SetV(e.v),this.id.Set(e.id)},W.Features=function(){},Object.defineProperty(W.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(W.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._referenceEdge=e,this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}}),Object.defineProperty(W.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(W.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._incidentEdge=e,this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}}),Object.defineProperty(W.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(W.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._incidentVertex=e,this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680}}),Object.defineProperty(W.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(W.prototype,"flip",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._flip=e,this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080}})}(),function(){var e=Box2D.Common.b2Color,t=Box2D.Common.b2internal,n=Box2D.Common.b2Settings,r=Box2D.Collision.Shapes.b2CircleShape,i=Box2D.Collision.Shapes.b2EdgeChainDef,s=Box2D.Collision.Shapes.b2EdgeShape,o=Box2D.Collision.Shapes.b2MassData,u=Box2D.Collision.Shapes.b2PolygonShape,a=Box2D.Collision.Shapes.b2Shape,f=Box2D.Common.Math.b2Mat22,l=Box2D.Common.Math.b2Mat33,c=Box2D.Common.Math.b2Math,h=Box2D.Common.Math.b2Sweep,p=Box2D.Common.Math.b2Transform,d=Box2D.Common.Math.b2Vec2,v=Box2D.Common.Math.b2Vec3,m=Box2D.Dynamics.b2Body,g=Box2D.Dynamics.b2BodyDef,y=Box2D.Dynamics.b2ContactFilter,b=Box2D.Dynamics.b2ContactImpulse,w=Box2D.Dynamics.b2ContactListener,E=Box2D.Dynamics.b2ContactManager,S=Box2D.Dynamics.b2DebugDraw,x=Box2D.Dynamics.b2DestructionListener,T=Box2D.Dynamics.b2FilterData,N=Box2D.Dynamics.b2Fixture,C=Box2D.Dynamics.b2FixtureDef,k=Box2D.Dynamics.b2Island,L=Box2D.Dynamics.b2TimeStep,A=Box2D.Dynamics.b2World,O=Box2D.Collision.b2AABB,M=Box2D.Collision.b2Bound,_=Box2D.Collision.b2BoundValues,D=Box2D.Collision.b2Collision,P=Box2D.Collision.b2ContactID,H=Box2D.Collision.b2ContactPoint,B=Box2D.Collision.b2Distance,j=Box2D.Collision.b2DistanceInput,F=Box2D.Collision.b2DistanceOutput,I=Box2D.Collision.b2DistanceProxy,q=Box2D.Collision.b2DynamicTree,R=Box2D.Collision.b2DynamicTreeBroadPhase,U=Box2D.Collision.b2DynamicTreeNode,z=Box2D.Collision.b2DynamicTreePair,W=Box2D.Collision.b2Manifold,X=Box2D.Collision.b2ManifoldPoint,V=Box2D.Collision.b2Point,$=Box2D.Collision.b2RayCastInput,J=Box2D.Collision.b2RayCastOutput,K=Box2D.Collision.b2Segment,Q=Box2D.Collision.b2SeparationFunction,G=Box2D.Collision.b2Simplex,Y=Box2D.Collision.b2SimplexCache,Z=Box2D.Collision.b2SimplexVertex,et=Box2D.Collision.b2TimeOfImpact,tt=Box2D.Collision.b2TOIInput,nt=Box2D.Collision.b2WorldManifold,rt=Box2D.Collision.ClipVertex,it=Box2D.Collision.Features,st=Box2D.Collision.IBroadPhase;Box2D.inherit(r,Box2D.Collision.Shapes.b2Shape),r.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,r.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new d},r.prototype.Copy=function(){var e=new r;return e.Set(this),e},r.prototype.Set=function(e){this.__super.Set.call(this,e);if(Box2D.is(e,r)){var t=e instanceof r?e:null;this.m_p.SetV(t.m_p)}},r.prototype.TestPoint=function(e,t){var n=e.R,r=e.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=e.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y);return r=t.x-r,i=t.y-i,r*r+i*i<=this.m_radius*this.m_radius},r.prototype.RayCast=function(e,t,n){var r=n.R,i=n.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),s=n.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y),o=t.p1.x-i,u=t.p1.y-s,a=o*o+u*u-this.m_radius*this.m_radius,f=t.p2.x-t.p1.x,l=t.p2.y-t.p1.y,c=o*f+u*l,h=f*f+l*l,p=c*c-h*a;if(p<0||h<Number.MIN_VALUE)return!1;var d=-(c+Math.sqrt(p));return 0<=d&&d<=t.maxFraction*h?(d/=h,e.fraction=d,e.normal.x=o+d*f,e.normal.y=u+d*l,e.normal.Normalize(),!0):!1},r.prototype.ComputeAABB=function(e,t){var n=t.R,r=t.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=t.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y);e.lowerBound.Set(r-this.m_radius,i-this.m_radius),e.upperBound.Set(r+this.m_radius,i+this.m_radius)},r.prototype.ComputeMass=function(e,t){t===undefined&&(t=0),e.mass=t*n.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},r.prototype.ComputeSubmergedArea=function(e,t,n,r){t===undefined&&(t=0);var i=c.MulX(n,this.m_p),s=-(c.Dot(e,i)-t);if(s<-this.m_radius+Number.MIN_VALUE)return 0;if(s>this.m_radius)return r.SetV(i),Math.PI*this.m_radius*this.m_radius;var o=this.m_radius*this.m_radius,u=s*s,a=o*(Math.asin(s/this.m_radius)+Math.PI/2)+s*Math.sqrt(o-u),f=-2/3*Math.pow(o-u,1.5)/a;return r.x=i.x+e.x*f,r.y=i.y+e.y*f,a},r.prototype.GetLocalPosition=function(){return this.m_p},r.prototype.SetLocalPosition=function(e){this.m_p.SetV(e)},r.prototype.GetRadius=function(){return this.m_radius},r.prototype.SetRadius=function(e){e===undefined&&(e=0),this.m_radius=e},r.prototype.b2CircleShape=function(e){e===undefined&&(e=0),this.__super.b2Shape.call(this),this.m_type=a.e_circleShape,this.m_radius=e},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(s,Box2D.Collision.Shapes.b2Shape),s.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,s.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new d,this.m_v1=new d,this.m_v2=new d,this.m_coreV1=new d,this.m_coreV2=new d,this.m_normal=new d,this.m_direction=new d,this.m_cornerDir1=new d,this.m_cornerDir2=new d},s.prototype.TestPoint=function(e,t){return!1},s.prototype.RayCast=function(e,t,n){var r,i=t.p2.x-t.p1.x,s=t.p2.y-t.p1.y;r=n.R;var o=n.position.x+(r.col1.x*this.m_v1.x+r.col2.x*this.m_v1.y),u=n.position.y+(r.col1.y*this.m_v1.x+r.col2.y*this.m_v1.y),a=n.position.y+(r.col1.y*this.m_v2.x+r.col2.y*this.m_v2.y)-u,f=-(n.position.x+(r.col1.x*this.m_v2.x+r.col2.x*this.m_v2.y)-o),l=100*Number.MIN_VALUE,c=-(i*a+s*f);if(c>l){var h=t.p1.x-o,p=t.p1.y-u,d=h*a+p*f;if(0<=d&&d<=t.maxFraction*c){var v=-i*p+s*h;if(-l*c<=v&&v<=c*(1+l)){d/=c,e.fraction=d;var m=Math.sqrt(a*a+f*f);return e.normal.x=a/m,e.normal.y=f/m,!0}}}return!1},s.prototype.ComputeAABB=function(e,t){var n=t.R,r=t.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),i=t.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),s=t.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y),o=t.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y);r<s?(e.lowerBound.x=r,e.upperBound.x=s):(e.lowerBound.x=s,e.upperBound.x=r),i<o?(e.lowerBound.y=i,e.upperBound.y=o):(e.lowerBound.y=o,e.upperBound.y=i)},s.prototype.ComputeMass=function(e,t){t===undefined&&(t=0),e.mass=0,e.center.SetV(this.m_v1),e.I=0},s.prototype.ComputeSubmergedArea=function(e,t,n,r){t===undefined&&(t=0);var i=new d(e.x*t,e.y*t),s=c.MulX(n,this.m_v1),o=c.MulX(n,this.m_v2),u=c.Dot(e,s)-t,a=c.Dot(e,o)-t;if(u>0){if(a>0)return 0;s.x=-a/(u-a)*s.x+u/(u-a)*o.x,s.y=-a/(u-a)*s.y+u/(u-a)*o.y}else a>0&&(o.x=-a/(u-a)*s.x+u/(u-a)*o.x,o.y=-a/(u-a)*s.y+u/(u-a)*o.y);return r.x=(i.x+s.x+o.x)/3,r.y=(i.y+s.y+o.y)/3,.5*((s.x-i.x)*(o.y-i.y)-(s.y-i.y)*(o.x-i.x))},s.prototype.GetLength=function(){return this.m_length},s.prototype.GetVertex1=function(){return this.m_v1},s.prototype.GetVertex2=function(){return this.m_v2},s.prototype.GetCoreVertex1=function(){return this.m_coreV1},s.prototype.GetCoreVertex2=function(){return this.m_coreV2},s.prototype.GetNormalVector=function(){return this.m_normal},s.prototype.GetDirectionVector=function(){return this.m_direction},s.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},s.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},s.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},s.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},s.prototype.GetFirstVertex=function(e){var t=e.R;return new d(e.position.x+(t.col1.x*this.m_coreV1.x+t.col2.x*this.m_coreV1.y),e.position.y+(t.col1.y*this.m_coreV1.x+t.col2.y*this.m_coreV1.y))},s.prototype.GetNextEdge=function(){return this.m_nextEdge},s.prototype.GetPrevEdge=function(){return this.m_prevEdge},s.prototype.Support=function(e,t,n){t===undefined&&(t=0),n===undefined&&(n=0);var r=e.R,i=e.position.x+(r.col1.x*this.m_coreV1.x+r.col2.x*this.m_coreV1.y),s=e.position.y+(r.col1.y*this.m_coreV1.x+r.col2.y*this.m_coreV1.y),o=e.position.x+(r.col1.x*this.m_coreV2.x+r.col2.x*this.m_coreV2.y),u=e.position.y+(r.col1.y*this.m_coreV2.x+r.col2.y*this.m_coreV2.y);return i*t+s*n>o*t+u*n?(this.s_supportVec.x=i,this.s_supportVec.y=s):(this.s_supportVec.x=o,this.s_supportVec.y=u),this.s_supportVec},s.prototype.b2EdgeShape=function(e,t){this.__super.b2Shape.call(this),this.m_type=a.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=t,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-n.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-n.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-n.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-n.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},s.prototype.SetPrevEdge=function(e,t,n,r){this.m_prevEdge=e,this.m_coreV1=t,this.m_cornerDir1=n,this.m_cornerConvex1=r},s.prototype.SetNextEdge=function(e,t,n,r){this.m_nextEdge=e,this.m_coreV2=t,this.m_cornerDir2=n,this.m_cornerConvex2=r},o.b2MassData=function(){this.mass=0,this.center=new d(0,0),this.I=0},Box2D.inherit(u,Box2D.Collision.Shapes.b2Shape),u.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,u.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},u.prototype.Copy=function(){var e=new u;return e.Set(this),e},u.prototype.Set=function(e){this.__super.Set.call(this,e);if(Box2D.is(e,u)){var t=e instanceof u?e:null;this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(t.m_vertices[n]),this.m_normals[n].SetV(t.m_normals[n])}},u.prototype.SetAsArray=function(e,t){t===undefined&&(t=0);var n=new Vector,r=0,i;for(r=0;r<e.length;++r)i=e[r],n.push(i);this.SetAsVector(n,t)},u.AsArray=function(e,t){t===undefined&&(t=0);var n=new u;return n.SetAsArray(e,t),n},u.prototype.SetAsVector=function(e,t){t===undefined&&(t=0),t==0&&(t=e.length),n.b2Assert(2<=t),this.m_vertexCount=t,this.Reserve(t);var r=0;for(r=0;r<this.m_vertexCount;r++)this.m_vertices[r].SetV(e[r]);for(r=0;r<this.m_vertexCount;++r){var i=parseInt(r),s=parseInt(r+1<this.m_vertexCount?r+1:0),o=c.SubtractVV(this.m_vertices[s],this.m_vertices[i]);n.b2Assert(o.LengthSquared()>Number.MIN_VALUE),this.m_normals[r].SetV(c.CrossVF(o,1)),this.m_normals[r].Normalize()}this.m_centroid=u.ComputeCentroid(this.m_vertices,this.m_vertexCount)},u.AsVector=function(e,t){t===undefined&&(t=0);var n=new u;return n.SetAsVector(e,t),n},u.prototype.SetAsBox=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-e,-t),this.m_vertices[1].Set(e,-t),this.m_vertices[2].Set(e,t),this.m_vertices[3].Set(-e,t),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},u.AsBox=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0);var n=new u;return n.SetAsBox(e,t),n},u.prototype.SetAsOrientedBox=function(e,t,n,r){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=null),r===undefined&&(r=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-e,-t),this.m_vertices[1].Set(e,-t),this.m_vertices[2].Set(e,t),this.m_vertices[3].Set(-e,t),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=n;var i=new p;i.position=n,i.R.Set(r);for(var s=0;s<this.m_vertexCount;++s)this.m_vertices[s]=c.MulX(i,this.m_vertices[s]),this.m_normals[s]=c.MulMV(i.R,this.m_normals[s])},u.AsOrientedBox=function(e,t,n,r){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=null),r===undefined&&(r=0);var i=new u;return i.SetAsOrientedBox(e,t,n,r),i},u.prototype.SetAsEdge=function(e,t){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(e),this.m_vertices[1].SetV(t),this.m_centroid.x=.5*(e.x+t.x),this.m_centroid.y=.5*(e.y+t.y),this.m_normals[0]=c.CrossVF(c.SubtractVV(t,e),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},u.AsEdge=function(e,t){var n=new u;return n.SetAsEdge(e,t),n},u.prototype.TestPoint=function(e,t){var n,r=e.R,i=t.x-e.position.x,s=t.y-e.position.y,o=i*r.col1.x+s*r.col1.y,u=i*r.col2.x+s*r.col2.y;for(var a=0;a<this.m_vertexCount;++a){n=this.m_vertices[a],i=o-n.x,s=u-n.y,n=this.m_normals[a];var f=n.x*i+n.y*s;if(f>0)return!1}return!0},u.prototype.RayCast=function(e,t,n){var r=0,i=t.maxFraction,s=0,o=0,u,a;s=t.p1.x-n.position.x,o=t.p1.y-n.position.y,u=n.R;var f=s*u.col1.x+o*u.col1.y,l=s*u.col2.x+o*u.col2.y;s=t.p2.x-n.position.x,o=t.p2.y-n.position.y,u=n.R;var c=s*u.col1.x+o*u.col1.y,h=s*u.col2.x+o*u.col2.y,p=c-f,d=h-l,v=parseInt(-1);for(var m=0;m<this.m_vertexCount;++m){a=this.m_vertices[m],s=a.x-f,o=a.y-l,a=this.m_normals[m];var g=a.x*s+a.y*o,y=a.x*p+a.y*d;if(y==0){if(g<0)return!1}else y<0&&g<r*y?(r=g/y,v=m):y>0&&g<i*y&&(i=g/y);if(i<r-Number.MIN_VALUE)return!1}return v>=0?(e.fraction=r,u=n.R,a=this.m_normals[v],e.normal.x=u.col1.x*a.x+u.col2.x*a.y,e.normal.y=u.col1.y*a.x+u.col2.y*a.y,!0):!1},u.prototype.ComputeAABB=function(e,t){var n=t.R,r=this.m_vertices[0],i=t.position.x+(n.col1.x*r.x+n.col2.x*r.y),s=t.position.y+(n.col1.y*r.x+n.col2.y*r.y),o=i,u=s;for(var a=1;a<this.m_vertexCount;++a){r=this.m_vertices[a];var f=t.position.x+(n.col1.x*r.x+n.col2.x*r.y),l=t.position.y+(n.col1.y*r.x+n.col2.y*r.y);i=i<f?i:f,s=s<l?s:l,o=o>f?o:f,u=u>l?u:l}e.lowerBound.x=i-this.m_radius,e.lowerBound.y=s-this.m_radius,e.upperBound.x=o+this.m_radius,e.upperBound.y=u+this.m_radius},u.prototype.ComputeMass=function(e,t){t===undefined&&(t=0);if(this.m_vertexCount==2){e.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),e.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),e.mass=0,e.I=0;return}var n=0,r=0,i=0,s=0,o=0,u=0,a=1/3;for(var f=0;f<this.m_vertexCount;++f){var l=this.m_vertices[f],c=f+1<this.m_vertexCount?this.m_vertices[parseInt(f+1)]:this.m_vertices[0],h=l.x-o,p=l.y-u,d=c.x-o,v=c.y-u,m=h*v-p*d,g=.5*m;i+=g,n+=g*a*(o+l.x+c.x),r+=g*a*(u+l.y+c.y);var y=o,b=u,w=h,E=p,S=d,x=v,T=a*(.25*(w*w+S*w+S*S)+(y*w+y*S))+.5*y*y,N=a*(.25*(E*E+x*E+x*x)+(b*E+b*x))+.5*b*b;s+=m*(T+N)}e.mass=t*i,n*=1/i,r*=1/i,e.center.Set(n,r),e.I=t*s},u.prototype.ComputeSubmergedArea=function(e,t,n,r){t===undefined&&(t=0);var i=c.MulTMV(n.R,e),s=t-c.Dot(e,n.position),u=new Vector_a2j_Number,a=0,f=parseInt(-1),l=parseInt(-1),h=!1,p=0;for(p=0;p<this.m_vertexCount;++p){u[p]=c.Dot(i,this.m_vertices[p])-s;var v=u[p]<-Number.MIN_VALUE;p>0&&(v?h||(f=p-1,a++):h&&(l=p-1,a++)),h=v}switch(a){case 0:if(h){var m=new o;return this.ComputeMass(m,1),r.SetV(c.MulX(n,m.center)),m.mass}return 0;case 1:f==-1?f=this.m_vertexCount-1:l=this.m_vertexCount-1}var g=parseInt((f+1)%this.m_vertexCount),y=parseInt((l+1)%this.m_vertexCount),b=(0-u[f])/(u[g]-u[f]),w=(0-u[l])/(u[y]-u[l]),E=new d(this.m_vertices[f].x*(1-b)+this.m_vertices[g].x*b,this.m_vertices[f].y*(1-b)+this.m_vertices[g].y*b),S=new d(this.m_vertices[l].x*(1-w)+this.m_vertices[y].x*w,this.m_vertices[l].y*(1-w)+this.m_vertices[y].y*w),x=0,T=new d,N=this.m_vertices[g],C;p=g;while(p!=y){p=(p+1)%this.m_vertexCount,p==y?C=S:C=this.m_vertices[p];var k=.5*((N.x-E.x)*(C.y-E.y)-(N.y-E.y)*(C.x-E.x));x+=k,T.x+=k*(E.x+N.x+C.x)/3,T.y+=k*(E.y+N.y+C.y)/3,N=C}return T.Multiply(1/x),r.SetV(c.MulX(n,T)),x},u.prototype.GetVertexCount=function(){return this.m_vertexCount},u.prototype.GetVertices=function(){return this.m_vertices},u.prototype.GetNormals=function(){return this.m_normals},u.prototype.GetSupport=function(e){var t=0,n=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y;for(var r=1;r<this.m_vertexCount;++r){var i=this.m_vertices[r].x*e.x+this.m_vertices[r].y*e.y;i>n&&(t=r,n=i)}return t},u.prototype.GetSupportVertex=function(e){var t=0,n=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y;for(var r=1;r<this.m_vertexCount;++r){var i=this.m_vertices[r].x*e.x+this.m_vertices[r].y*e.y;i>n&&(t=r,n=i)}return this.m_vertices[t]},u.prototype.Validate=function(){return!1},u.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=a.e_polygonShape,this.m_centroid=new d,this.m_vertices=new Vector,this.m_normals=new Vector},u.prototype.Reserve=function(e){e===undefined&&(e=0);for(var t=parseInt(this.m_vertices.length);t<e;t++)this.m_vertices[t]=new d,this.m_normals[t]=new d},u.ComputeCentroid=function(e,t){t===undefined&&(t=0);var n=new d,r=0,i=0,s=0,o=1/3;for(var u=0;u<t;++u){var a=e[u],f=u+1<t?e[parseInt(u+1)]:e[0],l=a.x-i,c=a.y-s,h=f.x-i,p=f.y-s,v=l*p-c*h,m=.5*v;r+=m,n.x+=m*o*(i+a.x+f.x),n.y+=m*o*(s+a.y+f.y)}return n.x*=1/r,n.y*=1/r,n},u.ComputeOBB=function(e,t,n){n===undefined&&(n=0);var r=0,i=new Vector(n+1);for(r=0;r<n;++r)i[r]=t[r];i[n]=i[0];var s=Number.MAX_VALUE;for(r=1;r<=n;++r){var o=i[parseInt(r-1)],u=i[r].x-o.x,a=i[r].y-o.y,f=Math.sqrt(u*u+a*a);u/=f,a/=f;var l=-a,c=u,h=Number.MAX_VALUE,p=Number.MAX_VALUE,d=-Number.MAX_VALUE,v=-Number.MAX_VALUE;for(var m=0;m<n;++m){var g=i[m].x-o.x,y=i[m].y-o.y,b=u*g+a*y,w=l*g+c*y;b<h&&(h=b),w<p&&(p=w),b>d&&(d=b),w>v&&(v=w)}var E=(d-h)*(v-p);if(E<.95*s){s=E,e.R.col1.x=u,e.R.col1.y=a,e.R.col2.x=l,e.R.col2.y=c;var S=.5*(h+d),x=.5*(p+v),T=e.R;e.center.x=o.x+(T.col1.x*S+T.col2.x*x),e.center.y=o.y+(T.col1.y*S+T.col2.y*x),e.extents.x=.5*(d-h),e.extents.y=.5*(v-p)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new f}),a.b2Shape=function(){},a.prototype.Copy=function(){return null},a.prototype.Set=function(e){this.m_radius=e.m_radius},a.prototype.GetType=function(){return this.m_type},a.prototype.TestPoint=function(e,t){return!1},a.prototype.RayCast=function(e,t,n){return!1},a.prototype.ComputeAABB=function(e,t){},a.prototype.ComputeMass=function(e,t){t===undefined&&(t=0)},a.prototype.ComputeSubmergedArea=function(e,t,n,r){return t===undefined&&(t=0),0},a.TestOverlap=function(e,t,n,r){var i=new j;i.proxyA=new I,i.proxyA.Set(e),i.proxyB=new I,i.proxyB.Set(n),i.transformA=t,i.transformB=r,i.useRadii=!0;var s=new Y;s.count=0;var o=new F;return B.Distance(o,s,i),o.distance<10*Number.MIN_VALUE},a.prototype.b2Shape=function(){this.m_type=a.e_unknownShape,this.m_radius=n.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var e=Box2D.Common.b2Color,t=Box2D.Common.b2internal,n=Box2D.Common.b2Settings,r=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,s=Box2D.Common.Math.b2Math,o=Box2D.Common.Math.b2Sweep,u=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,f=Box2D.Common.Math.b2Vec3;e.b2Color=function(){this._r=0,this._g=0,this._b=0},e.prototype.b2Color=function(e,t,n){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),this._r=Box2D.parseUInt(255*s.Clamp(e,0,1)),this._g=Box2D.parseUInt(255*s.Clamp(t,0,1)),this._b=Box2D.parseUInt(255*s.Clamp(n,0,1))},e.prototype.Set=function(e,t,n){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),this._r=Box2D.parseUInt(255*s.Clamp(e,0,1)),this._g=Box2D.parseUInt(255*s.Clamp(t,0,1)),this._b=Box2D.parseUInt(255*s.Clamp(n,0,1))},Object.defineProperty(e.prototype,"r",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._r=Box2D.parseUInt(255*s.Clamp(e,0,1))}}),Object.defineProperty(e.prototype,"g",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._g=Box2D.parseUInt(255*s.Clamp(e,0,1))}}),Object.defineProperty(e.prototype,"b",{enumerable:!1,configurable:!0,set:function(e){e===undefined&&(e=0),this._b=Box2D.parseUInt(255*s.Clamp(e,0,1))}}),Object.defineProperty(e.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),n.b2Settings=function(){},n.b2MixFriction=function(e,t){return e===undefined&&(e=0),t===undefined&&(t=0),Math.sqrt(e*t)},n.b2MixRestitution=function(e,t){return e===undefined&&(e=0),t===undefined&&(t=0),e>t?e:t},n.b2Assert=function(e){if(!e)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*n.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*n.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*n.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*n.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=n.b2_maxTranslation*n.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*n.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=n.b2_maxRotation*n.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*n.b2_pi})}(),function(){var e=Box2D.Collision.b2AABB,t=Box2D.Common.b2Color,n=Box2D.Common.b2internal,r=Box2D.Common.b2Settings,i=Box2D.Common.Math.b2Mat22,s=Box2D.Common.Math.b2Mat33,o=Box2D.Common.Math.b2Math,u=Box2D.Common.Math.b2Sweep,a=Box2D.Common.Math.b2Transform,f=Box2D.Common.Math.b2Vec2,l=Box2D.Common.Math.b2Vec3;i.b2Mat22=function(){this.col1=new f,this.col2=new f},i.prototype.b2Mat22=function(){this.SetIdentity()},i.FromAngle=function(e){e===undefined&&(e=0);var t=new i;return t.Set(e),t},i.FromVV=function(e,t){var n=new i;return n.SetVV(e,t),n},i.prototype.Set=function(e){e===undefined&&(e=0);var t=Math.cos(e),n=Math.sin(e);this.col1.x=t,this.col2.x=-n,this.col1.y=n,this.col2.y=t},i.prototype.SetVV=function(e,t){this.col1.SetV(e),this.col2.SetV(t)},i.prototype.Copy=function(){var e=new i;return e.SetM(this),e},i.prototype.SetM=function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2)},i.prototype.AddM=function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y},i.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},i.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},i.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},i.prototype.GetInverse=function(e){var t=this.col1.x,n=this.col2.x,r=this.col1.y,i=this.col2.y,s=t*i-n*r;return s!=0&&(s=1/s),e.col1.x=s*i,e.col2.x=-s*n,e.col1.y=-s*r,e.col2.y=s*t,e},i.prototype.Solve=function(e,t,n){t===undefined&&(t=0),n===undefined&&(n=0);var r=this.col1.x,i=this.col2.x,s=this.col1.y,o=this.col2.y,u=r*o-i*s;return u!=0&&(u=1/u),e.x=u*(o*t-i*n),e.y=u*(r*n-s*t),e},i.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},s.b2Mat33=function(){this.col1=new l,this.col2=new l,this.col3=new l},s.prototype.b2Mat33=function(e,t,n){e===undefined&&(e=null),t===undefined&&(t=null),n===undefined&&(n=null),!e&&!t&&!n?(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero()):(this.col1.SetV(e),this.col2.SetV(t),this.col3.SetV(n))},s.prototype.SetVVV=function(e,t,n){this.col1.SetV(e),this.col2.SetV(t),this.col3.SetV(n)},s.prototype.Copy=function(){return new s(this.col1,this.col2,this.col3)},s.prototype.SetM=function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2),this.col3.SetV(e.col3)},s.prototype.AddM=function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col1.z+=e.col1.z,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y,this.col2.z+=e.col2.z,this.col3.x+=e.col3.x,this.col3.y+=e.col3.y,this.col3.z+=e.col3.z},s.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},s.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},s.prototype.Solve22=function(e,t,n){t===undefined&&(t=0),n===undefined&&(n=0);var r=this.col1.x,i=this.col2.x,s=this.col1.y,o=this.col2.y,u=r*o-i*s;return u!=0&&(u=1/u),e.x=u*(o*t-i*n),e.y=u*(r*n-s*t),e},s.prototype.Solve33=function(e,t,n,r){t===undefined&&(t=0),n===undefined&&(n=0),r===undefined&&(r=0);var i=this.col1.x,s=this.col1.y,o=this.col1.z,u=this.col2.x,a=this.col2.y,f=this.col2.z,l=this.col3.x,c=this.col3.y,h=this.col3.z,p=i*(a*h-f*c)+s*(f*l-u*h)+o*(u*c-a*l);return p!=0&&(p=1/p),e.x=p*(t*(a*h-f*c)+n*(f*l-u*h)+r*(u*c-a*l)),e.y=p*(i*(n*h-r*c)+s*(r*l-t*h)+o*(t*c-n*l)),e.z=p*(i*(a*r-f*n)+s*(f*t-u*r)+o*(u*n-a*t)),e},o.b2Math=function(){},o.IsValid=function(e){return e===undefined&&(e=0),isFinite(e)},o.Dot=function(e,t){return e.x*t.x+e.y*t.y},o.CrossVV=function(e,t){return e.x*t.y-e.y*t.x},o.CrossVF=function(e,t){t===undefined&&(t=0);var n=new f(t*e.y,-t*e.x);return n},o.CrossFV=function(e,t){e===undefined&&(e=0);var n=new f(-e*t.y,e*t.x);return n},o.MulMV=function(e,t){var n=new f(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return n},o.MulTMV=function(e,t){var n=new f(o.Dot(t,e.col1),o.Dot(t,e.col2));return n},o.MulX=function(e,t){var n=o.MulMV(e.R,t);return n.x+=e.position.x,n.y+=e.position.y,n},o.MulXT=function(e,t){var n=o.SubtractVV(t,e.position),r=n.x*e.R.col1.x+n.y*e.R.col1.y;return n.y=n.x*e.R.col2.x+n.y*e.R.col2.y,n.x=r,n},o.AddVV=function(e,t){var n=new f(e.x+t.x,e.y+t.y);return n},o.SubtractVV=function(e,t){var n=new f(e.x-t.x,e.y-t.y);return n},o.Distance=function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},o.DistanceSquared=function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r},o.MulFV=function(e,t){e===undefined&&(e=0);var n=new f(e*t.x,e*t.y);return n},o.AddMM=function(e,t){var n=i.FromVV(o.AddVV(e.col1,t.col1),o.AddVV(e.col2,t.col2));return n},o.MulMM=function(e,t){var n=i.FromVV(o.MulMV(e,t.col1),o.MulMV(e,t.col2));return n},o.MulTMM=function(e,t){var n=new f(o.Dot(e.col1,t.col1),o.Dot(e.col2,t.col1)),r=new f(o.Dot(e.col1,t.col2),o.Dot(e.col2,t.col2)),s=i.FromVV(n,r);return s},o.Abs=function(e){return e===undefined&&(e=0),e>0?e:-e},o.AbsV=function(e){var t=new f(o.Abs(e.x),o.Abs(e.y));return t},o.AbsM=function(e){var t=i.FromVV(o.AbsV(e.col1),o.AbsV(e.col2));return t},o.Min=function(e,t){return e===undefined&&(e=0),t===undefined&&(t=0),e<t?e:t},o.MinV=function(e,t){var n=new f(o.Min(e.x,t.x),o.Min(e.y,t.y));return n},o.Max=function(e,t){return e===undefined&&(e=0),t===undefined&&(t=0),e>t?e:t},o.MaxV=function(e,t){var n=new f(o.Max(e.x,t.x),o.Max(e.y,t.y));return n},o.Clamp=function(e,t,n){return e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),e<t?t:e>n?n:e},o.ClampV=function(e,t,n){return o.MaxV(t,o.MinV(e,n))},o.Swap=function(e,t){var n=e[0];e[0]=t[0],t[0]=n},o.Random=function(){return Math.random()*2-1},o.RandomRange=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0);var n=Math.random();return n=(t-e)*n+e,n},o.NextPowerOfTwo=function(e){return e===undefined&&(e=0),e|=e>>1&2147483647,e|=e>>2&1073741823,e|=e>>4&268435455,e|=e>>8&16777215,e|=e>>16&65535,e+1},o.IsPowerOfTwo=function(e){e===undefined&&(e=0);var t=e>0&&(e&e-1)==0;return t},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new f(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=i.FromVV(new f(1,0),new f(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new a(o.b2Vec2_zero,o.b2Mat22_identity)}),u.b2Sweep=function(){this.localCenter=new f,this.c0=new f,this.c=new f},u.prototype.Set=function(e){this.localCenter.SetV(e.localCenter),this.c0.SetV(e.c0),this.c.SetV(e.c),this.a0=e.a0,this.a=e.a,this.t0=e.t0},u.prototype.Copy=function(){var e=new u;return e.localCenter.SetV(this.localCenter),e.c0.SetV(this.c0),e.c.SetV(this.c),e.a0=this.a0,e.a=this.a,e.t0=this.t0,e},u.prototype.GetTransform=function(e,t){t===undefined&&(t=0),e.position.x=(1-t)*this.c0.x+t*this.c.x,e.position.y=(1-t)*this.c0.y+t*this.c.y;var n=(1-t)*this.a0+t*this.a;e.R.Set(n);var r=e.R;e.position.x-=r.col1.x*this.localCenter.x+r.col2.x*this.localCenter.y,e.position.y-=r.col1.y*this.localCenter.x+r.col2.y*this.localCenter.y},u.prototype.Advance=function(e){e===undefined&&(e=0);if(this.t0<e&&1-this.t0>Number.MIN_VALUE){var t=(e-this.t0)/(1-this.t0);this.c0.x=(1-t)*this.c0.x+t*this.c.x,this.c0.y=(1-t)*this.c0.y+t*this.c.y,this.a0=(1-t)*this.a0+t*this.a,this.t0=e}},a.b2Transform=function(){this.position=new f,this.R=new i},a.prototype.b2Transform=function(e,t){e===undefined&&(e=null),t===undefined&&(t=null),e&&(this.position.SetV(e),this.R.SetM(t))},a.prototype.Initialize=function(e,t){this.position.SetV(e),this.R.SetM(t)},a.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},a.prototype.Set=function(e){this.position.SetV(e.position),this.R.SetM(e.R)},a.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},f.b2Vec2=function(){},f.prototype.b2Vec2=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.x=e,this.y=t},f.prototype.SetZero=function(){this.x=0,this.y=0},f.prototype.Set=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.x=e,this.y=t},f.prototype.SetV=function(e){this.x=e.x,this.y=e.y},f.prototype.GetNegative=function(){return new f(-this.x,-this.y)},f.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},f.Make=function(e,t){return e===undefined&&(e=0),t===undefined&&(t=0),new f(e,t)},f.prototype.Copy=function(){return new f(this.x,this.y)},f.prototype.Add=function(e){this.x+=e.x,this.y+=e.y},f.prototype.Subtract=function(e){this.x-=e.x,this.y-=e.y},f.prototype.Multiply=function(e){e===undefined&&(e=0),this.x*=e,this.y*=e},f.prototype.MulM=function(e){var t=this.x;this.x=e.col1.x*t+e.col2.x*this.y,this.y=e.col1.y*t+e.col2.y*this.y},f.prototype.MulTM=function(e){var t=o.Dot(this,e.col1);this.y=o.Dot(this,e.col2),this.x=t},f.prototype.CrossVF=function(e){e===undefined&&(e=0);var t=this.x;this.x=e*this.y,this.y=-e*t},f.prototype.CrossFV=function(e){e===undefined&&(e=0);var t=this.x;this.x=-e*this.y,this.y=e*t},f.prototype.MinV=function(e){this.x=this.x<e.x?this.x:e.x,this.y=this.y<e.y?this.y:e.y},f.prototype.MaxV=function(e){this.x=this.x>e.x?this.x:e.x,this.y=this.y>e.y?this.y:e.y},f.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},f.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},f.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},f.prototype.Normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(e<Number.MIN_VALUE)return 0;var t=1/e;return this.x*=t,this.y*=t,e},f.prototype.IsValid=function(){return o.IsValid(this.x)&&o.IsValid(this.y)},l.b2Vec3=function(){},l.prototype.b2Vec3=function(e,t,n){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),this.x=e,this.y=t,this.z=n},l.prototype.SetZero=function(){this.x=this.y=this.z=0},l.prototype.Set=function(e,t,n){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),this.x=e,this.y=t,this.z=n},l.prototype.SetV=function(e){this.x=e.x,this.y=e.y,this.z=e.z},l.prototype.GetNegative=function(){return new l(-this.x,-this.y,-this.z)},l.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},l.prototype.Copy=function(){return new l(this.x,this.y,this.z)},l.prototype.Add=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},l.prototype.Subtract=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},l.prototype.Multiply=function(e){e===undefined&&(e=0),this.x*=e,this.y*=e,this.z*=e}}(),function(){var e=Box2D.Dynamics.Controllers.b2ControllerEdge,t=Box2D.Common.Math.b2Mat22,n=Box2D.Common.Math.b2Mat33,r=Box2D.Common.Math.b2Math,i=Box2D.Common.Math.b2Sweep,s=Box2D.Common.Math.b2Transform,o=Box2D.Common.Math.b2Vec2,u=Box2D.Common.Math.b2Vec3,a=Box2D.Common.b2Color,f=Box2D.Common.b2internal,l=Box2D.Common.b2Settings,c=Box2D.Collision.b2AABB,h=Box2D.Collision.b2Bound,p=Box2D.Collision.b2BoundValues,d=Box2D.Collision.b2Collision,v=Box2D.Collision.b2ContactID,m=Box2D.Collision.b2ContactPoint,g=Box2D.Collision.b2Distance,y=Box2D.Collision.b2DistanceInput,b=Box2D.Collision.b2DistanceOutput,w=Box2D.Collision.b2DistanceProxy,E=Box2D.Collision.b2DynamicTree,S=Box2D.Collision.b2DynamicTreeBroadPhase,x=Box2D.Collision.b2DynamicTreeNode,T=Box2D.Collision.b2DynamicTreePair,N=Box2D.Collision.b2Manifold,C=Box2D.Collision.b2ManifoldPoint,k=Box2D.Collision.b2Point,L=Box2D.Collision.b2RayCastInput,A=Box2D.Collision.b2RayCastOutput,O=Box2D.Collision.b2Segment,M=Box2D.Collision.b2SeparationFunction,_=Box2D.Collision.b2Simplex,D=Box2D.Collision.b2SimplexCache,P=Box2D.Collision.b2SimplexVertex,H=Box2D.Collision.b2TimeOfImpact,B=Box2D.Collision.b2TOIInput,j=Box2D.Collision.b2WorldManifold,F=Box2D.Collision.ClipVertex,I=Box2D.Collision.Features,q=Box2D.Collision.IBroadPhase,R=Box2D.Collision.Shapes.b2CircleShape,U=Box2D.Collision.Shapes.b2EdgeChainDef,z=Box2D.Collision.Shapes.b2EdgeShape,W=Box2D.Collision.Shapes.b2MassData,X=Box2D.Collision.Shapes.b2PolygonShape,V=Box2D.Collision.Shapes.b2Shape,$=Box2D.Dynamics.b2Body,J=Box2D.Dynamics.b2BodyDef,K=Box2D.Dynamics.b2ContactFilter,Q=Box2D.Dynamics.b2ContactImpulse,G=Box2D.Dynamics.b2ContactListener,Y=Box2D.Dynamics.b2ContactManager,Z=Box2D.Dynamics.b2DebugDraw,et=Box2D.Dynamics.b2DestructionListener,tt=Box2D.Dynamics.b2FilterData,nt=Box2D.Dynamics.b2Fixture,rt=Box2D.Dynamics.b2FixtureDef,it=Box2D.Dynamics.b2Island,st=Box2D.Dynamics.b2TimeStep,ot=Box2D.Dynamics.b2World,ut=Box2D.Dynamics.Contacts.b2CircleContact,at=Box2D.Dynamics.Contacts.b2Contact,ft=Box2D.Dynamics.Contacts.b2ContactConstraint,lt=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,ct=Box2D.Dynamics.Contacts.b2ContactEdge,ht=Box2D.Dynamics.Contacts.b2ContactFactory,pt=Box2D.Dynamics.Contacts.b2ContactRegister,dt=Box2D.Dynamics.Contacts.b2ContactResult,vt=Box2D.Dynamics.Contacts.b2ContactSolver,mt=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,gt=Box2D.Dynamics.Contacts.b2NullContact,yt=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,bt=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,wt=Box2D.Dynamics.Contacts.b2PolygonContact,Et=Box2D.Dynamics.Contacts.b2PositionSolverManifold,St=Box2D.Dynamics.Controllers.b2Controller,xt=Box2D.Dynamics.Joints.b2DistanceJoint,Tt=Box2D.Dynamics.Joints.b2DistanceJointDef,Nt=Box2D.Dynamics.Joints.b2FrictionJoint,Ct=Box2D.Dynamics.Joints.b2FrictionJointDef,kt=Box2D.Dynamics.Joints.b2GearJoint,Lt=Box2D.Dynamics.Joints.b2GearJointDef,At=Box2D.Dynamics.Joints.b2Jacobian,Ot=Box2D.Dynamics.Joints.b2Joint,Mt=Box2D.Dynamics.Joints.b2JointDef,_t=Box2D.Dynamics.Joints.b2JointEdge,Dt=Box2D.Dynamics.Joints.b2LineJoint,Pt=Box2D.Dynamics.Joints.b2LineJointDef,Ht=Box2D.Dynamics.Joints.b2MouseJoint,Bt=Box2D.Dynamics.Joints.b2MouseJointDef,jt=Box2D.Dynamics.Joints.b2PrismaticJoint,Ft=Box2D.Dynamics.Joints.b2PrismaticJointDef,It=Box2D.Dynamics.Joints.b2PulleyJoint,qt=Box2D.Dynamics.Joints.b2PulleyJointDef,Rt=Box2D.Dynamics.Joints.b2RevoluteJoint,Ut=Box2D.Dynamics.Joints.b2RevoluteJointDef,zt=Box2D.Dynamics.Joints.b2WeldJoint,Wt=Box2D.Dynamics.Joints.b2WeldJointDef;$.b2Body=function(){this.m_xf=new s,this.m_sweep=new i,this.m_linearVelocity=new o,this.m_force=new o},$.prototype.connectEdges=function(e,t,n){n===undefined&&(n=0);var i=Math.atan2(t.GetDirectionVector().y,t.GetDirectionVector().x),s=Math.tan((i-n)*.5),o=r.MulFV(s,t.GetDirectionVector());o=r.SubtractVV(o,t.GetNormalVector()),o=r.MulFV(l.b2_toiSlop,o),o=r.AddVV(o,t.GetVertex1());var u=r.AddVV(e.GetDirectionVector(),t.GetDirectionVector());u.Normalize();var a=r.Dot(e.GetDirectionVector(),t.GetNormalVector())>0;return e.SetNextEdge(t,o,u,a),t.SetPrevEdge(e,o,u,a),i},$.prototype.CreateFixture=function(e){if(this.m_world.IsLocked()==1)return null;var t=new nt;t.Create(this,this.m_xf,e);if(this.m_flags&$.e_activeFlag){var n=this.m_world.m_contactManager.m_broadPhase;t.CreateProxy(n,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,++this.m_fixtureCount,t.m_body=this,t.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=ot.e_newFixture,t},$.prototype.CreateFixture2=function(e,t){t===undefined&&(t=0);var n=new rt;return n.shape=e,n.density=t,this.CreateFixture(n)},$.prototype.DestroyFixture=function(e){if(this.m_world.IsLocked()==1)return;var t=this.m_fixtureList,n=null,r=!1;while(t!=null){if(t==e){n?n.m_next=e.m_next:this.m_fixtureList=e.m_next,r=!0;break}n=t,t=t.m_next}var i=this.m_contactList;while(i){var s=i.contact;i=i.next;var o=s.GetFixtureA(),u=s.GetFixtureB();(e==o||e==u)&&this.m_world.m_contactManager.Destroy(s)}if(this.m_flags&$.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(a)}e.Destroy(),e.m_body=null,e.m_next=null,--this.m_fixtureCount,this.ResetMassData()},$.prototype.SetPositionAndAngle=function(e,t){t===undefined&&(t=0);var n;if(this.m_world.IsLocked()==1)return;this.m_xf.R.Set(t),this.m_xf.position.SetV(e);var r=this.m_xf.R,i=this.m_sweep.localCenter;this.m_sweep.c.x=r.col1.x*i.x+r.col2.x*i.y,this.m_sweep.c.y=r.col1.y*i.x+r.col2.y*i.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=t;var s=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(s,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()},$.prototype.SetTransform=function(e){this.SetPositionAndAngle(e.position,e.GetAngle())},$.prototype.GetTransform=function(){return this.m_xf},$.prototype.GetPosition=function(){return this.m_xf.position},$.prototype.SetPosition=function(e){this.SetPositionAndAngle(e,this.GetAngle())},$.prototype.GetAngle=function(){return this.m_sweep.a},$.prototype.SetAngle=function(e){e===undefined&&(e=0),this.SetPositionAndAngle(this.GetPosition(),e)},$.prototype.GetWorldCenter=function(){return this.m_sweep.c},$.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},$.prototype.SetLinearVelocity=function(e){if(this.m_type==$.b2_staticBody)return;this.m_linearVelocity.SetV(e)},$.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},$.prototype.SetAngularVelocity=function(e){e===undefined&&(e=0);if(this.m_type==$.b2_staticBody)return;this.m_angularVelocity=e},$.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},$.prototype.GetDefinition=function(){var e=new J;return e.type=this.GetType(),e.allowSleep=(this.m_flags&$.e_allowSleepFlag)==$.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&$.e_fixedRotationFlag)==$.e_fixedRotationFlag,e.bullet=(this.m_flags&$.e_bulletFlag)==$.e_bulletFlag,e.awake=(this.m_flags&$.e_awakeFlag)==$.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e},$.prototype.ApplyForce=function(e,t){if(this.m_type!=$.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(t.x-this.m_sweep.c.x)*e.y-(t.y-this.m_sweep.c.y)*e.x},$.prototype.ApplyTorque=function(e){e===undefined&&(e=0);if(this.m_type!=$.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_torque+=e},$.prototype.ApplyImpulse=function(e,t){if(this.m_type!=$.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((t.x-this.m_sweep.c.x)*e.y-(t.y-this.m_sweep.c.y)*e.x)},$.prototype.Split=function(e){var t=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),i=this.GetWorldCenter(),s=this,o=this.m_world.CreateBody(this.GetDefinition()),u;for(var a=s.m_fixtureList;a;)if(e(a)){var f=a.m_next;u?u.m_next=f:s.m_fixtureList=f,s.m_fixtureCount--,a.m_next=o.m_fixtureList,o.m_fixtureList=a,o.m_fixtureCount++,a.m_body=o,a=f}else u=a,a=a.m_next;s.ResetMassData(),o.ResetMassData();var l=s.GetWorldCenter(),c=o.GetWorldCenter(),h=r.AddVV(t,r.CrossFV(n,r.SubtractVV(l,i))),p=r.AddVV(t,r.CrossFV(n,r.SubtractVV(c,i)));return s.SetLinearVelocity(h),o.SetLinearVelocity(p),s.SetAngularVelocity(n),o.SetAngularVelocity(n),s.SynchronizeFixtures(),o.SynchronizeFixtures(),o},$.prototype.Merge=function(e){var t;for(t=e.m_fixtureList;t;){var n=t.m_next;e.m_fixtureCount--,t.m_next=this.m_fixtureList,this.m_fixtureList=t,this.m_fixtureCount++,t.m_body=i,t=n}r.m_fixtureCount=0;var r=this,i=e,s=r.GetWorldCenter(),o=i.GetWorldCenter(),u=r.GetLinearVelocity().Copy(),a=i.GetLinearVelocity().Copy(),f=r.GetAngularVelocity(),l=i.GetAngularVelocity();r.ResetMassData(),this.SynchronizeFixtures()},$.prototype.GetMass=function(){return this.m_mass},$.prototype.GetInertia=function(){return this.m_I},$.prototype.GetMassData=function(e){e.mass=this.m_mass,e.I=this.m_I,e.center.SetV(this.m_sweep.localCenter)},$.prototype.SetMassData=function(e){l.b2Assert(this.m_world.IsLocked()==0);if(this.m_world.IsLocked()==1)return;if(this.m_type!=$.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&(this.m_flags&$.e_fixedRotationFlag)==0&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var t=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(r.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-t.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-t.x)},$.prototype.ResetMassData=function(){this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero();if(this.m_type==$.b2_staticBody||this.m_type==$.b2_kinematicBody)return;var e=o.Make(0,0);for(var t=this.m_fixtureList;t;t=t.m_next){if(t.m_density==0)continue;var n=t.GetMassData();this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&(this.m_flags&$.e_fixedRotationFlag)==0?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,l.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(r.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)},$.prototype.GetWorldPoint=function(e){var t=this.m_xf.R,n=new o(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y);return n.x+=this.m_xf.position.x,n.y+=this.m_xf.position.y,n},$.prototype.GetWorldVector=function(e){return r.MulMV(this.m_xf.R,e)},$.prototype.GetLocalPoint=function(e){return r.MulXT(this.m_xf,e)},$.prototype.GetLocalVector=function(e){return r.MulTMV(this.m_xf.R,e)},$.prototype.GetLinearVelocityFromWorldPoint=function(e){return new o(this.m_linearVelocity.x-this.m_angularVelocity*(e.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(e.x-this.m_sweep.c.x))},$.prototype.GetLinearVelocityFromLocalPoint=function(e){var t=this.m_xf.R,n=new o(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y);return n.x+=this.m_xf.position.x,n.y+=this.m_xf.position.y,new o(this.m_linearVelocity.x-this.m_angularVelocity*(n.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(n.x-this.m_sweep.c.x))},$.prototype.GetLinearDamping=function(){return this.m_linearDamping},$.prototype.SetLinearDamping=function(e){e===undefined&&(e=0),this.m_linearDamping=e},$.prototype.GetAngularDamping=function(){return this.m_angularDamping},$.prototype.SetAngularDamping=function(e){e===undefined&&(e=0),this.m_angularDamping=e},$.prototype.SetType=function(e){e===undefined&&(e=0);if(this.m_type==e)return;this.m_type=e,this.ResetMassData(),this.m_type==$.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var t=this.m_contactList;t;t=t.next)t.contact.FlagForFiltering()},$.prototype.GetType=function(){return this.m_type},$.prototype.SetBullet=function(e){e?this.m_flags|=$.e_bulletFlag:this.m_flags&=~$.e_bulletFlag},$.prototype.IsBullet=function(){return(this.m_flags&$.e_bulletFlag)==$.e_bulletFlag},$.prototype.SetSleepingAllowed=function(e){e?this.m_flags|=$.e_allowSleepFlag:(this.m_flags&=~$.e_allowSleepFlag,this.SetAwake(!0))},$.prototype.SetAwake=function(e){e?(this.m_flags|=$.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~$.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},$.prototype.IsAwake=function(){return(this.m_flags&$.e_awakeFlag)==$.e_awakeFlag},$.prototype.SetFixedRotation=function(e){e?this.m_flags|=$.e_fixedRotationFlag:this.m_flags&=~$.e_fixedRotationFlag,this.ResetMassData()},$.prototype.IsFixedRotation=function(){return(this.m_flags&$.e_fixedRotationFlag)==$.e_fixedRotationFlag},$.prototype.SetActive=function(e){if(e==this.IsActive())return;var t,n;if(e){this.m_flags|=$.e_activeFlag,t=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.CreateProxy(t,this.m_xf)}else{this.m_flags&=~$.e_activeFlag,t=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.DestroyProxy(t);var r=this.m_contactList;while(r){var i=r;r=r.next,this.m_world.m_contactManager.Destroy(i.contact)}this.m_contactList=null}},$.prototype.IsActive=function(){return(this.m_flags&$.e_activeFlag)==$.e_activeFlag},$.prototype.IsSleepingAllowed=function(){return(this.m_flags&$.e_allowSleepFlag)==$.e_allowSleepFlag},$.prototype.GetFixtureList=function(){return this.m_fixtureList},$.prototype.GetJointList=function(){return this.m_jointList},$.prototype.GetControllerList=function(){return this.m_controllerList},$.prototype.GetContactList=function(){return this.m_contactList},$.prototype.GetNext=function(){return this.m_next},$.prototype.GetUserData=function(){return this.m_userData},$.prototype.SetUserData=function(e){this.m_userData=e},$.prototype.GetWorld=function(){return this.m_world},$.prototype.b2Body=function(e,t){this.m_flags=0,e.bullet&&(this.m_flags|=$.e_bulletFlag),e.fixedRotation&&(this.m_flags|=$.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=$.e_allowSleepFlag),e.awake&&(this.m_flags|=$.e_awakeFlag),e.active&&(this.m_flags|=$.e_activeFlag),this.m_world=t,this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type==$.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0},$.prototype.SynchronizeFixtures=function(){var e=$.s_xf1;e.R.Set(this.m_sweep.a0);var t=e.R,n=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(t.col1.x*n.x+t.col2.x*n.y),e.position.y=this.m_sweep.c0.y-(t.col1.y*n.x+t.col2.y*n.y);var r,i=this.m_world.m_contactManager.m_broadPhase;for(r=this.m_fixtureList;r;r=r.m_next)r.Synchronize(i,e,this.m_xf)},$.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var e=this.m_xf.R,t=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(e.col1.x*t.x+e.col2.x*t.y),this.m_xf.position.y=this.m_sweep.c.y-(e.col1.y*t.x+e.col2.y*t.y)},$.prototype.ShouldCollide=function(e){if(this.m_type!=$.b2_dynamicBody&&e.m_type!=$.b2_dynamicBody)return!1;for(var t=this.m_jointList;t;t=t.next)if(t.other==e&&t.joint.m_collideConnected==0)return!1;return!0},$.prototype.Advance=function(e){e===undefined&&(e=0),this.m_sweep.Advance(e),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new s,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),J.b2BodyDef=function(){this.position=new o,this.linearVelocity=new o},J.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=$.b2_staticBody,this.active=!0,this.inertiaScale=1},K.b2ContactFilter=function(){},K.prototype.ShouldCollide=function(e,t){var n=e.GetFilterData(),r=t.GetFilterData();if(n.groupIndex==r.groupIndex&&n.groupIndex!=0)return n.groupIndex>0;var i=(n.maskBits&r.categoryBits)!=0&&(n.categoryBits&r.maskBits)!=0;return i},K.prototype.RayCollide=function(e,t){return e?this.ShouldCollide(e instanceof nt?e:null,t):!0},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new K}),Q.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(l.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(l.b2_maxManifoldPoints)},G.b2ContactListener=function(){},G.prototype.BeginContact=function(e){},G.prototype.EndContact=function(e){},G.prototype.PreSolve=function(e,t){},G.prototype.PostSolve=function(e,t){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new G}),Y.b2ContactManager=function(){},Y.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=K.b2_defaultFilter,this.m_contactListener=G.b2_defaultListener,this.m_contactFactory=new ht(this.m_allocator),this.m_broadPhase=new S},Y.prototype.AddPair=function(e,t){var n=e instanceof nt?e:null,r=t instanceof nt?t:null,i=n.GetBody(),s=r.GetBody();if(i==s)return;var o=s.GetContactList();while(o){if(o.other==i){var u=o.contact.GetFixtureA(),a=o.contact.GetFixtureB();if(u==n&&a==r)return;if(u==r&&a==n)return}o=o.next}if(s.ShouldCollide(i)==0)return;if(this.m_contactFilter.ShouldCollide(n,r)==0)return;var f=this.m_contactFactory.Create(n,r);n=f.GetFixtureA(),r=f.GetFixtureB(),i=n.m_body,s=r.m_body,f.m_prev=null,f.m_next=this.m_world.m_contactList,this.m_world.m_contactList!=null&&(this.m_world.m_contactList.m_prev=f),this.m_world.m_contactList=f,f.m_nodeA.contact=f,f.m_nodeA.other=s,f.m_nodeA.prev=null,f.m_nodeA.next=i.m_contactList,i.m_contactList!=null&&(i.m_contactList.prev=f.m_nodeA),i.m_contactList=f.m_nodeA,f.m_nodeB.contact=f,f.m_nodeB.other=i,f.m_nodeB.prev=null,f.m_nodeB.next=s.m_contactList,s.m_contactList!=null&&(s.m_contactList.prev=f.m_nodeB),s.m_contactList=f.m_nodeB,++this.m_world.m_contactCount;return},Y.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},Y.prototype.Destroy=function(e){var t=e.GetFixtureA(),n=e.GetFixtureB(),r=t.GetBody(),i=n.GetBody();e.IsTouching()&&this.m_contactListener.EndContact(e),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_world.m_contactList&&(this.m_world.m_contactList=e.m_next),e.m_nodeA.prev&&(e.m_nodeA.prev.next=e.m_nodeA.next),e.m_nodeA.next&&(e.m_nodeA.next.prev=e.m_nodeA.prev),e.m_nodeA==r.m_contactList&&(r.m_contactList=e.m_nodeA.next),e.m_nodeB.prev&&(e.m_nodeB.prev.next=e.m_nodeB.next),e.m_nodeB.next&&(e.m_nodeB.next.prev=e.m_nodeB.prev),e.m_nodeB==i.m_contactList&&(i.m_contactList=e.m_nodeB.next),this.m_contactFactory.Destroy(e),--this.m_contactCount},Y.prototype.Collide=function(){var e=this.m_world.m_contactList;while(e){var t=e.GetFixtureA(),n=e.GetFixtureB(),r=t.GetBody(),i=n.GetBody();if(r.IsAwake()==0&&i.IsAwake()==0){e=e.GetNext();continue}if(e.m_flags&at.e_filterFlag){if(i.ShouldCollide(r)==0){var s=e;e=s.GetNext(),this.Destroy(s);continue}if(this.m_contactFilter.ShouldCollide(t,n)==0){s=e,e=s.GetNext(),this.Destroy(s);continue}e.m_flags&=~at.e_filterFlag}var o=t.m_proxy,u=n.m_proxy,a=this.m_broadPhase.TestOverlap(o,u);if(a==0){s=e,e=s.GetNext(),this.Destroy(s);continue}e.Update(this.m_contactListener),e=e.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new m}),Z.b2DebugDraw=function(){},Z.prototype.b2DebugDraw=function(){},Z.prototype.SetFlags=function(e){e===undefined&&(e=0)},Z.prototype.GetFlags=function(){},Z.prototype.AppendFlags=function(e){e===undefined&&(e=0)},Z.prototype.ClearFlags=function(e){e===undefined&&(e=0)},Z.prototype.SetSprite=function(e){},Z.prototype.GetSprite=function(){},Z.prototype.SetDrawScale=function(e){e===undefined&&(e=0)},Z.prototype.GetDrawScale=function(){},Z.prototype.SetLineThickness=function(e){e===undefined&&(e=0)},Z.prototype.GetLineThickness=function(){},Z.prototype.SetAlpha=function(e){e===undefined&&(e=0)},Z.prototype.GetAlpha=function(){},Z.prototype.SetFillAlpha=function(e){e===undefined&&(e=0)},Z.prototype.GetFillAlpha=function(){},Z.prototype.SetXFormScale=function(e){e===undefined&&(e=0)},Z.prototype.GetXFormScale=function(){},Z.prototype.DrawPolygon=function(e,t,n){t===undefined&&(t=0)},Z.prototype.DrawSolidPolygon=function(e,t,n){t===undefined&&(t=0)},Z.prototype.DrawCircle=function(e,t,n){t===undefined&&(t=0)},Z.prototype.DrawSolidCircle=function(e,t,n,r){t===undefined&&(t=0)},Z.prototype.DrawSegment=function(e,t,n){},Z.prototype.DrawTransform=function(e){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),et.b2DestructionListener=function(){},et.prototype.SayGoodbyeJoint=function(e){},et.prototype.SayGoodbyeFixture=function(e){},tt.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},tt.prototype.Copy=function(){var e=new tt;return e.categoryBits=this.categoryBits,e.maskBits=this.maskBits,e.groupIndex=this.groupIndex,e},nt.b2Fixture=function(){this.m_filter=new tt},nt.prototype.GetType=function(){return this.m_shape.GetType()},nt.prototype.GetShape=function(){return this.m_shape},nt.prototype.SetSensor=function(e){if(this.m_isSensor==e)return;this.m_isSensor=e;if(this.m_body==null)return;var t=this.m_body.GetContactList();while(t){var n=t.contact,r=n.GetFixtureA(),i=n.GetFixtureB();(r==this||i==this)&&n.SetSensor(r.IsSensor()||i.IsSensor()),t=t.next}},nt.prototype.IsSensor=function(){return this.m_isSensor},nt.prototype.SetFilterData=function(e){this.m_filter=e.Copy();if(this.m_body)return;var t=this.m_body.GetContactList();while(t){var n=t.contact,r=n.GetFixtureA(),i=n.GetFixtureB();(r==this||i==this)&&n.FlagForFiltering(),t=t.next}},nt.prototype.GetFilterData=function(){return this.m_filter.Copy()},nt.prototype.GetBody=function(){return this.m_body},nt.prototype.GetNext=function(){return this.m_next},nt.prototype.GetUserData=function(){return this.m_userData},nt.prototype.SetUserData=function(e){this.m_userData=e},nt.prototype.TestPoint=function(e){return this.m_shape.TestPoint(this.m_body.GetTransform(),e)},nt.prototype.RayCast=function(e,t){return this.m_shape.RayCast(e,t,this.m_body.GetTransform())},nt.prototype.GetMassData=function(e){return e===undefined&&(e=null),e==null&&(e=new W),this.m_shape.ComputeMass(e,this.m_density),e},nt.prototype.SetDensity=function(e){e===undefined&&(e=0),this.m_density=e},nt.prototype.GetDensity=function(){return this.m_density},nt.prototype.GetFriction=function(){return this.m_friction},nt.prototype.SetFriction=function(e){e===undefined&&(e=0),this.m_friction=e},nt.prototype.GetRestitution=function(){return this.m_restitution},nt.prototype.SetRestitution=function(e){e===undefined&&(e=0),this.m_restitution=e},nt.prototype.GetAABB=function(){return this.m_aabb},nt.prototype.b2Fixture=function(){this.m_aabb=new c,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},nt.prototype.Create=function(e,t,n){this.m_userData=n.userData,this.m_friction=n.friction,this.m_restitution=n.restitution,this.m_body=e,this.m_next=null,this.m_filter=n.filter.Copy(),this.m_isSensor=n.isSensor,this.m_shape=n.shape.Copy(),this.m_density=n.density},nt.prototype.Destroy=function(){this.m_shape=null},nt.prototype.CreateProxy=function(e,t){this.m_shape.ComputeAABB(this.m_aabb,t),this.m_proxy=e.CreateProxy(this.m_aabb,this)},nt.prototype.DestroyProxy=function(e){if(this.m_proxy==null)return;e.DestroyProxy(this.m_proxy),this.m_proxy=null},nt.prototype.Synchronize=function(e,t,n){if(!this.m_proxy)return;var i=new c,s=new c;this.m_shape.ComputeAABB(i,t),this.m_shape.ComputeAABB(s,n),this.m_aabb.Combine(i,s);var o=r.SubtractVV(n.position,t.position);e.MoveProxy(this.m_proxy,this.m_aabb,o)},rt.b2FixtureDef=function(){this.filter=new tt},rt.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},it.b2Island=function(){},it.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},it.prototype.Initialize=function(e,t,n,r,i,s){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0);var o=0;this.m_bodyCapacity=e,this.m_contactCapacity=t,this.m_jointCapacity=n,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=r,this.m_listener=i,this.m_contactSolver=s;for(o=this.m_bodies.length;o<e;o++)this.m_bodies[o]=null;for(o=this.m_contacts.length;o<t;o++)this.m_contacts[o]=null;for(o=this.m_joints.length;o<n;o++)this.m_joints[o]=null},it.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},it.prototype.Solve=function(e,t,n){var i=0,s=0,o,u;for(i=0;i<this.m_bodyCount;++i){o=this.m_bodies[i];if(o.GetType()!=$.b2_dynamicBody)continue;o.m_linearVelocity.x+=e.dt*(t.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=e.dt*(t.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=e.dt*o.m_invI*o.m_torque,o.m_linearVelocity.Multiply(r.Clamp(1-e.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=r.Clamp(1-e.dt*o.m_angularDamping,0,1)}this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var a=this.m_contactSolver;a.InitVelocityConstraints(e);for(i=0;i<this.m_jointCount;++i)u=this.m_joints[i],u.InitVelocityConstraints(e);for(i=0;i<e.velocityIterations;++i){for(s=0;s<this.m_jointCount;++s)u=this.m_joints[s],u.SolveVelocityConstraints(e);a.SolveVelocityConstraints()}for(i=0;i<this.m_jointCount;++i)u=this.m_joints[i],u.FinalizeVelocityConstraints();a.FinalizeVelocityConstraints();for(i=0;i<this.m_bodyCount;++i){o=this.m_bodies[i];if(o.GetType()==$.b2_staticBody)continue;var f=e.dt*o.m_linearVelocity.x,c=e.dt*o.m_linearVelocity.y;f*f+c*c>l.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=l.b2_maxTranslation*e.inv_dt,o.m_linearVelocity.y*=l.b2_maxTranslation*e.inv_dt);var h=e.dt*o.m_angularVelocity;h*h>l.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-l.b2_maxRotation*e.inv_dt:o.m_angularVelocity=l.b2_maxRotation*e.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=e.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=e.dt*o.m_linearVelocity.y,o.m_sweep.a+=e.dt*o.m_angularVelocity,o.SynchronizeTransform()}for(i=0;i<e.positionIterations;++i){var p=a.SolvePositionConstraints(l.b2_contactBaumgarte),d=!0;for(s=0;s<this.m_jointCount;++s){u=this.m_joints[s];var v=u.SolvePositionConstraints(l.b2_contactBaumgarte);d=d&&v}if(p&&d)break}this.Report(a.m_constraints);if(n){var m=Number.MAX_VALUE,g=l.b2_linearSleepTolerance*l.b2_linearSleepTolerance,y=l.b2_angularSleepTolerance*l.b2_angularSleepTolerance;for(i=0;i<this.m_bodyCount;++i){o=this.m_bodies[i];if(o.GetType()==$.b2_staticBody)continue;(o.m_flags&$.e_allowSleepFlag)==0&&(o.m_sleepTime=0,m=0),(o.m_flags&$.e_allowSleepFlag)==0||o.m_angularVelocity*o.m_angularVelocity>y||r.Dot(o.m_linearVelocity,o.m_linearVelocity)>g?(o.m_sleepTime=0,m=0):(o.m_sleepTime+=e.dt,m=r.Min(m,o.m_sleepTime))}if(m>=l.b2_timeToSleep)for(i=0;i<this.m_bodyCount;++i)o=this.m_bodies[i],o.SetAwake(!1)}},it.prototype.SolveTOI=function(e){var t=0,n=0;this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var r=this.m_contactSolver;for(t=0;t<this.m_jointCount;++t)this.m_joints[t].InitVelocityConstraints(e);for(t=0;t<e.velocityIterations;++t){r.SolveVelocityConstraints();for(n=0;n<this.m_jointCount;++n)this.m_joints[n].SolveVelocityConstraints(e)}for(t=0;t<this.m_bodyCount;++t){var i=this.m_bodies[t];if(i.GetType()==$.b2_staticBody)continue;var s=e.dt*i.m_linearVelocity.x,o=e.dt*i.m_linearVelocity.y;s*s+o*o>l.b2_maxTranslationSquared&&(i.m_linearVelocity.Normalize(),i.m_linearVelocity.x*=l.b2_maxTranslation*e.inv_dt,i.m_linearVelocity.y*=l.b2_maxTranslation*e.inv_dt);var u=e.dt*i.m_angularVelocity;u*u>l.b2_maxRotationSquared&&(i.m_angularVelocity<0?i.m_angularVelocity=-l.b2_maxRotation*e.inv_dt:i.m_angularVelocity=l.b2_maxRotation*e.inv_dt),i.m_sweep.c0.SetV(i.m_sweep.c),i.m_sweep.a0=i.m_sweep.a,i.m_sweep.c.x+=e.dt*i.m_linearVelocity.x,i.m_sweep.c.y+=e.dt*i.m_linearVelocity.y,i.m_sweep.a+=e.dt*i.m_angularVelocity,i.SynchronizeTransform()}var a=.75;for(t=0;t<e.positionIterations;++t){var f=r.SolvePositionConstraints(a),c=!0;for(n=0;n<this.m_jointCount;++n){var h=this.m_joints[n].SolvePositionConstraints(l.b2_contactBaumgarte);c=c&&h}if(f&&c)break}this.Report(r.m_constraints)},it.prototype.Report=function(e){if(this.m_listener==null)return;for(var t=0;t<this.m_contactCount;++t){var n=this.m_contacts[t],r=e[t];for(var i=0;i<r.pointCount;++i)it.s_impulse.normalImpulses[i]=r.points[i].normalImpulse,it.s_impulse.tangentImpulses[i]=r.points[i].tangentImpulse;this.m_listener.PostSolve(n,it.s_impulse)}},it.prototype.AddBody=function(e){e.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=e},it.prototype.AddContact=function(e){this.m_contacts[this.m_contactCount++]=e},it.prototype.AddJoint=function(e){this.m_joints[this.m_jointCount++]=e},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new Q}),st.b2TimeStep=function(){},st.prototype.Set=function(e){this.dt=e.dt,this.inv_dt=e.inv_dt,this.positionIterations=e.positionIterations,this.velocityIterations=e.velocityIterations,this.warmStarting=e.warmStarting},ot.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new Y,this.m_contactSolver=new vt,this.m_island=new it},ot.prototype.b2World=function(e,t){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,ot.m_warmStarting=!0,ot.m_continuousPhysics=!0,this.m_allowSleep=t,this.m_gravity=e,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var n=new J;this.m_groundBody=this.CreateBody(n)},ot.prototype.SetDestructionListener=function(e){this.m_destructionListener=e},ot.prototype.SetContactFilter=function(e){this.m_contactManager.m_contactFilter=e},ot.prototype.SetContactListener=function(e){this.m_contactManager.m_contactListener=e},ot.prototype.SetDebugDraw=function(e){this.m_debugDraw=e},ot.prototype.SetBroadPhase=function(e){var t=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=e;for(var n=this.m_bodyList;n;n=n.m_next)for(var r=n.m_fixtureList;r;r=r.m_next)r.m_proxy=e.CreateProxy(t.GetFatAABB(r.m_proxy),r)},ot.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},ot.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},ot.prototype.CreateBody=function(e){if(this.IsLocked()==1)return null;var t=new $(e,this);return t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount,t},ot.prototype.DestroyBody=function(e){if(this.IsLocked()==1)return;var t=e.m_jointList;while(t){var n=t;t=t.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(n.joint),this.DestroyJoint(n.joint)}var r=e.m_controllerList;while(r){var i=r;r=r.nextController,i.controller.RemoveBody(e)}var s=e.m_contactList;while(s){var o=s;s=s.next,this.m_contactManager.Destroy(o.contact)}e.m_contactList=null;var u=e.m_fixtureList;while(u){var a=u;u=u.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(a),a.DestroyProxy(this.m_contactManager.m_broadPhase),a.Destroy()}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_bodyList&&(this.m_bodyList=e.m_next),--this.m_bodyCount},ot.prototype.CreateJoint=function(e){var t=Ot.Create(e,null);t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB;var n=e.bodyA,r=e.bodyB;if(e.collideConnected==0){var i=r.GetContactList();while(i)i.other==n&&i.contact.FlagForFiltering(),i=i.next}return t},ot.prototype.DestroyJoint=function(e){var t=e.m_collideConnected;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e==this.m_jointList&&(this.m_jointList=e.m_next);var n=e.m_bodyA,r=e.m_bodyB;n.SetAwake(!0),r.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA==n.m_jointList&&(n.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB==r.m_jointList&&(r.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,Ot.Destroy(e,null),--this.m_jointCount;if(t==0){var i=r.GetContactList();while(i)i.other==n&&i.contact.FlagForFiltering(),i=i.next}},ot.prototype.AddController=function(e){return e.m_next=this.m_controllerList,e.m_prev=null,this.m_controllerList=e,e.m_world=this,this.m_controllerCount++,e},ot.prototype.RemoveController=function(e){e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),this.m_controllerList==e&&(this.m_controllerList=e.m_next),this.m_controllerCount--},ot.prototype.CreateController=function(e){if(e.m_world!=this)throw new Error("Controller can only be a member of one world");return e.m_next=this.m_controllerList,e.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=e),this.m_controllerList=e,++this.m_controllerCount,e.m_world=this,e},ot.prototype.DestroyController=function(e){e.Clear(),e.m_next&&(e.m_next.m_prev=e.m_prev),e.m_prev&&(e.m_prev.m_next=e.m_next),e==this.m_controllerList&&(this.m_controllerList=e.m_next),--this.m_controllerCount},ot.prototype.SetWarmStarting=function(e){ot.m_warmStarting=e},ot.prototype.SetContinuousPhysics=function(e){ot.m_continuousPhysics=e},ot.prototype.GetBodyCount=function(){return this.m_bodyCount},ot.prototype.GetJointCount=function(){return this.m_jointCount},ot.prototype.GetContactCount=function(){return this.m_contactCount},ot.prototype.SetGravity=function(e){this.m_gravity=e},ot.prototype.GetGravity=function(){return this.m_gravity},ot.prototype.GetGroundBody=function(){return this.m_groundBody},ot.prototype.Step=function(e,t,n){e===undefined&&(e=0),t===undefined&&(t=0),n===undefined&&(n=0),this.m_flags&ot.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~ot.e_newFixture),this.m_flags|=ot.e_locked;var r=ot.s_timestep2;r.dt=e,r.velocityIterations=t,r.positionIterations=n,e>0?r.inv_dt=1/e:r.inv_dt=0,r.dtRatio=this.m_inv_dt0*e,r.warmStarting=ot.m_warmStarting,this.m_contactManager.Collide(),r.dt>0&&this.Solve(r),ot.m_continuousPhysics&&r.dt>0&&this.SolveTOI(r),r.dt>0&&(this.m_inv_dt0=r.inv_dt),this.m_flags&=~ot.e_locked},ot.prototype.ClearForces=function(){for(var e=this.m_bodyList;e;e=e.m_next)e.m_force.SetZero(),e.m_torque=0},ot.prototype.DrawDebugData=function(){if(this.m_debugDraw==null)return;this.m_debugDraw.m_sprite.graphics.clear();var e=this.m_debugDraw.GetFlags(),t=0,n,r,i,s,u,f=new o,l=new o,h=new o,p,d=new c,v=new c,m=[new o,new o,new o,new o],g=new a(0,0,0);if(e&Z.e_shapeBit)for(n=this.m_bodyList;n;n=n.m_next){p=n.m_xf;for(r=n.GetFixtureList();r;r=r.m_next)i=r.GetShape(),n.IsActive()==0?(g.Set(.5,.5,.3),this.DrawShape(i,p,g)):n.GetType()==$.b2_staticBody?(g.Set(.5,.9,.5),this.DrawShape(i,p,g)):n.GetType()==$.b2_kinematicBody?(g.Set(.5,.5,.9),this.DrawShape(i,p,g)):n.IsAwake()==0?(g.Set(.6,.6,.6),this.DrawShape(i,p,g)):(g.Set(.9,.7,.7),this.DrawShape(i,p,g))}if(e&Z.e_jointBit)for(s=this.m_jointList;s;s=s.m_next)this.DrawJoint(s);if(e&Z.e_controllerBit)for(var y=this.m_controllerList;y;y=y.m_next)y.Draw(this.m_debugDraw);if(e&Z.e_pairBit){g.Set(.3,.9,.9);for(var b=this.m_contactManager.m_contactList;b;b=b.GetNext()){var w=b.GetFixtureA(),E=b.GetFixtureB(),S=w.GetAABB().GetCenter(),x=E.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(S,x,g)}}if(e&Z.e_aabbBit){u=this.m_contactManager.m_broadPhase,m=[new o,new o,new o,new o];for(n=this.m_bodyList;n;n=n.GetNext()){if(n.IsActive()==0)continue;for(r=n.GetFixtureList();r;r=r.GetNext()){var T=u.GetFatAABB(r.m_proxy);m[0].Set(T.lowerBound.x,T.lowerBound.y),m[1].Set(T.upperBound.x,T.lowerBound.y),m[2].Set(T.upperBound.x,T.upperBound.y),m[3].Set(T.lowerBound.x,T.upperBound.y),this.m_debugDraw.DrawPolygon(m,4,g)}}}if(e&Z.e_centerOfMassBit)for(n=this.m_bodyList;n;n=n.m_next)p=ot.s_xf,p.R=n.m_xf.R,p.position=n.GetWorldCenter(),this.m_debugDraw.DrawTransform(p)},ot.prototype.QueryAABB=function(e,t){function i(t){return e(r.GetUserData(t))}var n=this,r=n.m_contactManager.m_broadPhase;r.Query(i,t)},ot.prototype.QueryShape=function(e,t,n){function o(r){var s=i.GetUserData(r)instanceof nt?i.GetUserData(r):null;return V.TestOverlap(t,n,s.GetShape(),s.GetBody().GetTransform())?e(s):!0}var r=this;n===undefined&&(n=null),n==null&&(n=new s,n.SetIdentity());var i=r.m_contactManager.m_broadPhase,u=new c;t.ComputeAABB(u,n),i.Query(o,u)},ot.prototype.QueryPoint=function(e,t){function i(n){var i=r.GetUserData(n)instanceof nt?r.GetUserData(n):null;return i.TestPoint(t)?e(i):!0}var n=this,r=n.m_contactManager.m_broadPhase,s=new c;s.lowerBound.Set(t.x-l.b2_linearSlop,t.y-l.b2_linearSlop),s.upperBound.Set(t.x+l.b2_linearSlop,t.y+l.b2_linearSlop),r.Query(i,s)},ot.prototype.RayCast=function(e,t,n){function u(r,u){var a=i.GetUserData(u),f=a instanceof nt?a:null,l=f.RayCast(s,r);if(l){var c=s.fraction,h=new o((1-c)*t.x+c*n.x,(1-c)*t.y+c*n.y);return e(f,h,s.normal,c)}return r.maxFraction}var r=this,i=r.m_contactManager.m_broadPhase,s=new A,a=new L(t,n);i.RayCast(u,a)},ot.prototype.RayCastOne=function(e,t){function i(e,t,n,i){return i===undefined&&(i=0),r=e,i}var n=this,r;return n.RayCast(i,e,t),r},ot.prototype.RayCastAll=function(e,t){function i(e,t,n,i){return i===undefined&&(i=0),r[r.length]=e,1}var n=this,r=new Vector;return n.RayCast(i,e,t),r},ot.prototype.GetBodyList=function(){return this.m_bodyList},ot.prototype.GetJointList=function(){return this.m_jointList},ot.prototype.GetContactList=function(){return this.m_contactList},ot.prototype.IsLocked=function(){return(this.m_flags&ot.e_locked)>0},ot.prototype.Solve=function(e){var t;for(var n=this.m_controllerList;n;n=n.m_next)n.Step(e);var r=this.m_island;r.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(t=this.m_bodyList;t;t=t.m_next)t.m_flags&=~$.e_islandFlag;for(var i=this.m_contactList;i;i=i.m_next)i.m_flags&=~at.e_islandFlag;for(var s=this.m_jointList;s;s=s.m_next)s.m_islandFlag=!1;var o=parseInt(this.m_bodyCount),u=this.s_stack;for(var a=this.m_bodyList;a;a=a.m_next){if(a.m_flags&$.e_islandFlag)continue;if(a.IsAwake()==0||a.IsActive()==0)continue;if(a.GetType()==$.b2_staticBody)continue;r.Clear();var f=0;u[f++]=a,a.m_flags|=$.e_islandFlag;while(f>0){t=u[--f],r.AddBody(t),t.IsAwake()==0&&t.SetAwake(!0);if(t.GetType()==$.b2_staticBody)continue;var l;for(var c=t.m_contactList;c;c=c.next){if(c.contact.m_flags&at.e_islandFlag)continue;if(c.contact.IsSensor()==1||c.contact.IsEnabled()==0||c.contact.IsTouching()==0)continue;r.AddContact(c.contact),c.contact.m_flags|=at.e_islandFlag,l=c.other;if(l.m_flags&$.e_islandFlag)continue;u[f++]=l,l.m_flags|=$.e_islandFlag}for(var h=t.m_jointList;h;h=h.next){if(h.joint.m_islandFlag==1)continue;l=h.other;if(l.IsActive()==0)continue;r.AddJoint(h.joint),h.joint.m_islandFlag=!0;if(l.m_flags&$.e_islandFlag)continue;u[f++]=l,l.m_flags|=$.e_islandFlag}}r.Solve(e,this.m_gravity,this.m_allowSleep);for(var p=0;p<r.m_bodyCount;++p)t=r.m_bodies[p],t.GetType()==$.b2_staticBody&&(t.m_flags&=~$.e_islandFlag)}for(p=0;p<u.length;++p){if(!u[p])break;u[p]=null}for(t=this.m_bodyList;t;t=t.m_next){if(t.IsAwake()==0||t.IsActive()==0)continue;if(t.GetType()==$.b2_staticBody)continue;t.SynchronizeFixtures()}this.m_contactManager.FindNewContacts()},ot.prototype.SolveTOI=function(e){var t,n,r,i,s,o,u,a=this.m_island;a.Initialize(this.m_bodyCount,l.b2_maxTOIContactsPerIsland,l.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var f=ot.s_queue;for(t=this.m_bodyList;t;t=t.m_next)t.m_flags&=~$.e_islandFlag,t.m_sweep.t0=0;var c;for(c=this.m_contactList;c;c=c.m_next)c.m_flags&=~(at.e_toiFlag|at.e_islandFlag);for(u=this.m_jointList;u;u=u.m_next)u.m_islandFlag=!1;for(;;){var h=null,p=1;for(c=this.m_contactList;c;c=c.m_next){if(c.IsSensor()==1||c.IsEnabled()==0||c.IsContinuous()==0)continue;var d=1;if(c.m_flags&at.e_toiFlag)d=c.m_toi;else{n=c.m_fixtureA,r=c.m_fixtureB,i=n.m_body,s=r.m_body;if(!(i.GetType()==$.b2_dynamicBody&&i.IsAwake()!=0||s.GetType()==$.b2_dynamicBody&&s.IsAwake()!=0))continue;var v=i.m_sweep.t0;i.m_sweep.t0<s.m_sweep.t0?(v=s.m_sweep.t0,i.m_sweep.Advance(v)):s.m_sweep.t0<i.m_sweep.t0&&(v=i.m_sweep.t0,s.m_sweep.Advance(v)),d=c.ComputeTOI(i.m_sweep,s.m_sweep),l.b2Assert(0<=d&&d<=1),d>0&&d<1&&(d=(1-d)*v+d,d>1&&(d=1)),c.m_toi=d,c.m_flags|=at.e_toiFlag}Number.MIN_VALUE<d&&d<p&&(h=c,p=d)}if(h==null||1-100*Number.MIN_VALUE<p)break;n=h.m_fixtureA,r=h.m_fixtureB,i=n.m_body,s=r.m_body,ot.s_backupA.Set(i.m_sweep),ot.s_backupB.Set(s.m_sweep),i.Advance(p),s.Advance(p),h.Update(this.m_contactManager.m_contactListener),h.m_flags&=~at.e_toiFlag;if(h.IsSensor()==1||h.IsEnabled()==0){i.m_sweep.Set(ot.s_backupA),s.m_sweep.Set(ot.s_backupB),i.SynchronizeTransform(),s.SynchronizeTransform();continue}if(h.IsTouching()==0)continue;var m=i;m.GetType()!=$.b2_dynamicBody&&(m=s),a.Clear();var g=0,y=0;f[g+y++]=m,m.m_flags|=$.e_islandFlag;while(y>0){t=f[g++],--y,a.AddBody(t),t.IsAwake()==0&&t.SetAwake(!0);if(t.GetType()!=$.b2_dynamicBody)continue;for(o=t.m_contactList;o;o=o.next){if(a.m_contactCount==a.m_contactCapacity)break;if(o.contact.m_flags&at.e_islandFlag)continue;if(o.contact.IsSensor()==1||o.contact.IsEnabled()==0||o.contact.IsTouching()==0)continue;a.AddContact(o.contact),o.contact.m_flags|=at.e_islandFlag;var b=o.other;if(b.m_flags&$.e_islandFlag)continue;b.GetType()!=$.b2_staticBody&&(b.Advance(p),b.SetAwake(!0)),f[g+y]=b,++y,b.m_flags|=$.e_islandFlag}for(var w=t.m_jointList;w;w=w.next){if(a.m_jointCount==a.m_jointCapacity)continue;if(w.joint.m_islandFlag==1)continue;b=w.other;if(b.IsActive()==0)continue;a.AddJoint(w.joint),w.joint.m_islandFlag=!0;if(b.m_flags&$.e_islandFlag)continue;b.GetType()!=$.b2_staticBody&&(b.Advance(p),b.SetAwake(!0)),f[g+y]=b,++y,b.m_flags|=$.e_islandFlag}}var E=ot.s_timestep;E.warmStarting=!1,E.dt=(1-p)*e.dt,E.inv_dt=1/E.dt,E.dtRatio=0,E.velocityIterations=e.velocityIterations,E.positionIterations=e.positionIterations,a.SolveTOI(E);var S=0;for(S=0;S<a.m_bodyCount;++S){t=a.m_bodies[S],t.m_flags&=~$.e_islandFlag;if(t.IsAwake()==0)continue;if(t.GetType()!=$.b2_dynamicBody)continue;t.SynchronizeFixtures();for(o=t.m_contactList;o;o=o.next)o.contact.m_flags&=~at.e_toiFlag}for(S=0;S<a.m_contactCount;++S)c=a.m_contacts[S],c.m_flags&=~(at.e_toiFlag|at.e_islandFlag);for(S=0;S<a.m_jointCount;++S)u=a.m_joints[S],u.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}},ot.prototype.DrawJoint=function(e){var t=e.GetBodyA(),n=e.GetBodyB(),r=t.m_xf,i=n.m_xf,s=r.position,o=i.position,u=e.GetAnchorA(),a=e.GetAnchorB(),f=ot.s_jointColor;switch(e.m_type){case Ot.e_distanceJoint:this.m_debugDraw.DrawSegment(u,a,f);break;case Ot.e_pulleyJoint:var l=e instanceof It?e:null,c=l.GetGroundAnchorA(),h=l.GetGroundAnchorB();this.m_debugDraw.DrawSegment(c,u,f),this.m_debugDraw.DrawSegment(h,a,f),this.m_debugDraw.DrawSegment(c,h,f);break;case Ot.e_mouseJoint:this.m_debugDraw.DrawSegment(u,a,f);break;default:t!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,u,f),this.m_debugDraw.DrawSegment(u,a,f),n!=this.m_groundBody&&this.m_debugDraw.DrawSegment(o,a,f)}},ot.prototype.DrawShape=function(e,t,n){switch(e.m_type){case V.e_circleShape:var i=e instanceof R?e:null,s=r.MulX(t,i.m_p),o=i.m_radius,u=t.R.col1;this.m_debugDraw.DrawSolidCircle(s,o,u,n);break;case V.e_polygonShape:var a=0,f=e instanceof X?e:null,l=parseInt(f.GetVertexCount()),c=f.GetVertices(),h=new Vector(l);for(a=0;a<l;++a)h[a]=r.MulX(t,c[a]);this.m_debugDraw.DrawSolidPolygon(h,l,n);break;case V.e_edgeShape:var p=e instanceof z?e:null;this.m_debugDraw.DrawSegment(r.MulX(t,p.GetVertex1()),r.MulX(t,p.GetVertex2()),n)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new st,Box2D.Dynamics.b2World.s_xf=new s,Box2D.Dynamics.b2World.s_backupA=new i,Box2D.Dynamics.b2World.s_backupB=new i,Box2D.Dynamics.b2World.s_timestep=new st,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new a(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var e=Box2D.Collision.Shapes.b2CircleShape,t=Box2D.Collision.Shapes.b2EdgeChainDef,n=Box2D.Collision.Shapes.b2EdgeShape,r=Box2D.Collision.Shapes.b2MassData,i=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,o=Box2D.Dynamics.Contacts.b2CircleContact,u=Box2D.Dynamics.Contacts.b2Contact,a=Box2D.Dynamics.Contacts.b2ContactConstraint,f=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,c=Box2D.Dynamics.Contacts.b2ContactFactory,h=Box2D.Dynamics.Contacts.b2ContactRegister,p=Box2D.Dynamics.Contacts.b2ContactResult,d=Box2D.Dynamics.Contacts.b2ContactSolver,v=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,m=Box2D.Dynamics.Contacts.b2NullContact,g=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,y=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,b=Box2D.Dynamics.Contacts.b2PolygonContact,w=Box2D.Dynamics.Contacts.b2PositionSolverManifold,E=Box2D.Dynamics.b2Body,S=Box2D.Dynamics.b2BodyDef,x=Box2D.Dynamics.b2ContactFilter,T=Box2D.Dynamics.b2ContactImpulse,N=Box2D.Dynamics.b2ContactListener,C=Box2D.Dynamics.b2ContactManager,k=Box2D.Dynamics.b2DebugDraw,L=Box2D.Dynamics.b2DestructionListener,A=Box2D.Dynamics.b2FilterData,O=Box2D.Dynamics.b2Fixture,M=Box2D.Dynamics.b2FixtureDef,_=Box2D.Dynamics.b2Island,D=Box2D.Dynamics.b2TimeStep,P=Box2D.Dynamics.b2World,H=Box2D.Common.b2Color,B=Box2D.Common.b2internal,j=Box2D.Common.b2Settings,F=Box2D.Common.Math.b2Mat22,I=Box2D.Common.Math.b2Mat33,q=Box2D.Common.Math.b2Math,R=Box2D.Common.Math.b2Sweep,U=Box2D.Common.Math.b2Transform,z=Box2D.Common.Math.b2Vec2,W=Box2D.Common.Math.b2Vec3,X=Box2D.Collision.b2AABB,V=Box2D.Collision.b2Bound,$=Box2D.Collision.b2BoundValues,J=Box2D.Collision.b2Collision,K=Box2D.Collision.b2ContactID,Q=Box2D.Collision.b2ContactPoint,G=Box2D.Collision.b2Distance,Y=Box2D.Collision.b2DistanceInput,Z=Box2D.Collision.b2DistanceOutput,et=Box2D.Collision.b2DistanceProxy,tt=Box2D.Collision.b2DynamicTree,nt=Box2D.Collision.b2DynamicTreeBroadPhase,rt=Box2D.Collision.b2DynamicTreeNode,it=Box2D.Collision.b2DynamicTreePair,st=Box2D.Collision.b2Manifold,ot=Box2D.Collision.b2ManifoldPoint,ut=Box2D.Collision.b2Point,at=Box2D.Collision.b2RayCastInput,ft=Box2D.Collision.b2RayCastOutput,lt=Box2D.Collision.b2Segment,ct=Box2D.Collision.b2SeparationFunction,ht=Box2D.Collision.b2Simplex,pt=Box2D.Collision.b2SimplexCache,dt=Box2D.Collision.b2SimplexVertex,vt=Box2D.Collision.b2TimeOfImpact,mt=Box2D.Collision.b2TOIInput,gt=Box2D.Collision.b2WorldManifold,yt=Box2D.Collision.ClipVertex,bt=Box2D.Collision.Features,wt=Box2D.Collision.IBroadPhase;Box2D.inherit(o,Box2D.Dynamics.Contacts.b2Contact),o.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,o.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},o.Create=function(e){return new o},o.Destroy=function(e,t){},o.prototype.Reset=function(e,t){this.__super.Reset.call(this,e,t)},o.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();J.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},u.b2Contact=function(){this.m_nodeA=new l,this.m_nodeB=new l,this.m_manifold=new st,this.m_oldManifold=new st},u.prototype.GetManifold=function(){return this.m_manifold},u.prototype.GetWorldManifold=function(e){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),i=this.m_fixtureB.GetShape();e.Initialize(this.m_manifold,t.GetTransform(),r.m_radius,n.GetTransform(),i.m_radius)},u.prototype.IsTouching=function(){return(this.m_flags&u.e_touchingFlag)==u.e_touchingFlag},u.prototype.IsContinuous=function(){return(this.m_flags&u.e_continuousFlag)==u.e_continuousFlag},u.prototype.SetSensor=function(e){e?this.m_flags|=u.e_sensorFlag:this.m_flags&=~u.e_sensorFlag},u.prototype.IsSensor=function(){return(this.m_flags&u.e_sensorFlag)==u.e_sensorFlag},u.prototype.SetEnabled=function(e){e?this.m_flags|=u.e_enabledFlag:this.m_flags&=~u.e_enabledFlag},u.prototype.IsEnabled=function(){return(this.m_flags&u.e_enabledFlag)==u.e_enabledFlag},u.prototype.GetNext=function(){return this.m_next},u.prototype.GetFixtureA=function(){return this.m_fixtureA},u.prototype.GetFixtureB=function(){return this.m_fixtureB},u.prototype.FlagForFiltering=function(){this.m_flags|=u.e_filterFlag},u.prototype.b2Contact=function(){},u.prototype.Reset=function(e,t){e===undefined&&(e=null),t===undefined&&(t=null),this.m_flags=u.e_enabledFlag;if(!e||!t){this.m_fixtureA=null,this.m_fixtureB=null;return}if(e.IsSensor()||t.IsSensor())this.m_flags|=u.e_sensorFlag;var n=e.GetBody(),r=t.GetBody();if(n.GetType()!=E.b2_dynamicBody||n.IsBullet()||r.GetType()!=E.b2_dynamicBody||r.IsBullet())this.m_flags|=u.e_continuousFlag;this.m_fixtureA=e,this.m_fixtureB=t,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},u.prototype.Update=function(e){var t=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=t,this.m_flags|=u.e_enabledFlag;var n=!1,r=(this.m_flags&u.e_touchingFlag)==u.e_touchingFlag,i=this.m_fixtureA.m_body,o=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&u.e_sensorFlag){if(a){var f=this.m_fixtureA.GetShape(),l=this.m_fixtureB.GetShape(),c=i.GetTransform(),h=o.GetTransform();n=s.TestOverlap(f,c,l,h)}this.m_manifold.m_pointCount=0}else{i.GetType()!=E.b2_dynamicBody||i.IsBullet()||o.GetType()!=E.b2_dynamicBody||o.IsBullet()?this.m_flags|=u.e_continuousFlag:this.m_flags&=~u.e_continuousFlag;if(a){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var p=0;p<this.m_manifold.m_pointCount;++p){var d=this.m_manifold.m_points[p];d.m_normalImpulse=0,d.m_tangentImpulse=0;var v=d.m_id;for(var m=0;m<this.m_oldManifold.m_pointCount;++m){var g=this.m_oldManifold.m_points[m];if(g.m_id.key==v.key){d.m_normalImpulse=g.m_normalImpulse,d.m_tangentImpulse=g.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!=r&&(i.SetAwake(!0),o.SetAwake(!0))}n?this.m_flags|=u.e_touchingFlag:this.m_flags&=~u.e_touchingFlag,r==0&&n==1&&e.BeginContact(this),r==1&&n==0&&e.EndContact(this),(this.m_flags&u.e_sensorFlag)==0&&e.PreSolve(this,this.m_oldManifold)},u.prototype.Evaluate=function(){},u.prototype.ComputeTOI=function(e,t){return u.s_input.proxyA.Set(this.m_fixtureA.GetShape()),u.s_input.proxyB.Set(this.m_fixtureB.GetShape()),u.s_input.sweepA=e,u.s_input.sweepB=t,u.s_input.tolerance=j.b2_linearSlop,vt.TimeOfImpact(u.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new mt}),a.b2ContactConstraint=function(){this.localPlaneNormal=new z,this.localPoint=new z,this.normal=new z,this.normalMass=new F,this.K=new F},a.prototype.b2ContactConstraint=function(){this.points=new Vector(j.b2_maxManifoldPoints);for(var e=0;e<j.b2_maxManifoldPoints;e++)this.points[e]=new f},f.b2ContactConstraintPoint=function(){this.localPoint=new z,this.rA=new z,this.rB=new z},l.b2ContactEdge=function(){},c.b2ContactFactory=function(){},c.prototype.b2ContactFactory=function(e){this.m_allocator=e,this.InitializeRegisters()},c.prototype.AddType=function(e,t,n,r){n===undefined&&(n=0),r===undefined&&(r=0),this.m_registers[n][r].createFcn=e,this.m_registers[n][r].destroyFcn=t,this.m_registers[n][r].primary=!0,n!=r&&(this.m_registers[r][n].createFcn=e,this.m_registers[r][n].destroyFcn=t,this.m_registers[r][n].primary=!1)},c.prototype.InitializeRegisters=function(){this.m_registers=new Vector(s.e_shapeTypeCount);for(var e=0;e<s.e_shapeTypeCount;e++){this.m_registers[e]=new Vector(s.e_shapeTypeCount);for(var t=0;t<s.e_shapeTypeCount;t++)this.m_registers[e][t]=new h}this.AddType(o.Create,o.Destroy,s.e_circleShape,s.e_circleShape),this.AddType(g.Create,g.Destroy,s.e_polygonShape,s.e_circleShape),this.AddType(b.Create,b.Destroy,s.e_polygonShape,s.e_polygonShape),this.AddType(v.Create,v.Destroy,s.e_edgeShape,s.e_circleShape),this.AddType(y.Create,y.Destroy,s.e_polygonShape,s.e_edgeShape)},c.prototype.Create=function(e,t){var n=parseInt(e.GetType()),r=parseInt(t.GetType()),i=this.m_registers[n][r],s;if(i.pool)return s=i.pool,i.pool=s.m_next,i.poolCount--,s.Reset(e,t),s;var o=i.createFcn;return o!=null?i.primary?(s=o(this.m_allocator),s.Reset(e,t),s):(s=o(this.m_allocator),s.Reset(t,e),s):null},c.prototype.Destroy=function(e){e.m_manifold.m_pointCount>0&&(e.m_fixtureA.m_body.SetAwake(!0),e.m_fixtureB.m_body.SetAwake(!0));var t=parseInt(e.m_fixtureA.GetType()),n=parseInt(e.m_fixtureB.GetType()),r=this.m_registers[t][n];r.poolCount++,e.m_next=r.pool,r.pool=e;var i=r.destroyFcn;i(e,this.m_allocator)},h.b2ContactRegister=function(){},p.b2ContactResult=function(){this.position=new z,this.normal=new z,this.id=new K},d.b2ContactSolver=function(){this.m_step=new D,this.m_constraints=new Vector},d.prototype.b2ContactSolver=function(){},d.prototype.Initialize=function(e,t,n,r){n===undefined&&(n=0);var i;this.m_step.Set(e),this.m_allocator=r;var s=0,o,u;this.m_constraintCount=n;while(this.m_constraints.length<this.m_constraintCount)this.m_constraints[this.m_constraints.length]=new a;for(s=0;s<n;++s){i=t[s];var f=i.m_fixtureA,l=i.m_fixtureB,c=f.m_shape,h=l.m_shape,p=c.m_radius,v=h.m_radius,m=f.m_body,g=l.m_body,y=i.GetManifold(),b=j.b2MixFriction(f.GetFriction(),l.GetFriction()),w=j.b2MixRestitution(f.GetRestitution(),l.GetRestitution()),E=m.m_linearVelocity.x,S=m.m_linearVelocity.y,x=g.m_linearVelocity.x,T=g.m_linearVelocity.y,N=m.m_angularVelocity,C=g.m_angularVelocity;j.b2Assert(y.m_pointCount>0),d.s_worldManifold.Initialize(y,m.m_xf,p,g.m_xf,v);var k=d.s_worldManifold.m_normal.x,L=d.s_worldManifold.m_normal.y,A=this.m_constraints[s];A.bodyA=m,A.bodyB=g,A.manifold=y,A.normal.x=k,A.normal.y=L,A.pointCount=y.m_pointCount,A.friction=b,A.restitution=w,A.localPlaneNormal.x=y.m_localPlaneNormal.x,A.localPlaneNormal.y=y.m_localPlaneNormal.y,A.localPoint.x=y.m_localPoint.x,A.localPoint.y=y.m_localPoint.y,A.radius=p+v,A.type=y.m_type;for(var O=0;O<A.pointCount;++O){var M=y.m_points[O],_=A.points[O];_.normalImpulse=M.m_normalImpulse,_.tangentImpulse=M.m_tangentImpulse,_.localPoint.SetV(M.m_localPoint);var D=_.rA.x=d.s_worldManifold.m_points[O].x-m.m_sweep.c.x,P=_.rA.y=d.s_worldManifold.m_points[O].y-m.m_sweep.c.y,H=_.rB.x=d.s_worldManifold.m_points[O].x-g.m_sweep.c.x,B=_.rB.y=d.s_worldManifold.m_points[O].y-g.m_sweep.c.y,F=D*L-P*k,I=H*L-B*k;F*=F,I*=I;var q=m.m_invMass+g.m_invMass+m.m_invI*F+g.m_invI*I;_.normalMass=1/q;var R=m.m_mass*m.m_invMass+g.m_mass*g.m_invMass;R+=m.m_mass*m.m_invI*F+g.m_mass*g.m_invI*I,_.equalizedMass=1/R;var U=L,z=-k,W=D*z-P*U,X=H*z-B*U;W*=W,X*=X;var V=m.m_invMass+g.m_invMass+m.m_invI*W+g.m_invI*X;_.tangentMass=1/V,_.velocityBias=0;var $=x+ -C*B-E- -N*P,J=T+C*H-S-N*D,K=A.normal.x*$+A.normal.y*J;K<-j.b2_velocityThreshold&&(_.velocityBias+=-A.restitution*K)}if(A.pointCount==2){var Q=A.points[0],G=A.points[1],Y=m.m_invMass,Z=m.m_invI,et=g.m_invMass,tt=g.m_invI,nt=Q.rA.x*L-Q.rA.y*k,rt=Q.rB.x*L-Q.rB.y*k,it=G.rA.x*L-G.rA.y*k,st=G.rB.x*L-G.rB.y*k,ot=Y+et+Z*nt*nt+tt*rt*rt,ut=Y+et+Z*it*it+tt*st*st,at=Y+et+Z*nt*it+tt*rt*st,ft=100;ot*ot<ft*(ot*ut-at*at)?(A.K.col1.Set(ot,at),A.K.col2.Set(at,ut),A.K.GetInverse(A.normalMass)):A.pointCount=1}}},d.prototype.InitVelocityConstraints=function(e){var t,n,r;for(var i=0;i<this.m_constraintCount;++i){var s=this.m_constraints[i],o=s.bodyA,u=s.bodyB,a=o.m_invMass,f=o.m_invI,l=u.m_invMass,c=u.m_invI,h=s.normal.x,p=s.normal.y,d=p,v=-h,m=0,g=0,y=0;if(e.warmStarting){y=s.pointCount;for(g=0;g<y;++g){var b=s.points[g];b.normalImpulse*=e.dtRatio,b.tangentImpulse*=e.dtRatio;var w=b.normalImpulse*h+b.tangentImpulse*d,E=b.normalImpulse*p+b.tangentImpulse*v;o.m_angularVelocity-=f*(b.rA.x*E-b.rA.y*w),o.m_linearVelocity.x-=a*w,o.m_linearVelocity.y-=a*E,u.m_angularVelocity+=c*(b.rB.x*E-b.rB.y*w),u.m_linearVelocity.x+=l*w,u.m_linearVelocity.y+=l*E}}else{y=s.pointCount;for(g=0;g<y;++g){var S=s.points[g];S.normalImpulse=0,S.tangentImpulse=0}}}},d.prototype.SolveVelocityConstraints=function(){var e=0,t,n=0,r=0,i=0,s=0,o=0,u=0,a=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E,S;for(var x=0;x<this.m_constraintCount;++x){var T=this.m_constraints[x],N=T.bodyA,C=T.bodyB,k=N.m_angularVelocity,L=C.m_angularVelocity,A=N.m_linearVelocity,O=C.m_linearVelocity,M=N.m_invMass,_=N.m_invI,D=C.m_invMass,P=C.m_invI,H=T.normal.x,B=T.normal.y,j=B,F=-H,I=T.friction,R=0;for(e=0;e<T.pointCount;e++)t=T.points[e],o=O.x-L*t.rB.y-A.x+k*t.rA.y,u=O.y+L*t.rB.x-A.y-k*t.rA.x,f=o*j+u*F,l=t.tangentMass*-f,c=I*t.normalImpulse,h=q.Clamp(t.tangentImpulse+l,-c,c),l=h-t.tangentImpulse,p=l*j,d=l*F,A.x-=M*p,A.y-=M*d,k-=_*(t.rA.x*d-t.rA.y*p),O.x+=D*p,O.y+=D*d,L+=P*(t.rB.x*d-t.rB.y*p),t.tangentImpulse=h;var U=parseInt(T.pointCount);if(T.pointCount==1)t=T.points[0],o=O.x+ -L*t.rB.y-A.x- -k*t.rA.y,u=O.y+L*t.rB.x-A.y-k*t.rA.x,a=o*H+u*B,l=-t.normalMass*(a-t.velocityBias),h=t.normalImpulse+l,h=h>0?h:0,l=h-t.normalImpulse,p=l*H,d=l*B,A.x-=M*p,A.y-=M*d,k-=_*(t.rA.x*d-t.rA.y*p),O.x+=D*p,O.y+=D*d,L+=P*(t.rB.x*d-t.rB.y*p),t.normalImpulse=h;else{var z=T.points[0],W=T.points[1],X=z.normalImpulse,V=W.normalImpulse,$=O.x-L*z.rB.y-A.x+k*z.rA.y,J=O.y+L*z.rB.x-A.y-k*z.rA.x,K=O.x-L*W.rB.y-A.x+k*W.rA.y,Q=O.y+L*W.rB.x-A.y-k*W.rA.x,G=$*H+J*B,Y=K*H+Q*B,Z=G-z.velocityBias,et=Y-W.velocityBias;E=T.K,Z-=E.col1.x*X+E.col2.x*V,et-=E.col1.y*X+E.col2.y*V;var tt=.001;for(;;){E=T.normalMass;var nt=-(E.col1.x*Z+E.col2.x*et),rt=-(E.col1.y*Z+E.col2.y*et);if(nt>=0&&rt>=0){v=nt-X,m=rt-V,g=v*H,y=v*B,b=m*H,w=m*B,A.x-=M*(g+b),A.y-=M*(y+w),k-=_*(z.rA.x*y-z.rA.y*g+W.rA.x*w-W.rA.y*b),O.x+=D*(g+b),O.y+=D*(y+w),L+=P*(z.rB.x*y-z.rB.y*g+W.rB.x*w-W.rB.y*b),z.normalImpulse=nt,W.normalImpulse=rt;break}nt=-z.normalMass*Z,rt=0,G=0,Y=T.K.col1.y*nt+et;if(nt>=0&&Y>=0){v=nt-X,m=rt-V,g=v*H,y=v*B,b=m*H,w=m*B,A.x-=M*(g+b),A.y-=M*(y+w),k-=_*(z.rA.x*y-z.rA.y*g+W.rA.x*w-W.rA.y*b),O.x+=D*(g+b),O.y+=D*(y+w),L+=P*(z.rB.x*y-z.rB.y*g+W.rB.x*w-W.rB.y*b),z.normalImpulse=nt,W.normalImpulse=rt;break}nt=0,rt=-W.normalMass*et,G=T.K.col2.x*rt+Z,Y=0;if(rt>=0&&G>=0){v=nt-X,m=rt-V,g=v*H,y=v*B,b=m*H,w=m*B,A.x-=M*(g+b),A.y-=M*(y+w),k-=_*(z.rA.x*y-z.rA.y*g+W.rA.x*w-W.rA.y*b),O.x+=D*(g+b),O.y+=D*(y+w),L+=P*(z.rB.x*y-z.rB.y*g+W.rB.x*w-W.rB.y*b),z.normalImpulse=nt,W.normalImpulse=rt;break}nt=0,rt=0,G=Z,Y=et;if(G>=0&&Y>=0){v=nt-X,m=rt-V,g=v*H,y=v*B,b=m*H,w=m*B,A.x-=M*(g+b),A.y-=M*(y+w),k-=_*(z.rA.x*y-z.rA.y*g+W.rA.x*w-W.rA.y*b),O.x+=D*(g+b),O.y+=D*(y+w),L+=P*(z.rB.x*y-z.rB.y*g+W.rB.x*w-W.rB.y*b),z.normalImpulse=nt,W.normalImpulse=rt;break}break}}N.m_angularVelocity=k,C.m_angularVelocity=L}},d.prototype.FinalizeVelocityConstraints=function(){for(var e=0;e<this.m_constraintCount;++e){var t=this.m_constraints[e],n=t.manifold;for(var r=0;r<t.pointCount;++r){var i=n.m_points[r],s=t.points[r];i.m_normalImpulse=s.normalImpulse,i.m_tangentImpulse=s.tangentImpulse}}},d.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=0;for(var n=0;n<this.m_constraintCount;n++){var r=this.m_constraints[n],i=r.bodyA,s=r.bodyB,o=i.m_mass*i.m_invMass,u=i.m_mass*i.m_invI,a=s.m_mass*s.m_invMass,f=s.m_mass*s.m_invI;d.s_psm.Initialize(r);var l=d.s_psm.m_normal;for(var c=0;c<r.pointCount;c++){var h=r.points[c],p=d.s_psm.m_points[c],v=d.s_psm.m_separations[c],m=p.x-i.m_sweep.c.x,g=p.y-i.m_sweep.c.y,y=p.x-s.m_sweep.c.x,b=p.y-s.m_sweep.c.y;t=t<v?t:v;var w=q.Clamp(e*(v+j.b2_linearSlop),-j.b2_maxLinearCorrection,0),E=-h.equalizedMass*w,S=E*l.x,x=E*l.y;i.m_sweep.c.x-=o*S,i.m_sweep.c.y-=o*x,i.m_sweep.a-=u*(m*x-g*S),i.SynchronizeTransform(),s.m_sweep.c.x+=a*S,s.m_sweep.c.y+=a*x,s.m_sweep.a+=f*(y*x-b*S),s.SynchronizeTransform()}}return t>-1.5*j.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new gt,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new w}),Box2D.inherit(v,Box2D.Dynamics.Contacts.b2Contact),v.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,v.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},v.Create=function(e){return new v},v.Destroy=function(e,t){},v.prototype.Reset=function(e,t){this.__super.Reset.call(this,e,t)},v.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),r=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof n?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,r.m_xf)},v.prototype.b2CollideEdgeAndCircle=function(e,t,n,r,i){},Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact),m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,m.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},m.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},m.prototype.Evaluate=function(){},Box2D.inherit(g,Box2D.Dynamics.Contacts.b2Contact),g.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,g.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},g.Create=function(e){return new g},g.Destroy=function(e,t){},g.prototype.Reset=function(e,t){this.__super.Reset.call(this,e,t),j.b2Assert(e.GetType()==s.e_polygonShape),j.b2Assert(t.GetType()==s.e_circleShape)},g.prototype.Evaluate=function(){var t=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;J.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},Box2D.inherit(y,Box2D.Dynamics.Contacts.b2Contact),y.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,y.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.Create=function(e){return new y},y.Destroy=function(e,t){},y.prototype.Reset=function(e,t){this.__super.Reset.call(this,e,t),j.b2Assert(e.GetType()==s.e_polygonShape),j.b2Assert(t.GetType()==s.e_edgeShape)},y.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof n?this.m_fixtureB.GetShape():null,t.m_xf)},y.prototype.b2CollidePolyAndEdge=function(e,t,n,r,i){},Box2D.inherit(b,Box2D.Dynamics.Contacts.b2Contact),b.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,b.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},b.Create=function(e){return new b},b.Destroy=function(e,t){},b.prototype.Reset=function(e,t){this.__super.Reset.call(this,e,t)},b.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody();J.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,t.m_xf)},w.b2PositionSolverManifold=function(){},w.prototype.b2PositionSolverManifold=function(){this.m_normal=new z,this.m_separations=new Vector_a2j_Number(j.b2_maxManifoldPoints),this.m_points=new Vector(j.b2_maxManifoldPoints);for(var e=0;e<j.b2_maxManifoldPoints;e++)this.m_points[e]=new z},w.prototype.Initialize=function(e){j.b2Assert(e.pointCount>0);var t=0,n=0,r=0,i,s,o=0,u=0;switch(e.type){case st.e_circles:i=e.bodyA.m_xf.R,s=e.localPoint;var a=e.bodyA.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),f=e.bodyA.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y);i=e.bodyB.m_xf.R,s=e.points[0].localPoint;var l=e.bodyB.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),c=e.bodyB.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y),h=l-a,p=c-f,d=h*h+p*p;if(d>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(d);this.m_normal.x=h/v,this.m_normal.y=p/v}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(a+l),this.m_points[0].y=.5*(f+c),this.m_separations[0]=h*this.m_normal.x+p*this.m_normal.y-e.radius;break;case st.e_faceA:i=e.bodyA.m_xf.R,s=e.localPlaneNormal,this.m_normal.x=i.col1.x*s.x+i.col2.x*s.y,this.m_normal.y=i.col1.y*s.x+i.col2.y*s.y,i=e.bodyA.m_xf.R,s=e.localPoint,o=e.bodyA.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),u=e.bodyA.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y),i=e.bodyB.m_xf.R;for(t=0;t<e.pointCount;++t)s=e.points[t].localPoint,n=e.bodyB.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),r=e.bodyB.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y),this.m_separations[t]=(n-o)*this.m_normal.x+(r-u)*this.m_normal.y-e.radius,this.m_points[t].x=n,this.m_points[t].y=r;break;case st.e_faceB:i=e.bodyB.m_xf.R,s=e.localPlaneNormal,this.m_normal.x=i.col1.x*s.x+i.col2.x*s.y,this.m_normal.y=i.col1.y*s.x+i.col2.y*s.y,i=e.bodyB.m_xf.R,s=e.localPoint,o=e.bodyB.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),u=e.bodyB.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y),i=e.bodyA.m_xf.R;for(t=0;t<e.pointCount;++t)s=e.points[t].localPoint,n=e.bodyA.m_xf.position.x+(i.col1.x*s.x+i.col2.x*s.y),r=e.bodyA.m_xf.position.y+(i.col1.y*s.x+i.col2.y*s.y),this.m_separations[t]=(n-o)*this.m_normal.x+(r-u)*this.m_normal.y-e.radius,this.m_points[t].Set(n,r);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new z,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new z})}(),function(){var e=Box2D.Dynamics.b2Body,t=Box2D.Dynamics.b2BodyDef,n=Box2D.Dynamics.b2ContactFilter,r=Box2D.Dynamics.b2ContactImpulse,i=Box2D.Dynamics.b2ContactListener,s=Box2D.Dynamics.b2ContactManager,o=Box2D.Dynamics.b2DebugDraw,u=Box2D.Dynamics.b2DestructionListener,a=Box2D.Dynamics.b2FilterData,f=Box2D.Dynamics.b2Fixture,l=Box2D.Dynamics.b2FixtureDef,c=Box2D.Dynamics.b2Island,h=Box2D.Dynamics.b2TimeStep,p=Box2D.Dynamics.b2World,d=Box2D.Common.Math.b2Mat22,v=Box2D.Common.Math.b2Mat33,m=Box2D.Common.Math.b2Math,g=Box2D.Common.Math.b2Sweep,y=Box2D.Common.Math.b2Transform,b=Box2D.Common.Math.b2Vec2,w=Box2D.Common.Math.b2Vec3,E=Box2D.Common.b2Color,S=Box2D.Common.b2internal,x=Box2D.Common.b2Settings,T=Box2D.Collision.Shapes.b2CircleShape,N=Box2D.Collision.Shapes.b2EdgeChainDef,C=Box2D.Collision.Shapes.b2EdgeShape,k=Box2D.Collision.Shapes.b2MassData,L=Box2D.Collision.Shapes.b2PolygonShape,A=Box2D.Collision.Shapes.b2Shape,O=Box2D.Dynamics.Controllers.b2BuoyancyController,M=Box2D.Dynamics.Controllers.b2ConstantAccelController,_=Box2D.Dynamics.Controllers.b2ConstantForceController,D=Box2D.Dynamics.Controllers.b2Controller,P=Box2D.Dynamics.Controllers.b2ControllerEdge,H=Box2D.Dynamics.Controllers.b2GravityController,B=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(O,Box2D.Dynamics.Controllers.b2Controller),O.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,O.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new b(0,-1),this.offset=0,this.density=0,this.velocity=new b(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},O.prototype.Step=function(e){if(!this.m_bodyList)return;this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var t=this.m_bodyList;t;t=t.nextBody){var n=t.body;if(n.IsAwake()==0)continue;var r=new b,i=new b,s=0,o=0;for(var u=n.GetFixtureList();u;u=u.GetNext()){var a=new b,f=u.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),a);s+=f,r.x+=f*a.x,r.y+=f*a.y;var l=0;this.useDensity?l=1:l=1,o+=f*l,i.x+=f*a.x*l,i.y+=f*a.y*l}r.x/=s,r.y/=s,i.x/=o,i.y/=o;if(s<Number.MIN_VALUE)continue;var c=this.gravity.GetNegative();c.Multiply(this.density*s),n.ApplyForce(c,i);var h=n.GetLinearVelocityFromWorldPoint(r);h.Subtract(this.velocity),h.Multiply(-this.linearDrag*s),n.ApplyForce(h,r),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}},O.prototype.Draw=function(e){var t=1e3,n=new b,r=new b;n.x=this.normal.x*this.offset+this.normal.y*t,n.y=this.normal.y*this.offset-this.normal.x*t,r.x=this.normal.x*this.offset-this.normal.y*t,r.y=this.normal.y*this.offset+this.normal.x*t;var i=new E(0,0,1);e.DrawSegment(n,r,i)},Box2D.inherit(M,Box2D.Dynamics.Controllers.b2Controller),M.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,M.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new b(0,0)},M.prototype.Step=function(e){var t=new b(this.A.x*e.dt,this.A.y*e.dt);for(var n=this.m_bodyList;n;n=n.nextBody){var r=n.body;if(!r.IsAwake())continue;r.SetLinearVelocity(new b(r.GetLinearVelocity().x+t.x,r.GetLinearVelocity().y+t.y))}},Box2D.inherit(_,Box2D.Dynamics.Controllers.b2Controller),_.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,_.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new b(0,0)},_.prototype.Step=function(e){for(var t=this.m_bodyList;t;t=t.nextBody){var n=t.body;if(!n.IsAwake())continue;n.ApplyForce(this.F,n.GetWorldCenter())}},D.b2Controller=function(){},D.prototype.Step=function(e){},D.prototype.Draw=function(e){},D.prototype.AddBody=function(e){var t=new P;t.controller=this,t.body=e,t.nextBody=this.m_bodyList,t.prevBody=null,this.m_bodyList=t,t.nextBody&&(t.nextBody.prevBody=t),this.m_bodyCount++,t.nextController=e.m_controllerList,t.prevController=null,e.m_controllerList=t,t.nextController&&(t.nextController.prevController=t),e.m_controllerCount++},D.prototype.RemoveBody=function(e){var t=e.m_controllerList;while(t&&t.controller!=this)t=t.nextController;t.prevBody&&(t.prevBody.nextBody=t.nextBody),t.nextBody&&(t.nextBody.prevBody=t.prevBody),t.nextController&&(t.nextController.prevController=t.prevController),t.prevController&&(t.prevController.nextController=t.nextController),this.m_bodyList==t&&(this.m_bodyList=t.nextBody),e.m_controllerList==t&&(e.m_controllerList=t.nextController),e.m_controllerCount--,this.m_bodyCount--},D.prototype.Clear=function(){while(this.m_bodyList)this.RemoveBody(this.m_bodyList.body)},D.prototype.GetNext=function(){return this.m_next},D.prototype.GetWorld=function(){return this.m_world},D.prototype.GetBodyList=function(){return this.m_bodyList},P.b2ControllerEdge=function(){},Box2D.inherit(H,Box2D.Dynamics.Controllers.b2Controller),H.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,H.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},H.prototype.Step=function(e){var t=null,n=null,r=null,i=0,s=null,o=null,u=null,a=0,f=0,l=0,c=null;if(this.invSqr)for(t=this.m_bodyList;t;t=t.nextBody){n=t.body,r=n.GetWorldCenter(),i=n.GetMass();for(s=this.m_bodyList;s!=t;s=s.nextBody){o=s.body,u=o.GetWorldCenter(),a=u.x-r.x,f=u.y-r.y,l=a*a+f*f;if(l<Number.MIN_VALUE)continue;c=new b(a,f),c.Multiply(this.G/l/Math.sqrt(l)*i*o.GetMass()),n.IsAwake()&&n.ApplyForce(c,r),c.Multiply(-1),o.IsAwake()&&o.ApplyForce(c,u)}}else for(t=this.m_bodyList;t;t=t.nextBody){n=t.body,r=n.GetWorldCenter(),i=n.GetMass();for(s=this.m_bodyList;s!=t;s=s.nextBody){o=s.body,u=o.GetWorldCenter(),a=u.x-r.x,f=u.y-r.y,l=a*a+f*f;if(l<Number.MIN_VALUE)continue;c=new b(a,f),c.Multiply(this.G/l*i*o.GetMass()),n.IsAwake()&&n.ApplyForce(c,r),c.Multiply(-1),o.IsAwake()&&o.ApplyForce(c,u)}}},Box2D.inherit(B,Box2D.Dynamics.Controllers.b2Controller),B.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,B.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new d,this.maxTimestep=0},B.prototype.SetAxisAligned=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.T.col1.x=-e,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-t,e>0||t>0?this.maxTimestep=1/Math.max(e,t):this.maxTimestep=0},B.prototype.Step=function(e){var t=e.dt;if(t<=Number.MIN_VALUE)return;t>this.maxTimestep&&this.maxTimestep>0&&(t=this.maxTimestep);for(var n=this.m_bodyList;n;n=n.nextBody){var r=n.body;if(!r.IsAwake())continue;var i=r.GetWorldVector(m.MulMV(this.T,r.GetLocalVector(r.GetLinearVelocity())));r.SetLinearVelocity(new b(r.GetLinearVelocity().x+i.x*t,r.GetLinearVelocity().y+i.y*t))}}}(),function(){var e=Box2D.Common.b2Color,t=Box2D.Common.b2internal,n=Box2D.Common.b2Settings,r=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,s=Box2D.Common.Math.b2Math,o=Box2D.Common.Math.b2Sweep,u=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,f=Box2D.Common.Math.b2Vec3,l=Box2D.Dynamics.Joints.b2DistanceJoint,c=Box2D.Dynamics.Joints.b2DistanceJointDef,h=Box2D.Dynamics.Joints.b2FrictionJoint,p=Box2D.Dynamics.Joints.b2FrictionJointDef,d=Box2D.Dynamics.Joints.b2GearJoint,v=Box2D.Dynamics.Joints.b2GearJointDef,m=Box2D.Dynamics.Joints.b2Jacobian,g=Box2D.Dynamics.Joints.b2Joint,y=Box2D.Dynamics.Joints.b2JointDef,b=Box2D.Dynamics.Joints.b2JointEdge,w=Box2D.Dynamics.Joints.b2LineJoint,E=Box2D.Dynamics.Joints.b2LineJointDef,S=Box2D.Dynamics.Joints.b2MouseJoint,x=Box2D.Dynamics.Joints.b2MouseJointDef,T=Box2D.Dynamics.Joints.b2PrismaticJoint,N=Box2D.Dynamics.Joints.b2PrismaticJointDef,C=Box2D.Dynamics.Joints.b2PulleyJoint,k=Box2D.Dynamics.Joints.b2PulleyJointDef,L=Box2D.Dynamics.Joints.b2RevoluteJoint,A=Box2D.Dynamics.Joints.b2RevoluteJointDef,O=Box2D.Dynamics.Joints.b2WeldJoint,M=Box2D.Dynamics.Joints.b2WeldJointDef,_=Box2D.Dynamics.b2Body,D=Box2D.Dynamics.b2BodyDef,P=Box2D.Dynamics.b2ContactFilter,H=Box2D.Dynamics.b2ContactImpulse,B=Box2D.Dynamics.b2ContactListener,j=Box2D.Dynamics.b2ContactManager,F=Box2D.Dynamics.b2DebugDraw,I=Box2D.Dynamics.b2DestructionListener,q=Box2D.Dynamics.b2FilterData,R=Box2D.Dynamics.b2Fixture,U=Box2D.Dynamics.b2FixtureDef,z=Box2D.Dynamics.b2Island,W=Box2D.Dynamics.b2TimeStep,X=Box2D.Dynamics.b2World;Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint),l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,l.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_u=new a},l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},l.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse*this.m_u.x,e*this.m_impulse*this.m_u.y)},l.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),0},l.prototype.GetLength=function(){return this.m_length},l.prototype.SetLength=function(e){e===undefined&&(e=0),this.m_length=e},l.prototype.GetFrequency=function(){return this.m_frequencyHz},l.prototype.SetFrequency=function(e){e===undefined&&(e=0),this.m_frequencyHz=e},l.prototype.GetDampingRatio=function(){return this.m_dampingRatio},l.prototype.SetDampingRatio=function(e){e===undefined&&(e=0),this.m_dampingRatio=e},l.prototype.b2DistanceJoint=function(e){this.__super.b2Joint.call(this,e);var t,n=0,r=0;this.m_localAnchor1.SetV(e.localAnchorA),this.m_localAnchor2.SetV(e.localAnchorB),this.m_length=e.length,this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},l.prototype.InitVelocityConstraints=function(e){var t,r=0,i=this.m_bodyA,s=this.m_bodyB;t=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,u=this.m_localAnchor1.y-i.m_sweep.localCenter.y;r=t.col1.x*o+t.col2.x*u,u=t.col1.y*o+t.col2.y*u,o=r,t=s.m_xf.R;var a=this.m_localAnchor2.x-s.m_sweep.localCenter.x,f=this.m_localAnchor2.y-s.m_sweep.localCenter.y;r=t.col1.x*a+t.col2.x*f,f=t.col1.y*a+t.col2.y*f,a=r,this.m_u.x=s.m_sweep.c.x+a-i.m_sweep.c.x-o,this.m_u.y=s.m_sweep.c.y+f-i.m_sweep.c.y-u;var l=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);l>n.b2_linearSlop?this.m_u.Multiply(1/l):this.m_u.SetZero();var c=o*this.m_u.y-u*this.m_u.x,h=a*this.m_u.y-f*this.m_u.x,p=i.m_invMass+i.m_invI*c*c+s.m_invMass+s.m_invI*h*h;this.m_mass=p!=0?1/p:0;if(this.m_frequencyHz>0){var d=l-this.m_length,v=2*Math.PI*this.m_frequencyHz,m=2*this.m_mass*this.m_dampingRatio*v,g=this.m_mass*v*v;this.m_gamma=e.dt*(m+e.dt*g),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=d*e.dt*g*this.m_gamma,this.m_mass=p+this.m_gamma,this.m_mass=this.m_mass!=0?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var y=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*y,i.m_linearVelocity.y-=i.m_invMass*b,i.m_angularVelocity-=i.m_invI*(o*b-u*y),s.m_linearVelocity.x+=s.m_invMass*y,s.m_linearVelocity.y+=s.m_invMass*b,s.m_angularVelocity+=s.m_invI*(a*b-f*y)}else this.m_impulse=0},l.prototype.SolveVelocityConstraints=function(e){var t,n=this.m_bodyA,r=this.m_bodyB;t=n.m_xf.R;var i=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,o=t.col1.x*i+t.col2.x*s;s=t.col1.y*i+t.col2.y*s,i=o,t=r.m_xf.R;var u=this.m_localAnchor2.x-r.m_sweep.localCenter.x,a=this.m_localAnchor2.y-r.m_sweep.localCenter.y;o=t.col1.x*u+t.col2.x*a,a=t.col1.y*u+t.col2.y*a,u=o;var f=n.m_linearVelocity.x+ -n.m_angularVelocity*s,l=n.m_linearVelocity.y+n.m_angularVelocity*i,c=r.m_linearVelocity.x+ -r.m_angularVelocity*a,h=r.m_linearVelocity.y+r.m_angularVelocity*u,p=this.m_u.x*(c-f)+this.m_u.y*(h-l),d=-this.m_mass*(p+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=d;var v=d*this.m_u.x,m=d*this.m_u.y;n.m_linearVelocity.x-=n.m_invMass*v,n.m_linearVelocity.y-=n.m_invMass*m,n.m_angularVelocity-=n.m_invI*(i*m-s*v),r.m_linearVelocity.x+=r.m_invMass*v,r.m_linearVelocity.y+=r.m_invMass*m,r.m_angularVelocity+=r.m_invI*(u*m-a*v)},l.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t;if(this.m_frequencyHz>0)return!0;var r=this.m_bodyA,i=this.m_bodyB;t=r.m_xf.R;var o=this.m_localAnchor1.x-r.m_sweep.localCenter.x,u=this.m_localAnchor1.y-r.m_sweep.localCenter.y,a=t.col1.x*o+t.col2.x*u;u=t.col1.y*o+t.col2.y*u,o=a,t=i.m_xf.R;var f=this.m_localAnchor2.x-i.m_sweep.localCenter.x,l=this.m_localAnchor2.y-i.m_sweep.localCenter.y;a=t.col1.x*f+t.col2.x*l,l=t.col1.y*f+t.col2.y*l,f=a;var c=i.m_sweep.c.x+f-r.m_sweep.c.x-o,h=i.m_sweep.c.y+l-r.m_sweep.c.y-u,p=Math.sqrt(c*c+h*h);c/=p,h/=p;var d=p-this.m_length;d=s.Clamp(d,-n.b2_maxLinearCorrection,n.b2_maxLinearCorrection);var v=-this.m_mass*d;this.m_u.Set(c,h);var m=v*this.m_u.x,g=v*this.m_u.y;return r.m_sweep.c.x-=r.m_invMass*m,r.m_sweep.c.y-=r.m_invMass*g,r.m_sweep.a-=r.m_invI*(o*g-u*m),i.m_sweep.c.x+=i.m_invMass*m,i.m_sweep.c.y+=i.m_invMass*g,i.m_sweep.a+=i.m_invI*(f*g-l*m),r.SynchronizeTransform(),i.SynchronizeTransform(),s.Abs(d)<n.b2_linearSlop},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a},c.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},c.prototype.Initialize=function(e,t,n,r){this.bodyA=e,this.bodyB=t,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(n)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(r));var i=r.x-n.x,s=r.y-n.y;this.length=Math.sqrt(i*i+s*s),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(h,Box2D.Dynamics.Joints.b2Joint),h.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,h.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new a,this.m_localAnchorB=new a,this.m_linearMass=new r,this.m_linearImpulse=new a},h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},h.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_linearImpulse.x,e*this.m_linearImpulse.y)},h.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),e*this.m_angularImpulse},h.prototype.SetMaxForce=function(e){e===undefined&&(e=0),this.m_maxForce=e},h.prototype.GetMaxForce=function(){return this.m_maxForce},h.prototype.SetMaxTorque=function(e){e===undefined&&(e=0),this.m_maxTorque=e},h.prototype.GetMaxTorque=function(){return this.m_maxTorque},h.prototype.b2FrictionJoint=function(e){this.__super.b2Joint.call(this,e),this.m_localAnchorA.SetV(e.localAnchorA),this.m_localAnchorB.SetV(e.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=e.maxForce,this.m_maxTorque=e.maxTorque},h.prototype.InitVelocityConstraints=function(e){var t,n=0,i=this.m_bodyA,s=this.m_bodyB;t=i.m_xf.R;var o=this.m_localAnchorA.x-i.m_sweep.localCenter.x,u=this.m_localAnchorA.y-i.m_sweep.localCenter.y;n=t.col1.x*o+t.col2.x*u,u=t.col1.y*o+t.col2.y*u,o=n,t=s.m_xf.R;var a=this.m_localAnchorB.x-s.m_sweep.localCenter.x,f=this.m_localAnchorB.y-s.m_sweep.localCenter.y;n=t.col1.x*a+t.col2.x*f,f=t.col1.y*a+t.col2.y*f,a=n;var l=i.m_invMass,c=s.m_invMass,h=i.m_invI,p=s.m_invI,d=new r;d.col1.x=l+c,d.col2.x=0,d.col1.y=0,d.col2.y=l+c,d.col1.x+=h*u*u,d.col2.x+=-h*o*u,d.col1.y+=-h*o*u,d.col2.y+=h*o*o,d.col1.x+=p*f*f,d.col2.x+=-p*a*f,d.col1.y+=-p*a*f,d.col2.y+=p*a*a,d.GetInverse(this.m_linearMass),this.m_angularMass=h+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass);if(e.warmStarting){this.m_linearImpulse.x*=e.dtRatio,this.m_linearImpulse.y*=e.dtRatio,this.m_angularImpulse*=e.dtRatio;var v=this.m_linearImpulse;i.m_linearVelocity.x-=l*v.x,i.m_linearVelocity.y-=l*v.y,i.m_angularVelocity-=h*(o*v.y-u*v.x+this.m_angularImpulse),s.m_linearVelocity.x+=c*v.x,s.m_linearVelocity.y+=c*v.y,s.m_angularVelocity+=p*(a*v.y-f*v.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},h.prototype.SolveVelocityConstraints=function(e){var t,n=0,r=this.m_bodyA,i=this.m_bodyB,o=r.m_linearVelocity,u=r.m_angularVelocity,f=i.m_linearVelocity,l=i.m_angularVelocity,c=r.m_invMass,h=i.m_invMass,p=r.m_invI,d=i.m_invI;t=r.m_xf.R;var v=this.m_localAnchorA.x-r.m_sweep.localCenter.x,m=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=t.col1.x*v+t.col2.x*m,m=t.col1.y*v+t.col2.y*m,v=n,t=i.m_xf.R;var g=this.m_localAnchorB.x-i.m_sweep.localCenter.x,y=this.m_localAnchorB.y-i.m_sweep.localCenter.y;n=t.col1.x*g+t.col2.x*y,y=t.col1.y*g+t.col2.y*y,g=n;var b=0,w=l-u,E=-this.m_angularMass*w,S=this.m_angularImpulse;b=e.dt*this.m_maxTorque,this.m_angularImpulse=s.Clamp(this.m_angularImpulse+E,-b,b),E=this.m_angularImpulse-S,u-=p*E,l+=d*E;var x=f.x-l*y-o.x+u*m,T=f.y+l*g-o.y-u*v,N=s.MulMV(this.m_linearMass,new a(-x,-T)),C=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(N),b=e.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(b)),N=s.SubtractVV(this.m_linearImpulse,C),o.x-=c*N.x,o.y-=c*N.y,u-=p*(v*N.y-m*N.x),f.x+=h*N.x,f.y+=h*N.y,l+=d*(g*N.y-y*N.x),r.m_angularVelocity=u,i.m_angularVelocity=l},h.prototype.SolvePositionConstraints=function(e){return e===undefined&&(e=0),!0},Box2D.inherit(p,Box2D.Dynamics.Joints.b2JointDef),p.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,p.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a},p.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_frictionJoint,this.maxForce=0,this.maxTorque=0},p.prototype.Initialize=function(e,t,n){this.bodyA=e,this.bodyB=t,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(n)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n))},Box2D.inherit(d,Box2D.Dynamics.Joints.b2Joint),d.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,d.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new a,this.m_groundAnchor2=new a,this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_J=new m},d.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},d.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},d.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse*this.m_J.linearB.x,e*this.m_impulse*this.m_J.linearB.y)},d.prototype.GetReactionTorque=function(e){e===undefined&&(e=0);var t=this.m_bodyB.m_xf.R,n=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,r=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,i=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=i;var s=this.m_impulse*this.m_J.linearB.x,o=this.m_impulse*this.m_J.linearB.y;return e*(this.m_impulse*this.m_J.angularB-n*o+r*s)},d.prototype.GetRatio=function(){return this.m_ratio},d.prototype.SetRatio=function(e){e===undefined&&(e=0),this.m_ratio=e},d.prototype.b2GearJoint=function(e){this.__super.b2Joint.call(this,e);var t=parseInt(e.joint1.m_type),n=parseInt(e.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var r=0,i=0;this.m_ground1=e.joint1.GetBodyA(),this.m_bodyA=e.joint1.GetBodyB(),t==g.e_revoluteJoint?(this.m_revolute1=e.joint1 instanceof L?e.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),r=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=e.joint1 instanceof T?e.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),r=this.m_prismatic1.GetJointTranslation()),this.m_ground2=e.joint2.GetBodyA(),this.m_bodyB=e.joint2.GetBodyB(),n==g.e_revoluteJoint?(this.m_revolute2=e.joint2 instanceof L?e.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),i=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=e.joint2 instanceof T?e.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),i=this.m_prismatic2.GetJointTranslation()),this.m_ratio=e.ratio,this.m_constant=r+this.m_ratio*i,this.m_impulse=0},d.prototype.InitVelocityConstraints=function(e){var t=this.m_ground1,n=this.m_ground2,r=this.m_bodyA,i=this.m_bodyB,s=0,o=0,u=0,a=0,f,l,c=0,h=0,p=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,p+=r.m_invI):(f=t.m_xf.R,l=this.m_prismatic1.m_localXAxis1,s=f.col1.x*l.x+f.col2.x*l.y,o=f.col1.y*l.x+f.col2.y*l.y,f=r.m_xf.R,u=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y,h=f.col1.x*u+f.col2.x*a,a=f.col1.y*u+f.col2.y*a,u=h,c=u*o-a*s,this.m_J.linearA.Set(-s,-o),this.m_J.angularA=-c,p+=r.m_invMass+r.m_invI*c*c),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,p+=this.m_ratio*this.m_ratio*i.m_invI):(f=n.m_xf.R,l=this.m_prismatic2.m_localXAxis1,s=f.col1.x*l.x+f.col2.x*l.y,o=f.col1.y*l.x+f.col2.y*l.y,f=i.m_xf.R,u=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y,h=f.col1.x*u+f.col2.x*a,a=f.col1.y*u+f.col2.y*a,u=h,c=u*o-a*s,this.m_J.linearB.Set(-this.m_ratio*s,-this.m_ratio*o),this.m_J.angularB=-this.m_ratio*c,p+=this.m_ratio*this.m_ratio*(i.m_invMass+i.m_invI*c*c)),this.m_mass=p>0?1/p:0,e.warmStarting?(r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linearA.x,r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linearA.y,r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*this.m_impulse*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*this.m_impulse*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},d.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyA,n=this.m_bodyB,r=this.m_J.Compute(t.m_linearVelocity,t.m_angularVelocity,n.m_linearVelocity,n.m_angularVelocity),i=-this.m_mass*r;this.m_impulse+=i,t.m_linearVelocity.x+=t.m_invMass*i*this.m_J.linearA.x,t.m_linearVelocity.y+=t.m_invMass*i*this.m_J.linearA.y,t.m_angularVelocity+=t.m_invI*i*this.m_J.angularA,n.m_linearVelocity.x+=n.m_invMass*i*this.m_J.linearB.x,n.m_linearVelocity.y+=n.m_invMass*i*this.m_J.linearB.y,n.m_angularVelocity+=n.m_invI*i*this.m_J.angularB},d.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=0,r=this.m_bodyA,i=this.m_bodyB,s=0,o=0;this.m_revolute1?s=this.m_revolute1.GetJointAngle():s=this.m_prismatic1.GetJointTranslation(),this.m_revolute2?o=this.m_revolute2.GetJointAngle():o=this.m_prismatic2.GetJointTranslation();var u=this.m_constant-(s+this.m_ratio*o),a=-this.m_mass*u;return r.m_sweep.c.x+=r.m_invMass*a*this.m_J.linearA.x,r.m_sweep.c.y+=r.m_invMass*a*this.m_J.linearA.y,r.m_sweep.a+=r.m_invI*a*this.m_J.angularA,i.m_sweep.c.x+=i.m_invMass*a*this.m_J.linearB.x,i.m_sweep.c.y+=i.m_invMass*a*this.m_J.linearB.y,i.m_sweep.a+=i.m_invI*a*this.m_J.angularB,r.SynchronizeTransform(),i.SynchronizeTransform(),t<n.b2_linearSlop},Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef),v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,v.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},v.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},m.b2Jacobian=function(){this.linearA=new a,this.linearB=new a},m.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},m.prototype.Set=function(e,t,n,r){t===undefined&&(t=0),r===undefined&&(r=0),this.linearA.SetV(e),this.angularA=t,this.linearB.SetV(n),this.angularB=r},m.prototype.Compute=function(e,t,n,r){return t===undefined&&(t=0),r===undefined&&(r=0),this.linearA.x*e.x+this.linearA.y*e.y+this.angularA*t+(this.linearB.x*n.x+this.linearB.y*n.y)+this.angularB*r},g.b2Joint=function(){this.m_edgeA=new b,this.m_edgeB=new b,this.m_localCenterA=new a,this.m_localCenterB=new a},g.prototype.GetType=function(){return this.m_type},g.prototype.GetAnchorA=function(){return null},g.prototype.GetAnchorB=function(){return null},g.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),null},g.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),0},g.prototype.GetBodyA=function(){return this.m_bodyA},g.prototype.GetBodyB=function(){return this.m_bodyB},g.prototype.GetNext=function(){return this.m_next},g.prototype.GetUserData=function(){return this.m_userData},g.prototype.SetUserData=function(e){this.m_userData=e},g.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},g.Create=function(e,t){var n=null;switch(e.type){case g.e_distanceJoint:n=new l(e instanceof c?e:null);break;case g.e_mouseJoint:n=new S(e instanceof x?e:null);break;case g.e_prismaticJoint:n=new T(e instanceof N?e:null);break;case g.e_revoluteJoint:n=new L(e instanceof A?e:null);break;case g.e_pulleyJoint:n=new C(e instanceof k?e:null);break;case g.e_gearJoint:n=new d(e instanceof v?e:null);break;case g.e_lineJoint:n=new w(e instanceof E?e:null);break;case g.e_weldJoint:n=new O(e instanceof M?e:null);break;case g.e_frictionJoint:n=new h(e instanceof p?e:null);break;default:}return n},g.Destroy=function(e,t){},g.prototype.b2Joint=function(e){n.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},g.prototype.InitVelocityConstraints=function(e){},g.prototype.SolveVelocityConstraints=function(e){},g.prototype.FinalizeVelocityConstraints=function(){},g.prototype.SolvePositionConstraints=function(e){return e===undefined&&(e=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),y.b2JointDef=function(){},y.prototype.b2JointDef=function(){this.type=g.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},b.b2JointEdge=function(){},Box2D.inherit(w,Box2D.Dynamics.Joints.b2Joint),w.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,w.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_localXAxis1=new a,this.m_localYAxis1=new a,this.m_axis=new a,this.m_perp=new a,this.m_K=new r,this.m_impulse=new a},w.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},w.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},w.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),e*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},w.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),e*this.m_impulse.y},w.prototype.GetJointTranslation=function(){var e=this.m_bodyA,t=this.m_bodyB,n,r=e.GetWorldPoint(this.m_localAnchor1),i=t.GetWorldPoint(this.m_localAnchor2),s=i.x-r.x,o=i.y-r.y,u=e.GetWorldVector(this.m_localXAxis1),a=u.x*s+u.y*o;return a},w.prototype.GetJointSpeed=function(){var e=this.m_bodyA,t=this.m_bodyB,n;n=e.m_xf.R;var r=this.m_localAnchor1.x-e.m_sweep.localCenter.x,i=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=n.col1.x*r+n.col2.x*i;i=n.col1.y*r+n.col2.y*i,r=s,n=t.m_xf.R;var o=this.m_localAnchor2.x-t.m_sweep.localCenter.x,u=this.m_localAnchor2.y-t.m_sweep.localCenter.y;s=n.col1.x*o+n.col2.x*u,u=n.col1.y*o+n.col2.y*u,o=s;var a=e.m_sweep.c.x+r,f=e.m_sweep.c.y+i,l=t.m_sweep.c.x+o,c=t.m_sweep.c.y+u,h=l-a,p=c-f,d=e.GetWorldVector(this.m_localXAxis1),v=e.m_linearVelocity,m=t.m_linearVelocity,g=e.m_angularVelocity,y=t.m_angularVelocity,b=h*-g*d.y+p*g*d.x+(d.x*(m.x+ -y*u-v.x- -g*i)+d.y*(m.y+y*o-v.y-g*r));return b},w.prototype.IsLimitEnabled=function(){return this.m_enableLimit},w.prototype.EnableLimit=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e},w.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},w.prototype.GetUpperLimit=function(){return this.m_upperTranslation},w.prototype.SetLimits=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=t},w.prototype.IsMotorEnabled=function(){return this.m_enableMotor},w.prototype.EnableMotor=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e},w.prototype.SetMotorSpeed=function(e){e===undefined&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e},w.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},w.prototype.SetMaxMotorForce=function(e){e===undefined&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=e},w.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},w.prototype.GetMotorForce=function(){return this.m_motorImpulse},w.prototype.b2LineJoint=function(e){this.__super.b2Joint.call(this,e);var t,n=0,r=0;this.m_localAnchor1.SetV(e.localAnchorA),this.m_localAnchor2.SetV(e.localAnchorB),this.m_localXAxis1.SetV(e.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=e.lowerTranslation,this.m_upperTranslation=e.upperTranslation,this.m_maxMotorForce=e.maxMotorForce,this.m_motorSpeed=e.motorSpeed,this.m_enableLimit=e.enableLimit,this.m_enableMotor=e.enableMotor,this.m_limitState=g.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},w.prototype.InitVelocityConstraints=function(e){var t=this.m_bodyA,r=this.m_bodyB,i,o=0;this.m_localCenterA.SetV(t.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var u=t.GetTransform(),a=r.GetTransform();i=t.m_xf.R;var f=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y;o=i.col1.x*f+i.col2.x*l,l=i.col1.y*f+i.col2.y*l,f=o,i=r.m_xf.R;var c=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;o=i.col1.x*c+i.col2.x*h,h=i.col1.y*c+i.col2.y*h,c=o;var p=r.m_sweep.c.x+c-t.m_sweep.c.x-f,d=r.m_sweep.c.y+h-t.m_sweep.c.y-l;this.m_invMassA=t.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=t.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(s.MulMV(u.R,this.m_localXAxis1)),this.m_a1=(p+f)*this.m_axis.y-(d+l)*this.m_axis.x,this.m_a2=c*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(s.MulMV(u.R,this.m_localYAxis1)),this.m_s1=(p+f)*this.m_perp.y-(d+l)*this.m_perp.x,this.m_s2=c*this.m_perp.y-h*this.m_perp.x;var v=this.m_invMassA,m=this.m_invMassB,y=this.m_invIA,b=this.m_invIB;this.m_K.col1.x=v+m+y*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1*this.m_a1+b*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=v+m+y*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2;if(this.m_enableLimit){var w=this.m_axis.x*p+this.m_axis.y*d;s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.b2_linearSlop?this.m_limitState=g.e_equalLimits:w<=this.m_lowerTranslation?this.m_limitState!=g.e_atLowerLimit&&(this.m_limitState=g.e_atLowerLimit,this.m_impulse.y=0):w>=this.m_upperTranslation?this.m_limitState!=g.e_atUpperLimit&&(this.m_limitState=g.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=g.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=g.e_inactiveLimit;this.m_enableMotor==0&&(this.m_motorImpulse=0);if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var E=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,S=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,x=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,T=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;t.m_linearVelocity.x-=this.m_invMassA*E,t.m_linearVelocity.y-=this.m_invMassA*S,t.m_angularVelocity-=this.m_invIA*x,r.m_linearVelocity.x+=this.m_invMassB*E,r.m_linearVelocity.y+=this.m_invMassB*S,r.m_angularVelocity+=this.m_invIB*T}else this.m_impulse.SetZero(),this.m_motorImpulse=0},w.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyA,n=this.m_bodyB,r=t.m_linearVelocity,i=t.m_angularVelocity,o=n.m_linearVelocity,u=n.m_angularVelocity,f=0,l=0,c=0,h=0;if(this.m_enableMotor&&this.m_limitState!=g.e_equalLimits){var p=this.m_axis.x*(o.x-r.x)+this.m_axis.y*(o.y-r.y)+this.m_a2*u-this.m_a1*i,d=this.m_motorMass*(this.m_motorSpeed-p),v=this.m_motorImpulse,m=e.dt*this.m_maxMotorForce;this.m_motorImpulse=s.Clamp(this.m_motorImpulse+d,-m,m),d=this.m_motorImpulse-v,f=d*this.m_axis.x,l=d*this.m_axis.y,c=d*this.m_a1,h=d*this.m_a2,r.x-=this.m_invMassA*f,r.y-=this.m_invMassA*l,i-=this.m_invIA*c,o.x+=this.m_invMassB*f,o.y+=this.m_invMassB*l,u+=this.m_invIB*h}var y=this.m_perp.x*(o.x-r.x)+this.m_perp.y*(o.y-r.y)+this.m_s2*u-this.m_s1*i;if(this.m_enableLimit&&this.m_limitState!=g.e_inactiveLimit){var b=this.m_axis.x*(o.x-r.x)+this.m_axis.y*(o.y-r.y)+this.m_a2*u-this.m_a1*i,w=this.m_impulse.Copy(),E=this.m_K.Solve(new a,-y,-b);this.m_impulse.Add(E),this.m_limitState==g.e_atLowerLimit?this.m_impulse.y=s.Max(this.m_impulse.y,0):this.m_limitState==g.e_atUpperLimit&&(this.m_impulse.y=s.Min(this.m_impulse.y,0));var S=-y-(this.m_impulse.y-w.y)*this.m_K.col2.x,x=0;this.m_K.col1.x!=0?x=S/this.m_K.col1.x+w.x:x=w.x,this.m_impulse.x=x,E.x=this.m_impulse.x-w.x,E.y=this.m_impulse.y-w.y,f=E.x*this.m_perp.x+E.y*this.m_axis.x,l=E.x*this.m_perp.y+E.y*this.m_axis.y,c=E.x*this.m_s1+E.y*this.m_a1,h=E.x*this.m_s2+E.y*this.m_a2,r.x-=this.m_invMassA*f,r.y-=this.m_invMassA*l,i-=this.m_invIA*c,o.x+=this.m_invMassB*f,o.y+=this.m_invMassB*l,u+=this.m_invIB*h}else{var T=0;this.m_K.col1.x!=0?T=-y/this.m_K.col1.x:T=0,this.m_impulse.x+=T,f=T*this.m_perp.x,l=T*this.m_perp.y,c=T*this.m_s1,h=T*this.m_s2,r.x-=this.m_invMassA*f,r.y-=this.m_invMassA*l,i-=this.m_invIA*c,o.x+=this.m_invMassB*f,o.y+=this.m_invMassB*l,u+=this.m_invIB*h}t.m_linearVelocity.SetV(r),t.m_angularVelocity=i,n.m_linearVelocity.SetV(o),n.m_angularVelocity=u},w.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=0,i=0,o=this.m_bodyA,u=this.m_bodyB,f=o.m_sweep.c,l=o.m_sweep.a,c=u.m_sweep.c,h=u.m_sweep.a,p,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E=!1,S=0,x=r.FromAngle(l),T=r.FromAngle(h);p=x;var N=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y;d=p.col1.x*N+p.col2.x*C,C=p.col1.y*N+p.col2.y*C,N=d,p=T;var k=this.m_localAnchor2.x-this.m_localCenterB.x,L=this.m_localAnchor2.y-this.m_localCenterB.y;d=p.col1.x*k+p.col2.x*L,L=p.col1.y*k+p.col2.y*L,k=d;var A=c.x+k-f.x-N,O=c.y+L-f.y-C;if(this.m_enableLimit){this.m_axis=s.MulMV(x,this.m_localXAxis1),this.m_a1=(A+N)*this.m_axis.y-(O+C)*this.m_axis.x,this.m_a2=k*this.m_axis.y-L*this.m_axis.x;var M=this.m_axis.x*A+this.m_axis.y*O;s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.b2_linearSlop?(S=s.Clamp(M,-n.b2_maxLinearCorrection,n.b2_maxLinearCorrection),b=s.Abs(M),E=!0):M<=this.m_lowerTranslation?(S=s.Clamp(M-this.m_lowerTranslation+n.b2_linearSlop,-n.b2_maxLinearCorrection,0),b=this.m_lowerTranslation-M,E=!0):M>=this.m_upperTranslation&&(S=s.Clamp(M-this.m_upperTranslation+n.b2_linearSlop,0,n.b2_maxLinearCorrection),b=M-this.m_upperTranslation,E=!0)}this.m_perp=s.MulMV(x,this.m_localYAxis1),this.m_s1=(A+N)*this.m_perp.y-(O+C)*this.m_perp.x,this.m_s2=k*this.m_perp.y-L*this.m_perp.x;var _=new a,D=this.m_perp.x*A+this.m_perp.y*O;b=s.Max(b,s.Abs(D)),w=0;if(E)v=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,y=this.m_invIB,this.m_K.col1.x=v+m+g*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=v+m+g*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_K.Solve(_,-D,-S);else{v=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,y=this.m_invIB;var P=v+m+g*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,H=0;P!=0?H=-D/P:H=0,_.x=H,_.y=0}var B=_.x*this.m_perp.x+_.y*this.m_axis.x,j=_.x*this.m_perp.y+_.y*this.m_axis.y,F=_.x*this.m_s1+_.y*this.m_a1,I=_.x*this.m_s2+_.y*this.m_a2;return f.x-=this.m_invMassA*B,f.y-=this.m_invMassA*j,l-=this.m_invIA*F,c.x+=this.m_invMassB*B,c.y+=this.m_invMassB*j,h+=this.m_invIB*I,o.m_sweep.a=l,u.m_sweep.a=h,o.SynchronizeTransform(),u.SynchronizeTransform(),b<=n.b2_linearSlop&&w<=n.b2_angularSlop},Box2D.inherit(E,Box2D.Dynamics.Joints.b2JointDef),E.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,E.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a,this.localAxisA=new a},E.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},E.prototype.Initialize=function(e,t,n,r){this.bodyA=e,this.bodyB=t,this.localAnchorA=this.bodyA.GetLocalPoint(n),this.localAnchorB=this.bodyB.GetLocalPoint(n),this.localAxisA=this.bodyA.GetLocalVector(r)},Box2D.inherit(S,Box2D.Dynamics.Joints.b2Joint),S.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,S.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new r,this.K1=new r,this.K2=new r,this.m_localAnchor=new a,this.m_target=new a,this.m_impulse=new a,this.m_mass=new r,this.m_C=new a},S.prototype.GetAnchorA=function(){return this.m_target},S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},S.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse.x,e*this.m_impulse.y)},S.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),0},S.prototype.GetTarget=function(){return this.m_target},S.prototype.SetTarget=function(e){this.m_bodyB.IsAwake()==0&&this.m_bodyB.SetAwake(!0),this.m_target=e},S.prototype.GetMaxForce=function(){return this.m_maxForce},S.prototype.SetMaxForce=function(e){e===undefined&&(e=0),this.m_maxForce=e},S.prototype.GetFrequency=function(){return this.m_frequencyHz},S.prototype.SetFrequency=function(e){e===undefined&&(e=0),this.m_frequencyHz=e},S.prototype.GetDampingRatio=function(){return this.m_dampingRatio},S.prototype.SetDampingRatio=function(e){e===undefined&&(e=0),this.m_dampingRatio=e},S.prototype.b2MouseJoint=function(e){this.__super.b2Joint.call(this,e),this.m_target.SetV(e.target);var t=this.m_target.x-this.m_bodyB.m_xf.position.x,n=this.m_target.y-this.m_bodyB.m_xf.position.y,r=this.m_bodyB.m_xf.R;this.m_localAnchor.x=t*r.col1.x+n*r.col1.y,this.m_localAnchor.y=t*r.col2.x+n*r.col2.y,this.m_maxForce=e.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_beta=0,this.m_gamma=0},S.prototype.InitVelocityConstraints=function(e){var t=this.m_bodyB,n=t.GetMass(),r=2*Math.PI*this.m_frequencyHz,i=2*n*this.m_dampingRatio*r,s=n*r*r;this.m_gamma=e.dt*(i+e.dt*s),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_beta=e.dt*s*this.m_gamma;var o;o=t.m_xf.R;var u=this.m_localAnchor.x-t.m_sweep.localCenter.x,a=this.m_localAnchor.y-t.m_sweep.localCenter.y,f=o.col1.x*u+o.col2.x*a;a=o.col1.y*u+o.col2.y*a,u=f;var l=t.m_invMass,c=t.m_invI;this.K1.col1.x=l,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=l,this.K2.col1.x=c*a*a,this.K2.col2.x=-c*u*a,this.K2.col1.y=-c*u*a,this.K2.col2.y=c*u*u,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=t.m_sweep.c.x+u-this.m_target.x,this.m_C.y=t.m_sweep.c.y+a-this.m_target.y,t.m_angularVelocity*=.98,this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,t.m_linearVelocity.x+=l*this.m_impulse.x,t.m_linearVelocity.y+=l*this.m_impulse.y,t.m_angularVelocity+=c*(u*this.m_impulse.y-a*this.m_impulse.x)},S.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyB,n,r=0,i=0;n=t.m_xf.R;var s=this.m_localAnchor.x-t.m_sweep.localCenter.x,o=this.m_localAnchor.y-t.m_sweep.localCenter.y;r=n.col1.x*s+n.col2.x*o,o=n.col1.y*s+n.col2.y*o,s=r;var u=t.m_linearVelocity.x+ -t.m_angularVelocity*o,a=t.m_linearVelocity.y+t.m_angularVelocity*s;n=this.m_mass,r=u+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,i=a+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var f=-(n.col1.x*r+n.col2.x*i),l=-(n.col1.y*r+n.col2.y*i),c=this.m_impulse.x,h=this.m_impulse.y;this.m_impulse.x+=f,this.m_impulse.y+=l;var p=e.dt*this.m_maxForce;this.m_impulse.LengthSquared()>p*p&&this.m_impulse.Multiply(p/this.m_impulse.Length()),f=this.m_impulse.x-c,l=this.m_impulse.y-h,t.m_linearVelocity.x+=t.m_invMass*f,t.m_linearVelocity.y+=t.m_invMass*l,t.m_angularVelocity+=t.m_invI*(s*l-o*f)},S.prototype.SolvePositionConstraints=function(e){return e===undefined&&(e=0),!0},Box2D.inherit(x,Box2D.Dynamics.Joints.b2JointDef),x.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,x.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new a},x.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(T,Box2D.Dynamics.Joints.b2Joint),T.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,T.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_localXAxis1=new a,this.m_localYAxis1=new a,this.m_axis=new a,this.m_perp=new a,this.m_K=new i,this.m_impulse=new f},T.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},T.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},T.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),e*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},T.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),e*this.m_impulse.y},T.prototype.GetJointTranslation=function(){var e=this.m_bodyA,t=this.m_bodyB,n,r=e.GetWorldPoint(this.m_localAnchor1),i=t.GetWorldPoint(this.m_localAnchor2),s=i.x-r.x,o=i.y-r.y,u=e.GetWorldVector(this.m_localXAxis1),a=u.x*s+u.y*o;return a},T.prototype.GetJointSpeed=function(){var e=this.m_bodyA,t=this.m_bodyB,n;n=e.m_xf.R;var r=this.m_localAnchor1.x-e.m_sweep.localCenter.x,i=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=n.col1.x*r+n.col2.x*i;i=n.col1.y*r+n.col2.y*i,r=s,n=t.m_xf.R;var o=this.m_localAnchor2.x-t.m_sweep.localCenter.x,u=this.m_localAnchor2.y-t.m_sweep.localCenter.y;s=n.col1.x*o+n.col2.x*u,u=n.col1.y*o+n.col2.y*u,o=s;var a=e.m_sweep.c.x+r,f=e.m_sweep.c.y+i,l=t.m_sweep.c.x+o,c=t.m_sweep.c.y+u,h=l-a,p=c-f,d=e.GetWorldVector(this.m_localXAxis1),v=e.m_linearVelocity,m=t.m_linearVelocity,g=e.m_angularVelocity,y=t.m_angularVelocity,b=h*-g*d.y+p*g*d.x+(d.x*(m.x+ -y*u-v.x- -g*i)+d.y*(m.y+y*o-v.y-g*r));return b},T.prototype.IsLimitEnabled=function(){return this.m_enableLimit},T.prototype.EnableLimit=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e},T.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},T.prototype.GetUpperLimit=function(){return this.m_upperTranslation},T.prototype.SetLimits=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=t},T.prototype.IsMotorEnabled=function(){return this.m_enableMotor},T.prototype.EnableMotor=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e},T.prototype.SetMotorSpeed=function(e){e===undefined&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e},T.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},T.prototype.SetMaxMotorForce=function(e){e===undefined&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=e},T.prototype.GetMotorForce=function(){return this.m_motorImpulse},T.prototype.b2PrismaticJoint=function(e){this.__super.b2Joint.call(this,e);var t,n=0,r=0;this.m_localAnchor1.SetV(e.localAnchorA),this.m_localAnchor2.SetV(e.localAnchorB),this.m_localXAxis1.SetV(e.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=e.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=e.lowerTranslation,this.m_upperTranslation=e.upperTranslation,this.m_maxMotorForce=e.maxMotorForce,this.m_motorSpeed=e.motorSpeed,this.m_enableLimit=e.enableLimit,this.m_enableMotor=e.enableMotor,this.m_limitState=g.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},T.prototype.InitVelocityConstraints=function(e){var t=this.m_bodyA,r=this.m_bodyB,i,o=0;this.m_localCenterA.SetV(t.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var u=t.GetTransform(),a=r.GetTransform();i=t.m_xf.R;var f=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y;o=i.col1.x*f+i.col2.x*l,l=i.col1.y*f+i.col2.y*l,f=o,i=r.m_xf.R;var c=this.m_localAnchor2.x-this.m_localCenterB.x,h=this.m_localAnchor2.y-this.m_localCenterB.y;o=i.col1.x*c+i.col2.x*h,h=i.col1.y*c+i.col2.y*h,c=o;var p=r.m_sweep.c.x+c-t.m_sweep.c.x-f,d=r.m_sweep.c.y+h-t.m_sweep.c.y-l;this.m_invMassA=t.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=t.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(s.MulMV(u.R,this.m_localXAxis1)),this.m_a1=(p+f)*this.m_axis.y-(d+l)*this.m_axis.x,this.m_a2=c*this.m_axis.y-h*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(s.MulMV(u.R,this.m_localYAxis1)),this.m_s1=(p+f)*this.m_perp.y-(d+l)*this.m_perp.x,this.m_s2=c*this.m_perp.y-h*this.m_perp.x;var v=this.m_invMassA,m=this.m_invMassB,y=this.m_invIA,b=this.m_invIB;this.m_K.col1.x=v+m+y*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1+b*this.m_s2,this.m_K.col1.z=y*this.m_s1*this.m_a1+b*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=y+b,this.m_K.col2.z=y*this.m_a1+b*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=v+m+y*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2;if(this.m_enableLimit){var w=this.m_axis.x*p+this.m_axis.y*d;s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.b2_linearSlop?this.m_limitState=g.e_equalLimits:w<=this.m_lowerTranslation?this.m_limitState!=g.e_atLowerLimit&&(this.m_limitState=g.e_atLowerLimit,this.m_impulse.z=0):w>=this.m_upperTranslation?this.m_limitState!=g.e_atUpperLimit&&(this.m_limitState=g.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=g.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=g.e_inactiveLimit;this.m_enableMotor==0&&(this.m_motorImpulse=0);if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var E=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,S=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,x=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,T=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;t.m_linearVelocity.x-=this.m_invMassA*E,t.m_linearVelocity.y-=this.m_invMassA*S,t.m_angularVelocity-=this.m_invIA*x,r.m_linearVelocity.x+=this.m_invMassB*E,r.m_linearVelocity.y+=this.m_invMassB*S,r.m_angularVelocity+=this.m_invIB*T}else this.m_impulse.SetZero(),this.m_motorImpulse=0},T.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyA,n=this.m_bodyB,r=t.m_linearVelocity,i=t.m_angularVelocity,o=n.m_linearVelocity,u=n.m_angularVelocity,l=0,c=0,h=0,p=0;if(this.m_enableMotor&&this.m_limitState!=g.e_equalLimits){var d=this.m_axis.x*(o.x-r.x)+this.m_axis.y*(o.y-r.y)+this.m_a2*u-this.m_a1*i,v=this.m_motorMass*(this.m_motorSpeed-d),m=this.m_motorImpulse,y=e.dt*this.m_maxMotorForce;this.m_motorImpulse=s.Clamp(this.m_motorImpulse+v,-y,y),v=this.m_motorImpulse-m,l=v*this.m_axis.x,c=v*this.m_axis.y,h=v*this.m_a1,p=v*this.m_a2,r.x-=this.m_invMassA*l,r.y-=this.m_invMassA*c,i-=this.m_invIA*h,o.x+=this.m_invMassB*l,o.y+=this.m_invMassB*c,u+=this.m_invIB*p}var b=this.m_perp.x*(o.x-r.x)+this.m_perp.y*(o.y-r.y)+this.m_s2*u-this.m_s1*i,w=u-i;if(this.m_enableLimit&&this.m_limitState!=g.e_inactiveLimit){var E=this.m_axis.x*(o.x-r.x)+this.m_axis.y*(o.y-r.y)+this.m_a2*u-this.m_a1*i,S=this.m_impulse.Copy(),x=this.m_K.Solve33(new f,-b,-w,-E);this.m_impulse.Add(x),this.m_limitState==g.e_atLowerLimit?this.m_impulse.z=s.Max(this.m_impulse.z,0):this.m_limitState==g.e_atUpperLimit&&(this.m_impulse.z=s.Min(this.m_impulse.z,0));var T=-b-(this.m_impulse.z-S.z)*this.m_K.col3.x,N=-w-(this.m_impulse.z-S.z)*this.m_K.col3.y,C=this.m_K.Solve22(new a,T,N);C.x+=S.x,C.y+=S.y,this.m_impulse.x=C.x,this.m_impulse.y=C.y,x.x=this.m_impulse.x-S.x,x.y=this.m_impulse.y-S.y,x.z=this.m_impulse.z-S.z,l=x.x*this.m_perp.x+x.z*this.m_axis.x,c=x.x*this.m_perp.y+x.z*this.m_axis.y,h=x.x*this.m_s1+x.y+x.z*this.m_a1,p=x.x*this.m_s2+x.y+x.z*this.m_a2,r.x-=this.m_invMassA*l,r.y-=this.m_invMassA*c,i-=this.m_invIA*h,o.x+=this.m_invMassB*l,o.y+=this.m_invMassB*c,u+=this.m_invIB*p}else{var k=this.m_K.Solve22(new a,-b,-w);this.m_impulse.x+=k.x,this.m_impulse.y+=k.y,l=k.x*this.m_perp.x,c=k.x*this.m_perp.y,h=k.x*this.m_s1+k.y,p=k.x*this.m_s2+k.y,r.x-=this.m_invMassA*l,r.y-=this.m_invMassA*c,i-=this.m_invIA*h,o.x+=this.m_invMassB*l,o.y+=this.m_invMassB*c,u+=this.m_invIB*p}t.m_linearVelocity.SetV(r),t.m_angularVelocity=i,n.m_linearVelocity.SetV(o),n.m_angularVelocity=u},T.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=0,i=0,o=this.m_bodyA,u=this.m_bodyB,l=o.m_sweep.c,c=o.m_sweep.a,h=u.m_sweep.c,p=u.m_sweep.a,d,v=0,m=0,g=0,y=0,b=0,w=0,E=0,S=!1,x=0,T=r.FromAngle(c),N=r.FromAngle(p);d=T;var C=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y;v=d.col1.x*C+d.col2.x*k,k=d.col1.y*C+d.col2.y*k,C=v,d=N;var L=this.m_localAnchor2.x-this.m_localCenterB.x,A=this.m_localAnchor2.y-this.m_localCenterB.y;v=d.col1.x*L+d.col2.x*A,A=d.col1.y*L+d.col2.y*A,L=v;var O=h.x+L-l.x-C,M=h.y+A-l.y-k;if(this.m_enableLimit){this.m_axis=s.MulMV(T,this.m_localXAxis1),this.m_a1=(O+C)*this.m_axis.y-(M+k)*this.m_axis.x,this.m_a2=L*this.m_axis.y-A*this.m_axis.x;var _=this.m_axis.x*O+this.m_axis.y*M;s.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*n.b2_linearSlop?(x=s.Clamp(_,-n.b2_maxLinearCorrection,n.b2_maxLinearCorrection),w=s.Abs(_),S=!0):_<=this.m_lowerTranslation?(x=s.Clamp(_-this.m_lowerTranslation+n.b2_linearSlop,-n.b2_maxLinearCorrection,0),w=this.m_lowerTranslation-_,S=!0):_>=this.m_upperTranslation&&(x=s.Clamp(_-this.m_upperTranslation+n.b2_linearSlop,0,n.b2_maxLinearCorrection),w=_-this.m_upperTranslation,S=!0)}this.m_perp=s.MulMV(T,this.m_localYAxis1),this.m_s1=(O+C)*this.m_perp.y-(M+k)*this.m_perp.x,this.m_s2=L*this.m_perp.y-A*this.m_perp.x;var D=new f,P=this.m_perp.x*O+this.m_perp.y*M,H=p-c-this.m_refAngle;w=s.Max(w,s.Abs(P)),E=s.Abs(H);if(S)m=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,b=this.m_invIB,this.m_K.col1.x=m+g+y*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1+b*this.m_s2,this.m_K.col1.z=y*this.m_s1*this.m_a1+b*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=y+b,this.m_K.col2.z=y*this.m_a1+b*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+g+y*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2,this.m_K.Solve33(D,-P,-H,-x);else{m=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,b=this.m_invIB;var B=m+g+y*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,j=y*this.m_s1+b*this.m_s2,F=y+b;this.m_K.col1.Set(B,j,0),this.m_K.col2.Set(j,F,0);var I=this.m_K.Solve22(new a,-P,-H);D.x=I.x,D.y=I.y,D.z=0}var q=D.x*this.m_perp.x+D.z*this.m_axis.x,R=D.x*this.m_perp.y+D.z*this.m_axis.y,U=D.x*this.m_s1+D.y+D.z*this.m_a1,z=D.x*this.m_s2+D.y+D.z*this.m_a2;return l.x-=this.m_invMassA*q,l.y-=this.m_invMassA*R,c-=this.m_invIA*U,h.x+=this.m_invMassB*q,h.y+=this.m_invMassB*R,p+=this.m_invIB*z,o.m_sweep.a=c,u.m_sweep.a=p,o.SynchronizeTransform(),u.SynchronizeTransform(),w<=n.b2_linearSlop&&E<=n.b2_angularSlop},Box2D.inherit(N,Box2D.Dynamics.Joints.b2JointDef),N.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,N.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a,this.localAxisA=new a},N.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},N.prototype.Initialize=function(e,t,n,r){this.bodyA=e,this.bodyB=t,this.localAnchorA=this.bodyA.GetLocalPoint(n),this.localAnchorB=this.bodyB.GetLocalPoint(n),this.localAxisA=this.bodyA.GetLocalVector(r),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(C,Box2D.Dynamics.Joints.b2Joint),C.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,C.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new a,this.m_groundAnchor2=new a,this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_u1=new a,this.m_u2=new a},C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},C.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse*this.m_u2.x,e*this.m_impulse*this.m_u2.y)},C.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),0},C.prototype.GetGroundAnchorA=function(){var e=this.m_ground.m_xf.position.Copy();return e.Add(this.m_groundAnchor1),e},C.prototype.GetGroundAnchorB=function(){var e=this.m_ground.m_xf.position.Copy();return e.Add(this.m_groundAnchor2),e},C.prototype.GetLength1=function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),t=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,n=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,r=e.x-t,i=e.y-n;return Math.sqrt(r*r+i*i)},C.prototype.GetLength2=function(){var e=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),t=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,n=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,r=e.x-t,i=e.y-n;return Math.sqrt(r*r+i*i)},C.prototype.GetRatio=function(){return this.m_ratio},C.prototype.b2PulleyJoint=function(e){this.__super.b2Joint.call(this,e);var t,n=0,r=0;this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=e.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=e.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=e.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=e.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(e.localAnchorA),this.m_localAnchor2.SetV(e.localAnchorB),this.m_ratio=e.ratio,this.m_constant=e.lengthA+this.m_ratio*e.lengthB,this.m_maxLength1=s.Min(e.maxLengthA,this.m_constant-this.m_ratio*C.b2_minPulleyLength),this.m_maxLength2=s.Min(e.maxLengthB,(this.m_constant-C.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},C.prototype.InitVelocityConstraints=function(e){var t=this.m_bodyA,r=this.m_bodyB,i;i=t.m_xf.R;var s=this.m_localAnchor1.x-t.m_sweep.localCenter.x,o=this.m_localAnchor1.y-t.m_sweep.localCenter.y,u=i.col1.x*s+i.col2.x*o;o=i.col1.y*s+i.col2.y*o,s=u,i=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,f=this.m_localAnchor2.y-r.m_sweep.localCenter.y;u=i.col1.x*a+i.col2.x*f,f=i.col1.y*a+i.col2.y*f,a=u;var l=t.m_sweep.c.x+s,c=t.m_sweep.c.y+o,h=r.m_sweep.c.x+a,p=r.m_sweep.c.y+f,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,v=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,m=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(l-d,c-v),this.m_u2.Set(h-m,p-y);var b=this.m_u1.Length(),w=this.m_u2.Length();b>n.b2_linearSlop?this.m_u1.Multiply(1/b):this.m_u1.SetZero(),w>n.b2_linearSlop?this.m_u2.Multiply(1/w):this.m_u2.SetZero();var E=this.m_constant-b-this.m_ratio*w;E>0?(this.m_state=g.e_inactiveLimit,this.m_impulse=0):this.m_state=g.e_atUpperLimit,b<this.m_maxLength1?(this.m_limitState1=g.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=g.e_atUpperLimit,w<this.m_maxLength2?(this.m_limitState2=g.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=g.e_atUpperLimit;var S=s*this.m_u1.y-o*this.m_u1.x,x=a*this.m_u2.y-f*this.m_u2.x;this.m_limitMass1=t.m_invMass+t.m_invI*S*S,this.m_limitMass2=r.m_invMass+r.m_invI*x*x,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass;if(e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var T=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,N=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,C=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,k=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;t.m_linearVelocity.x+=t.m_invMass*T,t.m_linearVelocity.y+=t.m_invMass*N,t.m_angularVelocity+=t.m_invI*(s*N-o*T),r.m_linearVelocity.x+=r.m_invMass*C,r.m_linearVelocity.y+=r.m_invMass*k,r.m_angularVelocity+=r.m_invI*(a*k-f*C)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},C.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyA,n=this.m_bodyB,r;r=t.m_xf.R;var i=this.m_localAnchor1.x-t.m_sweep.localCenter.x,o=this.m_localAnchor1.y-t.m_sweep.localCenter.y,u=r.col1.x*i+r.col2.x*o;o=r.col1.y*i+r.col2.y*o,i=u,r=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,f=this.m_localAnchor2.y-n.m_sweep.localCenter.y;u=r.col1.x*a+r.col2.x*f,f=r.col1.y*a+r.col2.y*f,a=u;var l=0,c=0,h=0,p=0,d=0,v=0,m=0,y=0,b=0,w=0,E=0;this.m_state==g.e_atUpperLimit&&(l=t.m_linearVelocity.x+ -t.m_angularVelocity*o,c=t.m_linearVelocity.y+t.m_angularVelocity*i,h=n.m_linearVelocity.x+ -n.m_angularVelocity*f,p=n.m_linearVelocity.y+n.m_angularVelocity*a,b=-(this.m_u1.x*l+this.m_u1.y*c)-this.m_ratio*(this.m_u2.x*h+this.m_u2.y*p),w=this.m_pulleyMass*-b,E=this.m_impulse,this.m_impulse=s.Max(0,this.m_impulse+w),w=this.m_impulse-E,d=-w*this.m_u1.x,v=-w*this.m_u1.y,m=-this.m_ratio*w*this.m_u2.x,y=-this.m_ratio*w*this.m_u2.y,t.m_linearVelocity.x+=t.m_invMass*d,t.m_linearVelocity.y+=t.m_invMass*v,t.m_angularVelocity+=t.m_invI*(i*v-o*d),n.m_linearVelocity.x+=n.m_invMass*m,n.m_linearVelocity.y+=n.m_invMass*y,n.m_angularVelocity+=n.m_invI*(a*y-f*m)),this.m_limitState1==g.e_atUpperLimit&&(l=t.m_linearVelocity.x+ -t.m_angularVelocity*o,c=t.m_linearVelocity.y+t.m_angularVelocity*i,b=-(this.m_u1.x*l+this.m_u1.y*c),w=-this.m_limitMass1*b,E=this.m_limitImpulse1,this.m_limitImpulse1=s.Max(0,this.m_limitImpulse1+w),w=this.m_limitImpulse1-E,d=-w*this.m_u1.x,v=-w*this.m_u1.y,t.m_linearVelocity.x+=t.m_invMass*d,t.m_linearVelocity.y+=t.m_invMass*v,t.m_angularVelocity+=t.m_invI*(i*v-o*d)),this.m_limitState2==g.e_atUpperLimit&&(h=n.m_linearVelocity.x+ -n.m_angularVelocity*f,p=n.m_linearVelocity.y+n.m_angularVelocity*a,b=-(this.m_u2.x*h+this.m_u2.y*p),w=-this.m_limitMass2*b,E=this.m_limitImpulse2,this.m_limitImpulse2=s.Max(0,this.m_limitImpulse2+w),w=this.m_limitImpulse2-E,m=-w*this.m_u2.x,y=-w*this.m_u2.y,n.m_linearVelocity.x+=n.m_invMass*m,n.m_linearVelocity.y+=n.m_invMass*y,n.m_angularVelocity+=n.m_invI*(a*y-f*m))},C.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=this.m_bodyA,r=this.m_bodyB,i,o=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,u=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,a=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,f=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,l=0,c=0,h=0,p=0,d=0,v=0,m=0,y=0,b=0,w=0,E=0,S=0,x=0,T=0,N=0,C=0;return this.m_state==g.e_atUpperLimit&&(i=t.m_xf.R,l=this.m_localAnchor1.x-t.m_sweep.localCenter.x,c=this.m_localAnchor1.y-t.m_sweep.localCenter.y,N=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=N,i=r.m_xf.R,h=this.m_localAnchor2.x-r.m_sweep.localCenter.x,p=this.m_localAnchor2.y-r.m_sweep.localCenter.y,N=i.col1.x*h+i.col2.x*p,p=i.col1.y*h+i.col2.y*p,h=N,d=t.m_sweep.c.x+l,v=t.m_sweep.c.y+c,m=r.m_sweep.c.x+h,y=r.m_sweep.c.y+p,this.m_u1.Set(d-o,v-u),this.m_u2.Set(m-a,y-f),b=this.m_u1.Length(),w=this.m_u2.Length(),b>n.b2_linearSlop?this.m_u1.Multiply(1/b):this.m_u1.SetZero(),w>n.b2_linearSlop?this.m_u2.Multiply(1/w):this.m_u2.SetZero(),E=this.m_constant-b-this.m_ratio*w,C=s.Max(C,-E),E=s.Clamp(E+n.b2_linearSlop,-n.b2_maxLinearCorrection,0),S=-this.m_pulleyMass*E,d=-S*this.m_u1.x,v=-S*this.m_u1.y,m=-this.m_ratio*S*this.m_u2.x,y=-this.m_ratio*S*this.m_u2.y,t.m_sweep.c.x+=t.m_invMass*d,t.m_sweep.c.y+=t.m_invMass*v,t.m_sweep.a+=t.m_invI*(l*v-c*d),r.m_sweep.c.x+=r.m_invMass*m,r.m_sweep.c.y+=r.m_invMass*y,r.m_sweep.a+=r.m_invI*(h*y-p*m),t.SynchronizeTransform(),r.SynchronizeTransform()),this.m_limitState1==g.e_atUpperLimit&&(i=t.m_xf.R,l=this.m_localAnchor1.x-t.m_sweep.localCenter.x,c=this.m_localAnchor1.y-t.m_sweep.localCenter.y,N=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=N,d=t.m_sweep.c.x+l,v=t.m_sweep.c.y+c,this.m_u1.Set(d-o,v-u),b=this.m_u1.Length(),b>n.b2_linearSlop?(this.m_u1.x*=1/b,this.m_u1.y*=1/b):this.m_u1.SetZero(),E=this.m_maxLength1-b,C=s.Max(C,-E),E=s.Clamp(E+n.b2_linearSlop,-n.b2_maxLinearCorrection,0),S=-this.m_limitMass1*E,d=-S*this.m_u1.x,v=-S*this.m_u1.y,t.m_sweep.c.x+=t.m_invMass*d,t.m_sweep.c.y+=t.m_invMass*v,t.m_sweep.a+=t.m_invI*(l*v-c*d),t.SynchronizeTransform()),this.m_limitState2==g.e_atUpperLimit&&(i=r.m_xf.R,h=this.m_localAnchor2.x-r.m_sweep.localCenter.x,p=this.m_localAnchor2.y-r.m_sweep.localCenter.y,N=i.col1.x*h+i.col2.x*p,p=i.col1.y*h+i.col2.y*p,h=N,m=r.m_sweep.c.x+h,y=r.m_sweep.c.y+p,this.m_u2.Set(m-a,y-f),w=this.m_u2.Length(),w>n.b2_linearSlop?(this.m_u2.x*=1/w,this.m_u2.y*=1/w):this.m_u2.SetZero(),E=this.m_maxLength2-w,C=s.Max(C,-E),E=s.Clamp(E+n.b2_linearSlop,-n.b2_maxLinearCorrection,0),S=-this.m_limitMass2*E,m=-S*this.m_u2.x,y=-S*this.m_u2.y,r.m_sweep.c.x+=r.m_invMass*m,r.m_sweep.c.y+=r.m_invMass*y,r.m_sweep.a+=r.m_invI*(h*y-p*m),r.SynchronizeTransform()),C<n.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(k,Box2D.Dynamics.Joints.b2JointDef),k.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,k.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new a,this.groundAnchorB=new a,this.localAnchorA=new a,this.localAnchorB=new a},k.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},k.prototype.Initialize=function(e,t,n,r,i,s,o){o===undefined&&(o=0),this.bodyA=e,this.bodyB=t,this.groundAnchorA.SetV(n),this.groundAnchorB.SetV(r),this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(s);var u=i.x-n.x,a=i.y-n.y;this.lengthA=Math.sqrt(u*u+a*a);var f=s.x-r.x,l=s.y-r.y;this.lengthB=Math.sqrt(f*f+l*l),this.ratio=o;var c=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=c-this.ratio*C.b2_minPulleyLength,this.maxLengthB=(c-C.b2_minPulleyLength)/this.ratio},Box2D.inherit(L,Box2D.Dynamics.Joints.b2Joint),L.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,L.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new r,this.K1=new r,this.K2=new r,this.K3=new r,this.impulse3=new f,this.impulse2=new a,this.reduced=new a,this.m_localAnchor1=new a,this.m_localAnchor2=new a,this.m_impulse=new f,this.m_mass=new i},L.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},L.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},L.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse.x,e*this.m_impulse.y)},L.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),e*this.m_impulse.z},L.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},L.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},L.prototype.IsLimitEnabled=function(){return this.m_enableLimit},L.prototype.EnableLimit=function(e){this.m_enableLimit=e},L.prototype.GetLowerLimit=function(){return this.m_lowerAngle},L.prototype.GetUpperLimit=function(){return this.m_upperAngle},L.prototype.SetLimits=function(e,t){e===undefined&&(e=0),t===undefined&&(t=0),this.m_lowerAngle=e,this.m_upperAngle=t},L.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},L.prototype.EnableMotor=function(e){this.m_enableMotor=e},L.prototype.SetMotorSpeed=function(e){e===undefined&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e},L.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},L.prototype.SetMaxMotorTorque=function(e){e===undefined&&(e=0),this.m_maxMotorTorque=e},L.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},L.prototype.b2RevoluteJoint=function(e){this.__super.b2Joint.call(this,e),this.m_localAnchor1.SetV(e.localAnchorA),this.m_localAnchor2.SetV(e.localAnchorB),this.m_referenceAngle=e.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=e.lowerAngle,this.m_upperAngle=e.upperAngle,this.m_maxMotorTorque=e.maxMotorTorque,this.m_motorSpeed=e.motorSpeed,this.m_enableLimit=e.enableLimit,this.m_enableMotor=e.enableMotor,this.m_limitState=g.e_inactiveLimit},L.prototype.InitVelocityConstraints=function(e){var t=this.m_bodyA,r=this.m_bodyB,i,o=0;this.m_enableMotor||this.m_enableLimit,i=t.m_xf.R;var u=this.m_localAnchor1.x-t.m_sweep.localCenter.x,a=this.m_localAnchor1.y-t.m_sweep.localCenter.y;o=i.col1.x*u+i.col2.x*a,a=i.col1.y*u+i.col2.y*a,u=o,i=r.m_xf.R;var f=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;o=i.col1.x*f+i.col2.x*l,l=i.col1.y*f+i.col2.y*l,f=o;var c=t.m_invMass,h=r.m_invMass,p=t.m_invI,d=r.m_invI;this.m_mass.col1.x=c+h+a*a*p+l*l*d,this.m_mass.col2.x=-a*u*p-l*f*d,this.m_mass.col3.x=-a*p-l*d,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=c+h+u*u*p+f*f*d,this.m_mass.col3.y=u*p+f*d,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=p+d,this.m_motorMass=1/(p+d),this.m_enableMotor==0&&(this.m_motorImpulse=0);if(this.m_enableLimit){var v=r.m_sweep.a-t.m_sweep.a-this.m_referenceAngle;s.Abs(this.m_upperAngle-this.m_lowerAngle)<2*n.b2_angularSlop?this.m_limitState=g.e_equalLimits:v<=this.m_lowerAngle?(this.m_limitState!=g.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=g.e_atLowerLimit):v>=this.m_upperAngle?(this.m_limitState!=g.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=g.e_atUpperLimit):(this.m_limitState=g.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=g.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var m=this.m_impulse.x,y=this.m_impulse.y;t.m_linearVelocity.x-=c*m,t.m_linearVelocity.y-=c*y,t.m_angularVelocity-=p*(u*y-a*m+this.m_motorImpulse+this.m_impulse.z),r.m_linearVelocity.x+=h*m,r.m_linearVelocity.y+=h*y,r.m_angularVelocity+=d*(f*y-l*m+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},L.prototype.SolveVelocityConstraints=function(e){var t=this.m_bodyA,n=this.m_bodyB,r,i=0,o=0,u=0,a=0,f=0,l=0,c=t.m_linearVelocity,h=t.m_angularVelocity,p=n.m_linearVelocity,d=n.m_angularVelocity,v=t.m_invMass,m=n.m_invMass,y=t.m_invI,b=n.m_invI;if(this.m_enableMotor&&this.m_limitState!=g.e_equalLimits){var w=d-h-this.m_motorSpeed,E=this.m_motorMass*-w,S=this.m_motorImpulse,x=e.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.Clamp(this.m_motorImpulse+E,-x,x),E=this.m_motorImpulse-S,h-=y*E,d+=b*E}if(this.m_enableLimit&&this.m_limitState!=g.e_inactiveLimit){r=t.m_xf.R,u=this.m_localAnchor1.x-t.m_sweep.localCenter.x,a=this.m_localAnchor1.y-t.m_sweep.localCenter.y,i=r.col1.x*u+r.col2.x*a,a=r.col1.y*u+r.col2.y*a,u=i,r=n.m_xf.R,f=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y,i=r.col1.x*f+r.col2.x*l,l=r.col1.y*f+r.col2.y*l,f=i;var T=p.x+ -d*l-c.x- -h*a,N=p.y+d*f-c.y-h*u,C=d-h;this.m_mass.Solve33(this.impulse3,-T,-N,-C),this.m_limitState==g.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==g.e_atLowerLimit?(o=this.m_impulse.z+this.impulse3.z,o<0&&(this.m_mass.Solve22(this.reduced,-T,-N),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==g.e_atUpperLimit&&(o=this.m_impulse.z+this.impulse3.z,o>0&&(this.m_mass.Solve22(this.reduced,-T,-N),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),c.x-=v*this.impulse3.x,c.y-=v*this.impulse3.y,h-=y*(u*this.impulse3.y-a*this.impulse3.x+this.impulse3.z),p.x+=m*this.impulse3.x,p.y+=m*this.impulse3.y,d+=b*(f*this.impulse3.y-l*this.impulse3.x+this.impulse3.z)}else{r=t.m_xf.R,u=this.m_localAnchor1.x-t.m_sweep.localCenter.x,a=this.m_localAnchor1.y-t.m_sweep.localCenter.y,i=r.col1.x*u+r.col2.x*a,a=r.col1.y*u+r.col2.y*a,u=i,r=n.m_xf.R,f=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y,i=r.col1.x*f+r.col2.x*l,l=r.col1.y*f+r.col2.y*l,f=i;var k=p.x+ -d*l-c.x- -h*a,L=p.y+d*f-c.y-h*u;this.m_mass.Solve22(this.impulse2,-k,-L),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,c.x-=v*this.impulse2.x,c.y-=v*this.impulse2.y,h-=y*(u*this.impulse2.y-a*this.impulse2.x),p.x+=m*this.impulse2.x,p.y+=m*this.impulse2.y,d+=b*(f*this.impulse2.y-l*this.impulse2.x)}t.m_linearVelocity.SetV(c),t.m_angularVelocity=h,n.m_linearVelocity.SetV(p),n.m_angularVelocity=d},L.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t=0,r=0,i,o=this.m_bodyA,u=this.m_bodyB,a=0,f=0,l=0,c=0,h=0;if(this.m_enableLimit&&this.m_limitState!=g.e_inactiveLimit){var p=u.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,d=0;this.m_limitState==g.e_equalLimits?(r=s.Clamp(p-this.m_lowerAngle,-n.b2_maxAngularCorrection,n.b2_maxAngularCorrection),d=-this.m_motorMass*r,a=s.Abs(r)):this.m_limitState==g.e_atLowerLimit?(r=p-this.m_lowerAngle,a=-r,r=s.Clamp(r+n.b2_angularSlop,-n.b2_maxAngularCorrection,0),d=-this.m_motorMass*r):this.m_limitState==g.e_atUpperLimit&&(r=p-this.m_upperAngle,a=r,r=s.Clamp(r-n.b2_angularSlop,0,n.b2_maxAngularCorrection),d=-this.m_motorMass*r),o.m_sweep.a-=o.m_invI*d,u.m_sweep.a+=u.m_invI*d,o.SynchronizeTransform(),u.SynchronizeTransform()}i=o.m_xf.R;var v=this.m_localAnchor1.x-o.m_sweep.localCenter.x,m=this.m_localAnchor1.y-o.m_sweep.localCenter.y;l=i.col1.x*v+i.col2.x*m,m=i.col1.y*v+i.col2.y*m,v=l,i=u.m_xf.R;var y=this.m_localAnchor2.x-u.m_sweep.localCenter.x,b=this.m_localAnchor2.y-u.m_sweep.localCenter.y;l=i.col1.x*y+i.col2.x*b,b=i.col1.y*y+i.col2.y*b,y=l;var w=u.m_sweep.c.x+y-o.m_sweep.c.x-v,E=u.m_sweep.c.y+b-o.m_sweep.c.y-m,S=w*w+E*E,x=Math.sqrt(S);f=x;var T=o.m_invMass,N=u.m_invMass,C=o.m_invI,k=u.m_invI,A=10*n.b2_linearSlop;if(S>A*A){var O=w/x,M=E/x,_=T+N,D=1/_;c=D*-w,h=D*-E;var P=.5;o.m_sweep.c.x-=P*T*c,o.m_sweep.c.y-=P*T*h,u.m_sweep.c.x+=P*N*c,u.m_sweep.c.y+=P*N*h,w=u.m_sweep.c.x+y-o.m_sweep.c.x-v,E=u.m_sweep.c.y+b-o.m_sweep.c.y-m}return this.K1.col1.x=T+N,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=T+N,this.K2.col1.x=C*m*m,this.K2.col2.x=-C*v*m,this.K2.col1.y=-C*v*m,this.K2.col2.y=C*v*v,this.K3.col1.x=k*b*b,this.K3.col2.x=-k*y*b,this.K3.col1.y=-k*y*b,this.K3.col2.y=k*y*y,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(L.tImpulse,-w,-E),c=L.tImpulse.x,h=L.tImpulse.y,o.m_sweep.c.x-=o.m_invMass*c,o.m_sweep.c.y-=o.m_invMass*h,o.m_sweep.a-=o.m_invI*(v*h-m*c),u.m_sweep.c.x+=u.m_invMass*c,u.m_sweep.c.y+=u.m_invMass*h,u.m_sweep.a+=u.m_invI*(y*h-b*c),o.SynchronizeTransform(),u.SynchronizeTransform(),f<=n.b2_linearSlop&&a<=n.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new a}),Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef),A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,A.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a},A.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},A.prototype.Initialize=function(e,t,n){this.bodyA=e,this.bodyB=t,this.localAnchorA=this.bodyA.GetLocalPoint(n),this.localAnchorB=this.bodyB.GetLocalPoint(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(O,Box2D.Dynamics.Joints.b2Joint),O.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,O.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new a,this.m_localAnchorB=new a,this.m_impulse=new f,this.m_mass=new i},O.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},O.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},O.prototype.GetReactionForce=function(e){return e===undefined&&(e=0),new a(e*this.m_impulse.x,e*this.m_impulse.y)},O.prototype.GetReactionTorque=function(e){return e===undefined&&(e=0),e*this.m_impulse.z},O.prototype.b2WeldJoint=function(e){this.__super.b2Joint.call(this,e),this.m_localAnchorA.SetV(e.localAnchorA),this.m_localAnchorB.SetV(e.localAnchorB),this.m_referenceAngle=e.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},O.prototype.InitVelocityConstraints=function(e){var t,n=0,r=this.m_bodyA,i=this.m_bodyB;t=r.m_xf.R;var s=this.m_localAnchorA.x-r.m_sweep.localCenter.x,o=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=t.col1.x*s+t.col2.x*o,o=t.col1.y*s+t.col2.y*o,s=n,t=i.m_xf.R;var u=this.m_localAnchorB.x-i.m_sweep.localCenter.x,a=this.m_localAnchorB.y-i.m_sweep.localCenter.y;n=t.col1.x*u+t.col2.x*a,a=t.col1.y*u+t.col2.y*a,u=n;var f=r.m_invMass,l=i.m_invMass,c=r.m_invI,h=i.m_invI;this.m_mass.col1.x=f+l+o*o*c+a*a*h,this.m_mass.col2.x=-o*s*c-a*u*h,this.m_mass.col3.x=-o*c-a*h,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=f+l+s*s*c+u*u*h,this.m_mass.col3.y=s*c+u*h,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+h,e.warmStarting?(this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_impulse.z*=e.dtRatio,r.m_linearVelocity.x-=f*this.m_impulse.x,r.m_linearVelocity.y-=f*this.m_impulse.y,r.m_angularVelocity-=c*(s*this.m_impulse.y-o*this.m_impulse.x+this.m_impulse.z),i.m_linearVelocity.x+=l*this.m_impulse.x,i.m_linearVelocity.y+=l*this.m_impulse.y,i.m_angularVelocity+=h*(u*this.m_impulse.y-a*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},O.prototype.SolveVelocityConstraints=function(e){var t,n=0,r=this.m_bodyA,i=this.m_bodyB,s=r.m_linearVelocity,o=r.m_angularVelocity,u=i.m_linearVelocity,a=i.m_angularVelocity,l=r.m_invMass,c=i.m_invMass,h=r.m_invI,p=i.m_invI;t=r.m_xf.R;var d=this.m_localAnchorA.x-r.m_sweep.localCenter.x,v=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=t.col1.x*d+t.col2.x*v,v=t.col1.y*d+t.col2.y*v,d=n,t=i.m_xf.R;var m=this.m_localAnchorB.x-i.m_sweep.localCenter.x,g=this.m_localAnchorB.y-i.m_sweep.localCenter.y;n=t.col1.x*m+t.col2.x*g,g=t.col1.y*m+t.col2.y*g,m=n;var y=u.x-a*g-s.x+o*v,b=u.y+a*m-s.y-o*d,w=a-o,E=new f;this.m_mass.Solve33(E,-y,-b,-w),this.m_impulse.Add(E),s.x-=l*E.x,s.y-=l*E.y,o-=h*(d*E.y-v*E.x+E.z),u.x+=c*E.x,u.y+=c*E.y,a+=p*(m*E.y-g*E.x+E.z),r.m_angularVelocity=o,i.m_angularVelocity=a},O.prototype.SolvePositionConstraints=function(e){e===undefined&&(e=0);var t,r=0,i=this.m_bodyA,o=this.m_bodyB;t=i.m_xf.R;var u=this.m_localAnchorA.x-i.m_sweep.localCenter.x,a=this.m_localAnchorA.y-i.m_sweep.localCenter.y;r=t.col1.x*u+t.col2.x*a,a=t.col1.y*u+t.col2.y*a,u=r,t=o.m_xf.R;var l=this.m_localAnchorB.x-o.m_sweep.localCenter.x,c=this.m_localAnchorB.y-o.m_sweep.localCenter.y;r=t.col1.x*l+t.col2.x*c,c=t.col1.y*l+t.col2.y*c,l=r;var h=i.m_invMass,p=o.m_invMass,d=i.m_invI,v=o.m_invI,m=o.m_sweep.c.x+l-i.m_sweep.c.x-u,g=o.m_sweep.c.y+c-i.m_sweep.c.y-a,y=o.m_sweep.a-i.m_sweep.a-this.m_referenceAngle,b=10*n.b2_linearSlop,w=Math.sqrt(m*m+g*g),E=s.Abs(y);w>b&&(d*=1,v*=1),this.m_mass.col1.x=h+p+a*a*d+c*c*v,this.m_mass.col2.x=-a*u*d-c*l*v,this.m_mass.col3.x=-a*d-c*v,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=h+p+u*u*d+l*l*v,this.m_mass.col3.y=u*d+l*v,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=d+v;var S=new f;return this.m_mass.Solve33(S,-m,-g,-y),i.m_sweep.c.x-=h*S.x,i.m_sweep.c.y-=h*S.y,i.m_sweep.a-=d*(u*S.y-a*S.x+S.z),o.m_sweep.c.x+=p*S.x,o.m_sweep.c.y+=p*S.y,o.m_sweep.a+=v*(l*S.y-c*S.x+S.z),i.SynchronizeTransform(),o.SynchronizeTransform(),w<=n.b2_linearSlop&&E<=n.b2_angularSlop},Box2D.inherit(M,Box2D.Dynamics.Joints.b2JointDef),M.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,M.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new a,this.localAnchorB=new a},M.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=g.e_weldJoint,this.referenceAngle=0},M.prototype.Initialize=function(e,t,n){this.bodyA=e,this.bodyB=t,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(n)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var e=Box2D.Dynamics.b2DebugDraw;e.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var e=this;this.m_sprite={graphics:{clear:function(){e.m_ctx.clearRect(0,0,e.m_ctx.canvas.width,e.m_ctx.canvas.height)}}}},e.prototype._color=function(e,t){return"rgba("+((e&16711680)>>16)+","+((e&65280)>>8)+","+(e&255)+","+t+")"},e.prototype.b2DebugDraw=function(){this.m_drawFlags=0},e.prototype.SetFlags=function(e){e===undefined&&(e=0),this.m_drawFlags=e},e.prototype.GetFlags=function(){return this.m_drawFlags},e.prototype.AppendFlags=function(e){e===undefined&&(e=0),this.m_drawFlags|=e},e.prototype.ClearFlags=function(e){e===undefined&&(e=0),this.m_drawFlags&=~e},e.prototype.SetSprite=function(e){this.m_ctx=e},e.prototype.GetSprite=function(){return this.m_ctx},e.prototype.SetDrawScale=function(e){e===undefined&&(e=0),this.m_drawScale=e},e.prototype.GetDrawScale=function(){return this.m_drawScale},e.prototype.SetLineThickness=function(e){e===undefined&&(e=0),this.m_lineThickness=e,this.m_ctx.strokeWidth=e},e.prototype.GetLineThickness=function(){return this.m_lineThickness},e.prototype.SetAlpha=function(e){e===undefined&&(e=0),this.m_alpha=e},e.prototype.GetAlpha=function(){return this.m_alpha},e.prototype.SetFillAlpha=function(e){e===undefined&&(e=0),this.m_fillAlpha=e},e.prototype.GetFillAlpha=function(){return this.m_fillAlpha},e.prototype.SetXFormScale=function(e){e===undefined&&(e=0),this.m_xformScale=e},e.prototype.GetXFormScale=function(){return this.m_xformScale},e.prototype.DrawPolygon=function(e,t,n){if(!t)return;var r=this.m_ctx,i=this.m_drawScale;r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.moveTo(e[0].x*i,e[0].y*i);for(var s=1;s<t;s++)r.lineTo(e[s].x*i,e[s].y*i);r.lineTo(e[0].x*i,e[0].y*i),r.closePath(),r.stroke()},e.prototype.DrawSolidPolygon=function(e,t,n){if(!t)return;var r=this.m_ctx,i=this.m_drawScale;r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.fillStyle=this._color(n.color,this.m_fillAlpha),r.moveTo(e[0].x*i,e[0].y*i);for(var s=1;s<t;s++)r.lineTo(e[s].x*i,e[s].y*i);r.lineTo(e[0].x*i,e[0].y*i),r.closePath(),r.fill(),r.stroke()},e.prototype.DrawCircle=function(e,t,n){if(!t)return;var r=this.m_ctx,i=this.m_drawScale;r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.arc(e.x*i,e.y*i,t*i,0,Math.PI*2,!0),r.closePath(),r.stroke()},e.prototype.DrawSolidCircle=function(e,t,n,r){if(!t)return;var i=this.m_ctx,s=this.m_drawScale,o=e.x*s,u=e.y*s;i.moveTo(0,0),i.beginPath(),i.strokeStyle=this._color(r.color,this.m_alpha),i.fillStyle=this._color(r.color,this.m_fillAlpha),i.arc(o,u,t*s,0,Math.PI*2,!0),i.moveTo(o,u),i.lineTo((e.x+n.x*t)*s,(e.y+n.y*t)*s),i.closePath(),i.fill(),i.stroke()},e.prototype.DrawSegment=function(e,t,n){var r=this.m_ctx,i=this.m_drawScale;r.strokeStyle=this._color(n.color,this.m_alpha),r.beginPath(),r.moveTo(e.x*i,e.y*i),r.lineTo(t.x*i,t.y*i),r.closePath(),r.stroke()},e.prototype.DrawTransform=function(e){var t=this.m_ctx,n=this.m_drawScale;t.beginPath(),t.strokeStyle=this._color(16711680,this.m_alpha),t.moveTo(e.position.x*n,e.position.y*n),t.lineTo((e.position.x+this.m_xformScale*e.R.col1.x)*n,(e.position.y+this.m_xformScale*e.R.col1.y)*n),t.strokeStyle=this._color(65280,this.m_alpha),t.moveTo(e.position.x*n,e.position.y*n),t.lineTo((e.position.x+this.m_xformScale*e.R.col2.x)*n,(e.position.y+this.m_xformScale*e.R.col2.y)*n),t.closePath(),t.stroke()}}();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs,tagpro.ready(function(){tagpro.world=new function(){function s(e){if(!tagpro.map){setTimeout(function(){s(e)},0);return}e()}function c(e){if(e.rx==undefined||e.ry==undefined||e.lx==undefined||e.ly==undefined||e.a==undefined)return;e.sync=null;var r=new Box2D.Dynamics.b2FixtureDef,i=new Box2D.Dynamics.b2BodyDef,s=.19;r.density=1,r.friction=.5,r.restitution=.2,r.shape=new Box2D.Collision.Shapes.b2CircleShape(s),i.type=Box2D.Dynamics.b2Body.b2_dynamicBody,i.linearDamping=.5,i.angularDamping=.5,tagpro.events.setPlayerPhysics&&tagpro.events.setPlayerPhysics.forEach(function(e){e.setPlayerPhysics(Box2D,i,r)});var o=t.CreateBody(i),u=o.CreateFixture(r);return o.SetPosition(new Box2D.Common.Math.b2Vec2(e.rx,e.ry)),e.x=e.rx*100,e.y=e.ry*100,e.angle=e.ra,o.player=e,o.fixture=u,n[e.id]=o,o}function h(e){if(e.rx==undefined||e.ry==undefined||e.lx==undefined||e.ly==undefined||e.a==undefined)return;var n=new Box2D.Dynamics.b2FixtureDef,r=new Box2D.Dynamics.b2BodyDef,i=.39;n.density=2,n.friction=.5,n.restitution=.6,n.shape=new Box2D.Collision.Shapes.b2CircleShape(i),r.type=Box2D.Dynamics.b2Body.b2_dynamicBody,r.linearDamping=.5,r.angularDamping=.5,e.sensor&&(n.isSensor=!0);var s=t.CreateBody(r),o=s.CreateFixture(n);return s.SetPosition(new Box2D.Common.Math.b2Vec2(e.rx,e.ry)),e.x=e.rx*100,e.y=e.ry*100,s.object=e,s}function p(e){for(var t in n){var r=n[t],i=r.player;if(i.dead)continue;var s=r.GetWorldCenter(),o=new Box2D.Common.Math.b2Vec2(0,0);o.Add(s),o.Subtract(e.position);if(o.Length()>2.6)continue;var u=.06*r.GetMass()/Math.pow(o.Length(),2);o.NegativeSelf(),o.Multiply(u),r.ApplyImpulse(o,s)}}var e=tagpro.events.gravity?tagpro.events.gravity.map(function(e){return e.gravity})[0]:{x:0,y:0},t=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(e.x,e.y),!0),n={},r={},i=[];this._objectBodies=r,this._b2World=t;var o=1e3/60,u=performance.now()+o,a=!0;setTimeout(function(){a=!1},5e3),this.update=function(e){if(tagpro.state!==1&&tagpro.state!==5)return;var s=performance.now();if(u-s>o)return;for(var a in n){var f=n[a],l=f.player;f.SetAwake(!0);if(!l.draw||l.dead){f.SetPosition(new Box2D.Common.Math.b2Vec2(-100,-100));continue}var c=f.GetPosition(),h=f.GetAngle(),d=l.sync;d&&(d.frame--,d.step.x>0&&c.x<d.to.x||d.step.x<0&&c.x>d.to.x?c.x+=d.step.x:d.step.x=0,d.step.y>0&&c.y<d.to.y||d.step.y<0&&c.y>d.to.y?c.y+=d.step.y:d.step.y=0,d.step.a>0&&h<d.to.a||d.step.a<0&&h>d.to.a?h+=d.step.a:d.step.a=0,d.frame<=0&&(l.sync=null));var v=f.GetLinearVelocity();if(tagpro.events.playerControls)tagpro.events.playerControls.forEach(function(e){e.playerControls(l,f,v)});else if(tagpro.state===1||tagpro.state===5)l.left&&v.x>-l.ms&&(v.x-=l.ac),l.right&&v.x<l.ms&&(v.x+=l.ac),l.up&&v.y>-l.ms&&(v.y-=l.ac),l.down&&v.y<l.ms&&(v.y+=l.ac);f.SetPosition(c),f.SetAngle(h),f.SetLinearVelocity(v),l.speed=v.Length(),l.x=c.x*100,l.y=c.y*100,l.angle=h,tagpro.events.playerUpdate&&tagpro.events.playerUpdate.forEach(function(e){e.playerUpdate(l,f)})}i.forEach(function(e){p(e)});for(var a in r){var f=r[a],m=f.object;f.SetAwake(!0);if(!m.draw){f.SetPosition(new Box2D.Common.Math.b2Vec2(-100,-100));continue}var c=f.GetPosition(),d=m.sync;d&&(d.frame--,d.step.x>0&&c.x<d.to.x||d.step.x<0&&c.x>d.to.x?c.x+=d.step.x:d.step.x=0,d.step.y>0&&c.y<d.to.y||d.step.y<0&&c.y>d.to.y?c.y+=d.step.y:d.step.y=0,d.frame<=0&&(m.sync=null)),f.SetPosition(c),m.x=c.x*100,m.y=c.y*100,tagpro.events.objectUpdate&&tagpro.events.objectUpdate.forEach(function(e){e.objectUpdate(t,m,f)})}t.Step(1/60,8,3);for(var a in n){var f=n[a],l=f.player;if(l.dead)continue;var v=f.GetLinearVelocity(),c=f.GetPosition(),h=f.GetAngle();l.speed=v.Length(),l.x=c.x*100,l.y=c.y*100,l.angle=h}tagpro.events.update&&tagpro.events.update.forEach(function(e){e.update()}),u+=o;var s=performance.now();if(s>=u){if(e>=10){u=s;return}tagpro.world.update((e||0)+1)}};var f=new Box2D.Dynamics.b2FixtureDef,l=new Box2D.Dynamics.b2BodyDef;f.density=1,f.friction=.5,f.restitution=.2,f.filter.categoryBits=-1,l.type=Box2D.Dynamics.b2Body.b2_staticBody,tagpro.events.setWallPhysics&&tagpro.events.setWallPhysics.forEach(function(e){e.setWallPhysics(Box2D,l,f)}),s(function(){var e=tagpro.map;for(var n=0,r=e.length;n!=r;n++)for(var i=0,s=e[0].length;i!=s;i++){if(parseInt(e[n][i])!=1)continue;f.shape=new Box2D.Collision.Shapes.b2PolygonShape,e[n][i]==1.1?f.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(-0.2,.2),new Box2D.Common.Math.b2Vec2(-0.2,-0.2),new Box2D.Common.Math.b2Vec2(.2,.2)]):e[n][i]==1.2?f.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(-0.2,-0.2),new Box2D.Common.Math.b2Vec2(.2,-0.2),new Box2D.Common.Math.b2Vec2(-0.2,.2)]):e[n][i]==1.3?f.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(.2,-0.2),new Box2D.Common.Math.b2Vec2(.2,.2),new Box2D.Common.Math.b2Vec2(-0.2,-0.2)]):e[n][i]==1.4?f.shape.SetAsArray([new Box2D.Common.Math.b2Vec2(.2,.2),new Box2D.Common.Math.b2Vec2(-0.2,.2),new Box2D.Common.Math.b2Vec2(.2,-0.2)]):f.shape.SetAsBox(.2,.2),l.position.Set(n*.4,i*.4);var o=t.CreateBody(l);o.CreateFixture(f)}}),this.syncObject=function(e,n){var i=r[e.id]||(r[e.id]=this.objectCreators[e.type](e,t));if(!i)return;if(!e.draw)return;i.SetAwake(!0);if(!n){var s=i.GetPosition();e.sync={to:{x:e.rx,y:e.ry},frame:Math.ceil((tagpro.fps||60)/10)},e.sync.step={x:(e.sync.to.x-s.x)/e.sync.frame,y:(e.sync.to.y-s.y)/e.sync.frame},e.sync.frame==0&&(e.sync=null)}else e.sync=null,i.SetPosition(new Box2D.Common.Math.b2Vec2(e.rx,e.ry));i.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(e.lx,e.ly)),i.SetAngularVelocity(e.a)},this.syncPlayer=function(e,t){var r=n[e.id]||c(e);if(!r)return;r.SetAwake(!0);if(!t){if(e.dead||!e.draw)return;var i=r.GetPosition(),s=r.GetAngle();e.sync={to:{x:e.rx,y:e.ry,a:e.ra},frame:Math.ceil((tagpro.fps||60)/10)},e.sync.step={x:(e.sync.to.x-i.x)/e.sync.frame,y:(e.sync.to.y-i.y)/e.sync.frame,a:(e.sync.to.a-s)/e.sync.frame},e.sync.frame==0&&(e.sync=null)}else e.sync=null,r.SetPosition(new Box2D.Common.Math.b2Vec2(e.rx,e.ry)),r.SetAngle(e.ra),e.x=e.rx*100,e.y=e.ry*100;r.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(e.lx,e.ly)),r.SetAngularVelocity(e.a),r.fixture.GetDensity()!=e.den&&(r.fixture.SetDensity(e.den),r.ResetMassData())},this.destoryPlayer=function(e){var r=n[e];if(!r)return;t.DestroyBody(r),delete n[e]},this.createGravityWell=function(e,t){i.push({position:new Box2D.Common.Math.b2Vec2(e,t)})},this.objectCreators={marsball:h}}}),tagpro.ready(function(){tagpro.musicPlayer=new function(){var e=$("audio#music"),t=["mp3","m4a","ogg"],n=!1,r=!1,i=this;this.list=[],this.current=null,this.disabled=!1,this.next=function(){if(!tagpro.music||i.disabled)return;n=!1;if(!r)return;var s=tagpro.musicPlayer.list.shift();s.volume=parseFloat(s.volume||.5),tagpro.musicPlayer.list.push(s),tagpro.musicPlayer.mute(),tagpro.musicPlayer.current=s,e=$("<audio id='music' volume='"+s.volume+"' autoplay='true'>").appendTo($(document.body)),e[0].volume=s.volume*tagpro.volumeCoefficient,t.forEach(function(t){e.append("<source type='audio/"+t+"' src='http://"+tagproConfig.cdn+"/sounds/music/"+s.url+"."+t+"'></source>")}),e.on("ended",tagpro.musicPlayer.next)},this.refreshVolume=function(){if(!e||!e.length)return;e[0].volume=e[0].getAttribute("volume")*tagpro.volumeCoefficient},this.mute=function(){n=!0;if(!e||!e.length)return;e[0].pause(),e.remove(),tagpro.musicPlayer.current=null},this.disable=function(){if(i.disabled)return;i.disabled=!0,i.mute()},this.keyBindings={190:this.next},$(document).on("keyup",function(e){if(tagpro.disableControls)return;var t=tagpro.musicPlayer.keyBindings[e.which];t&&t()}),this.setList=function(){$.ajax({timeout:1e3,dataType:"json",url:"http://"+tagproConfig.musicHost+"/music?callback=?",success:function(e){while(e.length)tagpro.musicPlayer.list.push(e.splice(Math.floor(Math.random()*e.length),1)[0]);r=!0;if(n||!tagpro.music)return;tagpro.musicPlayer.next()}})},setTimeout(function(){if(tagpro.musicPlayer.setList()){r=!0;if(n||!tagpro.music)return;tagpro.musicPlayer.next()}})}}),tagpro.ready(function(){tagpro.sound=undefined,tagpro.music=undefined,tagpro.volume=undefined,tagpro.volumeCoefficient=1;var e=function(e,t){$.cookie(e,t,{expires:36500,path:"/",domain:tagproConfig.cookieHost}),tagpro[e]=t},t=function(e,t){tagpro[e]=t},n=function(e){if(!e||e=="music")tagpro.music?tagpro.musicPlayer.next():tagpro.musicPlayer.mute();if(!e||e=="sound")tagpro.sound||$("audio").not("#music").each(function(){this.play&&(this.pause(),this.readyState==4&&(this.currentTime=0))});if(!e||e=="volume")tagpro.volumeCoefficient=Math.pow(10,tagpro.volume/20),tagpro.musicPlayer.refreshVolume()};$(window).ready(function(){tagpro.sound=$.cookie("sound"),tagpro.music=$.cookie("music"),tagpro.volume=$.cookie("volume"),tagpro.sound==undefined&&e("sound",!0),tagpro.music==undefined&&e("music",!1),tagpro.volume==undefined?e("volume",0):tagpro.volume=Math.min(parseInt(tagpro.volume),0)}),$.fn.soundControl=function(){var r=$(this),i=$(this).find("#soundEffects"),s=$(this).find("#soundMusic");$slider=$(this).find("#volumeSlider");var o=function(){tagpro.sound?i.removeClass("off"):i.addClass("off"),tagpro.music?s.removeClass("off"):s.addClass("off"),$slider.val(tagpro.volume)};i.click(function(t){t.preventDefault(),e("sound",!tagpro.sound),o(),n("sound")}),s.click(function(t){t.preventDefault(),e("music",!tagpro.music),o(),n("music")}),$slider.change(function(t){e("volume",parseInt($slider.val())),n("volume")}),$slider.on("input",function(e){t("volume",parseInt($slider.val())),n("volume")}),o(),n()},$(document).ready(function(){$("div#sound").soundControl()})})
